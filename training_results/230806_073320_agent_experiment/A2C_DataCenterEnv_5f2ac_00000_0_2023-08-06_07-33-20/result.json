{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.8131314380523, "policy_loss": -2760052.097627779, "vf_loss": 4564682.942419825}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 343.5, "diff_num_grad_updates_vs_sampler_policy": 342.5}}, "num_env_steps_sampled": 4240560, "num_env_steps_trained": 4240560, "num_agent_steps_sampled": 4240560, "num_agent_steps_trained": 4240560}, "sampler_results": {"episode_reward_max": -157668.0116319876, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -157668.0116319876, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876], "episode_lengths": [43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.133963687148311, "mean_inference_ms": 0.22891793446783915, "mean_action_processing_ms": 0.055932555703831724, "mean_env_wait_ms": 0.4843426506358801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001811981201171875, "StateBufferConnector_ms": 0.001621246337890625, "ViewRequirementAgentConnector_ms": 0.04150867462158203}}, "episode_reward_max": -157668.0116319876, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -157668.0116319876, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876], "episode_lengths": [43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.133963687148311, "mean_inference_ms": 0.22891793446783915, "mean_action_processing_ms": 0.055932555703831724, "mean_env_wait_ms": 0.4843426506358801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001811981201171875, "StateBufferConnector_ms": 0.001621246337890625, "ViewRequirementAgentConnector_ms": 0.04150867462158203}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4240560, "num_agent_steps_trained": 4240560, "num_env_steps_sampled": 4240560, "num_env_steps_trained": 4240560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1073.2354414134118, "num_env_steps_trained_throughput_per_sec": 1073.2354414134118, "timesteps_total": 4240560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4240560, "timers": {"training_iteration_time_ms": 40922.963, "sample_time_ms": 40205.032, "load_time_ms": 0.588, "load_throughput": 74701472.701, "learn_time_ms": 716.474, "learn_throughput": 61300.196, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 4240560, "num_env_steps_trained": 4240560, "num_agent_steps_sampled": 4240560, "num_agent_steps_trained": 4240560}, "done": false, "episodes_total": 7549, "training_iteration": 1726, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-34-05", "timestamp": 1691296445, "time_this_iter_s": 40.92504000663757, "time_total_s": 22320.540736198425, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 40.92504000663757, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 21.68813559322034, "ram_util_percent": 70.83898305084747}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-10, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0571327765551, "policy_loss": -2507731.1928070337, "vf_loss": 4619834.87244898}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1029.5, "diff_num_grad_updates_vs_sampler_policy": 1028.5}}, "num_env_steps_sampled": 4284480, "num_env_steps_trained": 4284480, "num_agent_steps_sampled": 4284480, "num_agent_steps_trained": 4284480}, "sampler_results": {"episode_reward_max": -157527.2373972028, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -157597.6245145952, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028], "episode_lengths": [43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13391097032325489, "mean_inference_ms": 0.22845664991613546, "mean_action_processing_ms": 0.05581342865220481, "mean_env_wait_ms": 0.474279525847082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022292137145996094, "StateBufferConnector_ms": 0.0020265579223632812, "ViewRequirementAgentConnector_ms": 0.04392862319946289}}, "episode_reward_max": -157527.2373972028, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -157597.6245145952, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028], "episode_lengths": [43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13391097032325489, "mean_inference_ms": 0.22845664991613546, "mean_action_processing_ms": 0.05581342865220481, "mean_env_wait_ms": 0.474279525847082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022292137145996094, "StateBufferConnector_ms": 0.0020265579223632812, "ViewRequirementAgentConnector_ms": 0.04392862319946289}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4284480, "num_agent_steps_trained": 4284480, "num_env_steps_sampled": 4284480, "num_env_steps_trained": 4284480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1124.2498266606508, "num_env_steps_trained_throughput_per_sec": 1124.2498266606508, "timesteps_total": 4284480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4284480, "timers": {"training_iteration_time_ms": 39994.499, "sample_time_ms": 39274.993, "load_time_ms": 7.584, "load_throughput": 5791248.756, "learn_time_ms": 711.084, "learn_throughput": 61764.885, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 4284480, "num_env_steps_trained": 4284480, "num_agent_steps_sampled": 4284480, "num_agent_steps_trained": 4284480}, "done": false, "episodes_total": 7550, "training_iteration": 1727, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-34-44", "timestamp": 1691296484, "time_this_iter_s": 39.06788969039917, "time_total_s": 22359.608625888824, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 79.99292969703674, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 17.292727272727273, "ram_util_percent": 71.28727272727274}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.4750000000000006e-10, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.15668752242107, "policy_loss": -2255355.915457589, "vf_loss": 4517949.816690962}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1715.5, "diff_num_grad_updates_vs_sampler_policy": 1714.5}}, "num_env_steps_sampled": 4328400, "num_env_steps_trained": 4328400, "num_agent_steps_sampled": 4328400, "num_agent_steps_trained": 4328400}, "sampler_results": {"episode_reward_max": -156176.02912270022, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -157123.75938396354, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022], "episode_lengths": [43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1339223998855382, "mean_inference_ms": 0.2283189005512608, "mean_action_processing_ms": 0.05577312087850311, "mean_env_wait_ms": 0.46855245593195133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022967656453450522, "StateBufferConnector_ms": 0.0018437703450520833, "ViewRequirementAgentConnector_ms": 0.04432201385498047}}, "episode_reward_max": -156176.02912270022, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -157123.75938396354, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022], "episode_lengths": [43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1339223998855382, "mean_inference_ms": 0.2283189005512608, "mean_action_processing_ms": 0.05577312087850311, "mean_env_wait_ms": 0.46855245593195133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022967656453450522, "StateBufferConnector_ms": 0.0018437703450520833, "ViewRequirementAgentConnector_ms": 0.04432201385498047}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4328400, "num_agent_steps_trained": 4328400, "num_env_steps_sampled": 4328400, "num_env_steps_trained": 4328400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1124.1553825888461, "num_env_steps_trained_throughput_per_sec": 1124.1553825888461, "timesteps_total": 4328400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4328400, "timers": {"training_iteration_time_ms": 39686.105, "sample_time_ms": 38966.101, "load_time_ms": 10.083, "load_throughput": 4356035.368, "learn_time_ms": 709.109, "learn_throughput": 61936.875, "synch_weights_time_ms": 0.691}, "counters": {"num_env_steps_sampled": 4328400, "num_env_steps_trained": 4328400, "num_agent_steps_sampled": 4328400, "num_agent_steps_trained": 4328400}, "done": false, "episodes_total": 7551, "training_iteration": 1728, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-35-23", "timestamp": 1691296523, "time_this_iter_s": 39.07114291191101, "time_total_s": 22398.679768800735, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 119.06407260894775, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 17.401785714285715, "ram_util_percent": 71.57321428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.950000000000001e-10, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.25703207744453, "policy_loss": -2012372.2141091928, "vf_loss": 4589606.600400874}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2401.5, "diff_num_grad_updates_vs_sampler_policy": 2400.5}}, "num_env_steps_sampled": 4372320, "num_env_steps_trained": 4372320, "num_agent_steps_sampled": 4372320, "num_agent_steps_trained": 4372320}, "sampler_results": {"episode_reward_max": -156176.02912270022, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -157019.64688032036, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908], "episode_lengths": [43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13388428053210766, "mean_inference_ms": 0.2281941787791863, "mean_action_processing_ms": 0.05573811382030426, "mean_env_wait_ms": 0.46489541278292024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002187490463256836, "StateBufferConnector_ms": 0.0018358230590820312, "ViewRequirementAgentConnector_ms": 0.043767690658569336}}, "episode_reward_max": -156176.02912270022, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -157019.64688032036, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908], "episode_lengths": [43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13388428053210766, "mean_inference_ms": 0.2281941787791863, "mean_action_processing_ms": 0.05573811382030426, "mean_env_wait_ms": 0.46489541278292024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002187490463256836, "StateBufferConnector_ms": 0.0018358230590820312, "ViewRequirementAgentConnector_ms": 0.043767690658569336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4372320, "num_agent_steps_trained": 4372320, "num_env_steps_sampled": 4372320, "num_env_steps_trained": 4372320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1124.3870616058211, "num_env_steps_trained_throughput_per_sec": 1124.3870616058211, "timesteps_total": 4372320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4372320, "timers": {"training_iteration_time_ms": 39529.896, "sample_time_ms": 38807.067, "load_time_ms": 12.672, "load_throughput": 3465809.342, "learn_time_ms": 709.318, "learn_throughput": 61918.623, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 4372320, "num_env_steps_trained": 4372320, "num_agent_steps_sampled": 4372320, "num_agent_steps_trained": 4372320}, "done": false, "episodes_total": 7552, "training_iteration": 1729, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-36-02", "timestamp": 1691296562, "time_this_iter_s": 39.063477993011475, "time_total_s": 22437.743246793747, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 158.12755060195923, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 18.005454545454548, "ram_util_percent": 71.40727272727274}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.425e-10, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.18299042726744, "policy_loss": -1902242.2986914632, "vf_loss": 4357336.929300291}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3087.5, "diff_num_grad_updates_vs_sampler_policy": 3086.5}}, "num_env_steps_sampled": 4416240, "num_env_steps_trained": 4416240, "num_agent_steps_sampled": 4416240, "num_agent_steps_trained": 4416240}, "sampler_results": {"episode_reward_max": -153804.05517566946, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -156376.5285393902, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946], "episode_lengths": [43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13382551276007804, "mean_inference_ms": 0.22809949222367995, "mean_action_processing_ms": 0.055719956445624094, "mean_env_wait_ms": 0.4621630761081629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027179718017578125, "StateBufferConnector_ms": 0.0017690658569335938, "ViewRequirementAgentConnector_ms": 0.04372596740722656}}, "episode_reward_max": -153804.05517566946, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -156376.5285393902, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946], "episode_lengths": [43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13382551276007804, "mean_inference_ms": 0.22809949222367995, "mean_action_processing_ms": 0.055719956445624094, "mean_env_wait_ms": 0.4621630761081629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027179718017578125, "StateBufferConnector_ms": 0.0017690658569335938, "ViewRequirementAgentConnector_ms": 0.04372596740722656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4416240, "num_agent_steps_trained": 4416240, "num_env_steps_sampled": 4416240, "num_env_steps_trained": 4416240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1129.5954283689541, "num_env_steps_trained_throughput_per_sec": 1129.5954283689541, "timesteps_total": 4416240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4416240, "timers": {"training_iteration_time_ms": 39400.149, "sample_time_ms": 38677.333, "load_time_ms": 12.479, "load_throughput": 3519561.171, "learn_time_ms": 709.51, "learn_throughput": 61901.889, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 4416240, "num_env_steps_trained": 4416240, "num_agent_steps_sampled": 4416240, "num_agent_steps_trained": 4416240}, "done": false, "episodes_total": 7553, "training_iteration": 1730, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-36-41", "timestamp": 1691296601, "time_this_iter_s": 38.88305687904358, "time_total_s": 22476.62630367279, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 197.0106074810028, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 17.725, "ram_util_percent": 71.19107142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.9000000000000003e-10, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.05837750226345, "policy_loss": -1996806.192912377, "vf_loss": 4520584.485787172}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3773.5, "diff_num_grad_updates_vs_sampler_policy": 3772.5}}, "num_env_steps_sampled": 4460160, "num_env_steps_trained": 4460160, "num_agent_steps_sampled": 4460160, "num_agent_steps_trained": 4460160}, "sampler_results": {"episode_reward_max": -153804.05517566946, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -156273.85920155022, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13378507738709378, "mean_inference_ms": 0.22801799598044603, "mean_action_processing_ms": 0.05570491348134712, "mean_env_wait_ms": 0.4598745408550229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026941299438476562, "StateBufferConnector_ms": 0.0017603238423665364, "ViewRequirementAgentConnector_ms": 0.043872992197672524}}, "episode_reward_max": -153804.05517566946, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -156273.85920155022, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13378507738709378, "mean_inference_ms": 0.22801799598044603, "mean_action_processing_ms": 0.05570491348134712, "mean_env_wait_ms": 0.4598745408550229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026941299438476562, "StateBufferConnector_ms": 0.0017603238423665364, "ViewRequirementAgentConnector_ms": 0.043872992197672524}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4460160, "num_agent_steps_trained": 4460160, "num_env_steps_sampled": 4460160, "num_env_steps_trained": 4460160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1137.2346249274374, "num_env_steps_trained_throughput_per_sec": 1137.2346249274374, "timesteps_total": 4460160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4460160, "timers": {"training_iteration_time_ms": 39270.121, "sample_time_ms": 38547.579, "load_time_ms": 12.635, "load_throughput": 3476005.944, "learn_time_ms": 709.092, "learn_throughput": 61938.392, "synch_weights_time_ms": 0.696}, "counters": {"num_env_steps_sampled": 4460160, "num_env_steps_trained": 4460160, "num_agent_steps_sampled": 4460160, "num_agent_steps_trained": 4460160}, "done": false, "episodes_total": 7554, "training_iteration": 1731, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-37-20", "timestamp": 1691296640, "time_this_iter_s": 38.6220281124115, "time_total_s": 22515.248331785202, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 235.6326355934143, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 17.007272727272728, "ram_util_percent": 71.09454545454545}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.3750000000000006e-10, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.09202250933856, "policy_loss": -2071584.4136041135, "vf_loss": 4321092.429664723}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4459.5, "diff_num_grad_updates_vs_sampler_policy": 4458.5}}, "num_env_steps_sampled": 4504080, "num_env_steps_trained": 4504080, "num_agent_steps_sampled": 4504080, "num_agent_steps_trained": 4504080}, "sampler_results": {"episode_reward_max": -153422.9286911195, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155866.5834143458, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13374951277490668, "mean_inference_ms": 0.2279517140299408, "mean_action_processing_ms": 0.05569644491947683, "mean_env_wait_ms": 0.4581627680173092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026328223092215402, "StateBufferConnector_ms": 0.0017745154244559152, "ViewRequirementAgentConnector_ms": 0.04392351422991071}}, "episode_reward_max": -153422.9286911195, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155866.5834143458, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13374951277490668, "mean_inference_ms": 0.2279517140299408, "mean_action_processing_ms": 0.05569644491947683, "mean_env_wait_ms": 0.4581627680173092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026328223092215402, "StateBufferConnector_ms": 0.0017745154244559152, "ViewRequirementAgentConnector_ms": 0.04392351422991071}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4504080, "num_agent_steps_trained": 4504080, "num_env_steps_sampled": 4504080, "num_env_steps_trained": 4504080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1124.1505805392926, "num_env_steps_trained_throughput_per_sec": 1124.1505805392926, "timesteps_total": 4504080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4504080, "timers": {"training_iteration_time_ms": 39241.459, "sample_time_ms": 38519.812, "load_time_ms": 12.57, "load_throughput": 3494031.604, "learn_time_ms": 708.267, "learn_throughput": 62010.521, "synch_weights_time_ms": 0.693}, "counters": {"num_env_steps_sampled": 4504080, "num_env_steps_trained": 4504080, "num_agent_steps_sampled": 4504080, "num_agent_steps_trained": 4504080}, "done": false, "episodes_total": 7555, "training_iteration": 1732, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-37-59", "timestamp": 1691296679, "time_this_iter_s": 39.07139301300049, "time_total_s": 22554.319724798203, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 274.7040286064148, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 16.910909090909094, "ram_util_percent": 71.05818181818181}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.8500000000000003e-10, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.1428106102234, "policy_loss": -1962823.6404997266, "vf_loss": 4385937.604591837}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5145.5, "diff_num_grad_updates_vs_sampler_policy": 5144.5}}, "num_env_steps_sampled": 4548000, "num_env_steps_trained": 4548000, "num_agent_steps_sampled": 4548000, "num_agent_steps_trained": 4548000}, "sampler_results": {"episode_reward_max": -153422.9286911195, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155667.29168028652, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13369692739383254, "mean_inference_ms": 0.2278974013235514, "mean_action_processing_ms": 0.05568729611394688, "mean_env_wait_ms": 0.45670979952608265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025838613510131836, "StateBufferConnector_ms": 0.0017493963241577148, "ViewRequirementAgentConnector_ms": 0.04381239414215088}}, "episode_reward_max": -153422.9286911195, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155667.29168028652, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13369692739383254, "mean_inference_ms": 0.2278974013235514, "mean_action_processing_ms": 0.05568729611394688, "mean_env_wait_ms": 0.45670979952608265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025838613510131836, "StateBufferConnector_ms": 0.0017493963241577148, "ViewRequirementAgentConnector_ms": 0.04381239414215088}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4548000, "num_agent_steps_trained": 4548000, "num_env_steps_sampled": 4548000, "num_env_steps_trained": 4548000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1133.8011921424443, "num_env_steps_trained_throughput_per_sec": 1133.8011921424443, "timesteps_total": 4548000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4548000, "timers": {"training_iteration_time_ms": 39178.393, "sample_time_ms": 38448.812, "load_time_ms": 12.631, "load_throughput": 3477200.642, "learn_time_ms": 716.145, "learn_throughput": 61328.402, "synch_weights_time_ms": 0.69}, "counters": {"num_env_steps_sampled": 4548000, "num_env_steps_trained": 4548000, "num_agent_steps_sampled": 4548000, "num_agent_steps_trained": 4548000}, "done": false, "episodes_total": 7556, "training_iteration": 1733, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-38-38", "timestamp": 1691296718, "time_this_iter_s": 38.73885917663574, "time_total_s": 22593.05858397484, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 313.44288778305054, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 18.072727272727274, "ram_util_percent": 71.04727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.3250000000000003e-10, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9754392662827, "policy_loss": -2099659.8962395224, "vf_loss": 4415647.421738339}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5831.5, "diff_num_grad_updates_vs_sampler_policy": 5830.5}}, "num_env_steps_sampled": 4591920, "num_env_steps_trained": 4591920, "num_agent_steps_sampled": 4591920, "num_agent_steps_trained": 4591920}, "sampler_results": {"episode_reward_max": -153422.9286911195, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155545.63666447683, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13365989703286596, "mean_inference_ms": 0.22788416099924602, "mean_action_processing_ms": 0.05567973619171854, "mean_env_wait_ms": 0.4554470884066726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025298860337999132, "StateBufferConnector_ms": 0.0017642974853515625, "ViewRequirementAgentConnector_ms": 0.043768352932400174}}, "episode_reward_max": -153422.9286911195, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155545.63666447683, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13365989703286596, "mean_inference_ms": 0.22788416099924602, "mean_action_processing_ms": 0.05567973619171854, "mean_env_wait_ms": 0.4554470884066726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025298860337999132, "StateBufferConnector_ms": 0.0017642974853515625, "ViewRequirementAgentConnector_ms": 0.043768352932400174}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4591920, "num_agent_steps_trained": 4591920, "num_env_steps_sampled": 4591920, "num_env_steps_trained": 4591920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1131.7553753007628, "num_env_steps_trained_throughput_per_sec": 1131.7553753007628, "timesteps_total": 4591920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4591920, "timers": {"training_iteration_time_ms": 39137.123, "sample_time_ms": 38409.283, "load_time_ms": 12.85, "load_throughput": 3417787.913, "learn_time_ms": 714.191, "learn_throughput": 61496.124, "synch_weights_time_ms": 0.683}, "counters": {"num_env_steps_sampled": 4591920, "num_env_steps_trained": 4591920, "num_agent_steps_sampled": 4591920, "num_agent_steps_trained": 4591920}, "done": false, "episodes_total": 7557, "training_iteration": 1734, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-39-16", "timestamp": 1691296756, "time_this_iter_s": 38.80884099006653, "time_total_s": 22631.867424964905, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 352.25172877311707, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 18.56909090909091, "ram_util_percent": 71.06909090909089}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.000000000000002e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.97993197872063, "policy_loss": -2112854.0797108463, "vf_loss": 4486517.960094752}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6517.5, "diff_num_grad_updates_vs_sampler_policy": 6516.5}}, "num_env_steps_sampled": 4635840, "num_env_steps_trained": 4635840, "num_agent_steps_sampled": 4635840, "num_agent_steps_trained": 4635840}, "sampler_results": {"episode_reward_max": -153422.9286911195, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155552.7963920045, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13361728950661353, "mean_inference_ms": 0.22785895846571882, "mean_action_processing_ms": 0.055672553140188964, "mean_env_wait_ms": 0.4542770495534051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027060508728027344, "StateBufferConnector_ms": 0.0017571449279785156, "ViewRequirementAgentConnector_ms": 0.04378795623779297}}, "episode_reward_max": -153422.9286911195, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155552.7963920045, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13361728950661353, "mean_inference_ms": 0.22785895846571882, "mean_action_processing_ms": 0.055672553140188964, "mean_env_wait_ms": 0.4542770495534051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027060508728027344, "StateBufferConnector_ms": 0.0017571449279785156, "ViewRequirementAgentConnector_ms": 0.04378795623779297}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4635840, "num_agent_steps_trained": 4635840, "num_env_steps_sampled": 4635840, "num_env_steps_trained": 4635840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1146.8583460554805, "num_env_steps_trained_throughput_per_sec": 1146.8583460554805, "timesteps_total": 4635840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4635840, "timers": {"training_iteration_time_ms": 39053.001, "sample_time_ms": 38326.311, "load_time_ms": 12.953, "load_throughput": 3390727.768, "learn_time_ms": 712.94, "learn_throughput": 61604.068, "synch_weights_time_ms": 0.684}, "counters": {"num_env_steps_sampled": 4635840, "num_env_steps_trained": 4635840, "num_agent_steps_sampled": 4635840, "num_agent_steps_trained": 4635840}, "done": false, "episodes_total": 7558, "training_iteration": 1735, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-39-55", "timestamp": 1691296795, "time_this_iter_s": 38.29796624183655, "time_total_s": 22670.16539120674, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 390.5496950149536, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 24.409259259259258, "ram_util_percent": 70.92222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.312499999999999e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.06676387508827, "policy_loss": -2127253.5842477335, "vf_loss": 4364398.616071428}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7203.5, "diff_num_grad_updates_vs_sampler_policy": 7202.5}}, "num_env_steps_sampled": 4679760, "num_env_steps_trained": 4679760, "num_agent_steps_sampled": 4679760, "num_agent_steps_trained": 4679760}, "sampler_results": {"episode_reward_max": -153422.9286911195, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155389.17311774087, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13357332352973172, "mean_inference_ms": 0.22782910565538964, "mean_action_processing_ms": 0.0556663544110763, "mean_env_wait_ms": 0.45327988873037534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026962973854758525, "StateBufferConnector_ms": 0.001801143993030895, "ViewRequirementAgentConnector_ms": 0.044042413884943184}}, "episode_reward_max": -153422.9286911195, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155389.17311774087, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13357332352973172, "mean_inference_ms": 0.22782910565538964, "mean_action_processing_ms": 0.0556663544110763, "mean_env_wait_ms": 0.45327988873037534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026962973854758525, "StateBufferConnector_ms": 0.001801143993030895, "ViewRequirementAgentConnector_ms": 0.044042413884943184}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4679760, "num_agent_steps_trained": 4679760, "num_env_steps_sampled": 4679760, "num_env_steps_trained": 4679760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1133.8727594468469, "num_env_steps_trained_throughput_per_sec": 1133.8727594468469, "timesteps_total": 4679760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4679760, "timers": {"training_iteration_time_ms": 38834.154, "sample_time_ms": 38107.335, "load_time_ms": 14.015, "load_throughput": 3133746.343, "learn_time_ms": 711.998, "learn_throughput": 61685.607, "synch_weights_time_ms": 0.691}, "counters": {"num_env_steps_sampled": 4679760, "num_env_steps_trained": 4679760, "num_agent_steps_sampled": 4679760, "num_agent_steps_trained": 4679760}, "done": false, "episodes_total": 7559, "training_iteration": 1736, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-40-33", "timestamp": 1691296833, "time_this_iter_s": 38.73663067817688, "time_total_s": 22708.90202188492, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 429.2863256931305, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 18.150909090909092, "ram_util_percent": 70.89454545454547}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.625000000000002e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9506085899064, "policy_loss": -2259301.1755207386, "vf_loss": 4378771.60404519}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7889.5, "diff_num_grad_updates_vs_sampler_policy": 7888.5}}, "num_env_steps_sampled": 4723680, "num_env_steps_trained": 4723680, "num_agent_steps_sampled": 4723680, "num_agent_steps_trained": 4723680}, "sampler_results": {"episode_reward_max": -153422.9286911195, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155278.89703057442, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13353189801458829, "mean_inference_ms": 0.2277999497975652, "mean_action_processing_ms": 0.05566125841126634, "mean_env_wait_ms": 0.45244475699348835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002666314442952474, "StateBufferConnector_ms": 0.001819928487141927, "ViewRequirementAgentConnector_ms": 0.04418094952901205}}, "episode_reward_max": -153422.9286911195, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155278.89703057442, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13353189801458829, "mean_inference_ms": 0.2277999497975652, "mean_action_processing_ms": 0.05566125841126634, "mean_env_wait_ms": 0.45244475699348835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002666314442952474, "StateBufferConnector_ms": 0.001819928487141927, "ViewRequirementAgentConnector_ms": 0.04418094952901205}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4723680, "num_agent_steps_trained": 4723680, "num_env_steps_sampled": 4723680, "num_env_steps_trained": 4723680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1128.1861043936578, "num_env_steps_trained_throughput_per_sec": 1128.1861043936578, "timesteps_total": 4723680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4723680, "timers": {"training_iteration_time_ms": 38820.524, "sample_time_ms": 38094.368, "load_time_ms": 13.876, "load_throughput": 3165202.427, "learn_time_ms": 711.469, "learn_throughput": 61731.475, "synch_weights_time_ms": 0.693}, "counters": {"num_env_steps_sampled": 4723680, "num_env_steps_trained": 4723680, "num_agent_steps_sampled": 4723680, "num_agent_steps_trained": 4723680}, "done": false, "episodes_total": 7560, "training_iteration": 1737, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-41-12", "timestamp": 1691296872, "time_this_iter_s": 38.93179798126221, "time_total_s": 22747.83381986618, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 468.2181236743927, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 17.616363636363634, "ram_util_percent": 70.91272727272728}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.937500000000001e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.951571851013, "policy_loss": -2076985.329158505, "vf_loss": 4500086.599125365}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8575.5, "diff_num_grad_updates_vs_sampler_policy": 8574.5}}, "num_env_steps_sampled": 4767600, "num_env_steps_trained": 4767600, "num_agent_steps_sampled": 4767600, "num_agent_steps_trained": 4767600}, "sampler_results": {"episode_reward_max": -153422.9286911195, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155276.0735848933, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13349932659549943, "mean_inference_ms": 0.22777214515812977, "mean_action_processing_ms": 0.055656421732732345, "mean_env_wait_ms": 0.4517092284559229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026409442608173075, "StateBufferConnector_ms": 0.0018266531137319712, "ViewRequirementAgentConnector_ms": 0.04437519953801082}}, "episode_reward_max": -153422.9286911195, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155276.0735848933, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13349932659549943, "mean_inference_ms": 0.22777214515812977, "mean_action_processing_ms": 0.055656421732732345, "mean_env_wait_ms": 0.4517092284559229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026409442608173075, "StateBufferConnector_ms": 0.0018266531137319712, "ViewRequirementAgentConnector_ms": 0.04437519953801082}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4767600, "num_agent_steps_trained": 4767600, "num_env_steps_sampled": 4767600, "num_env_steps_trained": 4767600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1132.3719636115188, "num_env_steps_trained_throughput_per_sec": 1132.3719636115188, "timesteps_total": 4767600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4767600, "timers": {"training_iteration_time_ms": 38792.175, "sample_time_ms": 38066.337, "load_time_ms": 13.63, "load_throughput": 3222217.14, "learn_time_ms": 711.397, "learn_throughput": 61737.642, "synch_weights_time_ms": 0.692}, "counters": {"num_env_steps_sampled": 4767600, "num_env_steps_trained": 4767600, "num_agent_steps_sampled": 4767600, "num_agent_steps_trained": 4767600}, "done": false, "episodes_total": 7561, "training_iteration": 1738, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-41-51", "timestamp": 1691296911, "time_this_iter_s": 38.78774309158325, "time_total_s": 22786.621562957764, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 507.00586676597595, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 18.374545454545455, "ram_util_percent": 70.87818181818183}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.249999999999998e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0964799886542, "policy_loss": -1895566.4818239796, "vf_loss": 4469745.274690233}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9261.5, "diff_num_grad_updates_vs_sampler_policy": 9260.5}}, "num_env_steps_sampled": 4811520, "num_env_steps_trained": 4811520, "num_agent_steps_sampled": 4811520, "num_agent_steps_trained": 4811520}, "sampler_results": {"episode_reward_max": -153422.9286911195, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155264.75886008845, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13346658875049464, "mean_inference_ms": 0.22774669945244083, "mean_action_processing_ms": 0.05565223141985969, "mean_env_wait_ms": 0.4510348764389196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026072774614606586, "StateBufferConnector_ms": 0.001811981201171875, "ViewRequirementAgentConnector_ms": 0.04427262714930943}}, "episode_reward_max": -153422.9286911195, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155264.75886008845, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13346658875049464, "mean_inference_ms": 0.22774669945244083, "mean_action_processing_ms": 0.05565223141985969, "mean_env_wait_ms": 0.4510348764389196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026072774614606586, "StateBufferConnector_ms": 0.001811981201171875, "ViewRequirementAgentConnector_ms": 0.04427262714930943}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4811520, "num_agent_steps_trained": 4811520, "num_env_steps_sampled": 4811520, "num_env_steps_trained": 4811520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1138.9438068710017, "num_env_steps_trained_throughput_per_sec": 1138.9438068710017, "timesteps_total": 4811520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4811520, "timers": {"training_iteration_time_ms": 38742.251, "sample_time_ms": 38017.928, "load_time_ms": 12.81, "load_throughput": 3428682.098, "learn_time_ms": 710.718, "learn_throughput": 61796.651, "synch_weights_time_ms": 0.679}, "counters": {"num_env_steps_sampled": 4811520, "num_env_steps_trained": 4811520, "num_agent_steps_sampled": 4811520, "num_agent_steps_trained": 4811520}, "done": false, "episodes_total": 7562, "training_iteration": 1739, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-42-30", "timestamp": 1691296950, "time_this_iter_s": 38.5641348361969, "time_total_s": 22825.18569779396, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 545.5700016021729, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 17.399999999999995, "ram_util_percent": 70.81090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.5624999999999985e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.3605739048549, "policy_loss": -1640742.611040566, "vf_loss": 4625568.929118075}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9947.5, "diff_num_grad_updates_vs_sampler_policy": 9946.5}}, "num_env_steps_sampled": 4855440, "num_env_steps_trained": 4855440, "num_agent_steps_sampled": 4855440, "num_agent_steps_trained": 4855440}, "sampler_results": {"episode_reward_max": -153422.9286911195, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155418.18676784413, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1334329819023565, "mean_inference_ms": 0.2277197899294797, "mean_action_processing_ms": 0.05564824783570613, "mean_env_wait_ms": 0.4504155197627099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002590815226236979, "StateBufferConnector_ms": 0.0018151601155598958, "ViewRequirementAgentConnector_ms": 0.04433790842692057}}, "episode_reward_max": -153422.9286911195, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155418.18676784413, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1334329819023565, "mean_inference_ms": 0.2277197899294797, "mean_action_processing_ms": 0.05564824783570613, "mean_env_wait_ms": 0.4504155197627099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002590815226236979, "StateBufferConnector_ms": 0.0018151601155598958, "ViewRequirementAgentConnector_ms": 0.04433790842692057}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4855440, "num_agent_steps_trained": 4855440, "num_env_steps_sampled": 4855440, "num_env_steps_trained": 4855440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1140.2134096409354, "num_env_steps_trained_throughput_per_sec": 1140.2134096409354, "timesteps_total": 4855440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4855440, "timers": {"training_iteration_time_ms": 38706.044, "sample_time_ms": 37981.718, "load_time_ms": 12.803, "load_throughput": 3430386.843, "learn_time_ms": 710.724, "learn_throughput": 61796.145, "synch_weights_time_ms": 0.683}, "counters": {"num_env_steps_sampled": 4855440, "num_env_steps_trained": 4855440, "num_agent_steps_sampled": 4855440, "num_agent_steps_trained": 4855440}, "done": false, "episodes_total": 7563, "training_iteration": 1740, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-43-08", "timestamp": 1691296988, "time_this_iter_s": 38.520976066589355, "time_total_s": 22863.70667386055, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 584.0909776687622, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 17.592592592592588, "ram_util_percent": 70.81481481481482}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.875e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.19698438282956, "policy_loss": -2035662.8535213193, "vf_loss": 4411626.149963557}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10633.5, "diff_num_grad_updates_vs_sampler_policy": 10632.5}}, "num_env_steps_sampled": 4899360, "num_env_steps_trained": 4899360, "num_agent_steps_sampled": 4899360, "num_agent_steps_trained": 4899360}, "sampler_results": {"episode_reward_max": -153422.9286911195, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155325.19457351795, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1334049676752476, "mean_inference_ms": 0.22769715335304244, "mean_action_processing_ms": 0.05564489586872885, "mean_env_wait_ms": 0.4498818554455892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025585293769836426, "StateBufferConnector_ms": 0.0018209218978881836, "ViewRequirementAgentConnector_ms": 0.04427880048751831}}, "episode_reward_max": -153422.9286911195, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155325.19457351795, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1334049676752476, "mean_inference_ms": 0.22769715335304244, "mean_action_processing_ms": 0.05564489586872885, "mean_env_wait_ms": 0.4498818554455892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025585293769836426, "StateBufferConnector_ms": 0.0018209218978881836, "ViewRequirementAgentConnector_ms": 0.04427880048751831}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4899360, "num_agent_steps_trained": 4899360, "num_env_steps_sampled": 4899360, "num_env_steps_trained": 4899360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1124.6685052211838, "num_env_steps_trained_throughput_per_sec": 1124.6685052211838, "timesteps_total": 4899360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4899360, "timers": {"training_iteration_time_ms": 38749.195, "sample_time_ms": 38025.398, "load_time_ms": 12.714, "load_throughput": 3454426.034, "learn_time_ms": 710.281, "learn_throughput": 61834.696, "synch_weights_time_ms": 0.684}, "counters": {"num_env_steps_sampled": 4899360, "num_env_steps_trained": 4899360, "num_agent_steps_sampled": 4899360, "num_agent_steps_trained": 4899360}, "done": false, "episodes_total": 7564, "training_iteration": 1741, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-43-47", "timestamp": 1691297027, "time_this_iter_s": 39.053444147109985, "time_total_s": 22902.76011800766, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 623.1444218158722, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 17.969642857142855, "ram_util_percent": 70.66071428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.1875000000000006e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.10612910412493, "policy_loss": -1875660.4166903927, "vf_loss": 4512050.215014577}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11319.5, "diff_num_grad_updates_vs_sampler_policy": 11318.5}}, "num_env_steps_sampled": 4943280, "num_env_steps_trained": 4943280, "num_agent_steps_sampled": 4943280, "num_agent_steps_trained": 4943280}, "sampler_results": {"episode_reward_max": -153422.9286911195, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155320.90427043158, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13337878788994867, "mean_inference_ms": 0.22767598880513806, "mean_action_processing_ms": 0.0556421184552193, "mean_env_wait_ms": 0.4494013457764428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025272369384765625, "StateBufferConnector_ms": 0.0018147861256318934, "ViewRequirementAgentConnector_ms": 0.044256098130170035}}, "episode_reward_max": -153422.9286911195, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155320.90427043158, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13337878788994867, "mean_inference_ms": 0.22767598880513806, "mean_action_processing_ms": 0.0556421184552193, "mean_env_wait_ms": 0.4494013457764428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025272369384765625, "StateBufferConnector_ms": 0.0018147861256318934, "ViewRequirementAgentConnector_ms": 0.044256098130170035}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4943280, "num_agent_steps_trained": 4943280, "num_env_steps_sampled": 4943280, "num_env_steps_trained": 4943280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1132.1127698527264, "num_env_steps_trained_throughput_per_sec": 1132.1127698527264, "timesteps_total": 4943280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4943280, "timers": {"training_iteration_time_ms": 38721.717, "sample_time_ms": 37997.185, "load_time_ms": 12.816, "load_throughput": 3426902.545, "learn_time_ms": 710.903, "learn_throughput": 61780.614, "synch_weights_time_ms": 0.695}, "counters": {"num_env_steps_sampled": 4943280, "num_env_steps_trained": 4943280, "num_agent_steps_sampled": 4943280, "num_agent_steps_trained": 4943280}, "done": false, "episodes_total": 7565, "training_iteration": 1742, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-44-26", "timestamp": 1691297066, "time_this_iter_s": 38.796656131744385, "time_total_s": 22941.556774139404, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 661.9410779476166, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 17.74814814814815, "ram_util_percent": 70.6185185185185}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999998e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9876480769833, "policy_loss": -2163332.2915394953, "vf_loss": 4457318.602223032}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12005.5, "diff_num_grad_updates_vs_sampler_policy": 12004.5}}, "num_env_steps_sampled": 4987200, "num_env_steps_trained": 4987200, "num_agent_steps_sampled": 4987200, "num_agent_steps_trained": 4987200}, "sampler_results": {"episode_reward_max": -153422.9286911195, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155299.87474359697, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13335901463285507, "mean_inference_ms": 0.22765681324804232, "mean_action_processing_ms": 0.05563963126959743, "mean_env_wait_ms": 0.44897918793361913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002510017818874783, "StateBufferConnector_ms": 0.001804033915201823, "ViewRequirementAgentConnector_ms": 0.04421075185139974}}, "episode_reward_max": -153422.9286911195, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155299.87474359697, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13335901463285507, "mean_inference_ms": 0.22765681324804232, "mean_action_processing_ms": 0.05563963126959743, "mean_env_wait_ms": 0.44897918793361913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002510017818874783, "StateBufferConnector_ms": 0.001804033915201823, "ViewRequirementAgentConnector_ms": 0.04421075185139974}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4987200, "num_agent_steps_trained": 4987200, "num_env_steps_sampled": 4987200, "num_env_steps_trained": 4987200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1124.7086817529005, "num_env_steps_trained_throughput_per_sec": 1124.7086817529005, "timesteps_total": 4987200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4987200, "timers": {"training_iteration_time_ms": 38753.033, "sample_time_ms": 38034.576, "load_time_ms": 12.761, "load_throughput": 3441769.551, "learn_time_ms": 704.883, "learn_throughput": 62308.221, "synch_weights_time_ms": 0.695}, "counters": {"num_env_steps_sampled": 4987200, "num_env_steps_trained": 4987200, "num_agent_steps_sampled": 4987200, "num_agent_steps_trained": 4987200}, "done": false, "episodes_total": 7566, "training_iteration": 1743, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-45-05", "timestamp": 1691297105, "time_this_iter_s": 39.052024126052856, "time_total_s": 22980.608798265457, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 700.9931020736694, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 18.669642857142858, "ram_util_percent": 70.65357142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999998e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0781254448627, "policy_loss": -1969303.4606442465, "vf_loss": 4229050.5358965015}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12691.5, "diff_num_grad_updates_vs_sampler_policy": 12690.5}}, "num_env_steps_sampled": 5031120, "num_env_steps_trained": 5031120, "num_agent_steps_sampled": 5031120, "num_agent_steps_trained": 5031120}, "sampler_results": {"episode_reward_max": -151730.2922357145, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155112.0019800242, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13334095543319577, "mean_inference_ms": 0.22763806244132692, "mean_action_processing_ms": 0.05563725492277229, "mean_env_wait_ms": 0.4486014315002195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002490846734297903, "StateBufferConnector_ms": 0.001789394177888569, "ViewRequirementAgentConnector_ms": 0.04411245647229647}}, "episode_reward_max": -151730.2922357145, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155112.0019800242, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13334095543319577, "mean_inference_ms": 0.22763806244132692, "mean_action_processing_ms": 0.05563725492277229, "mean_env_wait_ms": 0.4486014315002195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002490846734297903, "StateBufferConnector_ms": 0.001789394177888569, "ViewRequirementAgentConnector_ms": 0.04411245647229647}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5031120, "num_agent_steps_trained": 5031120, "num_env_steps_sampled": 5031120, "num_env_steps_trained": 5031120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1128.8277496648057, "num_env_steps_trained_throughput_per_sec": 1128.8277496648057, "timesteps_total": 5031120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5031120, "timers": {"training_iteration_time_ms": 38763.098, "sample_time_ms": 38044.17, "load_time_ms": 12.56, "load_throughput": 3496706.314, "learn_time_ms": 705.545, "learn_throughput": 62249.711, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 5031120, "num_env_steps_trained": 5031120, "num_agent_steps_sampled": 5031120, "num_agent_steps_trained": 5031120}, "done": false, "episodes_total": 7567, "training_iteration": 1744, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-45-44", "timestamp": 1691297144, "time_this_iter_s": 38.90954804420471, "time_total_s": 23019.518346309662, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 739.9026501178741, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 17.069090909090907, "ram_util_percent": 70.63454545454543}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999998e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0586959794381, "policy_loss": -1959212.7548856596, "vf_loss": 4413314.885021866}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13377.5, "diff_num_grad_updates_vs_sampler_policy": 13376.5}}, "num_env_steps_sampled": 5075040, "num_env_steps_trained": 5075040, "num_agent_steps_sampled": 5075040, "num_agent_steps_trained": 5075040}, "sampler_results": {"episode_reward_max": -151730.2922357145, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155099.65309556658, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13332660119791445, "mean_inference_ms": 0.22762209442465348, "mean_action_processing_ms": 0.055635300584383006, "mean_env_wait_ms": 0.44825766156750024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002467632293701172, "StateBufferConnector_ms": 0.0017845630645751953, "ViewRequirementAgentConnector_ms": 0.04402637481689453}}, "episode_reward_max": -151730.2922357145, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155099.65309556658, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13332660119791445, "mean_inference_ms": 0.22762209442465348, "mean_action_processing_ms": 0.055635300584383006, "mean_env_wait_ms": 0.44825766156750024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002467632293701172, "StateBufferConnector_ms": 0.0017845630645751953, "ViewRequirementAgentConnector_ms": 0.04402637481689453}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5075040, "num_agent_steps_trained": 5075040, "num_env_steps_sampled": 5075040, "num_env_steps_trained": 5075040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1128.2218477634424, "num_env_steps_trained_throughput_per_sec": 1128.2218477634424, "timesteps_total": 5075040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5075040, "timers": {"training_iteration_time_ms": 38826.357, "sample_time_ms": 38106.868, "load_time_ms": 12.437, "load_throughput": 3531456.39, "learn_time_ms": 706.231, "learn_throughput": 62189.315, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 5075040, "num_env_steps_trained": 5075040, "num_agent_steps_sampled": 5075040, "num_agent_steps_trained": 5075040}, "done": false, "episodes_total": 7568, "training_iteration": 1745, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-46-23", "timestamp": 1691297183, "time_this_iter_s": 38.9304940700531, "time_total_s": 23058.448840379715, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 778.8331441879272, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 16.894545454545455, "ram_util_percent": 70.64727272727272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999998e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0105577474433, "policy_loss": -2216527.724632152, "vf_loss": 4530373.548469388}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14063.5, "diff_num_grad_updates_vs_sampler_policy": 14062.5}}, "num_env_steps_sampled": 5118960, "num_env_steps_trained": 5118960, "num_agent_steps_sampled": 5118960, "num_agent_steps_trained": 5118960}, "sampler_results": {"episode_reward_max": -151730.2922357145, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155154.46685135842, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13331226869150442, "mean_inference_ms": 0.2276077528219221, "mean_action_processing_ms": 0.055633763525384926, "mean_env_wait_ms": 0.447966917517597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024375461396716888, "StateBufferConnector_ms": 0.001781327383858817, "ViewRequirementAgentConnector_ms": 0.044051806131998696}}, "episode_reward_max": -151730.2922357145, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155154.46685135842, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13331226869150442, "mean_inference_ms": 0.2276077528219221, "mean_action_processing_ms": 0.055633763525384926, "mean_env_wait_ms": 0.447966917517597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024375461396716888, "StateBufferConnector_ms": 0.001781327383858817, "ViewRequirementAgentConnector_ms": 0.044051806131998696}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5118960, "num_agent_steps_trained": 5118960, "num_env_steps_sampled": 5118960, "num_env_steps_trained": 5118960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1116.8783767118878, "num_env_steps_trained_throughput_per_sec": 1116.8783767118878, "timesteps_total": 5118960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5118960, "timers": {"training_iteration_time_ms": 38885.295, "sample_time_ms": 38164.557, "load_time_ms": 12.531, "load_throughput": 3504936.065, "learn_time_ms": 707.398, "learn_throughput": 62086.728, "synch_weights_time_ms": 0.695}, "counters": {"num_env_steps_sampled": 5118960, "num_env_steps_trained": 5118960, "num_agent_steps_sampled": 5118960, "num_agent_steps_trained": 5118960}, "done": false, "episodes_total": 7569, "training_iteration": 1746, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-47-02", "timestamp": 1691297222, "time_this_iter_s": 39.32587218284607, "time_total_s": 23097.77471256256, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 818.1590163707733, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 17.464285714285715, "ram_util_percent": 70.67678571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999998e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0782991192431, "policy_loss": -2445561.1686121994, "vf_loss": 4612949.346574344}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14749.5, "diff_num_grad_updates_vs_sampler_policy": 14748.5}}, "num_env_steps_sampled": 5162880, "num_env_steps_trained": 5162880, "num_agent_steps_sampled": 5162880, "num_agent_steps_trained": 5162880}, "sampler_results": {"episode_reward_max": -151730.2922357145, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155239.87962909573, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13330009866745454, "mean_inference_ms": 0.22759356036562856, "mean_action_processing_ms": 0.05563232645232427, "mean_env_wait_ms": 0.4476934296258071, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024307857860218396, "StateBufferConnector_ms": 0.0018022277138449929, "ViewRequirementAgentConnector_ms": 0.044139948758212005}}, "episode_reward_max": -151730.2922357145, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155239.87962909573, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13330009866745454, "mean_inference_ms": 0.22759356036562856, "mean_action_processing_ms": 0.05563232645232427, "mean_env_wait_ms": 0.4476934296258071, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024307857860218396, "StateBufferConnector_ms": 0.0018022277138449929, "ViewRequirementAgentConnector_ms": 0.044139948758212005}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5162880, "num_agent_steps_trained": 5162880, "num_env_steps_sampled": 5162880, "num_env_steps_trained": 5162880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1133.3705136263604, "num_env_steps_trained_throughput_per_sec": 1133.3705136263604, "timesteps_total": 5162880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5162880, "timers": {"training_iteration_time_ms": 38867.487, "sample_time_ms": 38146.247, "load_time_ms": 12.469, "load_throughput": 3522279.935, "learn_time_ms": 707.974, "learn_throughput": 62036.197, "synch_weights_time_ms": 0.686}, "counters": {"num_env_steps_sampled": 5162880, "num_env_steps_trained": 5162880, "num_agent_steps_sampled": 5162880, "num_agent_steps_trained": 5162880}, "done": false, "episodes_total": 7570, "training_iteration": 1747, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-47-41", "timestamp": 1691297261, "time_this_iter_s": 38.75360894203186, "time_total_s": 23136.528321504593, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 856.9126253128052, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 17.429629629629627, "ram_util_percent": 70.65555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999998e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.01548406751095, "policy_loss": -2077460.998519497, "vf_loss": 4535932.570699709}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15435.5, "diff_num_grad_updates_vs_sampler_policy": 15434.5}}, "num_env_steps_sampled": 5206800, "num_env_steps_trained": 5206800, "num_agent_steps_sampled": 5206800, "num_agent_steps_trained": 5206800}, "sampler_results": {"episode_reward_max": -151730.2922357145, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155280.52244883173, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1332889380674197, "mean_inference_ms": 0.2275810839235038, "mean_action_processing_ms": 0.055631033185619204, "mean_env_wait_ms": 0.44742983447800233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024266864942467732, "StateBufferConnector_ms": 0.0018016151759935462, "ViewRequirementAgentConnector_ms": 0.04415201104205588}}, "episode_reward_max": -151730.2922357145, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155280.52244883173, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1332889380674197, "mean_inference_ms": 0.2275810839235038, "mean_action_processing_ms": 0.055631033185619204, "mean_env_wait_ms": 0.44742983447800233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024266864942467732, "StateBufferConnector_ms": 0.0018016151759935462, "ViewRequirementAgentConnector_ms": 0.04415201104205588}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5206800, "num_agent_steps_trained": 5206800, "num_env_steps_sampled": 5206800, "num_env_steps_trained": 5206800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1136.8746562978974, "num_env_steps_trained_throughput_per_sec": 1136.8746562978974, "timesteps_total": 5206800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5206800, "timers": {"training_iteration_time_ms": 38852.125, "sample_time_ms": 38130.833, "load_time_ms": 12.396, "load_throughput": 3543098.337, "learn_time_ms": 708.089, "learn_throughput": 62026.079, "synch_weights_time_ms": 0.695}, "counters": {"num_env_steps_sampled": 5206800, "num_env_steps_trained": 5206800, "num_agent_steps_sampled": 5206800, "num_agent_steps_trained": 5206800}, "done": false, "episodes_total": 7571, "training_iteration": 1748, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-48-20", "timestamp": 1691297300, "time_this_iter_s": 38.634758949279785, "time_total_s": 23175.163080453873, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 895.547384262085, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 18.179999999999996, "ram_util_percent": 70.61090909090908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999998e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.06004275663946, "policy_loss": -2120430.251787992, "vf_loss": 4414615.061771137}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16121.5, "diff_num_grad_updates_vs_sampler_policy": 16120.5}}, "num_env_steps_sampled": 5250720, "num_env_steps_trained": 5250720, "num_agent_steps_sampled": 5250720, "num_agent_steps_trained": 5250720}, "sampler_results": {"episode_reward_max": -151730.2922357145, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155249.61059971157, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13327612420338722, "mean_inference_ms": 0.22756750724516875, "mean_action_processing_ms": 0.05562964566392343, "mean_env_wait_ms": 0.44718481875543237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024984280268351236, "StateBufferConnector_ms": 0.0018010536829630535, "ViewRequirementAgentConnector_ms": 0.04413922627766927}}, "episode_reward_max": -151730.2922357145, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155249.61059971157, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13327612420338722, "mean_inference_ms": 0.22756750724516875, "mean_action_processing_ms": 0.05562964566392343, "mean_env_wait_ms": 0.44718481875543237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024984280268351236, "StateBufferConnector_ms": 0.0018010536829630535, "ViewRequirementAgentConnector_ms": 0.04413922627766927}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5250720, "num_agent_steps_trained": 5250720, "num_env_steps_sampled": 5250720, "num_env_steps_trained": 5250720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1134.3439822357582, "num_env_steps_trained_throughput_per_sec": 1134.3439822357582, "timesteps_total": 5250720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5250720, "timers": {"training_iteration_time_ms": 38867.762, "sample_time_ms": 38146.48, "load_time_ms": 12.382, "load_throughput": 3547198.688, "learn_time_ms": 708.09, "learn_throughput": 62025.991, "synch_weights_time_ms": 0.699}, "counters": {"num_env_steps_sampled": 5250720, "num_env_steps_trained": 5250720, "num_agent_steps_sampled": 5250720, "num_agent_steps_trained": 5250720}, "done": false, "episodes_total": 7572, "training_iteration": 1749, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-48-59", "timestamp": 1691297339, "time_this_iter_s": 38.72067308425903, "time_total_s": 23213.88375353813, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 934.268057346344, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 17.096363636363634, "ram_util_percent": 70.61818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999998e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0417835914011, "policy_loss": -2038141.4427871036, "vf_loss": 4424808.899052478}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16807.5, "diff_num_grad_updates_vs_sampler_policy": 16806.5}}, "num_env_steps_sampled": 5294640, "num_env_steps_trained": 5294640, "num_agent_steps_sampled": 5294640, "num_agent_steps_trained": 5294640}, "sampler_results": {"episode_reward_max": -151730.2922357145, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155235.2139544898, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13326507398762943, "mean_inference_ms": 0.22755704784140268, "mean_action_processing_ms": 0.055628845821160386, "mean_env_wait_ms": 0.4469585424202295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024814605712890625, "StateBufferConnector_ms": 0.001800537109375, "ViewRequirementAgentConnector_ms": 0.044101715087890625}}, "episode_reward_max": -151730.2922357145, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155235.2139544898, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13326507398762943, "mean_inference_ms": 0.22755704784140268, "mean_action_processing_ms": 0.055628845821160386, "mean_env_wait_ms": 0.4469585424202295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024814605712890625, "StateBufferConnector_ms": 0.001800537109375, "ViewRequirementAgentConnector_ms": 0.044101715087890625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5294640, "num_agent_steps_trained": 5294640, "num_env_steps_sampled": 5294640, "num_env_steps_trained": 5294640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1124.96069684287, "num_env_steps_trained_throughput_per_sec": 1124.96069684287, "timesteps_total": 5294640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5294640, "timers": {"training_iteration_time_ms": 38919.988, "sample_time_ms": 38193.768, "load_time_ms": 12.528, "load_throughput": 3505796.532, "learn_time_ms": 712.869, "learn_throughput": 61610.237, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 5294640, "num_env_steps_trained": 5294640, "num_agent_steps_sampled": 5294640, "num_agent_steps_trained": 5294640}, "done": false, "episodes_total": 7573, "training_iteration": 1750, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-49-38", "timestamp": 1691297378, "time_this_iter_s": 39.043407917022705, "time_total_s": 23252.927161455154, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 973.3114652633667, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 17.48181818181818, "ram_util_percent": 70.6309090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999998e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.93251131018815, "policy_loss": -2193728.590285054, "vf_loss": 4539190.519861516}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17493.5, "diff_num_grad_updates_vs_sampler_policy": 17492.5}}, "num_env_steps_sampled": 5338560, "num_env_steps_trained": 5338560, "num_agent_steps_sampled": 5338560, "num_agent_steps_trained": 5338560}, "sampler_results": {"episode_reward_max": -151730.2922357145, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155278.57588722807, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13325490261358944, "mean_inference_ms": 0.22754669847382722, "mean_action_processing_ms": 0.05562806532467217, "mean_env_wait_ms": 0.4467472048448506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002472217266376202, "StateBufferConnector_ms": 0.0017863053541917067, "ViewRequirementAgentConnector_ms": 0.04413127899169922}}, "episode_reward_max": -151730.2922357145, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155278.57588722807, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13325490261358944, "mean_inference_ms": 0.22754669847382722, "mean_action_processing_ms": 0.05562806532467217, "mean_env_wait_ms": 0.4467472048448506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002472217266376202, "StateBufferConnector_ms": 0.0017863053541917067, "ViewRequirementAgentConnector_ms": 0.04413127899169922}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5338560, "num_agent_steps_trained": 5338560, "num_env_steps_sampled": 5338560, "num_env_steps_trained": 5338560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1130.9136043565857, "num_env_steps_trained_throughput_per_sec": 1130.9136043565857, "timesteps_total": 5338560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5338560, "timers": {"training_iteration_time_ms": 38898.423, "sample_time_ms": 38171.677, "load_time_ms": 12.553, "load_throughput": 3498645.501, "learn_time_ms": 713.361, "learn_throughput": 61567.693, "synch_weights_time_ms": 0.719}, "counters": {"num_env_steps_sampled": 5338560, "num_env_steps_trained": 5338560, "num_agent_steps_sampled": 5338560, "num_agent_steps_trained": 5338560}, "done": false, "episodes_total": 7574, "training_iteration": 1751, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-50-17", "timestamp": 1691297417, "time_this_iter_s": 38.8378541469574, "time_total_s": 23291.76501560211, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1012.1493194103241, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 17.821818181818177, "ram_util_percent": 70.72909090909093}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999998e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.2155497470333, "policy_loss": -1693909.837258564, "vf_loss": 4475210.39085277}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18179.5, "diff_num_grad_updates_vs_sampler_policy": 18178.5}}, "num_env_steps_sampled": 5382480, "num_env_steps_trained": 5382480, "num_agent_steps_sampled": 5382480, "num_agent_steps_trained": 5382480}, "sampler_results": {"episode_reward_max": -151730.2922357145, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155287.4988499138, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13324658822139643, "mean_inference_ms": 0.22753683730444954, "mean_action_processing_ms": 0.05562740699797973, "mean_env_wait_ms": 0.44654835905213763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002460126523618345, "StateBufferConnector_ms": 0.0017837241843894677, "ViewRequirementAgentConnector_ms": 0.04410213894314236}}, "episode_reward_max": -151730.2922357145, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155287.4988499138, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13324658822139643, "mean_inference_ms": 0.22753683730444954, "mean_action_processing_ms": 0.05562740699797973, "mean_env_wait_ms": 0.44654835905213763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002460126523618345, "StateBufferConnector_ms": 0.0017837241843894677, "ViewRequirementAgentConnector_ms": 0.04410213894314236}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5382480, "num_agent_steps_trained": 5382480, "num_env_steps_sampled": 5382480, "num_env_steps_trained": 5382480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1130.3695690395657, "num_env_steps_trained_throughput_per_sec": 1130.3695690395657, "timesteps_total": 5382480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5382480, "timers": {"training_iteration_time_ms": 38904.406, "sample_time_ms": 38177.841, "load_time_ms": 12.566, "load_throughput": 3495246.701, "learn_time_ms": 713.172, "learn_throughput": 61584.042, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 5382480, "num_env_steps_trained": 5382480, "num_agent_steps_sampled": 5382480, "num_agent_steps_trained": 5382480}, "done": false, "episodes_total": 7575, "training_iteration": 1752, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-50-55", "timestamp": 1691297455, "time_this_iter_s": 38.85679793357849, "time_total_s": 23330.62181353569, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1051.0061173439026, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 17.28545454545455, "ram_util_percent": 70.71454545454544}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999998e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9204346681823, "policy_loss": -2177137.2827148438, "vf_loss": 4345588.070881925}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18865.5, "diff_num_grad_updates_vs_sampler_policy": 18864.5}}, "num_env_steps_sampled": 5426400, "num_env_steps_trained": 5426400, "num_agent_steps_sampled": 5426400, "num_agent_steps_trained": 5426400}, "sampler_results": {"episode_reward_max": -151730.2922357145, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155244.74055873425, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13323812960661158, "mean_inference_ms": 0.22752779461303269, "mean_action_processing_ms": 0.05562670452060484, "mean_env_wait_ms": 0.4463646945378799, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024540083748953684, "StateBufferConnector_ms": 0.0017889908381870814, "ViewRequirementAgentConnector_ms": 0.04413468497140067}}, "episode_reward_max": -151730.2922357145, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155244.74055873425, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13323812960661158, "mean_inference_ms": 0.22752779461303269, "mean_action_processing_ms": 0.05562670452060484, "mean_env_wait_ms": 0.4463646945378799, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024540083748953684, "StateBufferConnector_ms": 0.0017889908381870814, "ViewRequirementAgentConnector_ms": 0.04413468497140067}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5426400, "num_agent_steps_trained": 5426400, "num_env_steps_sampled": 5426400, "num_env_steps_trained": 5426400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1127.9888829060574, "num_env_steps_trained_throughput_per_sec": 1127.9888829060574, "timesteps_total": 5426400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5426400, "timers": {"training_iteration_time_ms": 38893.05, "sample_time_ms": 38166.994, "load_time_ms": 12.623, "load_throughput": 3479382.743, "learn_time_ms": 712.595, "learn_throughput": 61633.864, "synch_weights_time_ms": 0.722}, "counters": {"num_env_steps_sampled": 5426400, "num_env_steps_trained": 5426400, "num_agent_steps_sampled": 5426400, "num_agent_steps_trained": 5426400}, "done": false, "episodes_total": 7576, "training_iteration": 1753, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-51-34", "timestamp": 1691297494, "time_this_iter_s": 38.938551902770996, "time_total_s": 23369.56036543846, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1089.9446692466736, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 18.03818181818182, "ram_util_percent": 70.7109090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999998e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.82960474664895, "policy_loss": -2085915.7636149325, "vf_loss": 4276646.020408163}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19551.5, "diff_num_grad_updates_vs_sampler_policy": 19550.5}}, "num_env_steps_sampled": 5470320, "num_env_steps_trained": 5470320, "num_agent_steps_sampled": 5470320, "num_agent_steps_trained": 5470320}, "sampler_results": {"episode_reward_max": -151730.2922357145, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155163.96902737793, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13323122906054571, "mean_inference_ms": 0.22752113117451844, "mean_action_processing_ms": 0.05562629767302361, "mean_env_wait_ms": 0.4461970808085429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002506683612691945, "StateBufferConnector_ms": 0.0017906057423558728, "ViewRequirementAgentConnector_ms": 0.04411154779894599}}, "episode_reward_max": -151730.2922357145, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155163.96902737793, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13323122906054571, "mean_inference_ms": 0.22752113117451844, "mean_action_processing_ms": 0.05562629767302361, "mean_env_wait_ms": 0.4461970808085429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002506683612691945, "StateBufferConnector_ms": 0.0017906057423558728, "ViewRequirementAgentConnector_ms": 0.04411154779894599}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5470320, "num_agent_steps_trained": 5470320, "num_env_steps_sampled": 5470320, "num_env_steps_trained": 5470320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1121.6261827564201, "num_env_steps_trained_throughput_per_sec": 1121.6261827564201, "timesteps_total": 5470320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5470320, "timers": {"training_iteration_time_ms": 38918.031, "sample_time_ms": 38191.705, "load_time_ms": 12.682, "load_throughput": 3463277.942, "learn_time_ms": 712.814, "learn_throughput": 61614.956, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 5470320, "num_env_steps_trained": 5470320, "num_agent_steps_sampled": 5470320, "num_agent_steps_trained": 5470320}, "done": false, "episodes_total": 7577, "training_iteration": 1754, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-52-14", "timestamp": 1691297534, "time_this_iter_s": 39.159703969955444, "time_total_s": 23408.720069408417, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1129.104373216629, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 19.276785714285715, "ram_util_percent": 70.83392857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999998e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0115943664017, "policy_loss": -2035456.6451860878, "vf_loss": 4393296.931304664}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20237.5, "diff_num_grad_updates_vs_sampler_policy": 20236.5}}, "num_env_steps_sampled": 5514240, "num_env_steps_trained": 5514240, "num_agent_steps_sampled": 5514240, "num_agent_steps_trained": 5514240}, "sampler_results": {"episode_reward_max": -151730.2922357145, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155141.5914831675, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13322569405419038, "mean_inference_ms": 0.22751465680042882, "mean_action_processing_ms": 0.055626064771101706, "mean_env_wait_ms": 0.4460434758187382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025002161661783853, "StateBufferConnector_ms": 0.0017833709716796875, "ViewRequirementAgentConnector_ms": 0.04415671030680338}}, "episode_reward_max": -151730.2922357145, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155141.5914831675, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13322569405419038, "mean_inference_ms": 0.22751465680042882, "mean_action_processing_ms": 0.055626064771101706, "mean_env_wait_ms": 0.4460434758187382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025002161661783853, "StateBufferConnector_ms": 0.0017833709716796875, "ViewRequirementAgentConnector_ms": 0.04415671030680338}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5514240, "num_agent_steps_trained": 5514240, "num_env_steps_sampled": 5514240, "num_env_steps_trained": 5514240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1124.111706028563, "num_env_steps_trained_throughput_per_sec": 1124.111706028563, "timesteps_total": 5514240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5514240, "timers": {"training_iteration_time_ms": 38932.265, "sample_time_ms": 38206.126, "load_time_ms": 12.769, "load_throughput": 3439655.233, "learn_time_ms": 712.541, "learn_throughput": 61638.57, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 5514240, "num_env_steps_trained": 5514240, "num_agent_steps_sampled": 5514240, "num_agent_steps_trained": 5514240}, "done": false, "episodes_total": 7578, "training_iteration": 1755, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-52-53", "timestamp": 1691297573, "time_this_iter_s": 39.07276630401611, "time_total_s": 23447.792835712433, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1168.1771395206451, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 17.527272727272724, "ram_util_percent": 71.24000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999998e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9707815097998, "policy_loss": -2083131.1787849627, "vf_loss": 4312779.718385569}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20923.5, "diff_num_grad_updates_vs_sampler_policy": 20922.5}}, "num_env_steps_sampled": 5558160, "num_env_steps_trained": 5558160, "num_agent_steps_sampled": 5558160, "num_agent_steps_trained": 5558160}, "sampler_results": {"episode_reward_max": -151730.2922357145, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155084.0257972184, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13321971002307778, "mean_inference_ms": 0.2275081580251364, "mean_action_processing_ms": 0.055625767703144084, "mean_env_wait_ms": 0.4459019536170271, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002498780527422505, "StateBufferConnector_ms": 0.0017881393432617188, "ViewRequirementAgentConnector_ms": 0.04410743713378906}}, "episode_reward_max": -151730.2922357145, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155084.0257972184, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13321971002307778, "mean_inference_ms": 0.2275081580251364, "mean_action_processing_ms": 0.055625767703144084, "mean_env_wait_ms": 0.4459019536170271, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002498780527422505, "StateBufferConnector_ms": 0.0017881393432617188, "ViewRequirementAgentConnector_ms": 0.04410743713378906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5558160, "num_agent_steps_trained": 5558160, "num_env_steps_sampled": 5558160, "num_env_steps_trained": 5558160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1127.0526545221076, "num_env_steps_trained_throughput_per_sec": 1127.0526545221076, "timesteps_total": 5558160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5558160, "timers": {"training_iteration_time_ms": 38896.766, "sample_time_ms": 38171.967, "load_time_ms": 12.782, "load_throughput": 3436209.777, "learn_time_ms": 711.195, "learn_throughput": 61755.228, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 5558160, "num_env_steps_trained": 5558160, "num_agent_steps_sampled": 5558160, "num_agent_steps_trained": 5558160}, "done": false, "episodes_total": 7579, "training_iteration": 1756, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-53-32", "timestamp": 1691297612, "time_this_iter_s": 38.970980644226074, "time_total_s": 23486.76381635666, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1207.1481201648712, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 19.034545454545455, "ram_util_percent": 71.29272727272729}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999998e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0097638455494, "policy_loss": -2053032.6882203217, "vf_loss": 4286813.345207726}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21609.5, "diff_num_grad_updates_vs_sampler_policy": 21608.5}}, "num_env_steps_sampled": 5602080, "num_env_steps_trained": 5602080, "num_agent_steps_sampled": 5602080, "num_agent_steps_trained": 5602080}, "sampler_results": {"episode_reward_max": -151730.2922357145, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155009.29870137898, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13321404921332985, "mean_inference_ms": 0.22750215778893518, "mean_action_processing_ms": 0.05562538984031899, "mean_env_wait_ms": 0.44577173299919004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00249519944190979, "StateBufferConnector_ms": 0.001796334981918335, "ViewRequirementAgentConnector_ms": 0.0441528856754303}}, "episode_reward_max": -151730.2922357145, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155009.29870137898, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13321404921332985, "mean_inference_ms": 0.22750215778893518, "mean_action_processing_ms": 0.05562538984031899, "mean_env_wait_ms": 0.44577173299919004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00249519944190979, "StateBufferConnector_ms": 0.001796334981918335, "ViewRequirementAgentConnector_ms": 0.0441528856754303}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5602080, "num_agent_steps_trained": 5602080, "num_env_steps_sampled": 5602080, "num_env_steps_trained": 5602080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1125.0948413969002, "num_env_steps_trained_throughput_per_sec": 1125.0948413969002, "timesteps_total": 5602080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5602080, "timers": {"training_iteration_time_ms": 38925.27, "sample_time_ms": 38200.931, "load_time_ms": 12.718, "load_throughput": 3453305.733, "learn_time_ms": 710.789, "learn_throughput": 61790.519, "synch_weights_time_ms": 0.719}, "counters": {"num_env_steps_sampled": 5602080, "num_env_steps_trained": 5602080, "num_agent_steps_sampled": 5602080, "num_agent_steps_trained": 5602080}, "done": false, "episodes_total": 7580, "training_iteration": 1757, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-54-11", "timestamp": 1691297651, "time_this_iter_s": 39.03859782218933, "time_total_s": 23525.80241417885, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1246.1867179870605, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 17.425454545454542, "ram_util_percent": 71.27818181818184}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999998e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.07501567695994, "policy_loss": -2194588.9300946384, "vf_loss": 4545832.855685132}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22295.5, "diff_num_grad_updates_vs_sampler_policy": 22294.5}}, "num_env_steps_sampled": 5646000, "num_env_steps_trained": 5646000, "num_agent_steps_sampled": 5646000, "num_agent_steps_trained": 5646000}, "sampler_results": {"episode_reward_max": -151730.2922357145, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155057.2754580203, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13320865942908447, "mean_inference_ms": 0.22749601382298792, "mean_action_processing_ms": 0.055625052228605046, "mean_env_wait_ms": 0.4456524919319732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002498337716767282, "StateBufferConnector_ms": 0.0017975315903172348, "ViewRequirementAgentConnector_ms": 0.044176795265891335}}, "episode_reward_max": -151730.2922357145, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -155057.2754580203, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13320865942908447, "mean_inference_ms": 0.22749601382298792, "mean_action_processing_ms": 0.055625052228605046, "mean_env_wait_ms": 0.4456524919319732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002498337716767282, "StateBufferConnector_ms": 0.0017975315903172348, "ViewRequirementAgentConnector_ms": 0.044176795265891335}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5646000, "num_agent_steps_trained": 5646000, "num_env_steps_sampled": 5646000, "num_env_steps_trained": 5646000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1124.3560351644817, "num_env_steps_trained_throughput_per_sec": 1124.3560351644817, "timesteps_total": 5646000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5646000, "timers": {"training_iteration_time_ms": 38968.283, "sample_time_ms": 38243.537, "load_time_ms": 12.761, "load_throughput": 3441827.426, "learn_time_ms": 711.146, "learn_throughput": 61759.458, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 5646000, "num_env_steps_trained": 5646000, "num_agent_steps_sampled": 5646000, "num_agent_steps_trained": 5646000}, "done": false, "episodes_total": 7581, "training_iteration": 1758, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-54-50", "timestamp": 1691297690, "time_this_iter_s": 39.06470799446106, "time_total_s": 23564.86712217331, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1285.2514259815216, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 17.105357142857144, "ram_util_percent": 71.31250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999998e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.87479896656623, "policy_loss": -1839071.5793065552, "vf_loss": 4181272.4016034985}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22981.5, "diff_num_grad_updates_vs_sampler_policy": 22980.5}}, "num_env_steps_sampled": 5689920, "num_env_steps_trained": 5689920, "num_agent_steps_sampled": 5689920, "num_agent_steps_trained": 5689920}, "sampler_results": {"episode_reward_max": -151154.697882324, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -154942.49376461748, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13320439112530755, "mean_inference_ms": 0.22749088410758378, "mean_action_processing_ms": 0.05562476161480864, "mean_env_wait_ms": 0.4455441680317454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024886692271513097, "StateBufferConnector_ms": 0.0017916454988367418, "ViewRequirementAgentConnector_ms": 0.044153718387379366}}, "episode_reward_max": -151154.697882324, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -154942.49376461748, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13320439112530755, "mean_inference_ms": 0.22749088410758378, "mean_action_processing_ms": 0.05562476161480864, "mean_env_wait_ms": 0.4455441680317454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024886692271513097, "StateBufferConnector_ms": 0.0017916454988367418, "ViewRequirementAgentConnector_ms": 0.044153718387379366}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5689920, "num_agent_steps_trained": 5689920, "num_env_steps_sampled": 5689920, "num_env_steps_trained": 5689920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1119.8640613856817, "num_env_steps_trained_throughput_per_sec": 1119.8640613856817, "timesteps_total": 5689920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5689920, "timers": {"training_iteration_time_ms": 39018.346, "sample_time_ms": 38293.419, "load_time_ms": 12.861, "load_throughput": 3414927.632, "learn_time_ms": 711.232, "learn_throughput": 61752.027, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 5689920, "num_env_steps_trained": 5689920, "num_agent_steps_sampled": 5689920, "num_agent_steps_trained": 5689920}, "done": false, "episodes_total": 7582, "training_iteration": 1759, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-55-29", "timestamp": 1691297729, "time_this_iter_s": 39.22133922576904, "time_total_s": 23604.08846139908, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1324.4727652072906, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 17.614545454545457, "ram_util_percent": 71.27090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999998e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.06726456800635, "policy_loss": -1757156.1260562818, "vf_loss": 4263831.095116618}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23667.5, "diff_num_grad_updates_vs_sampler_policy": 23666.5}}, "num_env_steps_sampled": 5733840, "num_env_steps_trained": 5733840, "num_agent_steps_sampled": 5733840, "num_agent_steps_trained": 5733840}, "sampler_results": {"episode_reward_max": -151154.697882324, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -154866.1824218846, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1332007279814437, "mean_inference_ms": 0.22748604312900608, "mean_action_processing_ms": 0.05562443751130402, "mean_env_wait_ms": 0.4454427490036794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024809156145368305, "StateBufferConnector_ms": 0.0017935889107840402, "ViewRequirementAgentConnector_ms": 0.04417896270751953}}, "episode_reward_max": -151154.697882324, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -154866.1824218846, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1332007279814437, "mean_inference_ms": 0.22748604312900608, "mean_action_processing_ms": 0.05562443751130402, "mean_env_wait_ms": 0.4454427490036794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024809156145368305, "StateBufferConnector_ms": 0.0017935889107840402, "ViewRequirementAgentConnector_ms": 0.04417896270751953}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5733840, "num_agent_steps_trained": 5733840, "num_env_steps_sampled": 5733840, "num_env_steps_trained": 5733840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1126.2275428015034, "num_env_steps_trained_throughput_per_sec": 1126.2275428015034, "timesteps_total": 5733840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5733840, "timers": {"training_iteration_time_ms": 39013.955, "sample_time_ms": 38294.896, "load_time_ms": 12.786, "load_throughput": 3435043.609, "learn_time_ms": 705.453, "learn_throughput": 62257.894, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 5733840, "num_env_steps_trained": 5733840, "num_agent_steps_sampled": 5733840, "num_agent_steps_trained": 5733840}, "done": false, "episodes_total": 7583, "training_iteration": 1760, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-56-08", "timestamp": 1691297768, "time_this_iter_s": 38.99944090843201, "time_total_s": 23643.08790230751, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1363.4722061157227, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 17.64909090909091, "ram_util_percent": 71.2909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999998e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.04538479907865, "policy_loss": -2285866.541140898, "vf_loss": 4533660.019223761}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24353.5, "diff_num_grad_updates_vs_sampler_policy": 24352.5}}, "num_env_steps_sampled": 5777760, "num_env_steps_trained": 5777760, "num_agent_steps_sampled": 5777760, "num_agent_steps_trained": 5777760}, "sampler_results": {"episode_reward_max": -151154.697882324, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -154903.60341597616, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13319678136139648, "mean_inference_ms": 0.22748119724367177, "mean_action_processing_ms": 0.05562419393386052, "mean_env_wait_ms": 0.4453491391897988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002473592758178711, "StateBufferConnector_ms": 0.0017947620815700954, "ViewRequirementAgentConnector_ms": 0.044209427303738065}}, "episode_reward_max": -151154.697882324, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -154903.60341597616, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13319678136139648, "mean_inference_ms": 0.22748119724367177, "mean_action_processing_ms": 0.05562419393386052, "mean_env_wait_ms": 0.4453491391897988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002473592758178711, "StateBufferConnector_ms": 0.0017947620815700954, "ViewRequirementAgentConnector_ms": 0.044209427303738065}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5777760, "num_agent_steps_trained": 5777760, "num_env_steps_sampled": 5777760, "num_env_steps_trained": 5777760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1124.82845245222, "num_env_steps_trained_throughput_per_sec": 1124.82845245222, "timesteps_total": 5777760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5777760, "timers": {"training_iteration_time_ms": 39034.964, "sample_time_ms": 38315.658, "load_time_ms": 12.775, "load_throughput": 3437947.682, "learn_time_ms": 705.721, "learn_throughput": 62234.26, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 5777760, "num_env_steps_trained": 5777760, "num_agent_steps_sampled": 5777760, "num_agent_steps_trained": 5777760}, "done": false, "episodes_total": 7584, "training_iteration": 1761, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-56-47", "timestamp": 1691297807, "time_this_iter_s": 39.04798102378845, "time_total_s": 23682.1358833313, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1402.520187139511, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 17.446428571428573, "ram_util_percent": 71.25178571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999998e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.03296601320494, "policy_loss": -2142443.774453922, "vf_loss": 4533495.324344023}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25039.5, "diff_num_grad_updates_vs_sampler_policy": 25038.5}}, "num_env_steps_sampled": 5821680, "num_env_steps_trained": 5821680, "num_agent_steps_sampled": 5821680, "num_agent_steps_trained": 5821680}, "sampler_results": {"episode_reward_max": -151154.697882324, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -154935.64547214797, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.133192425425021, "mean_inference_ms": 0.22747658919230201, "mean_action_processing_ms": 0.0556238970351539, "mean_env_wait_ms": 0.44526048074260294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024666657318940036, "StateBufferConnector_ms": 0.0017932943395666174, "ViewRequirementAgentConnector_ms": 0.044198293943662904}}, "episode_reward_max": -151154.697882324, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -154935.64547214797, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.133192425425021, "mean_inference_ms": 0.22747658919230201, "mean_action_processing_ms": 0.0556238970351539, "mean_env_wait_ms": 0.44526048074260294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024666657318940036, "StateBufferConnector_ms": 0.0017932943395666174, "ViewRequirementAgentConnector_ms": 0.044198293943662904}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5821680, "num_agent_steps_trained": 5821680, "num_env_steps_sampled": 5821680, "num_env_steps_trained": 5821680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1128.9344997566445, "num_env_steps_trained_throughput_per_sec": 1128.9344997566445, "timesteps_total": 5821680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5821680, "timers": {"training_iteration_time_ms": 39039.903, "sample_time_ms": 38321.0, "load_time_ms": 12.678, "load_throughput": 3464333.057, "learn_time_ms": 705.421, "learn_throughput": 62260.693, "synch_weights_time_ms": 0.696}, "counters": {"num_env_steps_sampled": 5821680, "num_env_steps_trained": 5821680, "num_agent_steps_sampled": 5821680, "num_agent_steps_trained": 5821680}, "done": false, "episodes_total": 7585, "training_iteration": 1762, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-57-26", "timestamp": 1691297846, "time_this_iter_s": 38.90588188171387, "time_total_s": 23721.041765213013, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1441.426069021225, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 16.99090909090909, "ram_util_percent": 71.24363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999998e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.92837110691795, "policy_loss": -2157481.115923378, "vf_loss": 4512431.709730321}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25725.5, "diff_num_grad_updates_vs_sampler_policy": 25724.5}}, "num_env_steps_sampled": 5865600, "num_env_steps_trained": 5865600, "num_agent_steps_sampled": 5865600, "num_agent_steps_trained": 5865600}, "sampler_results": {"episode_reward_max": -151154.697882324, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -154952.38236134566, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13318873407954043, "mean_inference_ms": 0.2274719605097644, "mean_action_processing_ms": 0.05562356816860279, "mean_env_wait_ms": 0.44517726133389357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002451946860865543, "StateBufferConnector_ms": 0.0017937860990825452, "ViewRequirementAgentConnector_ms": 0.04414696442453485}}, "episode_reward_max": -151154.697882324, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -154952.38236134566, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13318873407954043, "mean_inference_ms": 0.2274719605097644, "mean_action_processing_ms": 0.05562356816860279, "mean_env_wait_ms": 0.44517726133389357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002451946860865543, "StateBufferConnector_ms": 0.0017937860990825452, "ViewRequirementAgentConnector_ms": 0.04414696442453485}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5865600, "num_agent_steps_trained": 5865600, "num_env_steps_sampled": 5865600, "num_env_steps_trained": 5865600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1125.8465503009293, "num_env_steps_trained_throughput_per_sec": 1125.8465503009293, "timesteps_total": 5865600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5865600, "timers": {"training_iteration_time_ms": 39047.312, "sample_time_ms": 38328.324, "load_time_ms": 12.604, "load_throughput": 3484476.737, "learn_time_ms": 705.592, "learn_throughput": 62245.586, "synch_weights_time_ms": 0.685}, "counters": {"num_env_steps_sampled": 5865600, "num_env_steps_trained": 5865600, "num_agent_steps_sampled": 5865600, "num_agent_steps_trained": 5865600}, "done": false, "episodes_total": 7586, "training_iteration": 1763, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-58-05", "timestamp": 1691297885, "time_this_iter_s": 39.0126678943634, "time_total_s": 23760.054433107376, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1480.4387369155884, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 16.621818181818178, "ram_util_percent": 71.23818181818183}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999998e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.7598888964417, "policy_loss": -1833354.0116162538, "vf_loss": 4003530.894041545}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26411.5, "diff_num_grad_updates_vs_sampler_policy": 26410.5}}, "num_env_steps_sampled": 5909520, "num_env_steps_trained": 5909520, "num_agent_steps_sampled": 5909520, "num_agent_steps_trained": 5909520}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -154807.58312609387, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13318496380042644, "mean_inference_ms": 0.22746725995562295, "mean_action_processing_ms": 0.05562318227020841, "mean_env_wait_ms": 0.44509938971032426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024404281224959935, "StateBufferConnector_ms": 0.0017911959917117388, "ViewRequirementAgentConnector_ms": 0.04412149771665915}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -154807.58312609387, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13318496380042644, "mean_inference_ms": 0.22746725995562295, "mean_action_processing_ms": 0.05562318227020841, "mean_env_wait_ms": 0.44509938971032426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024404281224959935, "StateBufferConnector_ms": 0.0017911959917117388, "ViewRequirementAgentConnector_ms": 0.04412149771665915}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5909520, "num_agent_steps_trained": 5909520, "num_env_steps_sampled": 5909520, "num_env_steps_trained": 5909520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1126.476106007018, "num_env_steps_trained_throughput_per_sec": 1126.476106007018, "timesteps_total": 5909520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5909520, "timers": {"training_iteration_time_ms": 39030.454, "sample_time_ms": 38311.396, "load_time_ms": 12.517, "load_throughput": 3508801.472, "learn_time_ms": 705.742, "learn_throughput": 62232.332, "synch_weights_time_ms": 0.691}, "counters": {"num_env_steps_sampled": 5909520, "num_env_steps_trained": 5909520, "num_agent_steps_sampled": 5909520, "num_agent_steps_trained": 5909520}, "done": false, "episodes_total": 7587, "training_iteration": 1764, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-58-44", "timestamp": 1691297924, "time_this_iter_s": 38.99083685874939, "time_total_s": 23799.045269966125, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1519.4295737743378, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 17.741818181818182, "ram_util_percent": 71.38909090909092}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999998e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.10674910920704, "policy_loss": -1937331.2979312818, "vf_loss": 4359086.459183673}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27097.5, "diff_num_grad_updates_vs_sampler_policy": 27096.5}}, "num_env_steps_sampled": 5953440, "num_env_steps_trained": 5953440, "num_agent_steps_sampled": 5953440, "num_agent_steps_trained": 5953440}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -154782.46339537212, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13318056968808312, "mean_inference_ms": 0.22746264410780953, "mean_action_processing_ms": 0.0556228693739929, "mean_env_wait_ms": 0.4450237402691773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002440214157104492, "StateBufferConnector_ms": 0.0017911195755004883, "ViewRequirementAgentConnector_ms": 0.04414021968841553}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -154782.46339537212, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13318056968808312, "mean_inference_ms": 0.22746264410780953, "mean_action_processing_ms": 0.0556228693739929, "mean_env_wait_ms": 0.4450237402691773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002440214157104492, "StateBufferConnector_ms": 0.0017911195755004883, "ViewRequirementAgentConnector_ms": 0.04414021968841553}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5953440, "num_agent_steps_trained": 5953440, "num_env_steps_sampled": 5953440, "num_env_steps_trained": 5953440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1131.0987722126329, "num_env_steps_trained_throughput_per_sec": 1131.0987722126329, "timesteps_total": 5953440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5953440, "timers": {"training_iteration_time_ms": 39006.319, "sample_time_ms": 38281.963, "load_time_ms": 12.438, "load_throughput": 3531111.156, "learn_time_ms": 711.106, "learn_throughput": 61762.939, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 5953440, "num_env_steps_trained": 5953440, "num_agent_steps_sampled": 5953440, "num_agent_steps_trained": 5953440}, "done": false, "episodes_total": 7588, "training_iteration": 1765, "trial_id": "5f2ac_00000", "date": "2023-08-06_07-59-23", "timestamp": 1691297963, "time_this_iter_s": 38.83150005340576, "time_total_s": 23837.87677001953, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1558.2610738277435, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 18.665454545454544, "ram_util_percent": 71.30363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999998e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0849966154849, "policy_loss": -2160474.1893790998, "vf_loss": 4571934.585094752}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27783.5, "diff_num_grad_updates_vs_sampler_policy": 27782.5}}, "num_env_steps_sampled": 5997360, "num_env_steps_trained": 5997360, "num_agent_steps_sampled": 5997360, "num_agent_steps_trained": 5997360}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -154847.32525401894, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13317638839763185, "mean_inference_ms": 0.22745931991790583, "mean_action_processing_ms": 0.05562255150632909, "mean_env_wait_ms": 0.4449529923780407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024277989457293253, "StateBufferConnector_ms": 0.0017893023607207508, "ViewRequirementAgentConnector_ms": 0.044125463904404055}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -154847.32525401894, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13317638839763185, "mean_inference_ms": 0.22745931991790583, "mean_action_processing_ms": 0.05562255150632909, "mean_env_wait_ms": 0.4449529923780407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024277989457293253, "StateBufferConnector_ms": 0.0017893023607207508, "ViewRequirementAgentConnector_ms": 0.044125463904404055}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5997360, "num_agent_steps_trained": 5997360, "num_env_steps_sampled": 5997360, "num_env_steps_trained": 5997360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1122.946500585068, "num_env_steps_trained_throughput_per_sec": 1122.946500585068, "timesteps_total": 5997360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5997360, "timers": {"training_iteration_time_ms": 39020.568, "sample_time_ms": 38296.667, "load_time_ms": 12.418, "load_throughput": 3536710.908, "learn_time_ms": 710.675, "learn_throughput": 61800.395, "synch_weights_time_ms": 0.694}, "counters": {"num_env_steps_sampled": 5997360, "num_env_steps_trained": 5997360, "num_agent_steps_sampled": 5997360, "num_agent_steps_trained": 5997360}, "done": false, "episodes_total": 7589, "training_iteration": 1766, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-00-02", "timestamp": 1691298002, "time_this_iter_s": 39.11333703994751, "time_total_s": 23876.99010705948, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1597.374410867691, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 17.44545454545455, "ram_util_percent": 71.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999998e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.06834304854056, "policy_loss": -1955658.5804567921, "vf_loss": 4381600.365433673}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28469.5, "diff_num_grad_updates_vs_sampler_policy": 28468.5}}, "num_env_steps_sampled": 6041280, "num_env_steps_trained": 6041280, "num_agent_steps_sampled": 6041280, "num_agent_steps_trained": 6041280}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -154825.0553382392, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13317291839823658, "mean_inference_ms": 0.2274564787296405, "mean_action_processing_ms": 0.055622311987009156, "mean_env_wait_ms": 0.4448868465370367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00242221923101516, "StateBufferConnector_ms": 0.0017875716799781436, "ViewRequirementAgentConnector_ms": 0.044123331705729164}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -157668.0116319876, "episode_reward_mean": -154825.0553382392, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13317291839823658, "mean_inference_ms": 0.2274564787296405, "mean_action_processing_ms": 0.055622311987009156, "mean_env_wait_ms": 0.4448868465370367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00242221923101516, "StateBufferConnector_ms": 0.0017875716799781436, "ViewRequirementAgentConnector_ms": 0.044123331705729164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6041280, "num_agent_steps_trained": 6041280, "num_env_steps_sampled": 6041280, "num_env_steps_trained": 6041280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1122.4084262244942, "num_env_steps_trained_throughput_per_sec": 1122.4084262244942, "timesteps_total": 6041280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6041280, "timers": {"training_iteration_time_ms": 39029.911, "sample_time_ms": 38305.262, "load_time_ms": 12.455, "load_throughput": 3526406.469, "learn_time_ms": 711.37, "learn_throughput": 61740.015, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 6041280, "num_env_steps_trained": 6041280, "num_agent_steps_sampled": 6041280, "num_agent_steps_trained": 6041280}, "done": false, "episodes_total": 7590, "training_iteration": 1767, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-00-41", "timestamp": 1691298041, "time_this_iter_s": 39.13232493400574, "time_total_s": 23916.122431993484, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1636.5067358016968, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 17.491071428571427, "ram_util_percent": 71.36785714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.3125000000000007e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.1605229502864, "policy_loss": -1908135.770616003, "vf_loss": 4802696.468932216}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29155.5, "diff_num_grad_updates_vs_sampler_policy": 29154.5}}, "num_env_steps_sampled": 6085200, "num_env_steps_trained": 6085200, "num_agent_steps_sampled": 6085200, "num_agent_steps_trained": 6085200}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -154933.5667033422, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13316963176794125, "mean_inference_ms": 0.22745373544933095, "mean_action_processing_ms": 0.055622059001839495, "mean_env_wait_ms": 0.4448192007915468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024584836738054143, "StateBufferConnector_ms": 0.001795901808627816, "ViewRequirementAgentConnector_ms": 0.04409357558849246}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -154933.5667033422, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13316963176794125, "mean_inference_ms": 0.22745373544933095, "mean_action_processing_ms": 0.055622059001839495, "mean_env_wait_ms": 0.4448192007915468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024584836738054143, "StateBufferConnector_ms": 0.001795901808627816, "ViewRequirementAgentConnector_ms": 0.04409357558849246}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6085200, "num_agent_steps_trained": 6085200, "num_env_steps_sampled": 6085200, "num_env_steps_trained": 6085200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1138.1725997995534, "num_env_steps_trained_throughput_per_sec": 1138.1725997995534, "timesteps_total": 6085200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6085200, "timers": {"training_iteration_time_ms": 38982.492, "sample_time_ms": 38257.852, "load_time_ms": 12.469, "load_throughput": 3522401.166, "learn_time_ms": 711.363, "learn_throughput": 61740.63, "synch_weights_time_ms": 0.695}, "counters": {"num_env_steps_sampled": 6085200, "num_env_steps_trained": 6085200, "num_agent_steps_sampled": 6085200, "num_agent_steps_trained": 6085200}, "done": false, "episodes_total": 7591, "training_iteration": 1768, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-01-20", "timestamp": 1691298080, "time_this_iter_s": 38.59011626243591, "time_total_s": 23954.71254825592, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1675.0968520641327, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 17.3962962962963, "ram_util_percent": 71.44259259259259}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.1249999999999998e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.2113267993093, "policy_loss": -2274547.7109716656, "vf_loss": 4667243.304664723}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29841.5, "diff_num_grad_updates_vs_sampler_policy": 29840.5}}, "num_env_steps_sampled": 6129120, "num_env_steps_trained": 6129120, "num_agent_steps_sampled": 6129120, "num_agent_steps_trained": 6129120}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155012.65029943304, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13316650116260573, "mean_inference_ms": 0.22745084635571133, "mean_action_processing_ms": 0.05562175514669387, "mean_env_wait_ms": 0.44475207802666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002451918341896751, "StateBufferConnector_ms": 0.001797350970181552, "ViewRequirementAgentConnector_ms": 0.04411502317948775}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155012.65029943304, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13316650116260573, "mean_inference_ms": 0.22745084635571133, "mean_action_processing_ms": 0.05562175514669387, "mean_env_wait_ms": 0.44475207802666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002451918341896751, "StateBufferConnector_ms": 0.001797350970181552, "ViewRequirementAgentConnector_ms": 0.04411502317948775}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6129120, "num_agent_steps_trained": 6129120, "num_env_steps_sampled": 6129120, "num_env_steps_trained": 6129120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1134.7539411397306, "num_env_steps_trained_throughput_per_sec": 1134.7539411397306, "timesteps_total": 6129120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6129120, "timers": {"training_iteration_time_ms": 38931.031, "sample_time_ms": 38206.128, "load_time_ms": 12.364, "load_throughput": 3552280.977, "learn_time_ms": 711.726, "learn_throughput": 61709.131, "synch_weights_time_ms": 0.698}, "counters": {"num_env_steps_sampled": 6129120, "num_env_steps_trained": 6129120, "num_agent_steps_sampled": 6129120, "num_agent_steps_trained": 6129120}, "done": false, "episodes_total": 7592, "training_iteration": 1769, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-01-58", "timestamp": 1691298118, "time_this_iter_s": 38.70669102668762, "time_total_s": 23993.419239282608, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1713.8035430908203, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 17.665454545454544, "ram_util_percent": 71.40181818181819}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.9375e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.15041736124556, "policy_loss": -2293628.32068832, "vf_loss": 4653317.850036443}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30527.5, "diff_num_grad_updates_vs_sampler_policy": 30526.5}}, "num_env_steps_sampled": 6173040, "num_env_steps_trained": 6173040, "num_agent_steps_sampled": 6173040, "num_agent_steps_trained": 6173040}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155084.38215173924, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13316368904582113, "mean_inference_ms": 0.22744841726984144, "mean_action_processing_ms": 0.05562155653136892, "mean_env_wait_ms": 0.44468796606718203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024610095553927952, "StateBufferConnector_ms": 0.0018035040961371528, "ViewRequirementAgentConnector_ms": 0.044291284349229604}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155084.38215173924, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13316368904582113, "mean_inference_ms": 0.22744841726984144, "mean_action_processing_ms": 0.05562155653136892, "mean_env_wait_ms": 0.44468796606718203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024610095553927952, "StateBufferConnector_ms": 0.0018035040961371528, "ViewRequirementAgentConnector_ms": 0.044291284349229604}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6173040, "num_agent_steps_trained": 6173040, "num_env_steps_sampled": 6173040, "num_env_steps_trained": 6173040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1125.9174816038776, "num_env_steps_trained_throughput_per_sec": 1125.9174816038776, "timesteps_total": 6173040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6173040, "timers": {"training_iteration_time_ms": 38932.105, "sample_time_ms": 38206.191, "load_time_ms": 12.353, "load_throughput": 3555503.411, "learn_time_ms": 712.756, "learn_throughput": 61619.981, "synch_weights_time_ms": 0.692}, "counters": {"num_env_steps_sampled": 6173040, "num_env_steps_trained": 6173040, "num_agent_steps_sampled": 6173040, "num_agent_steps_trained": 6173040}, "done": false, "episodes_total": 7593, "training_iteration": 1770, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-02-38", "timestamp": 1691298158, "time_this_iter_s": 39.01015496253967, "time_total_s": 24032.429394245148, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1752.81369805336, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 17.945454545454545, "ram_util_percent": 71.4109090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.7499999999999998e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0206950551914, "policy_loss": -2097932.6628980273, "vf_loss": 4456883.773596939}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31213.5, "diff_num_grad_updates_vs_sampler_policy": 31212.5}}, "num_env_steps_sampled": 6216960, "num_env_steps_trained": 6216960, "num_agent_steps_sampled": 6216960, "num_agent_steps_trained": 6216960}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155080.45294691742, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.133160709082072, "mean_inference_ms": 0.22744612101643547, "mean_action_processing_ms": 0.055621356094260443, "mean_env_wait_ms": 0.4446266432042686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024567479672639265, "StateBufferConnector_ms": 0.0018047249835470448, "ViewRequirementAgentConnector_ms": 0.04429920859958814}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155080.45294691742, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.133160709082072, "mean_inference_ms": 0.22744612101643547, "mean_action_processing_ms": 0.055621356094260443, "mean_env_wait_ms": 0.4446266432042686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024567479672639265, "StateBufferConnector_ms": 0.0018047249835470448, "ViewRequirementAgentConnector_ms": 0.04429920859958814}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6216960, "num_agent_steps_trained": 6216960, "num_env_steps_sampled": 6216960, "num_env_steps_trained": 6216960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1128.5664628317452, "num_env_steps_trained_throughput_per_sec": 1128.5664628317452, "timesteps_total": 6216960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6216960, "timers": {"training_iteration_time_ms": 38919.172, "sample_time_ms": 38194.077, "load_time_ms": 12.358, "load_throughput": 3554069.735, "learn_time_ms": 711.933, "learn_throughput": 61691.234, "synch_weights_time_ms": 0.691}, "counters": {"num_env_steps_sampled": 6216960, "num_env_steps_trained": 6216960, "num_agent_steps_sampled": 6216960, "num_agent_steps_trained": 6216960}, "done": false, "episodes_total": 7594, "training_iteration": 1771, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-03-16", "timestamp": 1691298196, "time_this_iter_s": 38.918647050857544, "time_total_s": 24071.348041296005, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1791.7323451042175, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 17.94181818181818, "ram_util_percent": 71.32363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.5625e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9991023116487, "policy_loss": -2116244.997713762, "vf_loss": 4311429.729591837}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31899.5, "diff_num_grad_updates_vs_sampler_policy": 31898.5}}, "num_env_steps_sampled": 6260880, "num_env_steps_trained": 6260880, "num_agent_steps_sampled": 6260880, "num_agent_steps_trained": 6260880}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155041.65137674223, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13315735798363937, "mean_inference_ms": 0.22744402918415832, "mean_action_processing_ms": 0.05562118552531747, "mean_env_wait_ms": 0.444569374512817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002448102261157746, "StateBufferConnector_ms": 0.0018074157390188664, "ViewRequirementAgentConnector_ms": 0.044266213761999254}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155041.65137674223, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13315735798363937, "mean_inference_ms": 0.22744402918415832, "mean_action_processing_ms": 0.05562118552531747, "mean_env_wait_ms": 0.444569374512817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002448102261157746, "StateBufferConnector_ms": 0.0018074157390188664, "ViewRequirementAgentConnector_ms": 0.044266213761999254}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6260880, "num_agent_steps_trained": 6260880, "num_env_steps_sampled": 6260880, "num_env_steps_trained": 6260880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1124.6847787396468, "num_env_steps_trained_throughput_per_sec": 1124.6847787396468, "timesteps_total": 6260880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6260880, "timers": {"training_iteration_time_ms": 38933.872, "sample_time_ms": 38208.506, "load_time_ms": 12.398, "load_throughput": 3542471.499, "learn_time_ms": 712.168, "learn_throughput": 61670.858, "synch_weights_time_ms": 0.687}, "counters": {"num_env_steps_sampled": 6260880, "num_env_steps_trained": 6260880, "num_agent_steps_sampled": 6260880, "num_agent_steps_trained": 6260880}, "done": false, "episodes_total": 7595, "training_iteration": 1772, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-03-56", "timestamp": 1691298236, "time_this_iter_s": 39.05292892456055, "time_total_s": 24110.400970220566, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1830.785274028778, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 17.407142857142855, "ram_util_percent": 71.34285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.3750000000000003e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0647607030396, "policy_loss": -2034309.5930866208, "vf_loss": 4441340.561042274}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 32585.5, "diff_num_grad_updates_vs_sampler_policy": 32584.5}}, "num_env_steps_sampled": 6304800, "num_env_steps_trained": 6304800, "num_agent_steps_sampled": 6304800, "num_agent_steps_trained": 6304800}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155036.29111337833, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13315438526934129, "mean_inference_ms": 0.22744187944540348, "mean_action_processing_ms": 0.055621023019204296, "mean_env_wait_ms": 0.444514590088841, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002500911553700765, "StateBufferConnector_ms": 0.0018070141474405925, "ViewRequirementAgentConnector_ms": 0.04423906405766805}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155036.29111337833, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13315438526934129, "mean_inference_ms": 0.22744187944540348, "mean_action_processing_ms": 0.055621023019204296, "mean_env_wait_ms": 0.444514590088841, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002500911553700765, "StateBufferConnector_ms": 0.0018070141474405925, "ViewRequirementAgentConnector_ms": 0.04423906405766805}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6304800, "num_agent_steps_trained": 6304800, "num_env_steps_sampled": 6304800, "num_env_steps_trained": 6304800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1126.8559600530807, "num_env_steps_trained_throughput_per_sec": 1126.8559600530807, "timesteps_total": 6304800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6304800, "timers": {"training_iteration_time_ms": 38930.378, "sample_time_ms": 38205.042, "load_time_ms": 12.375, "load_throughput": 3549146.432, "learn_time_ms": 712.154, "learn_throughput": 61672.035, "synch_weights_time_ms": 0.692}, "counters": {"num_env_steps_sampled": 6304800, "num_env_steps_trained": 6304800, "num_agent_steps_sampled": 6304800, "num_agent_steps_trained": 6304800}, "done": false, "episodes_total": 7596, "training_iteration": 1773, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-04-35", "timestamp": 1691298275, "time_this_iter_s": 38.978107213974, "time_total_s": 24149.37907743454, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1869.763381242752, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 18.07090909090909, "ram_util_percent": 71.35272727272728}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.1875e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0076554634828, "policy_loss": -2185290.5609426247, "vf_loss": 4491984.430575802}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33271.5, "diff_num_grad_updates_vs_sampler_policy": 33270.5}}, "num_env_steps_sampled": 6348720, "num_env_steps_trained": 6348720, "num_agent_steps_sampled": 6348720, "num_agent_steps_trained": 6348720}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155048.13819816159, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13315170770177967, "mean_inference_ms": 0.2274397154031684, "mean_action_processing_ms": 0.05562083063712345, "mean_env_wait_ms": 0.4444598441110069, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002499015963807398, "StateBufferConnector_ms": 0.001808575221470424, "ViewRequirementAgentConnector_ms": 0.04422275387510961}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155048.13819816159, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13315170770177967, "mean_inference_ms": 0.2274397154031684, "mean_action_processing_ms": 0.05562083063712345, "mean_env_wait_ms": 0.4444598441110069, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002499015963807398, "StateBufferConnector_ms": 0.001808575221470424, "ViewRequirementAgentConnector_ms": 0.04422275387510961}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6348720, "num_agent_steps_trained": 6348720, "num_env_steps_sampled": 6348720, "num_env_steps_trained": 6348720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1134.3073400338033, "num_env_steps_trained_throughput_per_sec": 1134.3073400338033, "timesteps_total": 6348720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6348720, "timers": {"training_iteration_time_ms": 38903.46, "sample_time_ms": 38178.894, "load_time_ms": 12.421, "load_throughput": 3536011.665, "learn_time_ms": 711.343, "learn_throughput": 61742.405, "synch_weights_time_ms": 0.688}, "counters": {"num_env_steps_sampled": 6348720, "num_env_steps_trained": 6348720, "num_agent_steps_sampled": 6348720, "num_agent_steps_trained": 6348720}, "done": false, "episodes_total": 7597, "training_iteration": 1774, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-05-13", "timestamp": 1691298313, "time_this_iter_s": 38.72240495681763, "time_total_s": 24188.101482391357, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1908.4857861995697, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 17.79454545454545, "ram_util_percent": 71.35090909090908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000003e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.94176970278903, "policy_loss": -2284192.6391103314, "vf_loss": 4486379.879919825}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33957.5, "diff_num_grad_updates_vs_sampler_policy": 33956.5}}, "num_env_steps_sampled": 6392640, "num_env_steps_trained": 6392640, "num_agent_steps_sampled": 6392640, "num_agent_steps_trained": 6392640}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155063.68114830376, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1331489277771495, "mean_inference_ms": 0.22743790490046004, "mean_action_processing_ms": 0.05562068603363915, "mean_env_wait_ms": 0.4444085709209087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025010108947753906, "StateBufferConnector_ms": 0.0018134117126464844, "ViewRequirementAgentConnector_ms": 0.04421854019165039}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155063.68114830376, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1331489277771495, "mean_inference_ms": 0.22743790490046004, "mean_action_processing_ms": 0.05562068603363915, "mean_env_wait_ms": 0.4444085709209087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025010108947753906, "StateBufferConnector_ms": 0.0018134117126464844, "ViewRequirementAgentConnector_ms": 0.04421854019165039}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6392640, "num_agent_steps_trained": 6392640, "num_env_steps_sampled": 6392640, "num_env_steps_trained": 6392640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1123.3060926041696, "num_env_steps_trained_throughput_per_sec": 1123.3060926041696, "timesteps_total": 6392640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6392640, "timers": {"training_iteration_time_ms": 38930.397, "sample_time_ms": 38211.289, "load_time_ms": 12.427, "load_throughput": 3534363.089, "learn_time_ms": 705.894, "learn_throughput": 62219.003, "synch_weights_time_ms": 0.677}, "counters": {"num_env_steps_sampled": 6392640, "num_env_steps_trained": 6392640, "num_agent_steps_sampled": 6392640, "num_agent_steps_trained": 6392640}, "done": false, "episodes_total": 7598, "training_iteration": 1775, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-05-52", "timestamp": 1691298352, "time_this_iter_s": 39.10102081298828, "time_total_s": 24227.202503204346, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1947.586807012558, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 17.501818181818184, "ram_util_percent": 71.32545454545456}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000003e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.90955355007515, "policy_loss": -2257347.740459298, "vf_loss": 4339538.677022595}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 34643.5, "diff_num_grad_updates_vs_sampler_policy": 34642.5}}, "num_env_steps_sampled": 6436560, "num_env_steps_trained": 6436560, "num_agent_steps_sampled": 6436560, "num_agent_steps_trained": 6436560}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155035.26257822747, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13314588180531595, "mean_inference_ms": 0.22743595648942386, "mean_action_processing_ms": 0.05562053943416061, "mean_env_wait_ms": 0.44436107031112093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002494980307186351, "StateBufferConnector_ms": 0.001811981201171875, "ViewRequirementAgentConnector_ms": 0.04420747943952972}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155035.26257822747, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13314588180531595, "mean_inference_ms": 0.22743595648942386, "mean_action_processing_ms": 0.05562053943416061, "mean_env_wait_ms": 0.44436107031112093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002494980307186351, "StateBufferConnector_ms": 0.001811981201171875, "ViewRequirementAgentConnector_ms": 0.04420747943952972}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6436560, "num_agent_steps_trained": 6436560, "num_env_steps_sampled": 6436560, "num_env_steps_trained": 6436560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1123.9541775713408, "num_env_steps_trained_throughput_per_sec": 1123.9541775713408, "timesteps_total": 6436560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6436560, "timers": {"training_iteration_time_ms": 38926.891, "sample_time_ms": 38207.836, "load_time_ms": 12.487, "load_throughput": 3517296.5, "learn_time_ms": 705.779, "learn_throughput": 62229.151, "synch_weights_time_ms": 0.68}, "counters": {"num_env_steps_sampled": 6436560, "num_env_steps_trained": 6436560, "num_agent_steps_sampled": 6436560, "num_agent_steps_trained": 6436560}, "done": false, "episodes_total": 7599, "training_iteration": 1776, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-06-31", "timestamp": 1691298391, "time_this_iter_s": 39.07832384109497, "time_total_s": 24266.28082704544, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1986.665130853653, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 17.170909090909092, "ram_util_percent": 71.36363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000003e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9645954721523, "policy_loss": -2081645.4961734693, "vf_loss": 4457509.252459913}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35329.5, "diff_num_grad_updates_vs_sampler_policy": 35328.5}}, "num_env_steps_sampled": 6480480, "num_env_steps_trained": 6480480, "num_agent_steps_sampled": 6480480, "num_agent_steps_trained": 6480480}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155037.1350084657, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13314261067221822, "mean_inference_ms": 0.2274339130366621, "mean_action_processing_ms": 0.05562042512682559, "mean_env_wait_ms": 0.44431461475934597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024887231680063102, "StateBufferConnector_ms": 0.001816107676579402, "ViewRequirementAgentConnector_ms": 0.04422572942880484}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155037.1350084657, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13314261067221822, "mean_inference_ms": 0.2274339130366621, "mean_action_processing_ms": 0.05562042512682559, "mean_env_wait_ms": 0.44431461475934597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024887231680063102, "StateBufferConnector_ms": 0.001816107676579402, "ViewRequirementAgentConnector_ms": 0.04422572942880484}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6480480, "num_agent_steps_trained": 6480480, "num_env_steps_sampled": 6480480, "num_env_steps_trained": 6480480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1131.710105016778, "num_env_steps_trained_throughput_per_sec": 1131.710105016778, "timesteps_total": 6480480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6480480, "timers": {"training_iteration_time_ms": 38894.729, "sample_time_ms": 38175.1, "load_time_ms": 12.517, "load_throughput": 3508928.461, "learn_time_ms": 706.347, "learn_throughput": 62179.076, "synch_weights_time_ms": 0.657}, "counters": {"num_env_steps_sampled": 6480480, "num_env_steps_trained": 6480480, "num_agent_steps_sampled": 6480480, "num_agent_steps_trained": 6480480}, "done": false, "episodes_total": 7600, "training_iteration": 1777, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-07-10", "timestamp": 1691298430, "time_this_iter_s": 38.810482025146484, "time_total_s": 24305.091309070587, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2025.4756128787994, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 17.752727272727274, "ram_util_percent": 71.32363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000003e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.04153024211917, "policy_loss": -1997392.7482661032, "vf_loss": 4360611.054300291}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36015.5, "diff_num_grad_updates_vs_sampler_policy": 36014.5}}, "num_env_steps_sampled": 6524400, "num_env_steps_trained": 6524400, "num_agent_steps_sampled": 6524400, "num_agent_steps_trained": 6524400}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155006.99193980786, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13313901344985135, "mean_inference_ms": 0.22743172768861303, "mean_action_processing_ms": 0.05562030784980629, "mean_env_wait_ms": 0.44426448838630866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024845015327885464, "StateBufferConnector_ms": 0.001816029818552845, "ViewRequirementAgentConnector_ms": 0.04420415410455668}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155006.99193980786, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13313901344985135, "mean_inference_ms": 0.22743172768861303, "mean_action_processing_ms": 0.05562030784980629, "mean_env_wait_ms": 0.44426448838630866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024845015327885464, "StateBufferConnector_ms": 0.001816029818552845, "ViewRequirementAgentConnector_ms": 0.04420415410455668}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6524400, "num_agent_steps_trained": 6524400, "num_env_steps_sampled": 6524400, "num_env_steps_trained": 6524400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1150.0203359769996, "num_env_steps_trained_throughput_per_sec": 1150.0203359769996, "timesteps_total": 6524400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6524400, "timers": {"training_iteration_time_ms": 38854.975, "sample_time_ms": 38135.809, "load_time_ms": 12.557, "load_throughput": 3497768.615, "learn_time_ms": 705.833, "learn_throughput": 62224.375, "synch_weights_time_ms": 0.668}, "counters": {"num_env_steps_sampled": 6524400, "num_env_steps_trained": 6524400, "num_agent_steps_sampled": 6524400, "num_agent_steps_trained": 6524400}, "done": false, "episodes_total": 7601, "training_iteration": 1778, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-07-48", "timestamp": 1691298468, "time_this_iter_s": 38.193037033081055, "time_total_s": 24343.28434610367, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2063.6686499118805, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 21.10740740740741, "ram_util_percent": 71.32037037037037}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000003e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0041137784285, "policy_loss": -2059018.954387698, "vf_loss": 4327053.174016035}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36701.5, "diff_num_grad_updates_vs_sampler_policy": 36700.5}}, "num_env_steps_sampled": 6568320, "num_env_steps_trained": 6568320, "num_agent_steps_sampled": 6568320, "num_agent_steps_trained": 6568320}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -154979.82761821605, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1331353764270969, "mean_inference_ms": 0.22742986974373752, "mean_action_processing_ms": 0.05562024235478638, "mean_env_wait_ms": 0.44421554949543735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002482643833866826, "StateBufferConnector_ms": 0.0018225775824652778, "ViewRequirementAgentConnector_ms": 0.04421340094672309}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -154979.82761821605, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1331353764270969, "mean_inference_ms": 0.22742986974373752, "mean_action_processing_ms": 0.05562024235478638, "mean_env_wait_ms": 0.44421554949543735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002482643833866826, "StateBufferConnector_ms": 0.0018225775824652778, "ViewRequirementAgentConnector_ms": 0.04421340094672309}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6568320, "num_agent_steps_trained": 6568320, "num_env_steps_sampled": 6568320, "num_env_steps_trained": 6568320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1130.3151506013135, "num_env_steps_trained_throughput_per_sec": 1130.3151506013135, "timesteps_total": 6568320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6568320, "timers": {"training_iteration_time_ms": 38870.174, "sample_time_ms": 38151.532, "load_time_ms": 12.566, "load_throughput": 3495127.333, "learn_time_ms": 705.299, "learn_throughput": 62271.467, "synch_weights_time_ms": 0.668}, "counters": {"num_env_steps_sampled": 6568320, "num_env_steps_trained": 6568320, "num_agent_steps_sampled": 6568320, "num_agent_steps_trained": 6568320}, "done": false, "episodes_total": 7602, "training_iteration": 1779, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-08-27", "timestamp": 1691298507, "time_this_iter_s": 38.858494997024536, "time_total_s": 24382.142841100693, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2102.527144908905, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 17.25818181818182, "ram_util_percent": 71.29272727272728}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000003e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.2301463135477, "policy_loss": -1807889.7252129647, "vf_loss": 4576976.169369534}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 37387.5, "diff_num_grad_updates_vs_sampler_policy": 37386.5}}, "num_env_steps_sampled": 6612240, "num_env_steps_trained": 6612240, "num_agent_steps_sampled": 6612240, "num_agent_steps_trained": 6612240}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155003.44776079126, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13313200749289358, "mean_inference_ms": 0.22742800022322857, "mean_action_processing_ms": 0.055620146208455706, "mean_env_wait_ms": 0.4441662653930701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024804201993075285, "StateBufferConnector_ms": 0.0018258528275923295, "ViewRequirementAgentConnector_ms": 0.044198036193847656}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155003.44776079126, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13313200749289358, "mean_inference_ms": 0.22742800022322857, "mean_action_processing_ms": 0.055620146208455706, "mean_env_wait_ms": 0.4441662653930701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024804201993075285, "StateBufferConnector_ms": 0.0018258528275923295, "ViewRequirementAgentConnector_ms": 0.044198036193847656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6612240, "num_agent_steps_trained": 6612240, "num_env_steps_sampled": 6612240, "num_env_steps_trained": 6612240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1136.3321128221016, "num_env_steps_trained_throughput_per_sec": 1136.3321128221016, "timesteps_total": 6612240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6612240, "timers": {"training_iteration_time_ms": 38834.423, "sample_time_ms": 38116.072, "load_time_ms": 12.66, "load_throughput": 3469258.905, "learn_time_ms": 704.898, "learn_throughput": 62306.916, "synch_weights_time_ms": 0.684}, "counters": {"num_env_steps_sampled": 6612240, "num_env_steps_trained": 6612240, "num_agent_steps_sampled": 6612240, "num_agent_steps_trained": 6612240}, "done": false, "episodes_total": 7603, "training_iteration": 1780, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-09-06", "timestamp": 1691298546, "time_this_iter_s": 38.65271592140198, "time_total_s": 24420.795557022095, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2141.179860830307, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 17.71272727272727, "ram_util_percent": 71.29636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000003e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.06100503904827, "policy_loss": -2194233.5706968615, "vf_loss": 4528101.650510204}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38073.5, "diff_num_grad_updates_vs_sampler_policy": 38072.5}}, "num_env_steps_sampled": 6656160, "num_env_steps_trained": 6656160, "num_agent_steps_sampled": 6656160, "num_agent_steps_trained": 6656160}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155014.9638948143, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13312857655383858, "mean_inference_ms": 0.22742683206726458, "mean_action_processing_ms": 0.05562006264118121, "mean_env_wait_ms": 0.4441179508022266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002473592758178711, "StateBufferConnector_ms": 0.0018251793725149973, "ViewRequirementAgentConnector_ms": 0.04419471536363874}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155014.9638948143, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13312857655383858, "mean_inference_ms": 0.22742683206726458, "mean_action_processing_ms": 0.05562006264118121, "mean_env_wait_ms": 0.4441179508022266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002473592758178711, "StateBufferConnector_ms": 0.0018251793725149973, "ViewRequirementAgentConnector_ms": 0.04419471536363874}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6656160, "num_agent_steps_trained": 6656160, "num_env_steps_sampled": 6656160, "num_env_steps_trained": 6656160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1127.835686458454, "num_env_steps_trained_throughput_per_sec": 1127.835686458454, "timesteps_total": 6656160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6656160, "timers": {"training_iteration_time_ms": 38836.944, "sample_time_ms": 38112.055, "load_time_ms": 12.605, "load_throughput": 3484344.922, "learn_time_ms": 711.474, "learn_throughput": 61731.007, "synch_weights_time_ms": 0.695}, "counters": {"num_env_steps_sampled": 6656160, "num_env_steps_trained": 6656160, "num_agent_steps_sampled": 6656160, "num_agent_steps_trained": 6656160}, "done": false, "episodes_total": 7604, "training_iteration": 1781, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-09-45", "timestamp": 1691298585, "time_this_iter_s": 38.94395303726196, "time_total_s": 24459.739510059357, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2180.123813867569, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 18.138181818181817, "ram_util_percent": 71.26545454545456}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000003e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.06725362438505, "policy_loss": -2000138.473009293, "vf_loss": 4603333.086005831}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38759.5, "diff_num_grad_updates_vs_sampler_policy": 38758.5}}, "num_env_steps_sampled": 6700080, "num_env_steps_trained": 6700080, "num_agent_steps_sampled": 6700080, "num_agent_steps_trained": 6700080}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155051.45142676876, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13312546752918333, "mean_inference_ms": 0.22742616615111064, "mean_action_processing_ms": 0.05562001002867923, "mean_env_wait_ms": 0.44407151820603175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002469096267432497, "StateBufferConnector_ms": 0.001819510208932977, "ViewRequirementAgentConnector_ms": 0.04417645303826583}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155051.45142676876, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13312546752918333, "mean_inference_ms": 0.22742616615111064, "mean_action_processing_ms": 0.05562001002867923, "mean_env_wait_ms": 0.44407151820603175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002469096267432497, "StateBufferConnector_ms": 0.001819510208932977, "ViewRequirementAgentConnector_ms": 0.04417645303826583}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6700080, "num_agent_steps_trained": 6700080, "num_env_steps_sampled": 6700080, "num_env_steps_trained": 6700080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1124.6942203428146, "num_env_steps_trained_throughput_per_sec": 1124.6942203428146, "timesteps_total": 6700080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6700080, "timers": {"training_iteration_time_ms": 38836.911, "sample_time_ms": 38112.142, "load_time_ms": 12.536, "load_throughput": 3503602.842, "learn_time_ms": 711.419, "learn_throughput": 61735.805, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 6700080, "num_env_steps_trained": 6700080, "num_agent_steps_sampled": 6700080, "num_agent_steps_trained": 6700080}, "done": false, "episodes_total": 7605, "training_iteration": 1782, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-10-24", "timestamp": 1691298624, "time_this_iter_s": 39.052757024765015, "time_total_s": 24498.79226708412, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2219.176570892334, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 18.259999999999998, "ram_util_percent": 71.26545454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000003e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.98529244025315, "policy_loss": -1830396.3575329126, "vf_loss": 4422013.988155977}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 39445.5, "diff_num_grad_updates_vs_sampler_policy": 39444.5}}, "num_env_steps_sampled": 6744000, "num_env_steps_trained": 6744000, "num_agent_steps_sampled": 6744000, "num_agent_steps_trained": 6744000}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155044.41415734444, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13312228078784832, "mean_inference_ms": 0.2274255849715969, "mean_action_processing_ms": 0.055619914644934924, "mean_env_wait_ms": 0.44402585878952827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002463932695059941, "StateBufferConnector_ms": 0.0018193803984543372, "ViewRequirementAgentConnector_ms": 0.04415183231748383}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155044.41415734444, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13312228078784832, "mean_inference_ms": 0.2274255849715969, "mean_action_processing_ms": 0.055619914644934924, "mean_env_wait_ms": 0.44402585878952827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002463932695059941, "StateBufferConnector_ms": 0.0018193803984543372, "ViewRequirementAgentConnector_ms": 0.04415183231748383}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6744000, "num_agent_steps_trained": 6744000, "num_env_steps_sampled": 6744000, "num_env_steps_trained": 6744000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1132.0455916117369, "num_env_steps_trained_throughput_per_sec": 1132.0455916117369, "timesteps_total": 6744000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6744000, "timers": {"training_iteration_time_ms": 38819.044, "sample_time_ms": 38093.525, "load_time_ms": 12.526, "load_throughput": 3506370.412, "learn_time_ms": 712.184, "learn_throughput": 61669.431, "synch_weights_time_ms": 0.694}, "counters": {"num_env_steps_sampled": 6744000, "num_env_steps_trained": 6744000, "num_agent_steps_sampled": 6744000, "num_agent_steps_trained": 6744000}, "done": false, "episodes_total": 7606, "training_iteration": 1783, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-11-03", "timestamp": 1691298663, "time_this_iter_s": 38.79931020736694, "time_total_s": 24537.59157729149, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2257.975881099701, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 17.332727272727276, "ram_util_percent": 71.20727272727274}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000003e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0081797341216, "policy_loss": -2078944.5244425337, "vf_loss": 4381489.005466472}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 40131.5, "diff_num_grad_updates_vs_sampler_policy": 40130.5}}, "num_env_steps_sampled": 6787920, "num_env_steps_trained": 6787920, "num_agent_steps_sampled": 6787920, "num_agent_steps_trained": 6787920}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155029.70209518512, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13311911453298533, "mean_inference_ms": 0.2274252961955362, "mean_action_processing_ms": 0.05561985034637717, "mean_env_wait_ms": 0.44398204453165785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024698548397775423, "StateBufferConnector_ms": 0.0018245082790568723, "ViewRequirementAgentConnector_ms": 0.04417896270751953}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155029.70209518512, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13311911453298533, "mean_inference_ms": 0.2274252961955362, "mean_action_processing_ms": 0.05561985034637717, "mean_env_wait_ms": 0.44398204453165785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024698548397775423, "StateBufferConnector_ms": 0.0018245082790568723, "ViewRequirementAgentConnector_ms": 0.04417896270751953}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6787920, "num_agent_steps_trained": 6787920, "num_env_steps_sampled": 6787920, "num_env_steps_trained": 6787920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1125.814452488633, "num_env_steps_trained_throughput_per_sec": 1125.814452488633, "timesteps_total": 6787920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6787920, "timers": {"training_iteration_time_ms": 38848.253, "sample_time_ms": 38121.573, "load_time_ms": 12.495, "load_throughput": 3515095.106, "learn_time_ms": 713.372, "learn_throughput": 61566.786, "synch_weights_time_ms": 0.695}, "counters": {"num_env_steps_sampled": 6787920, "num_env_steps_trained": 6787920, "num_agent_steps_sampled": 6787920, "num_agent_steps_trained": 6787920}, "done": false, "episodes_total": 7607, "training_iteration": 1784, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-11-42", "timestamp": 1691298702, "time_this_iter_s": 39.01382493972778, "time_total_s": 24576.605402231216, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2296.9897060394287, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 17.575, "ram_util_percent": 71.25892857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000003e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.2254768126908, "policy_loss": -2503401.599017174, "vf_loss": 4707386.392037172}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 40817.5, "diff_num_grad_updates_vs_sampler_policy": 40816.5}}, "num_env_steps_sampled": 6831840, "num_env_steps_trained": 6831840, "num_agent_steps_sampled": 6831840, "num_agent_steps_trained": 6831840}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155091.60431836912, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13311623177337847, "mean_inference_ms": 0.2274251361402384, "mean_action_processing_ms": 0.05561984623239006, "mean_env_wait_ms": 0.44393961574043656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002467632293701172, "StateBufferConnector_ms": 0.0018239021301269531, "ViewRequirementAgentConnector_ms": 0.04416028658548991}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155091.60431836912, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13311623177337847, "mean_inference_ms": 0.2274251361402384, "mean_action_processing_ms": 0.05561984623239006, "mean_env_wait_ms": 0.44393961574043656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002467632293701172, "StateBufferConnector_ms": 0.0018239021301269531, "ViewRequirementAgentConnector_ms": 0.04416028658548991}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6831840, "num_agent_steps_trained": 6831840, "num_env_steps_sampled": 6831840, "num_env_steps_trained": 6831840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1126.4616542169388, "num_env_steps_trained_throughput_per_sec": 1126.4616542169388, "timesteps_total": 6831840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6831840, "timers": {"training_iteration_time_ms": 38837.3, "sample_time_ms": 38108.472, "load_time_ms": 12.547, "load_throughput": 3500387.288, "learn_time_ms": 715.46, "learn_throughput": 61387.099, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 6831840, "num_env_steps_trained": 6831840, "num_agent_steps_sampled": 6831840, "num_agent_steps_trained": 6831840}, "done": false, "episodes_total": 7608, "training_iteration": 1785, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-12-21", "timestamp": 1691298741, "time_this_iter_s": 38.992084980010986, "time_total_s": 24615.597487211227, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2335.9817910194397, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 18.51818181818182, "ram_util_percent": 71.2509090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000003e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.03152421334045, "policy_loss": -2064843.4862540998, "vf_loss": 4350560.407798834}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 41503.5, "diff_num_grad_updates_vs_sampler_policy": 41502.5}}, "num_env_steps_sampled": 6875760, "num_env_steps_trained": 6875760, "num_agent_steps_sampled": 6875760, "num_agent_steps_trained": 6875760}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155075.9898371466, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13311336414508562, "mean_inference_ms": 0.22742521030421942, "mean_action_processing_ms": 0.05561989421361427, "mean_env_wait_ms": 0.44389886523305555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002468218568895684, "StateBufferConnector_ms": 0.0018248792554511398, "ViewRequirementAgentConnector_ms": 0.0441562933999984}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155075.9898371466, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13311336414508562, "mean_inference_ms": 0.22742521030421942, "mean_action_processing_ms": 0.05561989421361427, "mean_env_wait_ms": 0.44389886523305555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002468218568895684, "StateBufferConnector_ms": 0.0018248792554511398, "ViewRequirementAgentConnector_ms": 0.0441562933999984}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6875760, "num_agent_steps_trained": 6875760, "num_env_steps_sampled": 6875760, "num_env_steps_trained": 6875760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1125.7719196864703, "num_env_steps_trained_throughput_per_sec": 1125.7719196864703, "timesteps_total": 6875760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6875760, "timers": {"training_iteration_time_ms": 38830.99, "sample_time_ms": 38101.09, "load_time_ms": 12.457, "load_throughput": 3525711.294, "learn_time_ms": 716.622, "learn_throughput": 61287.578, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 6875760, "num_env_steps_trained": 6875760, "num_agent_steps_sampled": 6875760, "num_agent_steps_trained": 6875760}, "done": false, "episodes_total": 7609, "training_iteration": 1786, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-13-00", "timestamp": 1691298780, "time_this_iter_s": 39.01607608795166, "time_total_s": 24654.61356329918, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2374.9978671073914, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 18.236363636363638, "ram_util_percent": 71.25272727272728}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000003e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.17657635302305, "policy_loss": -1671043.7080846848, "vf_loss": 4433000.566053207}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 42189.5, "diff_num_grad_updates_vs_sampler_policy": 42188.5}}, "num_env_steps_sampled": 6919680, "num_env_steps_trained": 6919680, "num_agent_steps_sampled": 6919680, "num_agent_steps_trained": 6919680}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155066.48259838347, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13311030377273264, "mean_inference_ms": 0.227425367339637, "mean_action_processing_ms": 0.05561993435833456, "mean_env_wait_ms": 0.44385917039826706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024976268891365298, "StateBufferConnector_ms": 0.0018265939527942288, "ViewRequirementAgentConnector_ms": 0.04418780726771201}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155066.48259838347, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13311030377273264, "mean_inference_ms": 0.227425367339637, "mean_action_processing_ms": 0.05561993435833456, "mean_env_wait_ms": 0.44385917039826706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024976268891365298, "StateBufferConnector_ms": 0.0018265939527942288, "ViewRequirementAgentConnector_ms": 0.04418780726771201}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6919680, "num_agent_steps_trained": 6919680, "num_env_steps_sampled": 6919680, "num_env_steps_trained": 6919680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1130.2603975964885, "num_env_steps_trained_throughput_per_sec": 1130.2603975964885, "timesteps_total": 6919680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6919680, "timers": {"training_iteration_time_ms": 38835.968, "sample_time_ms": 38106.394, "load_time_ms": 12.413, "load_throughput": 3538144.202, "learn_time_ms": 716.336, "learn_throughput": 61312.033, "synch_weights_time_ms": 0.707}, "counters": {"num_env_steps_sampled": 6919680, "num_env_steps_trained": 6919680, "num_agent_steps_sampled": 6919680, "num_agent_steps_trained": 6919680}, "done": false, "episodes_total": 7610, "training_iteration": 1787, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-13-39", "timestamp": 1691298819, "time_this_iter_s": 38.860403060913086, "time_total_s": 24693.473966360092, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2413.8582701683044, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 17.71818181818182, "ram_util_percent": 71.22000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000003e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.004441286315, "policy_loss": -1999984.6457868305, "vf_loss": 4325884.520408163}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 42875.5, "diff_num_grad_updates_vs_sampler_policy": 42874.5}}, "num_env_steps_sampled": 6963600, "num_env_steps_trained": 6963600, "num_agent_steps_sampled": 6963600, "num_agent_steps_trained": 6963600}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155038.92964034865, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13310757689320227, "mean_inference_ms": 0.227425587660871, "mean_action_processing_ms": 0.05561994717997653, "mean_env_wait_ms": 0.44382085894162354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024927986992730033, "StateBufferConnector_ms": 0.001827497330922929, "ViewRequirementAgentConnector_ms": 0.044165338788713725}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155038.92964034865, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13310757689320227, "mean_inference_ms": 0.227425587660871, "mean_action_processing_ms": 0.05561994717997653, "mean_env_wait_ms": 0.44382085894162354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024927986992730033, "StateBufferConnector_ms": 0.001827497330922929, "ViewRequirementAgentConnector_ms": 0.044165338788713725}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6963600, "num_agent_steps_trained": 6963600, "num_env_steps_sampled": 6963600, "num_env_steps_trained": 6963600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1126.1016157776337, "num_env_steps_trained_throughput_per_sec": 1126.1016157776337, "timesteps_total": 6963600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6963600, "timers": {"training_iteration_time_ms": 38917.086, "sample_time_ms": 38186.976, "load_time_ms": 12.4, "load_throughput": 3541974.275, "learn_time_ms": 716.895, "learn_throughput": 61264.224, "synch_weights_time_ms": 0.697}, "counters": {"num_env_steps_sampled": 6963600, "num_env_steps_trained": 6963600, "num_agent_steps_sampled": 6963600, "num_agent_steps_trained": 6963600}, "done": false, "episodes_total": 7611, "training_iteration": 1788, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-14-18", "timestamp": 1691298858, "time_this_iter_s": 39.004350900650024, "time_total_s": 24732.478317260742, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2452.8626210689545, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 17.492727272727272, "ram_util_percent": 71.25636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000003e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.2318657521951, "policy_loss": -1982044.9997466062, "vf_loss": 4530350.897959184}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 43561.5, "diff_num_grad_updates_vs_sampler_policy": 43560.5}}, "num_env_steps_sampled": 7007520, "num_env_steps_trained": 7007520, "num_agent_steps_sampled": 7007520, "num_agent_steps_trained": 7007520}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155053.21908429355, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13310873779334648, "mean_inference_ms": 0.22742861551695567, "mean_action_processing_ms": 0.05562066449251343, "mean_env_wait_ms": 0.44378746702503613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024899840354919434, "StateBufferConnector_ms": 0.0018279999494552612, "ViewRequirementAgentConnector_ms": 0.0441771000623703}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155053.21908429355, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13310873779334648, "mean_inference_ms": 0.22742861551695567, "mean_action_processing_ms": 0.05562066449251343, "mean_env_wait_ms": 0.44378746702503613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024899840354919434, "StateBufferConnector_ms": 0.0018279999494552612, "ViewRequirementAgentConnector_ms": 0.0441771000623703}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7007520, "num_agent_steps_trained": 7007520, "num_env_steps_sampled": 7007520, "num_env_steps_trained": 7007520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1069.1224919599263, "num_env_steps_trained_throughput_per_sec": 1069.1224919599263, "timesteps_total": 7007520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7007520, "timers": {"training_iteration_time_ms": 39139.486, "sample_time_ms": 38397.372, "load_time_ms": 12.532, "load_throughput": 3504722.681, "learn_time_ms": 728.761, "learn_throughput": 60266.652, "synch_weights_time_ms": 0.702}, "counters": {"num_env_steps_sampled": 7007520, "num_env_steps_trained": 7007520, "num_agent_steps_sampled": 7007520, "num_agent_steps_trained": 7007520}, "done": false, "episodes_total": 7612, "training_iteration": 1789, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-14-59", "timestamp": 1691298899, "time_this_iter_s": 41.08308792114258, "time_total_s": 24773.561405181885, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2493.945708990097, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 19.549999999999997, "ram_util_percent": 71.37241379310345}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000003e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0022901974336, "policy_loss": -1780065.7378200165, "vf_loss": 4264317.7152879005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 44247.5, "diff_num_grad_updates_vs_sampler_policy": 44246.5}}, "num_env_steps_sampled": 7051440, "num_env_steps_trained": 7051440, "num_agent_steps_sampled": 7051440, "num_agent_steps_trained": 7051440}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155007.81428235906, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13311464757175123, "mean_inference_ms": 0.22743783209605692, "mean_action_processing_ms": 0.055622960572365925, "mean_env_wait_ms": 0.4437630902258566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024898235614483175, "StateBufferConnector_ms": 0.0018325218787560095, "ViewRequirementAgentConnector_ms": 0.04424645350529598}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -155007.81428235906, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13311464757175123, "mean_inference_ms": 0.22743783209605692, "mean_action_processing_ms": 0.055622960572365925, "mean_env_wait_ms": 0.4437630902258566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024898235614483175, "StateBufferConnector_ms": 0.0018325218787560095, "ViewRequirementAgentConnector_ms": 0.04424645350529598}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7051440, "num_agent_steps_trained": 7051440, "num_env_steps_sampled": 7051440, "num_env_steps_trained": 7051440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1020.3323717432025, "num_env_steps_trained_throughput_per_sec": 1020.3323717432025, "timesteps_total": 7051440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7051440, "timers": {"training_iteration_time_ms": 39578.898, "sample_time_ms": 38821.592, "load_time_ms": 12.593, "load_throughput": 3487610.289, "learn_time_ms": 743.899, "learn_throughput": 59040.261, "synch_weights_time_ms": 0.693}, "counters": {"num_env_steps_sampled": 7051440, "num_env_steps_trained": 7051440, "num_agent_steps_sampled": 7051440, "num_agent_steps_trained": 7051440}, "done": false, "episodes_total": 7613, "training_iteration": 1790, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-15-42", "timestamp": 1691298942, "time_this_iter_s": 43.0470130443573, "time_total_s": 24816.608418226242, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2536.9927220344543, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 18.224590163934426, "ram_util_percent": 71.47049180327868}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000003e-11, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0713694046955, "policy_loss": -1982372.716728544, "vf_loss": 4303508.730594023}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 44933.5, "diff_num_grad_updates_vs_sampler_policy": 44932.5}}, "num_env_steps_sampled": 7095360, "num_env_steps_trained": 7095360, "num_agent_steps_sampled": 7095360, "num_agent_steps_trained": 7095360}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -154978.48706212052, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1331242611243438, "mean_inference_ms": 0.22745203379269557, "mean_action_processing_ms": 0.055626626514241814, "mean_env_wait_ms": 0.44374875018010224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002489667950254498, "StateBufferConnector_ms": 0.0018365455396247633, "ViewRequirementAgentConnector_ms": 0.044298533237341675}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -154978.48706212052, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1331242611243438, "mean_inference_ms": 0.22745203379269557, "mean_action_processing_ms": 0.055626626514241814, "mean_env_wait_ms": 0.44374875018010224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002489667950254498, "StateBufferConnector_ms": 0.0018365455396247633, "ViewRequirementAgentConnector_ms": 0.044298533237341675}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7095360, "num_agent_steps_trained": 7095360, "num_env_steps_sampled": 7095360, "num_env_steps_trained": 7095360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1021.329557469841, "num_env_steps_trained_throughput_per_sec": 1021.329557469841, "timesteps_total": 7095360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7095360, "timers": {"training_iteration_time_ms": 39984.991, "sample_time_ms": 39222.168, "load_time_ms": 12.631, "load_throughput": 3477248.229, "learn_time_ms": 749.38, "learn_throughput": 58608.447, "synch_weights_time_ms": 0.696}, "counters": {"num_env_steps_sampled": 7095360, "num_env_steps_trained": 7095360, "num_agent_steps_sampled": 7095360, "num_agent_steps_trained": 7095360}, "done": false, "episodes_total": 7614, "training_iteration": 1791, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-16-25", "timestamp": 1691298985, "time_this_iter_s": 43.00536608695984, "time_total_s": 24859.613784313202, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2579.998088121414, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 18.224590163934426, "ram_util_percent": 71.3016393442623}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.375000000000002e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.00397684970335, "policy_loss": -2175232.627666329, "vf_loss": 4391492.318695336}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 45619.5, "diff_num_grad_updates_vs_sampler_policy": 45618.5}}, "num_env_steps_sampled": 7139280, "num_env_steps_trained": 7139280, "num_agent_steps_sampled": 7139280, "num_agent_steps_trained": 7139280}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -154972.76419237044, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1331373034322183, "mean_inference_ms": 0.2274703596438802, "mean_action_processing_ms": 0.055631397333210354, "mean_env_wait_ms": 0.44374192852582883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025464527642548975, "StateBufferConnector_ms": 0.0018372464535841302, "ViewRequirementAgentConnector_ms": 0.04434336477251195}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -159491.04403766844, "episode_reward_mean": -154972.76419237044, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1331373034322183, "mean_inference_ms": 0.2274703596438802, "mean_action_processing_ms": 0.055631397333210354, "mean_env_wait_ms": 0.44374192852582883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025464527642548975, "StateBufferConnector_ms": 0.0018372464535841302, "ViewRequirementAgentConnector_ms": 0.04434336477251195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7139280, "num_agent_steps_trained": 7139280, "num_env_steps_sampled": 7139280, "num_env_steps_trained": 7139280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1033.2830346632913, "num_env_steps_trained_throughput_per_sec": 1033.2830346632913, "timesteps_total": 7139280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7139280, "timers": {"training_iteration_time_ms": 40330.458, "sample_time_ms": 39557.148, "load_time_ms": 12.759, "load_throughput": 3442335.524, "learn_time_ms": 759.721, "learn_throughput": 57810.664, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 7139280, "num_env_steps_trained": 7139280, "num_agent_steps_sampled": 7139280, "num_agent_steps_trained": 7139280}, "done": false, "episodes_total": 7615, "training_iteration": 1792, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-17-08", "timestamp": 1691299028, "time_this_iter_s": 42.5076220035553, "time_total_s": 24902.121406316757, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2622.5057101249695, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 17.541666666666668, "ram_util_percent": 71.33}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.749999999999997e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.14675583019203, "policy_loss": -2153562.6086091246, "vf_loss": 4823465.619533528}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 46304.5}}, "num_env_steps_sampled": 7183200, "num_env_steps_trained": 7183200, "num_agent_steps_sampled": 7183200, "num_agent_steps_trained": 7183200}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -155050.27038658888, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13315345308520576, "mean_inference_ms": 0.22749216914490203, "mean_action_processing_ms": 0.05563712370795087, "mean_env_wait_ms": 0.44374103392031977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002543014638564166, "StateBufferConnector_ms": 0.0018393292146570543, "ViewRequirementAgentConnector_ms": 0.044366892646340764}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -155050.27038658888, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13315345308520576, "mean_inference_ms": 0.22749216914490203, "mean_action_processing_ms": 0.05563712370795087, "mean_env_wait_ms": 0.44374103392031977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002543014638564166, "StateBufferConnector_ms": 0.0018393292146570543, "ViewRequirementAgentConnector_ms": 0.044366892646340764}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7183200, "num_agent_steps_trained": 7183200, "num_env_steps_sampled": 7183200, "num_env_steps_trained": 7183200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1040.8962675748312, "num_env_steps_trained_throughput_per_sec": 1040.8962675748312, "timesteps_total": 7183200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7183200, "timers": {"training_iteration_time_ms": 40670.197, "sample_time_ms": 39887.293, "load_time_ms": 12.911, "load_throughput": 3401647.361, "learn_time_ms": 769.147, "learn_throughput": 57102.185, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 7183200, "num_env_steps_trained": 7183200, "num_agent_steps_sampled": 7183200, "num_agent_steps_trained": 7183200}, "done": false, "episodes_total": 7616, "training_iteration": 1793, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-17-50", "timestamp": 1691299070, "time_this_iter_s": 42.19670796394348, "time_total_s": 24944.3181142807, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2664.702418088913, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 17.623333333333335, "ram_util_percent": 71.35999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.124999999999998e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.02619337966075, "policy_loss": -2045490.920912673, "vf_loss": 4440034.064413265}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 46991.5, "diff_num_grad_updates_vs_sampler_policy": 46990.5}}, "num_env_steps_sampled": 7227120, "num_env_steps_trained": 7227120, "num_agent_steps_sampled": 7227120, "num_agent_steps_trained": 7227120}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -155044.38190191443, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1331719050149874, "mean_inference_ms": 0.227516676774782, "mean_action_processing_ms": 0.05564365358818092, "mean_env_wait_ms": 0.4437459796595298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025393306345179462, "StateBufferConnector_ms": 0.0018368596615998642, "ViewRequirementAgentConnector_ms": 0.044366587763247284}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -155044.38190191443, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1331719050149874, "mean_inference_ms": 0.227516676774782, "mean_action_processing_ms": 0.05564365358818092, "mean_env_wait_ms": 0.4437459796595298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025393306345179462, "StateBufferConnector_ms": 0.0018368596615998642, "ViewRequirementAgentConnector_ms": 0.044366587763247284}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7227120, "num_agent_steps_trained": 7227120, "num_env_steps_sampled": 7227120, "num_env_steps_trained": 7227120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1045.0625897551017, "num_env_steps_trained_throughput_per_sec": 1045.0625897551017, "timesteps_total": 7227120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7227120, "timers": {"training_iteration_time_ms": 40971.64, "sample_time_ms": 40177.893, "load_time_ms": 13.131, "load_throughput": 3344684.161, "learn_time_ms": 779.771, "learn_throughput": 56324.196, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 7227120, "num_env_steps_trained": 7227120, "num_agent_steps_sampled": 7227120, "num_agent_steps_trained": 7227120}, "done": false, "episodes_total": 7617, "training_iteration": 1794, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-18-32", "timestamp": 1691299112, "time_this_iter_s": 42.02843713760376, "time_total_s": 24986.346551418304, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2706.7308552265167, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 17.555932203389833, "ram_util_percent": 71.33050847457628}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.500000000000002e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0637982426857, "policy_loss": -2199122.217871663, "vf_loss": 4454050.514486152}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 47677.5, "diff_num_grad_updates_vs_sampler_policy": 47676.5}}, "num_env_steps_sampled": 7271040, "num_env_steps_trained": 7271040, "num_agent_steps_sampled": 7271040, "num_agent_steps_trained": 7271040}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -155040.73001483222, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13319161744046687, "mean_inference_ms": 0.22754297824770464, "mean_action_processing_ms": 0.05565074506968283, "mean_env_wait_ms": 0.4437536415142834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025320053100585938, "StateBufferConnector_ms": 0.0018361636570521764, "ViewRequirementAgentConnector_ms": 0.0443683351789202}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -155040.73001483222, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13319161744046687, "mean_inference_ms": 0.22754297824770464, "mean_action_processing_ms": 0.05565074506968283, "mean_env_wait_ms": 0.4437536415142834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025320053100585938, "StateBufferConnector_ms": 0.0018361636570521764, "ViewRequirementAgentConnector_ms": 0.0443683351789202}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7271040, "num_agent_steps_trained": 7271040, "num_env_steps_sampled": 7271040, "num_env_steps_trained": 7271040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1071.3320800697209, "num_env_steps_trained_throughput_per_sec": 1071.3320800697209, "timesteps_total": 7271040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7271040, "timers": {"training_iteration_time_ms": 41172.275, "sample_time_ms": 40374.549, "load_time_ms": 13.116, "load_throughput": 3348611.788, "learn_time_ms": 783.762, "learn_throughput": 56037.416, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 7271040, "num_env_steps_trained": 7271040, "num_agent_steps_sampled": 7271040, "num_agent_steps_trained": 7271040}, "done": false, "episodes_total": 7618, "training_iteration": 1795, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-19-13", "timestamp": 1691299153, "time_this_iter_s": 40.99829292297363, "time_total_s": 25027.344844341278, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2747.7291481494904, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 19.91379310344828, "ram_util_percent": 71.3051724137931}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.875000000000001e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9408256597491, "policy_loss": -2234113.101766069, "vf_loss": 4568990.558946793}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 48363.5, "diff_num_grad_updates_vs_sampler_policy": 48362.5}}, "num_env_steps_sampled": 7314960, "num_env_steps_trained": 7314960, "num_agent_steps_sampled": 7314960, "num_agent_steps_trained": 7314960}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -155061.95631429326, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13321036080345702, "mean_inference_ms": 0.22756818754109787, "mean_action_processing_ms": 0.05565759595315279, "mean_env_wait_ms": 0.4437608917363836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025265653368452905, "StateBufferConnector_ms": 0.0018364946607133032, "ViewRequirementAgentConnector_ms": 0.04437238397732587}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -155061.95631429326, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13321036080345702, "mean_inference_ms": 0.22756818754109787, "mean_action_processing_ms": 0.05565759595315279, "mean_env_wait_ms": 0.4437608917363836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025265653368452905, "StateBufferConnector_ms": 0.0018364946607133032, "ViewRequirementAgentConnector_ms": 0.04437238397732587}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7314960, "num_agent_steps_trained": 7314960, "num_env_steps_sampled": 7314960, "num_env_steps_trained": 7314960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1124.2492777606928, "num_env_steps_trained_throughput_per_sec": 1124.2492777606928, "timesteps_total": 7314960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7314960, "timers": {"training_iteration_time_ms": 41177.559, "sample_time_ms": 40374.629, "load_time_ms": 13.263, "load_throughput": 3311346.202, "learn_time_ms": 788.8, "learn_throughput": 55679.518, "synch_weights_time_ms": 0.744}, "counters": {"num_env_steps_sampled": 7314960, "num_env_steps_trained": 7314960, "num_agent_steps_sampled": 7314960, "num_agent_steps_trained": 7314960}, "done": false, "episodes_total": 7619, "training_iteration": 1796, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-19-52", "timestamp": 1691299192, "time_this_iter_s": 39.068215131759644, "time_total_s": 25066.413059473038, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2786.79736328125, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 17.094642857142855, "ram_util_percent": 71.35892857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.2499999999999994e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9478304226266, "policy_loss": -2257628.3301549973, "vf_loss": 4411353.378826531}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 49049.5, "diff_num_grad_updates_vs_sampler_policy": 49048.5}}, "num_env_steps_sampled": 7358880, "num_env_steps_trained": 7358880, "num_agent_steps_sampled": 7358880, "num_agent_steps_trained": 7358880}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -155054.8989282983, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1332282850132251, "mean_inference_ms": 0.22759264360702533, "mean_action_processing_ms": 0.055664164868164466, "mean_env_wait_ms": 0.44376849026263643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002522932158576118, "StateBufferConnector_ms": 0.0018371476067437066, "ViewRequirementAgentConnector_ms": 0.04436506165398492}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -155054.8989282983, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1332282850132251, "mean_inference_ms": 0.22759264360702533, "mean_action_processing_ms": 0.055664164868164466, "mean_env_wait_ms": 0.44376849026263643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002522932158576118, "StateBufferConnector_ms": 0.0018371476067437066, "ViewRequirementAgentConnector_ms": 0.04436506165398492}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7358880, "num_agent_steps_trained": 7358880, "num_env_steps_sampled": 7358880, "num_env_steps_trained": 7358880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1118.871455659204, "num_env_steps_trained_throughput_per_sec": 1118.871455659204, "timesteps_total": 7358880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7358880, "timers": {"training_iteration_time_ms": 41217.112, "sample_time_ms": 40414.349, "load_time_ms": 13.255, "load_throughput": 3313544.069, "learn_time_ms": 788.648, "learn_throughput": 55690.232, "synch_weights_time_ms": 0.74}, "counters": {"num_env_steps_sampled": 7358880, "num_env_steps_trained": 7358880, "num_agent_steps_sampled": 7358880, "num_agent_steps_trained": 7358880}, "done": false, "episodes_total": 7620, "training_iteration": 1797, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-20-31", "timestamp": 1691299231, "time_this_iter_s": 39.255918979644775, "time_total_s": 25105.668978452682, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2826.053282260895, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 17.407272727272726, "ram_util_percent": 71.36363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.625e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0251043113953, "policy_loss": -2133392.543879829, "vf_loss": 4450573.004919825}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 49735.5, "diff_num_grad_updates_vs_sampler_policy": 49734.5}}, "num_env_steps_sampled": 7402800, "num_env_steps_trained": 7402800, "num_agent_steps_sampled": 7402800, "num_agent_steps_trained": 7402800}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -155056.9964307925, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13324537412288634, "mean_inference_ms": 0.22761603234529953, "mean_action_processing_ms": 0.05567046061906788, "mean_env_wait_ms": 0.44377574107168183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025187453178510274, "StateBufferConnector_ms": 0.001836149659875321, "ViewRequirementAgentConnector_ms": 0.04434552911209733}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -155056.9964307925, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13324537412288634, "mean_inference_ms": 0.22761603234529953, "mean_action_processing_ms": 0.05567046061906788, "mean_env_wait_ms": 0.44377574107168183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025187453178510274, "StateBufferConnector_ms": 0.001836149659875321, "ViewRequirementAgentConnector_ms": 0.04434552911209733}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7402800, "num_agent_steps_trained": 7402800, "num_env_steps_sampled": 7402800, "num_env_steps_trained": 7402800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1126.007204474688, "num_env_steps_trained_throughput_per_sec": 1126.007204474688, "timesteps_total": 7402800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7402800, "timers": {"training_iteration_time_ms": 41217.439, "sample_time_ms": 40414.391, "load_time_ms": 13.257, "load_throughput": 3312900.489, "learn_time_ms": 788.924, "learn_throughput": 55670.736, "synch_weights_time_ms": 0.745}, "counters": {"num_env_steps_sampled": 7402800, "num_env_steps_trained": 7402800, "num_agent_steps_sampled": 7402800, "num_agent_steps_trained": 7402800}, "done": false, "episodes_total": 7621, "training_iteration": 1798, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-21-10", "timestamp": 1691299270, "time_this_iter_s": 39.00717377662659, "time_total_s": 25144.67615222931, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2865.0604560375214, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 17.883636363636366, "ram_util_percent": 71.34545454545456}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.10411894773256, "policy_loss": -1966235.1551339286, "vf_loss": 4303119.724854227}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 50421.5, "diff_num_grad_updates_vs_sampler_policy": 50420.5}}, "num_env_steps_sampled": 7446720, "num_env_steps_trained": 7446720, "num_agent_steps_sampled": 7446720, "num_agent_steps_trained": 7446720}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -155024.16040226872, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13326158247664233, "mean_inference_ms": 0.2276383982308405, "mean_action_processing_ms": 0.05567649307113688, "mean_env_wait_ms": 0.4437833104202533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025117719495618665, "StateBufferConnector_ms": 0.0018345343100058067, "ViewRequirementAgentConnector_ms": 0.04433908978024045}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -155024.16040226872, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13326158247664233, "mean_inference_ms": 0.2276383982308405, "mean_action_processing_ms": 0.05567649307113688, "mean_env_wait_ms": 0.4437833104202533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025117719495618665, "StateBufferConnector_ms": 0.0018345343100058067, "ViewRequirementAgentConnector_ms": 0.04433908978024045}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7446720, "num_agent_steps_trained": 7446720, "num_env_steps_sampled": 7446720, "num_env_steps_trained": 7446720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1122.2888216034587, "num_env_steps_trained_throughput_per_sec": 1122.2888216034587, "timesteps_total": 7446720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7446720, "timers": {"training_iteration_time_ms": 41022.828, "sample_time_ms": 40231.148, "load_time_ms": 13.144, "load_throughput": 3341377.765, "learn_time_ms": 777.679, "learn_throughput": 56475.734, "synch_weights_time_ms": 0.738}, "counters": {"num_env_steps_sampled": 7446720, "num_env_steps_trained": 7446720, "num_agent_steps_sampled": 7446720, "num_agent_steps_trained": 7446720}, "done": false, "episodes_total": 7622, "training_iteration": 1799, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-21-49", "timestamp": 1691299309, "time_this_iter_s": 39.13701295852661, "time_total_s": 25183.813165187836, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2904.197468996048, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 18.089285714285715, "ram_util_percent": 71.36964285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.8620264259094, "policy_loss": -2202518.4971158663, "vf_loss": 4551715.967110058}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 51107.5, "diff_num_grad_updates_vs_sampler_policy": 51106.5}}, "num_env_steps_sampled": 7490640, "num_env_steps_trained": 7490640, "num_agent_steps_sampled": 7490640, "num_agent_steps_trained": 7490640}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -155041.78487738667, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13327707678900527, "mean_inference_ms": 0.2276599347854624, "mean_action_processing_ms": 0.05568232502062321, "mean_env_wait_ms": 0.44378989168111777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025065739949544272, "StateBufferConnector_ms": 0.0018364588419596355, "ViewRequirementAgentConnector_ms": 0.044310569763183594}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -155041.78487738667, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13327707678900527, "mean_inference_ms": 0.2276599347854624, "mean_action_processing_ms": 0.05568232502062321, "mean_env_wait_ms": 0.44378989168111777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025065739949544272, "StateBufferConnector_ms": 0.0018364588419596355, "ViewRequirementAgentConnector_ms": 0.044310569763183594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7490640, "num_agent_steps_trained": 7490640, "num_env_steps_sampled": 7490640, "num_env_steps_trained": 7490640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1128.9245094549367, "num_env_steps_trained_throughput_per_sec": 1128.9245094549367, "timesteps_total": 7490640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7490640, "timers": {"training_iteration_time_ms": 40608.777, "sample_time_ms": 39831.103, "load_time_ms": 13.007, "load_throughput": 3376594.582, "learn_time_ms": 763.814, "learn_throughput": 57500.925, "synch_weights_time_ms": 0.735}, "counters": {"num_env_steps_sampled": 7490640, "num_env_steps_trained": 7490640, "num_agent_steps_sampled": 7490640, "num_agent_steps_trained": 7490640}, "done": false, "episodes_total": 7623, "training_iteration": 1800, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-22-28", "timestamp": 1691299348, "time_this_iter_s": 38.90642189979553, "time_total_s": 25222.71958708763, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2943.1038908958435, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 17.53272727272727, "ram_util_percent": 71.3618181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9794212763928, "policy_loss": -2124203.3364813, "vf_loss": 4328975.099945336}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 51793.5, "diff_num_grad_updates_vs_sampler_policy": 51792.5}}, "num_env_steps_sampled": 7534560, "num_env_steps_trained": 7534560, "num_agent_steps_sampled": 7534560, "num_agent_steps_trained": 7534560}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -155020.84488425133, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13329199348090648, "mean_inference_ms": 0.2276804939538268, "mean_action_processing_ms": 0.05568790442573192, "mean_env_wait_ms": 0.4437960148500947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025033950805664062, "StateBufferConnector_ms": 0.0018408423975894326, "ViewRequirementAgentConnector_ms": 0.044301936500950864}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -155020.84488425133, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13329199348090648, "mean_inference_ms": 0.2276804939538268, "mean_action_processing_ms": 0.05568790442573192, "mean_env_wait_ms": 0.4437960148500947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025033950805664062, "StateBufferConnector_ms": 0.0018408423975894326, "ViewRequirementAgentConnector_ms": 0.044301936500950864}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7534560, "num_agent_steps_trained": 7534560, "num_env_steps_sampled": 7534560, "num_env_steps_trained": 7534560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1126.6094340266413, "num_env_steps_trained_throughput_per_sec": 1126.6094340266413, "timesteps_total": 7534560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7534560, "timers": {"training_iteration_time_ms": 40206.923, "sample_time_ms": 39439.833, "load_time_ms": 13.019, "load_throughput": 3373484.274, "learn_time_ms": 753.234, "learn_throughput": 58308.571, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 7534560, "num_env_steps_trained": 7534560, "num_agent_steps_sampled": 7534560, "num_agent_steps_trained": 7534560}, "done": false, "episodes_total": 7624, "training_iteration": 1801, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-23-07", "timestamp": 1691299387, "time_this_iter_s": 38.986477851867676, "time_total_s": 25261.7060649395, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2982.090368747711, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 17.903636363636362, "ram_util_percent": 71.38363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0503232638968, "policy_loss": -1954117.1112370172, "vf_loss": 4299012.840561224}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 52479.5, "diff_num_grad_updates_vs_sampler_policy": 52478.5}}, "num_env_steps_sampled": 7578480, "num_env_steps_trained": 7578480, "num_agent_steps_sampled": 7578480, "num_agent_steps_trained": 7578480}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154995.77376368432, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13330621938331377, "mean_inference_ms": 0.22770047112090333, "mean_action_processing_ms": 0.05569325223922231, "mean_env_wait_ms": 0.44380124983243346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024990601973100142, "StateBufferConnector_ms": 0.0018376808661919135, "ViewRequirementAgentConnector_ms": 0.04431303445394937}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154995.77376368432, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13330621938331377, "mean_inference_ms": 0.22770047112090333, "mean_action_processing_ms": 0.05569325223922231, "mean_env_wait_ms": 0.44380124983243346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024990601973100142, "StateBufferConnector_ms": 0.0018376808661919135, "ViewRequirementAgentConnector_ms": 0.04431303445394937}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7578480, "num_agent_steps_trained": 7578480, "num_env_steps_sampled": 7578480, "num_env_steps_trained": 7578480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1128.6200492053647, "num_env_steps_trained_throughput_per_sec": 1128.6200492053647, "timesteps_total": 7578480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7578480, "timers": {"training_iteration_time_ms": 39847.872, "sample_time_ms": 39090.959, "load_time_ms": 12.89, "load_throughput": 3407221.8, "learn_time_ms": 743.208, "learn_throughput": 59095.133, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 7578480, "num_env_steps_trained": 7578480, "num_agent_steps_sampled": 7578480, "num_agent_steps_trained": 7578480}, "done": false, "episodes_total": 7625, "training_iteration": 1802, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-23-46", "timestamp": 1691299426, "time_this_iter_s": 38.917232275009155, "time_total_s": 25300.623297214508, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3021.0076010227203, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 17.618181818181817, "ram_util_percent": 71.39454545454547}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0596264096808, "policy_loss": -2056095.6443490342, "vf_loss": 4483377.007926385}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 53165.5, "diff_num_grad_updates_vs_sampler_policy": 53164.5}}, "num_env_steps_sampled": 7622400, "num_env_steps_trained": 7622400, "num_agent_steps_sampled": 7622400, "num_agent_steps_trained": 7622400}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154998.30446439114, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13331984020409868, "mean_inference_ms": 0.22771952587792568, "mean_action_processing_ms": 0.05569835653772034, "mean_env_wait_ms": 0.4438052267284459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002494225135216346, "StateBufferConnector_ms": 0.0018364343887720353, "ViewRequirementAgentConnector_ms": 0.0442969493376903}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154998.30446439114, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13331984020409868, "mean_inference_ms": 0.22771952587792568, "mean_action_processing_ms": 0.05569835653772034, "mean_env_wait_ms": 0.4438052267284459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002494225135216346, "StateBufferConnector_ms": 0.0018364343887720353, "ViewRequirementAgentConnector_ms": 0.0442969493376903}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7622400, "num_agent_steps_trained": 7622400, "num_env_steps_sampled": 7622400, "num_env_steps_trained": 7622400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1134.0859307004491, "num_env_steps_trained_throughput_per_sec": 1134.0859307004491, "timesteps_total": 7622400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7622400, "timers": {"training_iteration_time_ms": 39501.154, "sample_time_ms": 38752.914, "load_time_ms": 12.828, "load_throughput": 3423667.094, "learn_time_ms": 734.597, "learn_throughput": 59787.898, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 7622400, "num_env_steps_trained": 7622400, "num_agent_steps_sampled": 7622400, "num_agent_steps_trained": 7622400}, "done": false, "episodes_total": 7626, "training_iteration": 1803, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-24-25", "timestamp": 1691299465, "time_this_iter_s": 38.729448080062866, "time_total_s": 25339.35274529457, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3059.737049102783, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 19.249090909090913, "ram_util_percent": 71.3690909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.21601796497754, "policy_loss": -1963782.8796949026, "vf_loss": 4586398.932124635}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 53851.5, "diff_num_grad_updates_vs_sampler_policy": 53850.5}}, "num_env_steps_sampled": 7666320, "num_env_steps_trained": 7666320, "num_agent_steps_sampled": 7666320, "num_agent_steps_trained": 7666320}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -155019.2977526511, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13333269645879925, "mean_inference_ms": 0.22773765870551588, "mean_action_processing_ms": 0.055703248896094223, "mean_env_wait_ms": 0.4438073851199394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024898142754277096, "StateBufferConnector_ms": 0.0018337104893937895, "ViewRequirementAgentConnector_ms": 0.04427251936514166}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -155019.2977526511, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13333269645879925, "mean_inference_ms": 0.22773765870551588, "mean_action_processing_ms": 0.055703248896094223, "mean_env_wait_ms": 0.4438073851199394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024898142754277096, "StateBufferConnector_ms": 0.0018337104893937895, "ViewRequirementAgentConnector_ms": 0.04427251936514166}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7666320, "num_agent_steps_trained": 7666320, "num_env_steps_sampled": 7666320, "num_env_steps_trained": 7666320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1141.2018834215746, "num_env_steps_trained_throughput_per_sec": 1141.2018834215746, "timesteps_total": 7666320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7666320, "timers": {"training_iteration_time_ms": 39147.109, "sample_time_ms": 38409.589, "load_time_ms": 12.562, "load_throughput": 3496387.749, "learn_time_ms": 724.132, "learn_throughput": 60651.89, "synch_weights_time_ms": 0.711}, "counters": {"num_env_steps_sampled": 7666320, "num_env_steps_trained": 7666320, "num_agent_steps_sampled": 7666320, "num_agent_steps_trained": 7666320}, "done": false, "episodes_total": 7627, "training_iteration": 1804, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-25-03", "timestamp": 1691299503, "time_this_iter_s": 38.48816275596619, "time_total_s": 25377.840908050537, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3098.2252118587494, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 18.35185185185185, "ram_util_percent": 71.35000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.1089844550753, "policy_loss": -1847708.921991732, "vf_loss": 4395943.585459184}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 54537.5, "diff_num_grad_updates_vs_sampler_policy": 54536.5}}, "num_env_steps_sampled": 7710240, "num_env_steps_trained": 7710240, "num_agent_steps_sampled": 7710240, "num_agent_steps_trained": 7710240}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -155012.07764835545, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13334500992104878, "mean_inference_ms": 0.22775493086280632, "mean_action_processing_ms": 0.05570793456275186, "mean_env_wait_ms": 0.4438093203341353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024881958961486816, "StateBufferConnector_ms": 0.0018334388732910156, "ViewRequirementAgentConnector_ms": 0.044296979904174805}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -155012.07764835545, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13334500992104878, "mean_inference_ms": 0.22775493086280632, "mean_action_processing_ms": 0.05570793456275186, "mean_env_wait_ms": 0.4438093203341353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024881958961486816, "StateBufferConnector_ms": 0.0018334388732910156, "ViewRequirementAgentConnector_ms": 0.044296979904174805}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7710240, "num_agent_steps_trained": 7710240, "num_env_steps_sampled": 7710240, "num_env_steps_trained": 7710240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1127.5263334752124, "num_env_steps_trained_throughput_per_sec": 1127.5263334752124, "timesteps_total": 7710240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7710240, "timers": {"training_iteration_time_ms": 38942.793, "sample_time_ms": 38211.001, "load_time_ms": 12.479, "load_throughput": 3519588.069, "learn_time_ms": 718.487, "learn_throughput": 61128.422, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 7710240, "num_env_steps_trained": 7710240, "num_agent_steps_sampled": 7710240, "num_agent_steps_trained": 7710240}, "done": false, "episodes_total": 7628, "training_iteration": 1805, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-25-42", "timestamp": 1691299542, "time_this_iter_s": 38.954633951187134, "time_total_s": 25416.795542001724, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3137.1798458099365, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 17.167272727272728, "ram_util_percent": 71.35272727272728}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.96206318046194, "policy_loss": -1986293.5836256377, "vf_loss": 4323925.411260933}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 55223.5, "diff_num_grad_updates_vs_sampler_policy": 55222.5}}, "num_env_steps_sampled": 7754160, "num_env_steps_trained": 7754160, "num_agent_steps_sampled": 7754160, "num_agent_steps_trained": 7754160}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154990.41724092892, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1333568129380629, "mean_inference_ms": 0.22777148988686932, "mean_action_processing_ms": 0.055712443674740625, "mean_env_wait_ms": 0.44381069274843166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025549052674093365, "StateBufferConnector_ms": 0.0018346456833827642, "ViewRequirementAgentConnector_ms": 0.04425284303264854}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154990.41724092892, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1333568129380629, "mean_inference_ms": 0.22777148988686932, "mean_action_processing_ms": 0.055712443674740625, "mean_env_wait_ms": 0.44381069274843166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025549052674093365, "StateBufferConnector_ms": 0.0018346456833827642, "ViewRequirementAgentConnector_ms": 0.04425284303264854}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7754160, "num_agent_steps_trained": 7754160, "num_env_steps_sampled": 7754160, "num_env_steps_trained": 7754160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1129.5515704864301, "num_env_steps_trained_throughput_per_sec": 1129.5515704864301, "timesteps_total": 7754160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7754160, "timers": {"training_iteration_time_ms": 38924.455, "sample_time_ms": 38198.645, "load_time_ms": 12.4, "load_throughput": 3541838.074, "learn_time_ms": 712.597, "learn_throughput": 61633.697, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 7754160, "num_env_steps_trained": 7754160, "num_agent_steps_sampled": 7754160, "num_agent_steps_trained": 7754160}, "done": false, "episodes_total": 7629, "training_iteration": 1806, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-26-21", "timestamp": 1691299581, "time_this_iter_s": 38.8849401473999, "time_total_s": 25455.680482149124, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3176.0647859573364, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 17.541071428571428, "ram_util_percent": 71.39107142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.90885467084433, "policy_loss": -1912029.8403533846, "vf_loss": 4144812.819150875}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 55909.5, "diff_num_grad_updates_vs_sampler_policy": 55908.5}}, "num_env_steps_sampled": 7798080, "num_env_steps_trained": 7798080, "num_agent_steps_sampled": 7798080, "num_agent_steps_trained": 7798080}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154940.41669890564, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13336811884241215, "mean_inference_ms": 0.22778739839121312, "mean_action_processing_ms": 0.05571677654131482, "mean_env_wait_ms": 0.44381186341409506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025539863400342987, "StateBufferConnector_ms": 0.0018332062697992092, "ViewRequirementAgentConnector_ms": 0.04424234715903678}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154940.41669890564, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13336811884241215, "mean_inference_ms": 0.22778739839121312, "mean_action_processing_ms": 0.05571677654131482, "mean_env_wait_ms": 0.44381186341409506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025539863400342987, "StateBufferConnector_ms": 0.0018332062697992092, "ViewRequirementAgentConnector_ms": 0.04424234715903678}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7798080, "num_agent_steps_trained": 7798080, "num_env_steps_sampled": 7798080, "num_env_steps_trained": 7798080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1126.2773609746941, "num_env_steps_trained_throughput_per_sec": 1126.2773609746941, "timesteps_total": 7798080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7798080, "timers": {"training_iteration_time_ms": 38898.643, "sample_time_ms": 38172.579, "load_time_ms": 12.436, "load_throughput": 3531618.876, "learn_time_ms": 712.803, "learn_throughput": 61615.879, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 7798080, "num_env_steps_trained": 7798080, "num_agent_steps_sampled": 7798080, "num_agent_steps_trained": 7798080}, "done": false, "episodes_total": 7630, "training_iteration": 1807, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-27-00", "timestamp": 1691299620, "time_this_iter_s": 38.99817609786987, "time_total_s": 25494.678658246994, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3215.0629620552063, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 17.578181818181815, "ram_util_percent": 71.37818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0516100736123, "policy_loss": -2235182.7416522414, "vf_loss": 4634409.705812682}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 56595.5, "diff_num_grad_updates_vs_sampler_policy": 56594.5}}, "num_env_steps_sampled": 7842000, "num_env_steps_trained": 7842000, "num_agent_steps_sampled": 7842000, "num_agent_steps_trained": 7842000}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154971.82690066466, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13337894773211362, "mean_inference_ms": 0.22780262424324121, "mean_action_processing_ms": 0.05572093539110728, "mean_env_wait_ms": 0.44381250614117734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025467700268848835, "StateBufferConnector_ms": 0.001830939786979951, "ViewRequirementAgentConnector_ms": 0.04422578466943947}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154971.82690066466, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13337894773211362, "mean_inference_ms": 0.22780262424324121, "mean_action_processing_ms": 0.05572093539110728, "mean_env_wait_ms": 0.44381250614117734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025467700268848835, "StateBufferConnector_ms": 0.001830939786979951, "ViewRequirementAgentConnector_ms": 0.04422578466943947}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7842000, "num_agent_steps_trained": 7842000, "num_env_steps_sampled": 7842000, "num_env_steps_trained": 7842000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1130.2182909776259, "num_env_steps_trained_throughput_per_sec": 1130.2182909776259, "timesteps_total": 7842000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7842000, "timers": {"training_iteration_time_ms": 38884.11, "sample_time_ms": 38158.893, "load_time_ms": 12.413, "load_throughput": 3538218.955, "learn_time_ms": 711.981, "learn_throughput": 61687.043, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 7842000, "num_env_steps_trained": 7842000, "num_agent_steps_sampled": 7842000, "num_agent_steps_trained": 7842000}, "done": false, "episodes_total": 7631, "training_iteration": 1808, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-27-39", "timestamp": 1691299659, "time_this_iter_s": 38.86223888397217, "time_total_s": 25533.540897130966, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3253.9252009391785, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 18.71090909090909, "ram_util_percent": 71.31636363636365}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.10473330305894, "policy_loss": -2116392.6766154566, "vf_loss": 4419400.124453353}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 57281.5, "diff_num_grad_updates_vs_sampler_policy": 57280.5}}, "num_env_steps_sampled": 7885920, "num_env_steps_trained": 7885920, "num_agent_steps_sampled": 7885920, "num_agent_steps_trained": 7885920}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154965.35163427834, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1333894453334798, "mean_inference_ms": 0.2278171594878978, "mean_action_processing_ms": 0.05572490983788593, "mean_env_wait_ms": 0.4438125487080638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025425638471330914, "StateBufferConnector_ms": 0.0018295787629627046, "ViewRequirementAgentConnector_ms": 0.044216428484235494}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154965.35163427834, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1333894453334798, "mean_inference_ms": 0.2278171594878978, "mean_action_processing_ms": 0.05572490983788593, "mean_env_wait_ms": 0.4438125487080638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025425638471330914, "StateBufferConnector_ms": 0.0018295787629627046, "ViewRequirementAgentConnector_ms": 0.044216428484235494}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7885920, "num_agent_steps_trained": 7885920, "num_env_steps_sampled": 7885920, "num_env_steps_trained": 7885920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1130.6246620118789, "num_env_steps_trained_throughput_per_sec": 1130.6246620118789, "timesteps_total": 7885920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7885920, "timers": {"training_iteration_time_ms": 38855.258, "sample_time_ms": 38130.541, "load_time_ms": 12.381, "load_throughput": 3547424.106, "learn_time_ms": 711.516, "learn_throughput": 61727.375, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 7885920, "num_env_steps_trained": 7885920, "num_agent_steps_sampled": 7885920, "num_agent_steps_trained": 7885920}, "done": false, "episodes_total": 7632, "training_iteration": 1809, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-28-18", "timestamp": 1691299698, "time_this_iter_s": 38.847980976104736, "time_total_s": 25572.38887810707, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3292.773181915283, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 17.774545454545454, "ram_util_percent": 71.32545454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.047260562463, "policy_loss": -2058928.4318968658, "vf_loss": 4393289.629828718}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 57967.5, "diff_num_grad_updates_vs_sampler_policy": 57966.5}}, "num_env_steps_sampled": 7929840, "num_env_steps_trained": 7929840, "num_agent_steps_sampled": 7929840, "num_agent_steps_trained": 7929840}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154956.84869703327, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13339969149462982, "mean_inference_ms": 0.2278313122517306, "mean_action_processing_ms": 0.05572873184965637, "mean_env_wait_ms": 0.443812304060273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025392981136546414, "StateBufferConnector_ms": 0.0018296522252699908, "ViewRequirementAgentConnector_ms": 0.044191865360035616}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154956.84869703327, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13339969149462982, "mean_inference_ms": 0.2278313122517306, "mean_action_processing_ms": 0.05572873184965637, "mean_env_wait_ms": 0.443812304060273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025392981136546414, "StateBufferConnector_ms": 0.0018296522252699908, "ViewRequirementAgentConnector_ms": 0.044191865360035616}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7929840, "num_agent_steps_trained": 7929840, "num_env_steps_sampled": 7929840, "num_env_steps_trained": 7929840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1124.7694841713924, "num_env_steps_trained_throughput_per_sec": 1124.7694841713924, "timesteps_total": 7929840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7929840, "timers": {"training_iteration_time_ms": 38869.63, "sample_time_ms": 38146.517, "load_time_ms": 12.372, "load_throughput": 3549830.359, "learn_time_ms": 709.92, "learn_throughput": 61866.138, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 7929840, "num_env_steps_trained": 7929840, "num_agent_steps_sampled": 7929840, "num_agent_steps_trained": 7929840}, "done": false, "episodes_total": 7633, "training_iteration": 1810, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-28-57", "timestamp": 1691299737, "time_this_iter_s": 39.050220012664795, "time_total_s": 25611.439098119736, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3331.823401927948, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 17.258181818181818, "ram_util_percent": 71.38363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.8749015074082, "policy_loss": -1947531.2438388302, "vf_loss": 4497868.655976676}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 58653.5, "diff_num_grad_updates_vs_sampler_policy": 58652.5}}, "num_env_steps_sampled": 7973760, "num_env_steps_trained": 7973760, "num_agent_steps_sampled": 7973760, "num_agent_steps_trained": 7973760}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154966.25941662074, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13340944885363382, "mean_inference_ms": 0.22784523469180717, "mean_action_processing_ms": 0.05573240160251531, "mean_env_wait_ms": 0.4438119211759479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025599501853765445, "StateBufferConnector_ms": 0.0018338824427405068, "ViewRequirementAgentConnector_ms": 0.04418007163114326}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154966.25941662074, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13340944885363382, "mean_inference_ms": 0.22784523469180717, "mean_action_processing_ms": 0.05573240160251531, "mean_env_wait_ms": 0.4438119211759479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025599501853765445, "StateBufferConnector_ms": 0.0018338824427405068, "ViewRequirementAgentConnector_ms": 0.04418007163114326}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7973760, "num_agent_steps_trained": 7973760, "num_env_steps_sampled": 7973760, "num_env_steps_trained": 7973760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1122.7706230803024, "num_env_steps_trained_throughput_per_sec": 1122.7706230803024, "timesteps_total": 7973760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7973760, "timers": {"training_iteration_time_ms": 38882.959, "sample_time_ms": 38155.681, "load_time_ms": 12.395, "load_throughput": 3543302.789, "learn_time_ms": 714.054, "learn_throughput": 61507.913, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 7973760, "num_env_steps_trained": 7973760, "num_agent_steps_sampled": 7973760, "num_agent_steps_trained": 7973760}, "done": false, "episodes_total": 7634, "training_iteration": 1811, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-29-36", "timestamp": 1691299776, "time_this_iter_s": 39.12002992630005, "time_total_s": 25650.559128046036, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3370.943431854248, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 17.714545454545455, "ram_util_percent": 71.46545454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0304662854609, "policy_loss": -1944955.7561910646, "vf_loss": 4307985.974216472}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 59339.5, "diff_num_grad_updates_vs_sampler_policy": 59338.5}}, "num_env_steps_sampled": 8017680, "num_env_steps_trained": 8017680, "num_agent_steps_sampled": 8017680, "num_agent_steps_trained": 8017680}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154946.0380300657, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13341881811311965, "mean_inference_ms": 0.2278588056806391, "mean_action_processing_ms": 0.05573593905723529, "mean_env_wait_ms": 0.4438106935623311, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002552997106793283, "StateBufferConnector_ms": 0.0018347268817068517, "ViewRequirementAgentConnector_ms": 0.044189102348239945}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154946.0380300657, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13341881811311965, "mean_inference_ms": 0.2278588056806391, "mean_action_processing_ms": 0.05573593905723529, "mean_env_wait_ms": 0.4438106935623311, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002552997106793283, "StateBufferConnector_ms": 0.0018347268817068517, "ViewRequirementAgentConnector_ms": 0.044189102348239945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8017680, "num_agent_steps_trained": 8017680, "num_env_steps_sampled": 8017680, "num_env_steps_trained": 8017680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1131.5247578161407, "num_env_steps_trained_throughput_per_sec": 1131.5247578161407, "timesteps_total": 8017680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8017680, "timers": {"training_iteration_time_ms": 38872.969, "sample_time_ms": 38145.948, "load_time_ms": 12.484, "load_throughput": 3518035.389, "learn_time_ms": 713.709, "learn_throughput": 61537.696, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 8017680, "num_env_steps_trained": 8017680, "num_agent_steps_sampled": 8017680, "num_agent_steps_trained": 8017680}, "done": false, "episodes_total": 7635, "training_iteration": 1812, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-30-15", "timestamp": 1691299815, "time_this_iter_s": 38.817026138305664, "time_total_s": 25689.37615418434, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3409.7604579925537, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 19.16909090909091, "ram_util_percent": 71.47272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.22755449923415, "policy_loss": -1702352.6655287673, "vf_loss": 4494611.125637755}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 60025.5, "diff_num_grad_updates_vs_sampler_policy": 60024.5}}, "num_env_steps_sampled": 8061600, "num_env_steps_trained": 8061600, "num_agent_steps_sampled": 8061600, "num_agent_steps_trained": 8061600}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154949.6567968327, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13342767399082855, "mean_inference_ms": 0.22787196764603238, "mean_action_processing_ms": 0.055739339626173126, "mean_env_wait_ms": 0.4438087294318464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025505369359796696, "StateBufferConnector_ms": 0.0018341974778608842, "ViewRequirementAgentConnector_ms": 0.044199553402987396}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154949.6567968327, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13342767399082855, "mean_inference_ms": 0.22787196764603238, "mean_action_processing_ms": 0.055739339626173126, "mean_env_wait_ms": 0.4438087294318464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025505369359796696, "StateBufferConnector_ms": 0.0018341974778608842, "ViewRequirementAgentConnector_ms": 0.044199553402987396}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8061600, "num_agent_steps_trained": 8061600, "num_env_steps_sampled": 8061600, "num_env_steps_trained": 8061600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1133.360772386066, "num_env_steps_trained_throughput_per_sec": 1133.360772386066, "timesteps_total": 8061600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8061600, "timers": {"training_iteration_time_ms": 38875.447, "sample_time_ms": 38150.897, "load_time_ms": 12.557, "load_throughput": 3497609.229, "learn_time_ms": 711.173, "learn_throughput": 61757.093, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 8061600, "num_env_steps_trained": 8061600, "num_agent_steps_sampled": 8061600, "num_agent_steps_trained": 8061600}, "done": false, "episodes_total": 7636, "training_iteration": 1813, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-30-54", "timestamp": 1691299854, "time_this_iter_s": 38.75430178642273, "time_total_s": 25728.130455970764, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3448.5147597789764, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 16.6, "ram_util_percent": 71.39818181818183}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9324294554596, "policy_loss": -1908981.3505546192, "vf_loss": 4213580.462463557}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 60711.5, "diff_num_grad_updates_vs_sampler_policy": 60710.5}}, "num_env_steps_sampled": 8105520, "num_env_steps_trained": 8105520, "num_agent_steps_sampled": 8105520, "num_agent_steps_trained": 8105520}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154916.89204348766, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13343605698314204, "mean_inference_ms": 0.22788478620199537, "mean_action_processing_ms": 0.0557426219866808, "mean_env_wait_ms": 0.4438065580206993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002545721075508032, "StateBufferConnector_ms": 0.0018320726544669506, "ViewRequirementAgentConnector_ms": 0.04419851838872674}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154916.89204348766, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13343605698314204, "mean_inference_ms": 0.22788478620199537, "mean_action_processing_ms": 0.0557426219866808, "mean_env_wait_ms": 0.4438065580206993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002545721075508032, "StateBufferConnector_ms": 0.0018320726544669506, "ViewRequirementAgentConnector_ms": 0.04419851838872674}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8105520, "num_agent_steps_trained": 8105520, "num_env_steps_sampled": 8105520, "num_env_steps_trained": 8105520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1127.251038682001, "num_env_steps_trained_throughput_per_sec": 1127.251038682001, "timesteps_total": 8105520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8105520, "timers": {"training_iteration_time_ms": 38923.077, "sample_time_ms": 38198.813, "load_time_ms": 12.579, "load_throughput": 3491464.024, "learn_time_ms": 710.882, "learn_throughput": 61782.425, "synch_weights_time_ms": 0.685}, "counters": {"num_env_steps_sampled": 8105520, "num_env_steps_trained": 8105520, "num_agent_steps_sampled": 8105520, "num_agent_steps_trained": 8105520}, "done": false, "episodes_total": 7637, "training_iteration": 1814, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-31-33", "timestamp": 1691299893, "time_this_iter_s": 38.964173793792725, "time_total_s": 25767.094629764557, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3487.478933572769, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 17.378181818181815, "ram_util_percent": 71.35454545454544}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.1582675411124, "policy_loss": -1816344.7498234785, "vf_loss": 4482499.236880466}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 61397.5, "diff_num_grad_updates_vs_sampler_policy": 61396.5}}, "num_env_steps_sampled": 8149440, "num_env_steps_trained": 8149440, "num_agent_steps_sampled": 8149440, "num_agent_steps_trained": 8149440}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154917.81161418496, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1334440111140987, "mean_inference_ms": 0.22789720403616387, "mean_action_processing_ms": 0.055745778091721446, "mean_env_wait_ms": 0.4438040085335243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002539952596028646, "StateBufferConnector_ms": 0.0018302599589029949, "ViewRequirementAgentConnector_ms": 0.04420704311794705}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154917.81161418496, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1334440111140987, "mean_inference_ms": 0.22789720403616387, "mean_action_processing_ms": 0.055745778091721446, "mean_env_wait_ms": 0.4438040085335243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002539952596028646, "StateBufferConnector_ms": 0.0018302599589029949, "ViewRequirementAgentConnector_ms": 0.04420704311794705}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8149440, "num_agent_steps_trained": 8149440, "num_env_steps_sampled": 8149440, "num_env_steps_trained": 8149440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1130.1546446515492, "num_env_steps_trained_throughput_per_sec": 1130.1546446515492, "timesteps_total": 8149440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8149440, "timers": {"training_iteration_time_ms": 38914.018, "sample_time_ms": 38190.543, "load_time_ms": 12.57, "load_throughput": 3494079.889, "learn_time_ms": 710.114, "learn_throughput": 61849.228, "synch_weights_time_ms": 0.676}, "counters": {"num_env_steps_sampled": 8149440, "num_env_steps_trained": 8149440, "num_agent_steps_sampled": 8149440, "num_agent_steps_trained": 8149440}, "done": false, "episodes_total": 7638, "training_iteration": 1815, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-32-12", "timestamp": 1691299932, "time_this_iter_s": 38.86416220664978, "time_total_s": 25805.958791971207, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3526.343095779419, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 17.725454545454546, "ram_util_percent": 71.34545454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.23011717504386, "policy_loss": -2047188.860360104, "vf_loss": 4621928.355502916}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 62083.5, "diff_num_grad_updates_vs_sampler_policy": 62082.5}}, "num_env_steps_sampled": 8193360, "num_env_steps_trained": 8193360, "num_agent_steps_sampled": 8193360, "num_agent_steps_trained": 8193360}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154944.7337252563, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13345154074296117, "mean_inference_ms": 0.2279092280908753, "mean_action_processing_ms": 0.05574881629230131, "mean_env_wait_ms": 0.44380092718874853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025364068838266227, "StateBufferConnector_ms": 0.0018313690856262878, "ViewRequirementAgentConnector_ms": 0.04420594854669257}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154944.7337252563, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13345154074296117, "mean_inference_ms": 0.2279092280908753, "mean_action_processing_ms": 0.05574881629230131, "mean_env_wait_ms": 0.44380092718874853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025364068838266227, "StateBufferConnector_ms": 0.0018313690856262878, "ViewRequirementAgentConnector_ms": 0.04420594854669257}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8193360, "num_agent_steps_trained": 8193360, "num_env_steps_sampled": 8193360, "num_env_steps_trained": 8193360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1132.031733960808, "num_env_steps_trained_throughput_per_sec": 1132.031733960808, "timesteps_total": 8193360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8193360, "timers": {"training_iteration_time_ms": 38905.499, "sample_time_ms": 38182.004, "load_time_ms": 12.595, "load_throughput": 3487002.93, "learn_time_ms": 710.108, "learn_throughput": 61849.739, "synch_weights_time_ms": 0.677}, "counters": {"num_env_steps_sampled": 8193360, "num_env_steps_trained": 8193360, "num_agent_steps_sampled": 8193360, "num_agent_steps_trained": 8193360}, "done": false, "episodes_total": 7639, "training_iteration": 1816, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-32-51", "timestamp": 1691299971, "time_this_iter_s": 38.79978609085083, "time_total_s": 25844.758578062057, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3565.14288187027, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 17.53454545454546, "ram_util_percent": 71.38909090909092}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9865249322385, "policy_loss": -1942782.4470947979, "vf_loss": 4344017.35914723}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 62769.5, "diff_num_grad_updates_vs_sampler_policy": 62768.5}}, "num_env_steps_sampled": 8237280, "num_env_steps_trained": 8237280, "num_agent_steps_sampled": 8237280, "num_agent_steps_trained": 8237280}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154926.98393383605, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13345866423968075, "mean_inference_ms": 0.22792071657037302, "mean_action_processing_ms": 0.05575175830166998, "mean_env_wait_ms": 0.44379782287195085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002532160800436269, "StateBufferConnector_ms": 0.0018308991971223252, "ViewRequirementAgentConnector_ms": 0.04419192023899244}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154926.98393383605, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13345866423968075, "mean_inference_ms": 0.22792071657037302, "mean_action_processing_ms": 0.05575175830166998, "mean_env_wait_ms": 0.44379782287195085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002532160800436269, "StateBufferConnector_ms": 0.0018308991971223252, "ViewRequirementAgentConnector_ms": 0.04419192023899244}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8237280, "num_agent_steps_trained": 8237280, "num_env_steps_sampled": 8237280, "num_env_steps_trained": 8237280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1128.4155425548406, "num_env_steps_trained_throughput_per_sec": 1128.4155425548406, "timesteps_total": 8237280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8237280, "timers": {"training_iteration_time_ms": 38898.109, "sample_time_ms": 38175.444, "load_time_ms": 12.575, "load_throughput": 3492622.468, "learn_time_ms": 709.301, "learn_throughput": 61920.089, "synch_weights_time_ms": 0.675}, "counters": {"num_env_steps_sampled": 8237280, "num_env_steps_trained": 8237280, "num_agent_steps_sampled": 8237280, "num_agent_steps_trained": 8237280}, "done": false, "episodes_total": 7640, "training_iteration": 1817, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-33-30", "timestamp": 1691300010, "time_this_iter_s": 38.924134969711304, "time_total_s": 25883.68271303177, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3604.067016839981, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 19.34727272727273, "ram_util_percent": 71.34363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.10257745414714, "policy_loss": -1954030.550616117, "vf_loss": 4458086.399781341}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 63455.5, "diff_num_grad_updates_vs_sampler_policy": 63454.5}}, "num_env_steps_sampled": 8281200, "num_env_steps_trained": 8281200, "num_agent_steps_sampled": 8281200, "num_agent_steps_trained": 8281200}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154932.6360553633, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1334653269606301, "mean_inference_ms": 0.2279317836023583, "mean_action_processing_ms": 0.05575459618049434, "mean_env_wait_ms": 0.44379451275727516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025267242103494624, "StateBufferConnector_ms": 0.0018283885012390793, "ViewRequirementAgentConnector_ms": 0.044178706343455984}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154932.6360553633, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1334653269606301, "mean_inference_ms": 0.2279317836023583, "mean_action_processing_ms": 0.05575459618049434, "mean_env_wait_ms": 0.44379451275727516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025267242103494624, "StateBufferConnector_ms": 0.0018283885012390793, "ViewRequirementAgentConnector_ms": 0.044178706343455984}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8281200, "num_agent_steps_trained": 8281200, "num_env_steps_sampled": 8281200, "num_env_steps_trained": 8281200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1130.2685738007476, "num_env_steps_trained_throughput_per_sec": 1130.2685738007476, "timesteps_total": 8281200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8281200, "timers": {"training_iteration_time_ms": 38897.937, "sample_time_ms": 38174.939, "load_time_ms": 12.495, "load_throughput": 3514967.671, "learn_time_ms": 709.71, "learn_throughput": 61884.448, "synch_weights_time_ms": 0.676}, "counters": {"num_env_steps_sampled": 8281200, "num_env_steps_trained": 8281200, "num_agent_steps_sampled": 8281200, "num_agent_steps_trained": 8281200}, "done": false, "episodes_total": 7641, "training_iteration": 1818, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-34-08", "timestamp": 1691300048, "time_this_iter_s": 38.860254764556885, "time_total_s": 25922.542967796326, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3642.927271604538, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 17.90909090909091, "ram_util_percent": 71.34363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.205345887832, "policy_loss": -1851784.3765146683, "vf_loss": 4348553.861516035}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 64141.5, "diff_num_grad_updates_vs_sampler_policy": 64140.5}}, "num_env_steps_sampled": 8325120, "num_env_steps_trained": 8325120, "num_agent_steps_sampled": 8325120, "num_agent_steps_trained": 8325120}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154916.8342498653, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13347156994340023, "mean_inference_ms": 0.22794245470023627, "mean_action_processing_ms": 0.0557573221598879, "mean_env_wait_ms": 0.44379042768121296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025224178395372755, "StateBufferConnector_ms": 0.0018284675922799617, "ViewRequirementAgentConnector_ms": 0.04416551995784678}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154916.8342498653, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13347156994340023, "mean_inference_ms": 0.22794245470023627, "mean_action_processing_ms": 0.0557573221598879, "mean_env_wait_ms": 0.44379042768121296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025224178395372755, "StateBufferConnector_ms": 0.0018284675922799617, "ViewRequirementAgentConnector_ms": 0.04416551995784678}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8325120, "num_agent_steps_trained": 8325120, "num_env_steps_sampled": 8325120, "num_env_steps_trained": 8325120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1136.9524995249012, "num_env_steps_trained_throughput_per_sec": 1136.9524995249012, "timesteps_total": 8325120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8325120, "timers": {"training_iteration_time_ms": 38876.316, "sample_time_ms": 38153.262, "load_time_ms": 12.506, "load_throughput": 3512019.12, "learn_time_ms": 709.746, "learn_throughput": 61881.255, "synch_weights_time_ms": 0.684}, "counters": {"num_env_steps_sampled": 8325120, "num_env_steps_trained": 8325120, "num_agent_steps_sampled": 8325120, "num_agent_steps_trained": 8325120}, "done": false, "episodes_total": 7642, "training_iteration": 1819, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-34-47", "timestamp": 1691300087, "time_this_iter_s": 38.632091999053955, "time_total_s": 25961.17505979538, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3681.559363603592, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 17.78909090909091, "ram_util_percent": 71.36}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.95661316807696, "policy_loss": -1984817.7255432308, "vf_loss": 4370564.830539359}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 64827.5, "diff_num_grad_updates_vs_sampler_policy": 64826.5}}, "num_env_steps_sampled": 8369040, "num_env_steps_trained": 8369040, "num_agent_steps_sampled": 8369040, "num_agent_steps_trained": 8369040}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154904.2975526424, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1334776369758293, "mean_inference_ms": 0.22795278660895194, "mean_action_processing_ms": 0.05575993832044097, "mean_env_wait_ms": 0.4437862901490669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025166963276110196, "StateBufferConnector_ms": 0.001827039216694079, "ViewRequirementAgentConnector_ms": 0.044153113114206416}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154904.2975526424, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1334776369758293, "mean_inference_ms": 0.22795278660895194, "mean_action_processing_ms": 0.05575993832044097, "mean_env_wait_ms": 0.4437862901490669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025166963276110196, "StateBufferConnector_ms": 0.001827039216694079, "ViewRequirementAgentConnector_ms": 0.044153113114206416}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8369040, "num_agent_steps_trained": 8369040, "num_env_steps_sampled": 8369040, "num_env_steps_trained": 8369040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1125.9926339449821, "num_env_steps_trained_throughput_per_sec": 1125.9926339449821, "timesteps_total": 8369040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8369040, "timers": {"training_iteration_time_ms": 38872.075, "sample_time_ms": 38148.818, "load_time_ms": 12.509, "load_throughput": 3511122.134, "learn_time_ms": 709.941, "learn_throughput": 61864.304, "synch_weights_time_ms": 0.689}, "counters": {"num_env_steps_sampled": 8369040, "num_env_steps_trained": 8369040, "num_agent_steps_sampled": 8369040, "num_agent_steps_trained": 8369040}, "done": false, "episodes_total": 7643, "training_iteration": 1820, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-35-26", "timestamp": 1691300126, "time_this_iter_s": 39.00784635543823, "time_total_s": 26000.182906150818, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3720.56720995903, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 18.170909090909092, "ram_util_percent": 71.41272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.06420618174025, "policy_loss": -2069046.834220686, "vf_loss": 4416022.226676385}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 65513.5, "diff_num_grad_updates_vs_sampler_policy": 65512.5}}, "num_env_steps_sampled": 8412960, "num_env_steps_trained": 8412960, "num_agent_steps_sampled": 8412960, "num_agent_steps_trained": 8412960}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154902.8433256684, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13348341602085811, "mean_inference_ms": 0.22796275531857724, "mean_action_processing_ms": 0.055762459267879046, "mean_env_wait_ms": 0.4437818861821102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025153160095214844, "StateBufferConnector_ms": 0.0018263856569925945, "ViewRequirementAgentConnector_ms": 0.04415387908617655}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154902.8433256684, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13348341602085811, "mean_inference_ms": 0.22796275531857724, "mean_action_processing_ms": 0.055762459267879046, "mean_env_wait_ms": 0.4437818861821102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025153160095214844, "StateBufferConnector_ms": 0.0018263856569925945, "ViewRequirementAgentConnector_ms": 0.04415387908617655}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8412960, "num_agent_steps_trained": 8412960, "num_env_steps_sampled": 8412960, "num_env_steps_trained": 8412960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1130.2385533561571, "num_env_steps_trained_throughput_per_sec": 1130.2385533561571, "timesteps_total": 8412960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8412960, "timers": {"training_iteration_time_ms": 38846.228, "sample_time_ms": 38128.674, "load_time_ms": 12.399, "load_throughput": 3542239.898, "learn_time_ms": 704.354, "learn_throughput": 62355.045, "synch_weights_time_ms": 0.686}, "counters": {"num_env_steps_sampled": 8412960, "num_env_steps_trained": 8412960, "num_agent_steps_sampled": 8412960, "num_agent_steps_trained": 8412960}, "done": false, "episodes_total": 7644, "training_iteration": 1821, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-36-05", "timestamp": 1691300165, "time_this_iter_s": 38.86155104637146, "time_total_s": 26039.04445719719, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3759.4287610054016, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 18.69272727272727, "ram_util_percent": 71.37636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9980592421818, "policy_loss": -1992221.4970048286, "vf_loss": 4383622.006559767}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 66199.5, "diff_num_grad_updates_vs_sampler_policy": 66198.5}}, "num_env_steps_sampled": 8456880, "num_env_steps_trained": 8456880, "num_agent_steps_sampled": 8456880, "num_agent_steps_trained": 8456880}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154893.76453992582, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1334890026864393, "mean_inference_ms": 0.22797232861807204, "mean_action_processing_ms": 0.05576488982366156, "mean_env_wait_ms": 0.4437775534210078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025107688510540836, "StateBufferConnector_ms": 0.0018259913650984616, "ViewRequirementAgentConnector_ms": 0.04417601319932446}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154893.76453992582, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1334890026864393, "mean_inference_ms": 0.22797232861807204, "mean_action_processing_ms": 0.05576488982366156, "mean_env_wait_ms": 0.4437775534210078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025107688510540836, "StateBufferConnector_ms": 0.0018259913650984616, "ViewRequirementAgentConnector_ms": 0.04417601319932446}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8456880, "num_agent_steps_trained": 8456880, "num_env_steps_sampled": 8456880, "num_env_steps_trained": 8456880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1125.8333325235521, "num_env_steps_trained_throughput_per_sec": 1125.8333325235521, "timesteps_total": 8456880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8456880, "timers": {"training_iteration_time_ms": 38865.85, "sample_time_ms": 38148.051, "load_time_ms": 12.343, "load_throughput": 3558284.882, "learn_time_ms": 704.645, "learn_throughput": 62329.295, "synch_weights_time_ms": 0.696}, "counters": {"num_env_steps_sampled": 8456880, "num_env_steps_trained": 8456880, "num_agent_steps_sampled": 8456880, "num_agent_steps_trained": 8456880}, "done": false, "episodes_total": 7645, "training_iteration": 1822, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-36-44", "timestamp": 1691300204, "time_this_iter_s": 39.013583183288574, "time_total_s": 26078.058040380478, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3798.44234418869, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 17.992727272727276, "ram_util_percent": 71.36}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.11697111880466, "policy_loss": -2288339.943928799, "vf_loss": 4490780.644405977}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 66885.5, "diff_num_grad_updates_vs_sampler_policy": 66884.5}}, "num_env_steps_sampled": 8500800, "num_env_steps_trained": 8500800, "num_agent_steps_sampled": 8500800, "num_agent_steps_trained": 8500800}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154902.02176746685, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13349439411188102, "mean_inference_ms": 0.22798155425156402, "mean_action_processing_ms": 0.055767230652108014, "mean_env_wait_ms": 0.44377309728176867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025111801770268654, "StateBufferConnector_ms": 0.001828037962621572, "ViewRequirementAgentConnector_ms": 0.044198425448670677}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154902.02176746685, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13349439411188102, "mean_inference_ms": 0.22798155425156402, "mean_action_processing_ms": 0.055767230652108014, "mean_env_wait_ms": 0.44377309728176867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025111801770268654, "StateBufferConnector_ms": 0.001828037962621572, "ViewRequirementAgentConnector_ms": 0.044198425448670677}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8500800, "num_agent_steps_trained": 8500800, "num_env_steps_sampled": 8500800, "num_env_steps_trained": 8500800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1127.9946088110523, "num_env_steps_trained_throughput_per_sec": 1127.9946088110523, "timesteps_total": 8500800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8500800, "timers": {"training_iteration_time_ms": 38884.285, "sample_time_ms": 38165.889, "load_time_ms": 12.276, "load_throughput": 3577710.936, "learn_time_ms": 705.314, "learn_throughput": 62270.168, "synch_weights_time_ms": 0.693}, "counters": {"num_env_steps_sampled": 8500800, "num_env_steps_trained": 8500800, "num_agent_steps_sampled": 8500800, "num_agent_steps_trained": 8500800}, "done": false, "episodes_total": 7646, "training_iteration": 1823, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-37-23", "timestamp": 1691300243, "time_this_iter_s": 38.93877911567688, "time_total_s": 26116.996819496155, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3837.381123304367, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 18.05454545454545, "ram_util_percent": 71.30545454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.499999999999999e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.07820578705815, "policy_loss": -2163402.575827373, "vf_loss": 4391401.922376093}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 67571.5, "diff_num_grad_updates_vs_sampler_policy": 67570.5}}, "num_env_steps_sampled": 8544720, "num_env_steps_trained": 8544720, "num_agent_steps_sampled": 8544720, "num_agent_steps_trained": 8544720}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154894.73332320421, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13349961095797155, "mean_inference_ms": 0.22799058248433982, "mean_action_processing_ms": 0.055769495328464765, "mean_env_wait_ms": 0.4437686724858386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025084524443655305, "StateBufferConnector_ms": 0.0018269124657216698, "ViewRequirementAgentConnector_ms": 0.04418642833979443}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154894.73332320421, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13349961095797155, "mean_inference_ms": 0.22799058248433982, "mean_action_processing_ms": 0.055769495328464765, "mean_env_wait_ms": 0.4437686724858386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025084524443655305, "StateBufferConnector_ms": 0.0018269124657216698, "ViewRequirementAgentConnector_ms": 0.04418642833979443}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8544720, "num_agent_steps_trained": 8544720, "num_env_steps_sampled": 8544720, "num_env_steps_trained": 8544720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1124.1155611184588, "num_env_steps_trained_throughput_per_sec": 1124.1155611184588, "timesteps_total": 8544720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8544720, "timers": {"training_iteration_time_ms": 38895.153, "sample_time_ms": 38177.351, "load_time_ms": 12.288, "load_throughput": 3574073.647, "learn_time_ms": 704.704, "learn_throughput": 62324.027, "synch_weights_time_ms": 0.695}, "counters": {"num_env_steps_sampled": 8544720, "num_env_steps_trained": 8544720, "num_agent_steps_sampled": 8544720, "num_agent_steps_trained": 8544720}, "done": false, "episodes_total": 7647, "training_iteration": 1824, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-38-02", "timestamp": 1691300282, "time_this_iter_s": 39.07299494743347, "time_total_s": 26156.06981444359, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3876.4541182518005, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 18.510714285714283, "ram_util_percent": 71.26785714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.999999999999999e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.99437889343795, "policy_loss": -2034511.3120416135, "vf_loss": 4392480.285349854}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 68257.5, "diff_num_grad_updates_vs_sampler_policy": 68256.5}}, "num_env_steps_sampled": 8588640, "num_env_steps_trained": 8588640, "num_agent_steps_sampled": 8588640, "num_agent_steps_trained": 8588640}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154894.51626042827, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13350454465414088, "mean_inference_ms": 0.22799922326355238, "mean_action_processing_ms": 0.055771673530070995, "mean_env_wait_ms": 0.44376352349030945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025048255920410156, "StateBufferConnector_ms": 0.0018260478973388672, "ViewRequirementAgentConnector_ms": 0.04419970512390137}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154894.51626042827, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157668.0116319876, -157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13350454465414088, "mean_inference_ms": 0.22799922326355238, "mean_action_processing_ms": 0.055771673530070995, "mean_env_wait_ms": 0.44376352349030945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025048255920410156, "StateBufferConnector_ms": 0.0018260478973388672, "ViewRequirementAgentConnector_ms": 0.04419970512390137}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8588640, "num_agent_steps_trained": 8588640, "num_env_steps_sampled": 8588640, "num_env_steps_trained": 8588640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1138.1433956338499, "num_env_steps_trained_throughput_per_sec": 1138.1433956338499, "timesteps_total": 8588640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8588640, "timers": {"training_iteration_time_ms": 38867.875, "sample_time_ms": 38150.181, "load_time_ms": 12.308, "load_throughput": 3568493.3, "learn_time_ms": 704.576, "learn_throughput": 62335.327, "synch_weights_time_ms": 0.696}, "counters": {"num_env_steps_sampled": 8588640, "num_env_steps_trained": 8588640, "num_agent_steps_sampled": 8588640, "num_agent_steps_trained": 8588640}, "done": false, "episodes_total": 7648, "training_iteration": 1825, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-38-41", "timestamp": 1691300321, "time_this_iter_s": 38.59146285057068, "time_total_s": 26194.66127729416, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3915.045581102371, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 19.146296296296295, "ram_util_percent": 71.39259259259259}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.5000000000000004e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.91195936731276, "policy_loss": -1897191.9143642948, "vf_loss": 4108617.5921100583}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 68943.5, "diff_num_grad_updates_vs_sampler_policy": 68942.5}}, "num_env_steps_sampled": 8632560, "num_env_steps_trained": 8632560, "num_agent_steps_sampled": 8632560, "num_agent_steps_trained": 8632560}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154821.74246786517, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13350463459933595, "mean_inference_ms": 0.2279984470248036, "mean_action_processing_ms": 0.055772170603400985, "mean_env_wait_ms": 0.4433521221848704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002505779266357422, "StateBufferConnector_ms": 0.0018281936645507812, "ViewRequirementAgentConnector_ms": 0.04421734809875488}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154821.74246786517, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157527.2373972028, -156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13350463459933595, "mean_inference_ms": 0.2279984470248036, "mean_action_processing_ms": 0.055772170603400985, "mean_env_wait_ms": 0.4433521221848704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002505779266357422, "StateBufferConnector_ms": 0.0018281936645507812, "ViewRequirementAgentConnector_ms": 0.04421734809875488}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8632560, "num_agent_steps_trained": 8632560, "num_env_steps_sampled": 8632560, "num_env_steps_trained": 8632560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1132.5296674211154, "num_env_steps_trained_throughput_per_sec": 1132.5296674211154, "timesteps_total": 8632560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8632560, "timers": {"training_iteration_time_ms": 38866.17, "sample_time_ms": 38142.696, "load_time_ms": 12.256, "load_throughput": 3583452.611, "learn_time_ms": 710.397, "learn_throughput": 61824.573, "synch_weights_time_ms": 0.702}, "counters": {"num_env_steps_sampled": 8632560, "num_env_steps_trained": 8632560, "num_agent_steps_sampled": 8632560, "num_agent_steps_trained": 8632560}, "done": false, "episodes_total": 7649, "training_iteration": 1826, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-39-19", "timestamp": 1691300359, "time_this_iter_s": 38.78255367279053, "time_total_s": 26233.44383096695, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3953.8281347751617, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 18.21090909090909, "ram_util_percent": 71.39272727272729}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9700056248434, "policy_loss": -1910161.8519924153, "vf_loss": 4098602.7330539357}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 69629.5, "diff_num_grad_updates_vs_sampler_policy": 69628.5}}, "num_env_steps_sampled": 8676480, "num_env_steps_trained": 8676480, "num_agent_steps_sampled": 8676480, "num_agent_steps_trained": 8676480}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154748.69082012883, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13350557071717853, "mean_inference_ms": 0.2280070190741141, "mean_action_processing_ms": 0.055775008870799746, "mean_env_wait_ms": 0.443142028940618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025014877319335938, "StateBufferConnector_ms": 0.00182342529296875, "ViewRequirementAgentConnector_ms": 0.044181108474731445}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154748.69082012883, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-156176.02912270022, -156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13350557071717853, "mean_inference_ms": 0.2280070190741141, "mean_action_processing_ms": 0.055775008870799746, "mean_env_wait_ms": 0.443142028940618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025014877319335938, "StateBufferConnector_ms": 0.00182342529296875, "ViewRequirementAgentConnector_ms": 0.044181108474731445}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8676480, "num_agent_steps_trained": 8676480, "num_env_steps_sampled": 8676480, "num_env_steps_trained": 8676480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1123.516179119823, "num_env_steps_trained_throughput_per_sec": 1123.516179119823, "timesteps_total": 8676480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8676480, "timers": {"training_iteration_time_ms": 38883.142, "sample_time_ms": 38159.804, "load_time_ms": 12.258, "load_throughput": 3582936.848, "learn_time_ms": 710.258, "learn_throughput": 61836.645, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 8676480, "num_env_steps_trained": 8676480, "num_agent_steps_sampled": 8676480, "num_agent_steps_trained": 8676480}, "done": false, "episodes_total": 7650, "training_iteration": 1827, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-39-59", "timestamp": 1691300399, "time_this_iter_s": 39.09391784667969, "time_total_s": 26272.53774881363, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3992.9220526218414, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 17.605357142857144, "ram_util_percent": 71.4125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000007e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0127419785925, "policy_loss": -2062360.172228043, "vf_loss": 4373841.978680758}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 70315.5, "diff_num_grad_updates_vs_sampler_policy": 70314.5}}, "num_env_steps_sampled": 8720400, "num_env_steps_trained": 8720400, "num_agent_steps_sampled": 8720400, "num_agent_steps_trained": 8720400}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154727.02968626822, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1335055068916394, "mean_inference_ms": 0.22801491588887304, "mean_action_processing_ms": 0.05577782243071898, "mean_env_wait_ms": 0.4430031043804528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025038719177246094, "StateBufferConnector_ms": 0.0018291473388671875, "ViewRequirementAgentConnector_ms": 0.04422903060913086}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154727.02968626822, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-156707.3093693908, -153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1335055068916394, "mean_inference_ms": 0.22801491588887304, "mean_action_processing_ms": 0.05577782243071898, "mean_env_wait_ms": 0.4430031043804528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025038719177246094, "StateBufferConnector_ms": 0.0018291473388671875, "ViewRequirementAgentConnector_ms": 0.04422903060913086}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8720400, "num_agent_steps_trained": 8720400, "num_env_steps_sampled": 8720400, "num_env_steps_trained": 8720400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1126.9125138832446, "num_env_steps_trained_throughput_per_sec": 1126.9125138832446, "timesteps_total": 8720400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8720400, "timers": {"training_iteration_time_ms": 38894.715, "sample_time_ms": 38169.852, "load_time_ms": 12.356, "load_throughput": 3554549.785, "learn_time_ms": 711.693, "learn_throughput": 61712.031, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 8720400, "num_env_steps_trained": 8720400, "num_agent_steps_sampled": 8720400, "num_agent_steps_trained": 8720400}, "done": false, "episodes_total": 7651, "training_iteration": 1828, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-40-38", "timestamp": 1691300438, "time_this_iter_s": 38.976117849349976, "time_total_s": 26311.51386666298, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4031.8981704711914, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 17.1, "ram_util_percent": 71.43090909090908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.9999999999999996e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.7472133803298, "policy_loss": -1741842.7280059904, "vf_loss": 4030324.3624271136}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 71001.5, "diff_num_grad_updates_vs_sampler_policy": 71000.5}}, "num_env_steps_sampled": 8764320, "num_env_steps_trained": 8764320, "num_agent_steps_sampled": 8764320, "num_agent_steps_trained": 8764320}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154653.65471800233, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13350713267634395, "mean_inference_ms": 0.2280249948861868, "mean_action_processing_ms": 0.055781184980540036, "mean_env_wait_ms": 0.4428960705329765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002506732940673828, "StateBufferConnector_ms": 0.0018291473388671875, "ViewRequirementAgentConnector_ms": 0.0442354679107666}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154653.65471800233, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-153804.05517566946, -155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13350713267634395, "mean_inference_ms": 0.2280249948861868, "mean_action_processing_ms": 0.055781184980540036, "mean_env_wait_ms": 0.4428960705329765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002506732940673828, "StateBufferConnector_ms": 0.0018291473388671875, "ViewRequirementAgentConnector_ms": 0.0442354679107666}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8764320, "num_agent_steps_trained": 8764320, "num_env_steps_sampled": 8764320, "num_env_steps_trained": 8764320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1121.8094214112846, "num_env_steps_trained_throughput_per_sec": 1121.8094214112846, "timesteps_total": 8764320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8764320, "timers": {"training_iteration_time_ms": 38946.86, "sample_time_ms": 38218.715, "load_time_ms": 12.342, "load_throughput": 3558491.091, "learn_time_ms": 714.995, "learn_throughput": 61426.999, "synch_weights_time_ms": 0.694}, "counters": {"num_env_steps_sampled": 8764320, "num_env_steps_trained": 8764320, "num_agent_steps_sampled": 8764320, "num_agent_steps_trained": 8764320}, "done": false, "episodes_total": 7652, "training_iteration": 1829, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-41-17", "timestamp": 1691300477, "time_this_iter_s": 39.153193950653076, "time_total_s": 26350.667060613632, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4071.0513644218445, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 18.65454545454546, "ram_util_percent": 71.38727272727272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.4999999999999995e-12, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0929202421761, "policy_loss": -2032681.2534763347, "vf_loss": 4425426.886935132}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 71687.5, "diff_num_grad_updates_vs_sampler_policy": 71686.5}}, "num_env_steps_sampled": 8808240, "num_env_steps_trained": 8808240, "num_agent_steps_sampled": 8808240, "num_agent_steps_trained": 8808240}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154660.4774197851, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13351035201943606, "mean_inference_ms": 0.2280358814613114, "mean_action_processing_ms": 0.055784352889450446, "mean_env_wait_ms": 0.44281521703817667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024976730346679688, "StateBufferConnector_ms": 0.001829385757446289, "ViewRequirementAgentConnector_ms": 0.044223785400390625}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154660.4774197851, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155760.51251235037, -153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13351035201943606, "mean_inference_ms": 0.2280358814613114, "mean_action_processing_ms": 0.055784352889450446, "mean_env_wait_ms": 0.44281521703817667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024976730346679688, "StateBufferConnector_ms": 0.001829385757446289, "ViewRequirementAgentConnector_ms": 0.044223785400390625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8808240, "num_agent_steps_trained": 8808240, "num_env_steps_sampled": 8808240, "num_env_steps_trained": 8808240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1137.178736203707, "num_env_steps_trained_throughput_per_sec": 1137.178736203707, "timesteps_total": 8808240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8808240, "timers": {"training_iteration_time_ms": 38908.491, "sample_time_ms": 38177.251, "load_time_ms": 12.425, "load_throughput": 3534688.612, "learn_time_ms": 718.006, "learn_throughput": 61169.441, "synch_weights_time_ms": 0.697}, "counters": {"num_env_steps_sampled": 8808240, "num_env_steps_trained": 8808240, "num_agent_steps_sampled": 8808240, "num_agent_steps_trained": 8808240}, "done": false, "episodes_total": 7653, "training_iteration": 1830, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-41-55", "timestamp": 1691300515, "time_this_iter_s": 38.62405729293823, "time_total_s": 26389.29111790657, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4109.675421714783, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 19.439999999999998, "ram_util_percent": 71.35636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9663086382363, "policy_loss": -1913305.4957834138, "vf_loss": 4278023.59119898}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 72373.5, "diff_num_grad_updates_vs_sampler_policy": 72372.5}}, "num_env_steps_sampled": 8852160, "num_env_steps_trained": 8852160, "num_agent_steps_sampled": 8852160, "num_agent_steps_trained": 8852160}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154629.57251082442, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13351349095028173, "mean_inference_ms": 0.22804789849290877, "mean_action_processing_ms": 0.0557876733492869, "mean_env_wait_ms": 0.442762056842164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024945735931396484, "StateBufferConnector_ms": 0.0018303394317626953, "ViewRequirementAgentConnector_ms": 0.044232845306396484}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154629.57251082442, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-153422.9286911195, -154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13351349095028173, "mean_inference_ms": 0.22804789849290877, "mean_action_processing_ms": 0.0557876733492869, "mean_env_wait_ms": 0.442762056842164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024945735931396484, "StateBufferConnector_ms": 0.0018303394317626953, "ViewRequirementAgentConnector_ms": 0.044232845306396484}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8852160, "num_agent_steps_trained": 8852160, "num_env_steps_sampled": 8852160, "num_env_steps_trained": 8852160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1128.42553767507, "num_env_steps_trained_throughput_per_sec": 1128.42553767507, "timesteps_total": 8852160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8852160, "timers": {"training_iteration_time_ms": 38914.735, "sample_time_ms": 38181.616, "load_time_ms": 12.469, "load_throughput": 3522279.935, "learn_time_ms": 719.843, "learn_throughput": 61013.304, "synch_weights_time_ms": 0.694}, "counters": {"num_env_steps_sampled": 8852160, "num_env_steps_trained": 8852160, "num_agent_steps_sampled": 8852160, "num_agent_steps_trained": 8852160}, "done": false, "episodes_total": 7654, "training_iteration": 1831, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-42-34", "timestamp": 1691300554, "time_this_iter_s": 38.92379808425903, "time_total_s": 26428.21491599083, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4148.599219799042, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 17.325454545454544, "ram_util_percent": 71.39636363636365}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.1112818592839, "policy_loss": -2216725.773326462, "vf_loss": 4541519.253279883}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 73059.5, "diff_num_grad_updates_vs_sampler_policy": 73058.5}}, "num_env_steps_sampled": 8896080, "num_env_steps_trained": 8896080, "num_agent_steps_sampled": 8896080, "num_agent_steps_trained": 8896080}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154658.18939410546, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13351694785696658, "mean_inference_ms": 0.22806039861876123, "mean_action_processing_ms": 0.05579079761389318, "mean_env_wait_ms": 0.44271377657983324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024945735931396484, "StateBufferConnector_ms": 0.0018296241760253906, "ViewRequirementAgentConnector_ms": 0.04424405097961426}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154658.18939410546, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154272.24954187122, -154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13351694785696658, "mean_inference_ms": 0.22806039861876123, "mean_action_processing_ms": 0.05579079761389318, "mean_env_wait_ms": 0.44271377657983324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024945735931396484, "StateBufferConnector_ms": 0.0018296241760253906, "ViewRequirementAgentConnector_ms": 0.04424405097961426}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8896080, "num_agent_steps_trained": 8896080, "num_env_steps_sampled": 8896080, "num_env_steps_trained": 8896080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1133.5067342073557, "num_env_steps_trained_throughput_per_sec": 1133.5067342073557, "timesteps_total": 8896080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8896080, "timers": {"training_iteration_time_ms": 38888.326, "sample_time_ms": 38155.774, "load_time_ms": 12.49, "load_throughput": 3516329.695, "learn_time_ms": 719.26, "learn_throughput": 61062.728, "synch_weights_time_ms": 0.689}, "counters": {"num_env_steps_sampled": 8896080, "num_env_steps_trained": 8896080, "num_agent_steps_sampled": 8896080, "num_agent_steps_trained": 8896080}, "done": false, "episodes_total": 7655, "training_iteration": 1832, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-43-13", "timestamp": 1691300593, "time_this_iter_s": 38.749186754226685, "time_total_s": 26466.964102745056, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4187.348406553268, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 16.95818181818182, "ram_util_percent": 71.38909090909092}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0342828066634, "policy_loss": -1870837.3474313274, "vf_loss": 4247686.402332362}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 73745.5, "diff_num_grad_updates_vs_sampler_policy": 73744.5}}, "num_env_steps_sampled": 8940000, "num_env_steps_trained": 8940000, "num_agent_steps_sampled": 8940000, "num_agent_steps_trained": 8940000}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154636.40237863705, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13352246815611862, "mean_inference_ms": 0.2280732077833274, "mean_action_processing_ms": 0.05579410057689205, "mean_env_wait_ms": 0.4426789875064443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024967193603515625, "StateBufferConnector_ms": 0.0018298625946044922, "ViewRequirementAgentConnector_ms": 0.04424881935119629}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154636.40237863705, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154572.39653799904, -155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13352246815611862, "mean_inference_ms": 0.2280732077833274, "mean_action_processing_ms": 0.05579410057689205, "mean_env_wait_ms": 0.4426789875064443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024967193603515625, "StateBufferConnector_ms": 0.0018298625946044922, "ViewRequirementAgentConnector_ms": 0.04424881935119629}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8940000, "num_agent_steps_trained": 8940000, "num_env_steps_sampled": 8940000, "num_env_steps_trained": 8940000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1124.8880657372843, "num_env_steps_trained_throughput_per_sec": 1124.8880657372843, "timesteps_total": 8940000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8940000, "timers": {"training_iteration_time_ms": 38899.079, "sample_time_ms": 38166.488, "load_time_ms": 12.396, "load_throughput": 3543077.893, "learn_time_ms": 719.394, "learn_throughput": 61051.377, "synch_weights_time_ms": 0.689}, "counters": {"num_env_steps_sampled": 8940000, "num_env_steps_trained": 8940000, "num_agent_steps_sampled": 8940000, "num_agent_steps_trained": 8940000}, "done": false, "episodes_total": 7656, "training_iteration": 1833, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-43-52", "timestamp": 1691300632, "time_this_iter_s": 39.04622411727905, "time_total_s": 26506.010326862335, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4226.3946306705475, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 17.46909090909091, "ram_util_percent": 71.42181818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.01207174851663, "policy_loss": -2188079.5789136523, "vf_loss": 4468236.929938046}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 74431.5, "diff_num_grad_updates_vs_sampler_policy": 74430.5}}, "num_env_steps_sampled": 8983920, "num_env_steps_trained": 8983920, "num_agent_steps_sampled": 8983920, "num_agent_steps_trained": 8983920}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154644.06035849775, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13352758554130886, "mean_inference_ms": 0.22808334059822047, "mean_action_processing_ms": 0.05579741141282229, "mean_env_wait_ms": 0.44265573925433543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002498626708984375, "StateBufferConnector_ms": 0.0018298625946044922, "ViewRequirementAgentConnector_ms": 0.04425811767578125}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154644.06035849775, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155617.23393975367, -153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13352758554130886, "mean_inference_ms": 0.22808334059822047, "mean_action_processing_ms": 0.05579741141282229, "mean_env_wait_ms": 0.44265573925433543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002498626708984375, "StateBufferConnector_ms": 0.0018298625946044922, "ViewRequirementAgentConnector_ms": 0.04425811767578125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8983920, "num_agent_steps_trained": 8983920, "num_env_steps_sampled": 8983920, "num_env_steps_trained": 8983920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1129.7543828541625, "num_env_steps_trained_throughput_per_sec": 1129.7543828541625, "timesteps_total": 8983920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 8983920, "timers": {"training_iteration_time_ms": 38879.578, "sample_time_ms": 38144.634, "load_time_ms": 12.354, "load_throughput": 3555256.38, "learn_time_ms": 721.787, "learn_throughput": 60848.95, "synch_weights_time_ms": 0.691}, "counters": {"num_env_steps_sampled": 8983920, "num_env_steps_trained": 8983920, "num_agent_steps_sampled": 8983920, "num_agent_steps_trained": 8983920}, "done": false, "episodes_total": 7657, "training_iteration": 1834, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-44-31", "timestamp": 1691300671, "time_this_iter_s": 38.87790489196777, "time_total_s": 26544.888231754303, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4265.272535562515, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 18.812727272727273, "ram_util_percent": 71.41090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.12399363170215, "policy_loss": -2147929.3080613385, "vf_loss": 4465896.558400146}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 75117.5, "diff_num_grad_updates_vs_sampler_policy": 75116.5}}, "num_env_steps_sampled": 9027840, "num_env_steps_trained": 9027840, "num_agent_steps_sampled": 9027840, "num_agent_steps_trained": 9027840}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154638.39717606516, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13353383602280558, "mean_inference_ms": 0.2280948300393733, "mean_action_processing_ms": 0.05580080294915877, "mean_env_wait_ms": 0.44264826368707516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002498149871826172, "StateBufferConnector_ms": 0.0018320083618164062, "ViewRequirementAgentConnector_ms": 0.04424452781677246}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154638.39717606516, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-153752.94037510458, -154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13353383602280558, "mean_inference_ms": 0.2280948300393733, "mean_action_processing_ms": 0.05580080294915877, "mean_env_wait_ms": 0.44264826368707516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002498149871826172, "StateBufferConnector_ms": 0.0018320083618164062, "ViewRequirementAgentConnector_ms": 0.04424452781677246}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9027840, "num_agent_steps_trained": 9027840, "num_env_steps_sampled": 9027840, "num_env_steps_trained": 9027840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1129.4825143851056, "num_env_steps_trained_throughput_per_sec": 1129.4825143851056, "timesteps_total": 9027840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9027840, "timers": {"training_iteration_time_ms": 38909.168, "sample_time_ms": 38171.361, "load_time_ms": 12.388, "load_throughput": 3545464.603, "learn_time_ms": 724.606, "learn_throughput": 60612.269, "synch_weights_time_ms": 0.702}, "counters": {"num_env_steps_sampled": 9027840, "num_env_steps_trained": 9027840, "num_agent_steps_sampled": 9027840, "num_agent_steps_trained": 9027840}, "done": false, "episodes_total": 7658, "training_iteration": 1835, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-45-10", "timestamp": 1691300710, "time_this_iter_s": 38.88726091384888, "time_total_s": 26583.775492668152, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4304.159796476364, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 17.865454545454543, "ram_util_percent": 71.41636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.13384991971117, "policy_loss": -1953687.951052296, "vf_loss": 4535463.807671282}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 75803.5, "diff_num_grad_updates_vs_sampler_policy": 75802.5}}, "num_env_steps_sampled": 9071760, "num_env_steps_trained": 9071760, "num_agent_steps_sampled": 9071760, "num_agent_steps_trained": 9071760}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154663.50496548304, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13354098418521873, "mean_inference_ms": 0.22810721408038823, "mean_action_processing_ms": 0.055804199994815375, "mean_env_wait_ms": 0.4426447521445717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002496004104614258, "StateBufferConnector_ms": 0.0018291473388671875, "ViewRequirementAgentConnector_ms": 0.0442352294921875}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154663.50496548304, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154065.86007174358, -155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13354098418521873, "mean_inference_ms": 0.22810721408038823, "mean_action_processing_ms": 0.055804199994815375, "mean_env_wait_ms": 0.4426447521445717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002496004104614258, "StateBufferConnector_ms": 0.0018291473388671875, "ViewRequirementAgentConnector_ms": 0.0442352294921875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9071760, "num_agent_steps_trained": 9071760, "num_env_steps_sampled": 9071760, "num_env_steps_trained": 9071760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1132.0626080467864, "num_env_steps_trained_throughput_per_sec": 1132.0626080467864, "timesteps_total": 9071760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9071760, "timers": {"training_iteration_time_ms": 38910.767, "sample_time_ms": 38176.817, "load_time_ms": 12.465, "load_throughput": 3523371.313, "learn_time_ms": 720.68, "learn_throughput": 60942.409, "synch_weights_time_ms": 0.693}, "counters": {"num_env_steps_sampled": 9071760, "num_env_steps_trained": 9071760, "num_agent_steps_sampled": 9071760, "num_agent_steps_trained": 9071760}, "done": false, "episodes_total": 7659, "training_iteration": 1836, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-45-49", "timestamp": 1691300749, "time_this_iter_s": 38.798688888549805, "time_total_s": 26622.5741815567, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4342.958485364914, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 17.65090909090909, "ram_util_percent": 71.47272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.99021422272176, "policy_loss": -2034500.4879823022, "vf_loss": 4455068.639941691}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 76489.5, "diff_num_grad_updates_vs_sampler_policy": 76488.5}}, "num_env_steps_sampled": 9115680, "num_env_steps_trained": 9115680, "num_agent_steps_sampled": 9115680, "num_agent_steps_trained": 9115680}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154674.46807387215, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13354856916005098, "mean_inference_ms": 0.22812014637487305, "mean_action_processing_ms": 0.05580757134656957, "mean_env_wait_ms": 0.442641455094173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024929046630859375, "StateBufferConnector_ms": 0.001828908920288086, "ViewRequirementAgentConnector_ms": 0.04421091079711914}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154674.46807387215, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155242.19223672006, -155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13354856916005098, "mean_inference_ms": 0.22812014637487305, "mean_action_processing_ms": 0.05580757134656957, "mean_env_wait_ms": 0.442641455094173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024929046630859375, "StateBufferConnector_ms": 0.001828908920288086, "ViewRequirementAgentConnector_ms": 0.04421091079711914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9115680, "num_agent_steps_trained": 9115680, "num_env_steps_sampled": 9115680, "num_env_steps_trained": 9115680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1128.3667791375626, "num_env_steps_trained_throughput_per_sec": 1128.3667791375626, "timesteps_total": 9115680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9115680, "timers": {"training_iteration_time_ms": 38893.963, "sample_time_ms": 38158.217, "load_time_ms": 12.464, "load_throughput": 3523620.673, "learn_time_ms": 722.488, "learn_throughput": 60789.947, "synch_weights_time_ms": 0.682}, "counters": {"num_env_steps_sampled": 9115680, "num_env_steps_trained": 9115680, "num_agent_steps_sampled": 9115680, "num_agent_steps_trained": 9115680}, "done": false, "episodes_total": 7660, "training_iteration": 1837, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-46-28", "timestamp": 1691300788, "time_this_iter_s": 38.92568397521973, "time_total_s": 26661.49986553192, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4381.884169340134, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 17.32, "ram_util_percent": 71.42545454545456}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0182520474359, "policy_loss": -2089636.3155549609, "vf_loss": 4509132.802478134}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 77175.5, "diff_num_grad_updates_vs_sampler_policy": 77174.5}}, "num_env_steps_sampled": 9159600, "num_env_steps_trained": 9159600, "num_agent_steps_sampled": 9159600, "num_agent_steps_trained": 9159600}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154680.9008754651, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13355581455257906, "mean_inference_ms": 0.2281335276375303, "mean_action_processing_ms": 0.055810994182360796, "mean_env_wait_ms": 0.44264183923710543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024912357330322266, "StateBufferConnector_ms": 0.001825571060180664, "ViewRequirementAgentConnector_ms": 0.0441746711730957}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154680.9008754651, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155117.6674376251, -157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13355581455257906, "mean_inference_ms": 0.2281335276375303, "mean_action_processing_ms": 0.055810994182360796, "mean_env_wait_ms": 0.44264183923710543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024912357330322266, "StateBufferConnector_ms": 0.001825571060180664, "ViewRequirementAgentConnector_ms": 0.0441746711730957}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9159600, "num_agent_steps_trained": 9159600, "num_env_steps_sampled": 9159600, "num_env_steps_trained": 9159600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1123.5137602628126, "num_env_steps_trained_throughput_per_sec": 1123.5137602628126, "timesteps_total": 9159600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9159600, "timers": {"training_iteration_time_ms": 38905.753, "sample_time_ms": 38170.408, "load_time_ms": 12.405, "load_throughput": 3540524.267, "learn_time_ms": 722.141, "learn_throughput": 60819.115, "synch_weights_time_ms": 0.687}, "counters": {"num_env_steps_sampled": 9159600, "num_env_steps_trained": 9159600, "num_agent_steps_sampled": 9159600, "num_agent_steps_trained": 9159600}, "done": false, "episodes_total": 7661, "training_iteration": 1838, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-47-07", "timestamp": 1691300827, "time_this_iter_s": 39.09372305870056, "time_total_s": 26700.593588590622, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4420.977892398834, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 18.592857142857145, "ram_util_percent": 71.41071428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.087368489702, "policy_loss": -2014658.278448433, "vf_loss": 4408893.024052478}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 77861.5, "diff_num_grad_updates_vs_sampler_policy": 77860.5}}, "num_env_steps_sampled": 9203520, "num_env_steps_trained": 9203520, "num_agent_steps_sampled": 9203520, "num_agent_steps_trained": 9203520}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154674.83924371825, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.133563672182651, "mean_inference_ms": 0.22814716346173725, "mean_action_processing_ms": 0.05581439847227622, "mean_env_wait_ms": 0.4426482558200344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002489805221557617, "StateBufferConnector_ms": 0.0018260478973388672, "ViewRequirementAgentConnector_ms": 0.04419279098510742}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154674.83924371825, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157566.177476424, -153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.133563672182651, "mean_inference_ms": 0.22814716346173725, "mean_action_processing_ms": 0.05581439847227622, "mean_env_wait_ms": 0.4426482558200344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002489805221557617, "StateBufferConnector_ms": 0.0018260478973388672, "ViewRequirementAgentConnector_ms": 0.04419279098510742}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9203520, "num_agent_steps_trained": 9203520, "num_env_steps_sampled": 9203520, "num_env_steps_trained": 9203520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1124.8479588116247, "num_env_steps_trained_throughput_per_sec": 1124.8479588116247, "timesteps_total": 9203520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9203520, "timers": {"training_iteration_time_ms": 38895.177, "sample_time_ms": 38160.957, "load_time_ms": 12.511, "load_throughput": 3510586.839, "learn_time_ms": 720.909, "learn_throughput": 60923.095, "synch_weights_time_ms": 0.687}, "counters": {"num_env_steps_sampled": 9203520, "num_env_steps_trained": 9203520, "num_agent_steps_sampled": 9203520, "num_agent_steps_trained": 9203520}, "done": false, "episodes_total": 7662, "training_iteration": 1839, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-47-46", "timestamp": 1691300866, "time_this_iter_s": 39.047839879989624, "time_total_s": 26739.64142847061, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4460.025732278824, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 18.665454545454544, "ram_util_percent": 71.37818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.1098806753798, "policy_loss": -2142471.94103043, "vf_loss": 4599485.195335277}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 78547.5, "diff_num_grad_updates_vs_sampler_policy": 78546.5}}, "num_env_steps_sampled": 9247440, "num_env_steps_trained": 9247440, "num_agent_steps_sampled": 9247440, "num_agent_steps_trained": 9247440}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154667.9291418114, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1335721666405524, "mean_inference_ms": 0.22816154698564833, "mean_action_processing_ms": 0.05581782965322041, "mean_env_wait_ms": 0.44265995528085916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024929046630859375, "StateBufferConnector_ms": 0.0018260478973388672, "ViewRequirementAgentConnector_ms": 0.04419970512390137}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154667.9291418114, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-153930.3116586247, -155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1335721666405524, "mean_inference_ms": 0.22816154698564833, "mean_action_processing_ms": 0.05581782965322041, "mean_env_wait_ms": 0.44265995528085916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024929046630859375, "StateBufferConnector_ms": 0.0018260478973388672, "ViewRequirementAgentConnector_ms": 0.04419970512390137}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9247440, "num_agent_steps_trained": 9247440, "num_env_steps_sampled": 9247440, "num_env_steps_trained": 9247440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1124.4137727561558, "num_env_steps_trained_throughput_per_sec": 1124.4137727561558, "timesteps_total": 9247440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9247440, "timers": {"training_iteration_time_ms": 38939.022, "sample_time_ms": 38206.601, "load_time_ms": 12.388, "load_throughput": 3545478.251, "learn_time_ms": 719.241, "learn_throughput": 61064.4, "synch_weights_time_ms": 0.681}, "counters": {"num_env_steps_sampled": 9247440, "num_env_steps_trained": 9247440, "num_agent_steps_sampled": 9247440, "num_agent_steps_trained": 9247440}, "done": false, "episodes_total": 7663, "training_iteration": 1840, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-48-25", "timestamp": 1691300905, "time_this_iter_s": 39.062845945358276, "time_total_s": 26778.70427441597, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4499.088578224182, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 17.375, "ram_util_percent": 71.38214285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.006894081049, "policy_loss": -1881181.7725264214, "vf_loss": 4292165.428844752}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 79233.5, "diff_num_grad_updates_vs_sampler_policy": 79232.5}}, "num_env_steps_sampled": 9291360, "num_env_steps_trained": 9291360, "num_agent_steps_sampled": 9291360, "num_agent_steps_trained": 9291360}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154657.59935427268, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1335804673850582, "mean_inference_ms": 0.22817570664518372, "mean_action_processing_ms": 0.05582121538238833, "mean_env_wait_ms": 0.44267013365573915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002493143081665039, "StateBufferConnector_ms": 0.0018227100372314453, "ViewRequirementAgentConnector_ms": 0.04419350624084473}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154657.59935427268, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155252.25942104968, -154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1335804673850582, "mean_inference_ms": 0.22817570664518372, "mean_action_processing_ms": 0.05582121538238833, "mean_env_wait_ms": 0.44267013365573915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002493143081665039, "StateBufferConnector_ms": 0.0018227100372314453, "ViewRequirementAgentConnector_ms": 0.04419350624084473}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9291360, "num_agent_steps_trained": 9291360, "num_env_steps_sampled": 9291360, "num_env_steps_trained": 9291360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1126.2856862381182, "num_env_steps_trained_throughput_per_sec": 1126.2856862381182, "timesteps_total": 9291360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9291360, "timers": {"training_iteration_time_ms": 38946.417, "sample_time_ms": 38212.931, "load_time_ms": 12.394, "load_throughput": 3543752.665, "learn_time_ms": 720.302, "learn_throughput": 60974.412, "synch_weights_time_ms": 0.677}, "counters": {"num_env_steps_sampled": 9291360, "num_env_steps_trained": 9291360, "num_agent_steps_sampled": 9291360, "num_agent_steps_trained": 9291360}, "done": false, "episodes_total": 7664, "training_iteration": 1841, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-49-04", "timestamp": 1691300944, "time_this_iter_s": 38.9978768825531, "time_total_s": 26817.702151298523, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4538.086455106735, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 17.463636363636365, "ram_util_percent": 71.42909090909092}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9510076761941, "policy_loss": -2059821.2003974582, "vf_loss": 4273377.155976676}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 79919.5, "diff_num_grad_updates_vs_sampler_policy": 79918.5}}, "num_env_steps_sampled": 9335280, "num_env_steps_trained": 9335280, "num_agent_steps_sampled": 9335280, "num_agent_steps_trained": 9335280}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154630.5921018181, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13358891154897767, "mean_inference_ms": 0.2281901672829019, "mean_action_processing_ms": 0.05582456216979715, "mean_env_wait_ms": 0.4426817536171329, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024945735931396484, "StateBufferConnector_ms": 0.0018231868743896484, "ViewRequirementAgentConnector_ms": 0.04418635368347168}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154630.5921018181, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154942.3727874084, -151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13358891154897767, "mean_inference_ms": 0.2281901672829019, "mean_action_processing_ms": 0.05582456216979715, "mean_env_wait_ms": 0.4426817536171329, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024945735931396484, "StateBufferConnector_ms": 0.0018231868743896484, "ViewRequirementAgentConnector_ms": 0.04418635368347168}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9335280, "num_agent_steps_trained": 9335280, "num_env_steps_sampled": 9335280, "num_env_steps_trained": 9335280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1124.7295367773718, "num_env_steps_trained_throughput_per_sec": 1124.7295367773718, "timesteps_total": 9335280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9335280, "timers": {"training_iteration_time_ms": 38976.655, "sample_time_ms": 38237.808, "load_time_ms": 12.359, "load_throughput": 3553665.222, "learn_time_ms": 725.694, "learn_throughput": 60521.417, "synch_weights_time_ms": 0.676}, "counters": {"num_env_steps_sampled": 9335280, "num_env_steps_trained": 9335280, "num_agent_steps_sampled": 9335280, "num_agent_steps_trained": 9335280}, "done": false, "episodes_total": 7665, "training_iteration": 1842, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-49-43", "timestamp": 1691300983, "time_this_iter_s": 39.05157279968262, "time_total_s": 26856.753724098206, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4577.138027906418, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 16.72, "ram_util_percent": 71.42}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.04413006396055, "policy_loss": -1913188.0849808673, "vf_loss": 4326630.516308309}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 80605.5, "diff_num_grad_updates_vs_sampler_policy": 80604.5}}, "num_env_steps_sampled": 9379200, "num_env_steps_trained": 9379200, "num_agent_steps_sampled": 9379200, "num_agent_steps_trained": 9379200}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154613.55051816627, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13360097072835636, "mean_inference_ms": 0.2282072671693013, "mean_action_processing_ms": 0.05582858303275863, "mean_env_wait_ms": 0.44269733335991146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025060176849365234, "StateBufferConnector_ms": 0.0018334388732910156, "ViewRequirementAgentConnector_ms": 0.04441046714782715}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154613.55051816627, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-151730.2922357145, -154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13360097072835636, "mean_inference_ms": 0.2282072671693013, "mean_action_processing_ms": 0.05582858303275863, "mean_env_wait_ms": 0.44269733335991146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025060176849365234, "StateBufferConnector_ms": 0.0018334388732910156, "ViewRequirementAgentConnector_ms": 0.04441046714782715}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9379200, "num_agent_steps_trained": 9379200, "num_env_steps_sampled": 9379200, "num_env_steps_trained": 9379200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 950.932528814654, "num_env_steps_trained_throughput_per_sec": 950.932528814654, "timesteps_total": 9379200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9379200, "timers": {"training_iteration_time_ms": 39690.891, "sample_time_ms": 38908.245, "load_time_ms": 14.176, "load_throughput": 3098217.762, "learn_time_ms": 767.637, "learn_throughput": 57214.513, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 9379200, "num_env_steps_trained": 9379200, "num_agent_steps_sampled": 9379200, "num_agent_steps_trained": 9379200}, "done": false, "episodes_total": 7666, "training_iteration": 1843, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-50-29", "timestamp": 1691301029, "time_this_iter_s": 46.189176082611084, "time_total_s": 26902.942900180817, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4623.327203989029, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 19.818181818181813, "ram_util_percent": 71.34848484848484}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.00278012467544, "policy_loss": -2133114.2062625275, "vf_loss": 4502969.605685132}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 81291.5, "diff_num_grad_updates_vs_sampler_policy": 81290.5}}, "num_env_steps_sampled": 9423120, "num_env_steps_trained": 9423120, "num_agent_steps_sampled": 9423120, "num_agent_steps_trained": 9423120}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154652.518629407, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13361991161754305, "mean_inference_ms": 0.2282357431797811, "mean_action_processing_ms": 0.05583542576499435, "mean_env_wait_ms": 0.4427331970446135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002518177032470703, "StateBufferConnector_ms": 0.0018472671508789062, "ViewRequirementAgentConnector_ms": 0.0446622371673584}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154652.518629407, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154865.02429087195, -156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13361991161754305, "mean_inference_ms": 0.2282357431797811, "mean_action_processing_ms": 0.05583542576499435, "mean_env_wait_ms": 0.4427331970446135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002518177032470703, "StateBufferConnector_ms": 0.0018472671508789062, "ViewRequirementAgentConnector_ms": 0.0446622371673584}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9423120, "num_agent_steps_trained": 9423120, "num_env_steps_sampled": 9423120, "num_env_steps_trained": 9423120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.6898306874655, "num_env_steps_trained_throughput_per_sec": 716.6898306874655, "timesteps_total": 9423120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9423120, "timers": {"training_iteration_time_ms": 41931.494, "sample_time_ms": 41110.22, "load_time_ms": 14.972, "load_throughput": 2933565.49, "learn_time_ms": 805.447, "learn_throughput": 54528.721, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 9423120, "num_env_steps_trained": 9423120, "num_agent_steps_sampled": 9423120, "num_agent_steps_trained": 9423120}, "done": false, "episodes_total": 7667, "training_iteration": 1844, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-51-31", "timestamp": 1691301091, "time_this_iter_s": 61.28470492362976, "time_total_s": 26964.227605104446, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4684.611908912659, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 17.74137931034483, "ram_util_percent": 71.70804597701151}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.16829452292217, "policy_loss": -2034218.3080641855, "vf_loss": 4616689.889030612}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 81977.5, "diff_num_grad_updates_vs_sampler_policy": 81976.5}}, "num_env_steps_sampled": 9467040, "num_env_steps_trained": 9467040, "num_agent_steps_sampled": 9467040, "num_agent_steps_trained": 9467040}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154674.99011067953, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1336452569590593, "mean_inference_ms": 0.22827489401652354, "mean_action_processing_ms": 0.055844972472563044, "mean_env_wait_ms": 0.44278908772751224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025284290313720703, "StateBufferConnector_ms": 0.0018572807312011719, "ViewRequirementAgentConnector_ms": 0.044896602630615234}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154674.99011067953, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-156250.74196719506, -157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1336452569590593, "mean_inference_ms": 0.22827489401652354, "mean_action_processing_ms": 0.055844972472563044, "mean_env_wait_ms": 0.44278908772751224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025284290313720703, "StateBufferConnector_ms": 0.0018572807312011719, "ViewRequirementAgentConnector_ms": 0.044896602630615234}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9467040, "num_agent_steps_trained": 9467040, "num_env_steps_sampled": 9467040, "num_env_steps_trained": 9467040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 720.1166951785275, "num_env_steps_trained_throughput_per_sec": 720.1166951785275, "timesteps_total": 9467040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9467040, "timers": {"training_iteration_time_ms": 44141.998, "sample_time_ms": 43279.628, "load_time_ms": 15.362, "load_throughput": 2859073.644, "learn_time_ms": 846.138, "learn_throughput": 51906.419, "synch_weights_time_ms": 0.74}, "counters": {"num_env_steps_sampled": 9467040, "num_env_steps_trained": 9467040, "num_agent_steps_sampled": 9467040, "num_agent_steps_trained": 9467040}, "done": false, "episodes_total": 7668, "training_iteration": 1845, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-52-32", "timestamp": 1691301152, "time_this_iter_s": 60.99308180809021, "time_total_s": 27025.220686912537, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4745.604990720749, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 17.381609195402298, "ram_util_percent": 71.71034482758623}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.06729099284803, "policy_loss": -2084569.5753946109, "vf_loss": 4418227.271683673}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 82663.5, "diff_num_grad_updates_vs_sampler_policy": 82662.5}}, "num_env_steps_sampled": 9510960, "num_env_steps_trained": 9510960, "num_agent_steps_sampled": 9510960, "num_agent_steps_trained": 9510960}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154657.01648775852, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1336775836563353, "mean_inference_ms": 0.22832502257905193, "mean_action_processing_ms": 0.055857193394223896, "mean_env_wait_ms": 0.44286017396808647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002541780471801758, "StateBufferConnector_ms": 0.0018668174743652344, "ViewRequirementAgentConnector_ms": 0.045122385025024414}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154657.01648775852, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157033.54796157914, -156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1336775836563353, "mean_inference_ms": 0.22832502257905193, "mean_action_processing_ms": 0.055857193394223896, "mean_env_wait_ms": 0.44286017396808647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002541780471801758, "StateBufferConnector_ms": 0.0018668174743652344, "ViewRequirementAgentConnector_ms": 0.045122385025024414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9510960, "num_agent_steps_trained": 9510960, "num_env_steps_sampled": 9510960, "num_env_steps_trained": 9510960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.8148708155082, "num_env_steps_trained_throughput_per_sec": 714.8148708155082, "timesteps_total": 9510960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9510960, "timers": {"training_iteration_time_ms": 46406.602, "sample_time_ms": 45502.828, "load_time_ms": 15.879, "load_throughput": 2765969.296, "learn_time_ms": 887.005, "learn_throughput": 49514.913, "synch_weights_time_ms": 0.757}, "counters": {"num_env_steps_sampled": 9510960, "num_env_steps_trained": 9510960, "num_agent_steps_sampled": 9510960, "num_agent_steps_trained": 9510960}, "done": false, "episodes_total": 7669, "training_iteration": 1846, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-53-33", "timestamp": 1691301213, "time_this_iter_s": 61.44547986984253, "time_total_s": 27086.66616678238, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4807.050470590591, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 18.742528735632177, "ram_util_percent": 71.86436781609196}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0868991151148, "policy_loss": -2088929.5704690916, "vf_loss": 4494330.41226312}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 83349.5, "diff_num_grad_updates_vs_sampler_policy": 83348.5}}, "num_env_steps_sampled": 9554880, "num_env_steps_trained": 9554880, "num_agent_steps_sampled": 9554880, "num_agent_steps_trained": 9554880}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154640.84584169762, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1337160756651008, "mean_inference_ms": 0.22838584293308134, "mean_action_processing_ms": 0.055872072168745575, "mean_env_wait_ms": 0.4429528832674886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002552509307861328, "StateBufferConnector_ms": 0.0018699169158935547, "ViewRequirementAgentConnector_ms": 0.04530620574951172}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154640.84584169762, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-156174.6644830237, -154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1337160756651008, "mean_inference_ms": 0.22838584293308134, "mean_action_processing_ms": 0.055872072168745575, "mean_env_wait_ms": 0.4429528832674886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002552509307861328, "StateBufferConnector_ms": 0.0018699169158935547, "ViewRequirementAgentConnector_ms": 0.04530620574951172}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9554880, "num_agent_steps_trained": 9554880, "num_env_steps_sampled": 9554880, "num_env_steps_trained": 9554880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.844428017614, "num_env_steps_trained_throughput_per_sec": 715.844428017614, "timesteps_total": 9554880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9554880, "timers": {"training_iteration_time_ms": 48649.662, "sample_time_ms": 47704.38, "load_time_ms": 16.549, "load_throughput": 2653907.617, "learn_time_ms": 927.818, "learn_throughput": 47336.875, "synch_weights_time_ms": 0.777}, "counters": {"num_env_steps_sampled": 9554880, "num_env_steps_trained": 9554880, "num_agent_steps_sampled": 9554880, "num_agent_steps_trained": 9554880}, "done": false, "episodes_total": 7670, "training_iteration": 1847, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-54-34", "timestamp": 1691301274, "time_this_iter_s": 61.35723090171814, "time_total_s": 27148.023397684097, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4868.40770149231, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 17.500000000000004, "ram_util_percent": 71.74712643678161}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0408572983811, "policy_loss": -2150519.919568832, "vf_loss": 4345030.46018586}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 84035.5, "diff_num_grad_updates_vs_sampler_policy": 84034.5}}, "num_env_steps_sampled": 9598800, "num_env_steps_trained": 9598800, "num_agent_steps_sampled": 9598800, "num_agent_steps_trained": 9598800}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154617.37026313305, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13376114492767954, "mean_inference_ms": 0.22845689377860098, "mean_action_processing_ms": 0.055889534356915425, "mean_env_wait_ms": 0.4430675761054884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025603771209716797, "StateBufferConnector_ms": 0.0018775463104248047, "ViewRequirementAgentConnector_ms": 0.04550290107727051}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154617.37026313305, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154538.6380699484, -154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13376114492767954, "mean_inference_ms": 0.22845689377860098, "mean_action_processing_ms": 0.055889534356915425, "mean_env_wait_ms": 0.4430675761054884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025603771209716797, "StateBufferConnector_ms": 0.0018775463104248047, "ViewRequirementAgentConnector_ms": 0.04550290107727051}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9598800, "num_agent_steps_trained": 9598800, "num_env_steps_sampled": 9598800, "num_env_steps_trained": 9598800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.6346348683212, "num_env_steps_trained_throughput_per_sec": 716.6346348683212, "timesteps_total": 9598800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9598800, "timers": {"training_iteration_time_ms": 50869.143, "sample_time_ms": 49882.257, "load_time_ms": 17.133, "load_throughput": 2563538.582, "learn_time_ms": 968.813, "learn_throughput": 45333.831, "synch_weights_time_ms": 0.798}, "counters": {"num_env_steps_sampled": 9598800, "num_env_steps_trained": 9598800, "num_agent_steps_sampled": 9598800, "num_agent_steps_trained": 9598800}, "done": false, "episodes_total": 7671, "training_iteration": 1848, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-55-36", "timestamp": 1691301336, "time_this_iter_s": 61.289411306381226, "time_total_s": 27209.31280899048, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4929.697112798691, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 17.587209302325583, "ram_util_percent": 71.72558139534884}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.05645969935824, "policy_loss": -1985716.8223054847, "vf_loss": 4222425.570699709}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 84721.5, "diff_num_grad_updates_vs_sampler_policy": 84720.5}}, "num_env_steps_sampled": 9642720, "num_env_steps_trained": 9642720, "num_agent_steps_sampled": 9642720, "num_agent_steps_trained": 9642720}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154591.12255713082, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1338131175474718, "mean_inference_ms": 0.22853863097066351, "mean_action_processing_ms": 0.05590962280191545, "mean_env_wait_ms": 0.4432026712892162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002580881118774414, "StateBufferConnector_ms": 0.0018868446350097656, "ViewRequirementAgentConnector_ms": 0.04572892189025879}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154591.12255713082, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154889.69446916744, -156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1338131175474718, "mean_inference_ms": 0.22853863097066351, "mean_action_processing_ms": 0.05590962280191545, "mean_env_wait_ms": 0.4432026712892162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002580881118774414, "StateBufferConnector_ms": 0.0018868446350097656, "ViewRequirementAgentConnector_ms": 0.04572892189025879}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9642720, "num_agent_steps_trained": 9642720, "num_env_steps_sampled": 9642720, "num_env_steps_trained": 9642720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 710.6490513929423, "num_env_steps_trained_throughput_per_sec": 710.6490513929423, "timesteps_total": 9642720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9642720, "timers": {"training_iteration_time_ms": 53144.881, "sample_time_ms": 52116.588, "load_time_ms": 17.719, "load_throughput": 2478710.947, "learn_time_ms": 1009.605, "learn_throughput": 43502.158, "synch_weights_time_ms": 0.822}, "counters": {"num_env_steps_sampled": 9642720, "num_env_steps_trained": 9642720, "num_agent_steps_sampled": 9642720, "num_agent_steps_trained": 9642720}, "done": false, "episodes_total": 7672, "training_iteration": 1849, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-56-38", "timestamp": 1691301398, "time_this_iter_s": 61.80605387687683, "time_total_s": 27271.118862867355, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4991.503166675568, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 17.418181818181818, "ram_util_percent": 71.91590909090907}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.96227235488226, "policy_loss": -2072827.4139713922, "vf_loss": 4397397.659620991}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 85407.5, "diff_num_grad_updates_vs_sampler_policy": 85406.5}}, "num_env_steps_sampled": 9686640, "num_env_steps_trained": 9686640, "num_agent_steps_sampled": 9686640, "num_agent_steps_trained": 9686640}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154582.74080087667, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13387090716941935, "mean_inference_ms": 0.22862971730981407, "mean_action_processing_ms": 0.05593212204383046, "mean_env_wait_ms": 0.44335598425212913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002592325210571289, "StateBufferConnector_ms": 0.0018990039825439453, "ViewRequirementAgentConnector_ms": 0.04596066474914551}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154582.74080087667, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-156362.62420568516, -155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13387090716941935, "mean_inference_ms": 0.22862971730981407, "mean_action_processing_ms": 0.05593212204383046, "mean_env_wait_ms": 0.44335598425212913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002592325210571289, "StateBufferConnector_ms": 0.0018990039825439453, "ViewRequirementAgentConnector_ms": 0.04596066474914551}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9686640, "num_agent_steps_trained": 9686640, "num_env_steps_sampled": 9686640, "num_env_steps_trained": 9686640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 721.1663018982302, "num_env_steps_trained_throughput_per_sec": 721.1663018982302, "timesteps_total": 9686640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9686640, "timers": {"training_iteration_time_ms": 55328.98, "sample_time_ms": 54258.979, "load_time_ms": 18.2, "load_throughput": 2413228.947, "learn_time_ms": 1050.807, "learn_throughput": 41796.455, "synch_weights_time_ms": 0.843}, "counters": {"num_env_steps_sampled": 9686640, "num_env_steps_trained": 9686640, "num_agent_steps_sampled": 9686640, "num_agent_steps_trained": 9686640}, "done": false, "episodes_total": 7673, "training_iteration": 1850, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-57-39", "timestamp": 1691301459, "time_this_iter_s": 60.904316902160645, "time_total_s": 27332.023179769516, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5052.407483577728, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 17.624418604651165, "ram_util_percent": 71.88372093023254}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0388182704025, "policy_loss": -2271993.482162787, "vf_loss": 4458645.192875365}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 86093.5, "diff_num_grad_updates_vs_sampler_policy": 86092.5}}, "num_env_steps_sampled": 9730560, "num_env_steps_trained": 9730560, "num_agent_steps_sampled": 9730560, "num_agent_steps_trained": 9730560}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154572.93680665575, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13393466655437394, "mean_inference_ms": 0.22873084755606524, "mean_action_processing_ms": 0.05595710795863026, "mean_env_wait_ms": 0.4435287035599231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026063919067382812, "StateBufferConnector_ms": 0.0019147396087646484, "ViewRequirementAgentConnector_ms": 0.046213388442993164}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154572.93680665575, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155519.4958797421, -154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13393466655437394, "mean_inference_ms": 0.22873084755606524, "mean_action_processing_ms": 0.05595710795863026, "mean_env_wait_ms": 0.4435287035599231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026063919067382812, "StateBufferConnector_ms": 0.0019147396087646484, "ViewRequirementAgentConnector_ms": 0.046213388442993164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9730560, "num_agent_steps_trained": 9730560, "num_env_steps_sampled": 9730560, "num_env_steps_trained": 9730560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.7981689752493, "num_env_steps_trained_throughput_per_sec": 712.7981689752493, "timesteps_total": 9730560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9730560, "timers": {"training_iteration_time_ms": 57591.068, "sample_time_ms": 56480.737, "load_time_ms": 18.58, "load_throughput": 2363782.585, "learn_time_ms": 1090.718, "learn_throughput": 40267.067, "synch_weights_time_ms": 0.878}, "counters": {"num_env_steps_sampled": 9730560, "num_env_steps_trained": 9730560, "num_agent_steps_sampled": 9730560, "num_agent_steps_trained": 9730560}, "done": false, "episodes_total": 7674, "training_iteration": 1851, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-58-40", "timestamp": 1691301520, "time_this_iter_s": 61.61920785903931, "time_total_s": 27393.642387628555, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5114.026691436768, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 17.367816091954026, "ram_util_percent": 71.86896551724138}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.03971182153106, "policy_loss": -2210768.1149937934, "vf_loss": 4490576.224854227}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 86779.5, "diff_num_grad_updates_vs_sampler_policy": 86778.5}}, "num_env_steps_sampled": 9774480, "num_env_steps_trained": 9774480, "num_agent_steps_sampled": 9774480, "num_agent_steps_trained": 9774480}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154574.20899572887, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13400410207590135, "mean_inference_ms": 0.22884170010803978, "mean_action_processing_ms": 0.055984525742608066, "mean_env_wait_ms": 0.4437198832185527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002619504928588867, "StateBufferConnector_ms": 0.0019278526306152344, "ViewRequirementAgentConnector_ms": 0.04647970199584961}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154574.20899572887, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154090.26669688665, -152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13400410207590135, "mean_inference_ms": 0.22884170010803978, "mean_action_processing_ms": 0.055984525742608066, "mean_env_wait_ms": 0.4437198832185527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002619504928588867, "StateBufferConnector_ms": 0.0019278526306152344, "ViewRequirementAgentConnector_ms": 0.04647970199584961}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9774480, "num_agent_steps_trained": 9774480, "num_env_steps_sampled": 9774480, "num_env_steps_trained": 9774480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 718.2158331822022, "num_env_steps_trained_throughput_per_sec": 718.2158331822022, "timesteps_total": 9774480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9774480, "timers": {"training_iteration_time_ms": 59801.282, "sample_time_ms": 58653.687, "load_time_ms": 19.025, "load_throughput": 2308571.296, "learn_time_ms": 1127.516, "learn_throughput": 38952.886, "synch_weights_time_ms": 0.896}, "counters": {"num_env_steps_sampled": 9774480, "num_env_steps_trained": 9774480, "num_agent_steps_sampled": 9774480, "num_agent_steps_trained": 9774480}, "done": false, "episodes_total": 7675, "training_iteration": 1852, "trial_id": "5f2ac_00000", "date": "2023-08-06_08-59-41", "timestamp": 1691301581, "time_this_iter_s": 61.15503215789795, "time_total_s": 27454.797419786453, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5175.1817235946655, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 17.064367816091952, "ram_util_percent": 71.82758620689654}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.1493697541796, "policy_loss": -2295946.1476061405, "vf_loss": 4585307.941417638}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 87465.5, "diff_num_grad_updates_vs_sampler_policy": 87464.5}}, "num_env_steps_sampled": 9818400, "num_env_steps_trained": 9818400, "num_agent_steps_sampled": 9818400, "num_agent_steps_trained": 9818400}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154602.7360291889, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13407957972488238, "mean_inference_ms": 0.22896197510181474, "mean_action_processing_ms": 0.05601437424284673, "mean_env_wait_ms": 0.44392866075067217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002626180648803711, "StateBufferConnector_ms": 0.0019338130950927734, "ViewRequirementAgentConnector_ms": 0.04668378829956055}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154602.7360291889, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152902.36614940042, -154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13407957972488238, "mean_inference_ms": 0.22896197510181474, "mean_action_processing_ms": 0.05601437424284673, "mean_env_wait_ms": 0.44392866075067217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002626180648803711, "StateBufferConnector_ms": 0.0019338130950927734, "ViewRequirementAgentConnector_ms": 0.04668378829956055}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9818400, "num_agent_steps_trained": 9818400, "num_env_steps_sampled": 9818400, "num_env_steps_trained": 9818400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.2521928094363, "num_env_steps_trained_throughput_per_sec": 715.2521928094363, "timesteps_total": 9818400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9818400, "timers": {"training_iteration_time_ms": 61323.149, "sample_time_ms": 60176.443, "load_time_ms": 17.615, "load_throughput": 2493294.62, "learn_time_ms": 1128.05, "learn_throughput": 38934.44, "synch_weights_time_ms": 0.884}, "counters": {"num_env_steps_sampled": 9818400, "num_env_steps_trained": 9818400, "num_agent_steps_sampled": 9818400, "num_agent_steps_trained": 9818400}, "done": false, "episodes_total": 7676, "training_iteration": 1853, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-00-43", "timestamp": 1691301643, "time_this_iter_s": 61.407925844192505, "time_total_s": 27516.205345630646, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5236.589649438858, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 17.472413793103446, "ram_util_percent": 71.84482758620689}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.1404468325067, "policy_loss": -2049392.980423196, "vf_loss": 4498948.792000729}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 88151.5, "diff_num_grad_updates_vs_sampler_policy": 88150.5}}, "num_env_steps_sampled": 9862320, "num_env_steps_trained": 9862320, "num_agent_steps_sampled": 9862320, "num_agent_steps_trained": 9862320}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154627.92114089653, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13416053267126668, "mean_inference_ms": 0.2290910666172552, "mean_action_processing_ms": 0.056046536132821484, "mean_env_wait_ms": 0.4441540343754999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026509761810302734, "StateBufferConnector_ms": 0.0019428730010986328, "ViewRequirementAgentConnector_ms": 0.046912431716918945}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154627.92114089653, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154492.64270106534, -153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13416053267126668, "mean_inference_ms": 0.2290910666172552, "mean_action_processing_ms": 0.056046536132821484, "mean_env_wait_ms": 0.4441540343754999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026509761810302734, "StateBufferConnector_ms": 0.0019428730010986328, "ViewRequirementAgentConnector_ms": 0.046912431716918945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9862320, "num_agent_steps_trained": 9862320, "num_env_steps_sampled": 9862320, "num_env_steps_trained": 9862320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.9892814192799, "num_env_steps_trained_throughput_per_sec": 714.9892814192799, "timesteps_total": 9862320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9862320, "timers": {"training_iteration_time_ms": 61337.724, "sample_time_ms": 60188.491, "load_time_ms": 17.471, "load_throughput": 2513886.497, "learn_time_ms": 1130.706, "learn_throughput": 38842.983, "synch_weights_time_ms": 0.899}, "counters": {"num_env_steps_sampled": 9862320, "num_env_steps_trained": 9862320, "num_agent_steps_sampled": 9862320, "num_agent_steps_trained": 9862320}, "done": false, "episodes_total": 7677, "training_iteration": 1854, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-01-44", "timestamp": 1691301704, "time_this_iter_s": 61.430583238601685, "time_total_s": 27577.635928869247, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5298.02023267746, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 17.948275862068964, "ram_util_percent": 71.86896551724135}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.08763932208626, "policy_loss": -2068882.8000409985, "vf_loss": 4687441.014121721}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 88837.5, "diff_num_grad_updates_vs_sampler_policy": 88836.5}}, "num_env_steps_sampled": 9906240, "num_env_steps_trained": 9906240, "num_agent_steps_sampled": 9906240, "num_agent_steps_trained": 9906240}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154664.4444963874, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1342471256061889, "mean_inference_ms": 0.22922952310076222, "mean_action_processing_ms": 0.056081023496436684, "mean_env_wait_ms": 0.4443952571472813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002657651901245117, "StateBufferConnector_ms": 0.0019519329071044922, "ViewRequirementAgentConnector_ms": 0.047113895416259766}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154664.4444963874, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-153357.05521874563, -152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1342471256061889, "mean_inference_ms": 0.22922952310076222, "mean_action_processing_ms": 0.056081023496436684, "mean_env_wait_ms": 0.4443952571472813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002657651901245117, "StateBufferConnector_ms": 0.0019519329071044922, "ViewRequirementAgentConnector_ms": 0.047113895416259766}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9906240, "num_agent_steps_trained": 9906240, "num_env_steps_sampled": 9906240, "num_env_steps_trained": 9906240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.9094568762754, "num_env_steps_trained_throughput_per_sec": 715.9094568762754, "timesteps_total": 9906240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9906240, "timers": {"training_iteration_time_ms": 61373.566, "sample_time_ms": 60219.433, "load_time_ms": 17.532, "load_throughput": 2505138.162, "learn_time_ms": 1135.539, "learn_throughput": 38677.662, "synch_weights_time_ms": 0.901}, "counters": {"num_env_steps_sampled": 9906240, "num_env_steps_trained": 9906240, "num_agent_steps_sampled": 9906240, "num_agent_steps_trained": 9906240}, "done": false, "episodes_total": 7678, "training_iteration": 1855, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-02-46", "timestamp": 1691301766, "time_this_iter_s": 61.351298093795776, "time_total_s": 27638.987226963043, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5359.3715307712555, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 17.376744186046512, "ram_util_percent": 71.86627906976743}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.375000000000002e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.956921991732, "policy_loss": -1956324.933240707, "vf_loss": 4258357.63101312}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 89523.5, "diff_num_grad_updates_vs_sampler_policy": 89522.5}}, "num_env_steps_sampled": 9950160, "num_env_steps_trained": 9950160, "num_agent_steps_sampled": 9950160, "num_agent_steps_trained": 9950160}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154657.59230327324, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1343395240467922, "mean_inference_ms": 0.2293773460530312, "mean_action_processing_ms": 0.056117834904018615, "mean_env_wait_ms": 0.44465319079711463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026674270629882812, "StateBufferConnector_ms": 0.0019567012786865234, "ViewRequirementAgentConnector_ms": 0.047341108322143555}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154657.59230327324, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152692.75873035644, -156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1343395240467922, "mean_inference_ms": 0.2293773460530312, "mean_action_processing_ms": 0.056117834904018615, "mean_env_wait_ms": 0.44465319079711463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026674270629882812, "StateBufferConnector_ms": 0.0019567012786865234, "ViewRequirementAgentConnector_ms": 0.047341108322143555}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9950160, "num_agent_steps_trained": 9950160, "num_env_steps_sampled": 9950160, "num_env_steps_trained": 9950160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 711.6304936545, "num_env_steps_trained_throughput_per_sec": 711.6304936545, "timesteps_total": 9950160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9950160, "timers": {"training_iteration_time_ms": 61401.06, "sample_time_ms": 60246.272, "load_time_ms": 17.566, "load_throughput": 2500330.253, "learn_time_ms": 1136.155, "learn_throughput": 38656.705, "synch_weights_time_ms": 0.907}, "counters": {"num_env_steps_sampled": 9950160, "num_env_steps_trained": 9950160, "num_agent_steps_sampled": 9950160, "num_agent_steps_trained": 9950160}, "done": false, "episodes_total": 7679, "training_iteration": 1856, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-03-47", "timestamp": 1691301827, "time_this_iter_s": 61.720266819000244, "time_total_s": 27700.707493782043, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5421.091797590256, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 17.718181818181822, "ram_util_percent": 71.83181818181819}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.750000000000001e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.22186475036443, "policy_loss": -2239851.0910737063, "vf_loss": 4630372.719569971}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 90209.5, "diff_num_grad_updates_vs_sampler_policy": 90208.5}}, "num_env_steps_sampled": 9994080, "num_env_steps_trained": 9994080, "num_agent_steps_sampled": 9994080, "num_agent_steps_trained": 9994080}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154709.00945142924, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13443744571541535, "mean_inference_ms": 0.22953407976888823, "mean_action_processing_ms": 0.05615694262236482, "mean_env_wait_ms": 0.44492641292547774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026760101318359375, "StateBufferConnector_ms": 0.001963376998901367, "ViewRequirementAgentConnector_ms": 0.04755091667175293}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154709.00945142924, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-156592.53167054275, -151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13443744571541535, "mean_inference_ms": 0.22953407976888823, "mean_action_processing_ms": 0.05615694262236482, "mean_env_wait_ms": 0.44492641292547774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026760101318359375, "StateBufferConnector_ms": 0.001963376998901367, "ViewRequirementAgentConnector_ms": 0.04755091667175293}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9994080, "num_agent_steps_trained": 9994080, "num_env_steps_sampled": 9994080, "num_env_steps_trained": 9994080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 719.5655594063875, "num_env_steps_trained_throughput_per_sec": 719.5655594063875, "timesteps_total": 9994080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 9994080, "timers": {"training_iteration_time_ms": 61369.332, "sample_time_ms": 60214.563, "load_time_ms": 17.369, "load_throughput": 2528572.393, "learn_time_ms": 1136.319, "learn_throughput": 38651.102, "synch_weights_time_ms": 0.919}, "counters": {"num_env_steps_sampled": 9994080, "num_env_steps_trained": 9994080, "num_agent_steps_sampled": 9994080, "num_agent_steps_trained": 9994080}, "done": false, "episodes_total": 7680, "training_iteration": 1857, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-04-48", "timestamp": 1691301888, "time_this_iter_s": 61.039742946624756, "time_total_s": 27761.74723672867, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5482.1315405368805, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 17.53488372093023, "ram_util_percent": 71.81511627906976}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.125000000000004e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.82604282034384, "policy_loss": -2115180.75875205, "vf_loss": 4391041.763119534}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 90895.5, "diff_num_grad_updates_vs_sampler_policy": 90894.5}}, "num_env_steps_sampled": 10038000, "num_env_steps_trained": 10038000, "num_agent_steps_sampled": 10038000, "num_agent_steps_trained": 10038000}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154689.6646903424, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13454073073030398, "mean_inference_ms": 0.2296997526855046, "mean_action_processing_ms": 0.056198284284476534, "mean_env_wait_ms": 0.4452155977387573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026826858520507812, "StateBufferConnector_ms": 0.001974344253540039, "ViewRequirementAgentConnector_ms": 0.047757863998413086}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154689.6646903424, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-151154.697882324, -152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13454073073030398, "mean_inference_ms": 0.2296997526855046, "mean_action_processing_ms": 0.056198284284476534, "mean_env_wait_ms": 0.4452155977387573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026826858520507812, "StateBufferConnector_ms": 0.001974344253540039, "ViewRequirementAgentConnector_ms": 0.047757863998413086}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10038000, "num_agent_steps_trained": 10038000, "num_env_steps_sampled": 10038000, "num_env_steps_trained": 10038000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.4413329760359, "num_env_steps_trained_throughput_per_sec": 712.4413329760359, "timesteps_total": 10038000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10038000, "timers": {"training_iteration_time_ms": 61405.404, "sample_time_ms": 60250.723, "load_time_ms": 17.247, "load_throughput": 2546514.381, "learn_time_ms": 1136.354, "learn_throughput": 38649.916, "synch_weights_time_ms": 0.918}, "counters": {"num_env_steps_sampled": 10038000, "num_env_steps_trained": 10038000, "num_agent_steps_sampled": 10038000, "num_agent_steps_trained": 10038000}, "done": false, "episodes_total": 7681, "training_iteration": 1858, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-05-50", "timestamp": 1691301950, "time_this_iter_s": 61.65024995803833, "time_total_s": 27823.397486686707, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5543.781790494919, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 17.455172413793104, "ram_util_percent": 71.78160919540231}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.5e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.92369297572543, "policy_loss": -2040583.5571758838, "vf_loss": 4292436.217383382}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 91581.5, "diff_num_grad_updates_vs_sampler_policy": 91580.5}}, "num_env_steps_sampled": 10081920, "num_env_steps_trained": 10081920, "num_agent_steps_sampled": 10081920, "num_agent_steps_trained": 10081920}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154709.0042246046, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1346493392495289, "mean_inference_ms": 0.22987385295857854, "mean_action_processing_ms": 0.05624181244678758, "mean_env_wait_ms": 0.44551958974778905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002694845199584961, "StateBufferConnector_ms": 0.001986980438232422, "ViewRequirementAgentConnector_ms": 0.04797673225402832}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154709.0042246046, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152271.59676896603, -156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1346493392495289, "mean_inference_ms": 0.22987385295857854, "mean_action_processing_ms": 0.05624181244678758, "mean_env_wait_ms": 0.44551958974778905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002694845199584961, "StateBufferConnector_ms": 0.001986980438232422, "ViewRequirementAgentConnector_ms": 0.04797673225402832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10081920, "num_agent_steps_trained": 10081920, "num_env_steps_sampled": 10081920, "num_env_steps_trained": 10081920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.2032701346437, "num_env_steps_trained_throughput_per_sec": 714.2032701346437, "timesteps_total": 10081920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10081920, "timers": {"training_iteration_time_ms": 61374.648, "sample_time_ms": 60220.57, "load_time_ms": 17.006, "load_throughput": 2582633.607, "learn_time_ms": 1135.995, "learn_throughput": 38662.139, "synch_weights_time_ms": 0.916}, "counters": {"num_env_steps_sampled": 10081920, "num_env_steps_trained": 10081920, "num_agent_steps_sampled": 10081920, "num_agent_steps_trained": 10081920}, "done": false, "episodes_total": 7682, "training_iteration": 1859, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-06-52", "timestamp": 1691302012, "time_this_iter_s": 61.49812912940979, "time_total_s": 27884.895615816116, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5605.279919624329, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 17.47701149425287, "ram_util_percent": 71.79999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.875e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.941584195062, "policy_loss": -1929789.7057329628, "vf_loss": 4294015.588101312}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 92267.5, "diff_num_grad_updates_vs_sampler_policy": 92266.5}}, "num_env_steps_sampled": 10125840, "num_env_steps_trained": 10125840, "num_agent_steps_sampled": 10125840, "num_agent_steps_trained": 10125840}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154714.8769556866, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13476333623002518, "mean_inference_ms": 0.2300563923007436, "mean_action_processing_ms": 0.05628752428538733, "mean_env_wait_ms": 0.44583920671091576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002706289291381836, "StateBufferConnector_ms": 0.0019960403442382812, "ViewRequirementAgentConnector_ms": 0.048169612884521484}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154714.8769556866, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-156213.33820918246, -156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13476333623002518, "mean_inference_ms": 0.2300563923007436, "mean_action_processing_ms": 0.05628752428538733, "mean_env_wait_ms": 0.44583920671091576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002706289291381836, "StateBufferConnector_ms": 0.0019960403442382812, "ViewRequirementAgentConnector_ms": 0.048169612884521484}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10125840, "num_agent_steps_trained": 10125840, "num_env_steps_sampled": 10125840, "num_env_steps_trained": 10125840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.0302246432989, "num_env_steps_trained_throughput_per_sec": 715.0302246432989, "timesteps_total": 10125840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10125840, "timers": {"training_iteration_time_ms": 61426.91, "sample_time_ms": 60273.569, "load_time_ms": 17.039, "load_throughput": 2577556.398, "learn_time_ms": 1135.222, "learn_throughput": 38688.459, "synch_weights_time_ms": 0.919}, "counters": {"num_env_steps_sampled": 10125840, "num_env_steps_trained": 10125840, "num_agent_steps_sampled": 10125840, "num_agent_steps_trained": 10125840}, "done": false, "episodes_total": 7683, "training_iteration": 1860, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-07-53", "timestamp": 1691302073, "time_this_iter_s": 61.42718291282654, "time_total_s": 27946.322798728943, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5666.707102537155, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 17.506896551724136, "ram_util_percent": 71.83103448275864}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.250000000000002e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0892371352838, "policy_loss": -2087381.027965846, "vf_loss": 4430913.73159621}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 92953.5, "diff_num_grad_updates_vs_sampler_policy": 92952.5}}, "num_env_steps_sampled": 10169760, "num_env_steps_trained": 10169760, "num_agent_steps_sampled": 10169760, "num_agent_steps_trained": 10169760}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154701.5071375487, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13488283468907042, "mean_inference_ms": 0.23024746127214665, "mean_action_processing_ms": 0.05633535446791959, "mean_env_wait_ms": 0.4461736813455009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027184486389160156, "StateBufferConnector_ms": 0.0020020008087158203, "ViewRequirementAgentConnector_ms": 0.04837298393249512}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154701.5071375487, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-156089.15949433247, -155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13488283468907042, "mean_inference_ms": 0.23024746127214665, "mean_action_processing_ms": 0.05633535446791959, "mean_env_wait_ms": 0.4461736813455009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027184486389160156, "StateBufferConnector_ms": 0.0020020008087158203, "ViewRequirementAgentConnector_ms": 0.04837298393249512}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10169760, "num_agent_steps_trained": 10169760, "num_env_steps_sampled": 10169760, "num_env_steps_trained": 10169760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.8943554736437, "num_env_steps_trained_throughput_per_sec": 714.8943554736437, "timesteps_total": 10169760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10169760, "timers": {"training_iteration_time_ms": 61408.843, "sample_time_ms": 60254.903, "load_time_ms": 17.141, "load_throughput": 2562265.636, "learn_time_ms": 1135.722, "learn_throughput": 38671.445, "synch_weights_time_ms": 0.917}, "counters": {"num_env_steps_sampled": 10169760, "num_env_steps_trained": 10169760, "num_agent_steps_sampled": 10169760, "num_agent_steps_trained": 10169760}, "done": false, "episodes_total": 7684, "training_iteration": 1861, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-08-55", "timestamp": 1691302135, "time_this_iter_s": 61.438936948776245, "time_total_s": 28007.76173567772, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5728.146039485931, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 17.775, "ram_util_percent": 71.78977272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.624999999999999e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.14973084919654, "policy_loss": -2013679.9154476244, "vf_loss": 4416078.991526968}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 93639.5, "diff_num_grad_updates_vs_sampler_policy": 93638.5}}, "num_env_steps_sampled": 10213680, "num_env_steps_trained": 10213680, "num_agent_steps_sampled": 10213680, "num_agent_steps_trained": 10213680}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154682.2633777334, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13500762073171374, "mean_inference_ms": 0.23044690265354606, "mean_action_processing_ms": 0.05638531094543346, "mean_env_wait_ms": 0.44652309327232464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027282238006591797, "StateBufferConnector_ms": 0.0020089149475097656, "ViewRequirementAgentConnector_ms": 0.04858231544494629}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154682.2633777334, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155571.64726166028, -149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13500762073171374, "mean_inference_ms": 0.23044690265354606, "mean_action_processing_ms": 0.05638531094543346, "mean_env_wait_ms": 0.44652309327232464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027282238006591797, "StateBufferConnector_ms": 0.0020089149475097656, "ViewRequirementAgentConnector_ms": 0.04858231544494629}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10213680, "num_agent_steps_trained": 10213680, "num_env_steps_sampled": 10213680, "num_env_steps_trained": 10213680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 719.5232745196907, "num_env_steps_trained_throughput_per_sec": 719.5232745196907, "timesteps_total": 10213680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10213680, "timers": {"training_iteration_time_ms": 61397.732, "sample_time_ms": 60243.887, "load_time_ms": 17.107, "load_throughput": 2567372.177, "learn_time_ms": 1135.654, "learn_throughput": 38673.75, "synch_weights_time_ms": 0.925}, "counters": {"num_env_steps_sampled": 10213680, "num_env_steps_trained": 10213680, "num_agent_steps_sampled": 10213680, "num_agent_steps_trained": 10213680}, "done": false, "episodes_total": 7685, "training_iteration": 1862, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-09-56", "timestamp": 1691302196, "time_this_iter_s": 61.04337191581726, "time_total_s": 28068.805107593536, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5789.189411401749, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 17.32906976744186, "ram_util_percent": 71.81860465116281}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9657221313121, "policy_loss": -2337578.5476266397, "vf_loss": 4621266.447612974}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 94325.5, "diff_num_grad_updates_vs_sampler_policy": 94324.5}}, "num_env_steps_sampled": 10257600, "num_env_steps_trained": 10257600, "num_agent_steps_sampled": 10257600, "num_agent_steps_trained": 10257600}, "sampler_results": {"episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154703.18096583209, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13513727120995647, "mean_inference_ms": 0.23065465339771166, "mean_action_processing_ms": 0.05643739449227463, "mean_env_wait_ms": 0.4468877846084664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027451515197753906, "StateBufferConnector_ms": 0.0020198822021484375, "ViewRequirementAgentConnector_ms": 0.04885363578796387}}, "episode_reward_max": -149305.21218652598, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154703.18096583209, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149305.21218652598, -153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13513727120995647, "mean_inference_ms": 0.23065465339771166, "mean_action_processing_ms": 0.05643739449227463, "mean_env_wait_ms": 0.4468877846084664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027451515197753906, "StateBufferConnector_ms": 0.0020198822021484375, "ViewRequirementAgentConnector_ms": 0.04885363578796387}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10257600, "num_agent_steps_trained": 10257600, "num_env_steps_sampled": 10257600, "num_env_steps_trained": 10257600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.6983698608701, "num_env_steps_trained_throughput_per_sec": 712.6983698608701, "timesteps_total": 10257600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10257600, "timers": {"training_iteration_time_ms": 61419.735, "sample_time_ms": 60265.322, "load_time_ms": 17.262, "load_throughput": 2544365.34, "learn_time_ms": 1136.055, "learn_throughput": 38660.103, "synch_weights_time_ms": 0.938}, "counters": {"num_env_steps_sampled": 10257600, "num_env_steps_trained": 10257600, "num_agent_steps_sampled": 10257600, "num_agent_steps_trained": 10257600}, "done": false, "episodes_total": 7686, "training_iteration": 1863, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-10-57", "timestamp": 1691302257, "time_this_iter_s": 61.627989053726196, "time_total_s": 28130.433096647263, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5850.817400455475, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 17.217241379310344, "ram_util_percent": 71.85747126436782}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.02990936190326, "policy_loss": -2071356.851442921, "vf_loss": 4419510.91909621}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 95011.5, "diff_num_grad_updates_vs_sampler_policy": 95010.5}}, "num_env_steps_sampled": 10301520, "num_env_steps_trained": 10301520, "num_agent_steps_sampled": 10301520, "num_agent_steps_trained": 10301520}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154758.4850647664, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13527215614373678, "mean_inference_ms": 0.23087052615871026, "mean_action_processing_ms": 0.05649155937546469, "mean_env_wait_ms": 0.44726702900858306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00275421142578125, "StateBufferConnector_ms": 0.0020318031311035156, "ViewRequirementAgentConnector_ms": 0.04907369613647461}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154758.4850647664, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-153802.7938972239, -157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13527215614373678, "mean_inference_ms": 0.23087052615871026, "mean_action_processing_ms": 0.05649155937546469, "mean_env_wait_ms": 0.44726702900858306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00275421142578125, "StateBufferConnector_ms": 0.0020318031311035156, "ViewRequirementAgentConnector_ms": 0.04907369613647461}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10301520, "num_agent_steps_trained": 10301520, "num_env_steps_sampled": 10301520, "num_env_steps_trained": 10301520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.3117505371308, "num_env_steps_trained_throughput_per_sec": 715.3117505371308, "timesteps_total": 10301520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10301520, "timers": {"training_iteration_time_ms": 61416.965, "sample_time_ms": 60263.21, "load_time_ms": 17.033, "load_throughput": 2578559.414, "learn_time_ms": 1135.642, "learn_throughput": 38674.164, "synch_weights_time_ms": 0.921}, "counters": {"num_env_steps_sampled": 10301520, "num_env_steps_trained": 10301520, "num_agent_steps_sampled": 10301520, "num_agent_steps_trained": 10301520}, "done": false, "episodes_total": 7687, "training_iteration": 1864, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-11-59", "timestamp": 1691302319, "time_this_iter_s": 61.40316104888916, "time_total_s": 28191.83625769615, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5912.220561504364, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 18.386206896551723, "ram_util_percent": 71.81954022988504}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9770302730816, "policy_loss": -1796588.1782468567, "vf_loss": 4365531.986516035}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 95697.5, "diff_num_grad_updates_vs_sampler_policy": 95696.5}}, "num_env_steps_sampled": 10345440, "num_env_steps_trained": 10345440, "num_agent_steps_sampled": 10345440, "num_agent_steps_trained": 10345440}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154754.96300416184, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13541247222546074, "mean_inference_ms": 0.23109441170289424, "mean_action_processing_ms": 0.056547740220818925, "mean_env_wait_ms": 0.44766123615724646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027625560760498047, "StateBufferConnector_ms": 0.0020411014556884766, "ViewRequirementAgentConnector_ms": 0.04927349090576172}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154754.96300416184, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157441.79959989197, -153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13541247222546074, "mean_inference_ms": 0.23109441170289424, "mean_action_processing_ms": 0.056547740220818925, "mean_env_wait_ms": 0.44766123615724646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027625560760498047, "StateBufferConnector_ms": 0.0020411014556884766, "ViewRequirementAgentConnector_ms": 0.04927349090576172}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10345440, "num_agent_steps_trained": 10345440, "num_env_steps_sampled": 10345440, "num_env_steps_trained": 10345440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.6508216381907, "num_env_steps_trained_throughput_per_sec": 716.6508216381907, "timesteps_total": 10345440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10345440, "timers": {"training_iteration_time_ms": 61410.619, "sample_time_ms": 60255.152, "load_time_ms": 16.953, "load_throughput": 2590682.284, "learn_time_ms": 1137.422, "learn_throughput": 38613.648, "synch_weights_time_ms": 0.932}, "counters": {"num_env_steps_sampled": 10345440, "num_env_steps_trained": 10345440, "num_agent_steps_sampled": 10345440, "num_agent_steps_trained": 10345440}, "done": false, "episodes_total": 7688, "training_iteration": 1865, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-13-00", "timestamp": 1691302380, "time_this_iter_s": 61.28832411766052, "time_total_s": 28253.124581813812, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5973.5088856220245, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 17.404597701149427, "ram_util_percent": 71.76781609195403}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.92973563413926, "policy_loss": -2249915.6879882812, "vf_loss": 4247882.586188046}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 96383.5, "diff_num_grad_updates_vs_sampler_policy": 96382.5}}, "num_env_steps_sampled": 10389360, "num_env_steps_trained": 10389360, "num_agent_steps_sampled": 10389360, "num_agent_steps_trained": 10389360}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154706.9373499075, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13555767799803056, "mean_inference_ms": 0.23132578050552277, "mean_action_processing_ms": 0.056605904363034656, "mean_env_wait_ms": 0.44806942916567677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002777099609375, "StateBufferConnector_ms": 0.002052783966064453, "ViewRequirementAgentConnector_ms": 0.04948592185974121}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154706.9373499075, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-153911.9887912703, -159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13555767799803056, "mean_inference_ms": 0.23132578050552277, "mean_action_processing_ms": 0.056605904363034656, "mean_env_wait_ms": 0.44806942916567677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002777099609375, "StateBufferConnector_ms": 0.002052783966064453, "ViewRequirementAgentConnector_ms": 0.04948592185974121}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10389360, "num_agent_steps_trained": 10389360, "num_env_steps_sampled": 10389360, "num_env_steps_trained": 10389360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.533512787731, "num_env_steps_trained_throughput_per_sec": 715.533512787731, "timesteps_total": 10389360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10389360, "timers": {"training_iteration_time_ms": 61376.954, "sample_time_ms": 60223.726, "load_time_ms": 16.687, "load_throughput": 2631911.917, "learn_time_ms": 1135.441, "learn_throughput": 38681.017, "synch_weights_time_ms": 0.939}, "counters": {"num_env_steps_sampled": 10389360, "num_env_steps_trained": 10389360, "num_agent_steps_sampled": 10389360, "num_agent_steps_trained": 10389360}, "done": false, "episodes_total": 7689, "training_iteration": 1866, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-14-01", "timestamp": 1691302441, "time_this_iter_s": 61.383689165115356, "time_total_s": 28314.508270978928, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6034.89257478714, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 17.264367816091955, "ram_util_percent": 71.76321839080458}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0131912009014, "policy_loss": -2133338.14664239, "vf_loss": 4479575.588465744}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 97069.5, "diff_num_grad_updates_vs_sampler_policy": 97068.5}}, "num_env_steps_sampled": 10433280, "num_env_steps_trained": 10433280, "num_agent_steps_sampled": 10433280, "num_agent_steps_trained": 10433280}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154724.73949381482, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1357076253379871, "mean_inference_ms": 0.2315647837662013, "mean_action_processing_ms": 0.056665998124924254, "mean_env_wait_ms": 0.4484911924757396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027887821197509766, "StateBufferConnector_ms": 0.002062082290649414, "ViewRequirementAgentConnector_ms": 0.04969525337219238}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154724.73949381482, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-159491.04403766844, -158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1357076253379871, "mean_inference_ms": 0.2315647837662013, "mean_action_processing_ms": 0.056665998124924254, "mean_env_wait_ms": 0.4484911924757396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027887821197509766, "StateBufferConnector_ms": 0.002062082290649414, "ViewRequirementAgentConnector_ms": 0.04969525337219238}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10433280, "num_agent_steps_trained": 10433280, "num_env_steps_sampled": 10433280, "num_env_steps_trained": 10433280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.0492136090211, "num_env_steps_trained_throughput_per_sec": 716.0492136090211, "timesteps_total": 10433280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10433280, "timers": {"training_iteration_time_ms": 61406.928, "sample_time_ms": 60254.425, "load_time_ms": 16.678, "load_throughput": 2633424.42, "learn_time_ms": 1134.728, "learn_throughput": 38705.302, "synch_weights_time_ms": 0.936}, "counters": {"num_env_steps_sampled": 10433280, "num_env_steps_trained": 10433280, "num_agent_steps_sampled": 10433280, "num_agent_steps_trained": 10433280}, "done": false, "episodes_total": 7690, "training_iteration": 1867, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-15-03", "timestamp": 1691302503, "time_this_iter_s": 61.33935904502869, "time_total_s": 28375.847630023956, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6096.231933832169, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 17.460465116279067, "ram_util_percent": 71.78488372093024}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.05386009994817, "policy_loss": -2216390.823393085, "vf_loss": 4579930.725400874}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 97755.5, "diff_num_grad_updates_vs_sampler_policy": 97754.5}}, "num_env_steps_sampled": 10477200, "num_env_steps_trained": 10477200, "num_agent_steps_sampled": 10477200, "num_agent_steps_trained": 10477200}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154700.16492437618, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1358622597479806, "mean_inference_ms": 0.23181148630582576, "mean_action_processing_ms": 0.056728038253300674, "mean_env_wait_ms": 0.4489289419862365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028123855590820312, "StateBufferConnector_ms": 0.0020661354064941406, "ViewRequirementAgentConnector_ms": 0.04991340637207031}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154700.16492437618, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-158413.24493133937, -158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1358622597479806, "mean_inference_ms": 0.23181148630582576, "mean_action_processing_ms": 0.056728038253300674, "mean_env_wait_ms": 0.4489289419862365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028123855590820312, "StateBufferConnector_ms": 0.0020661354064941406, "ViewRequirementAgentConnector_ms": 0.04991340637207031}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10477200, "num_agent_steps_trained": 10477200, "num_env_steps_sampled": 10477200, "num_env_steps_trained": 10477200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.3817634704396, "num_env_steps_trained_throughput_per_sec": 716.3817634704396, "timesteps_total": 10477200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10477200, "timers": {"training_iteration_time_ms": 61373.019, "sample_time_ms": 60220.993, "load_time_ms": 16.678, "load_throughput": 2633473.36, "learn_time_ms": 1134.256, "learn_throughput": 38721.415, "synch_weights_time_ms": 0.933}, "counters": {"num_env_steps_sampled": 10477200, "num_env_steps_trained": 10477200, "num_agent_steps_sampled": 10477200, "num_agent_steps_trained": 10477200}, "done": false, "episodes_total": 7691, "training_iteration": 1868, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-16-04", "timestamp": 1691302564, "time_this_iter_s": 61.31098198890686, "time_total_s": 28437.158612012863, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6157.542915821075, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 17.848275862068967, "ram_util_percent": 71.75402298850577}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.8017587022253, "policy_loss": -2075015.335464878, "vf_loss": 4201708.379099854}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 98441.5, "diff_num_grad_updates_vs_sampler_policy": 98440.5}}, "num_env_steps_sampled": 10521120, "num_env_steps_trained": 10521120, "num_agent_steps_sampled": 10521120, "num_agent_steps_trained": 10521120}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154634.58115076146, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1360215174518124, "mean_inference_ms": 0.2320657083844489, "mean_action_processing_ms": 0.056792009558702554, "mean_env_wait_ms": 0.44938188292160397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028219223022460938, "StateBufferConnector_ms": 0.0020737648010253906, "ViewRequirementAgentConnector_ms": 0.05012154579162598}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154634.58115076146, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-158240.58365321162, -154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1360215174518124, "mean_inference_ms": 0.2320657083844489, "mean_action_processing_ms": 0.056792009558702554, "mean_env_wait_ms": 0.44938188292160397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028219223022460938, "StateBufferConnector_ms": 0.0020737648010253906, "ViewRequirementAgentConnector_ms": 0.05012154579162598}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10521120, "num_agent_steps_trained": 10521120, "num_env_steps_sampled": 10521120, "num_env_steps_trained": 10521120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.6848200956294, "num_env_steps_trained_throughput_per_sec": 715.6848200956294, "timesteps_total": 10521120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10521120, "timers": {"training_iteration_time_ms": 61360.289, "sample_time_ms": 60207.715, "load_time_ms": 16.703, "load_throughput": 2629530.056, "learn_time_ms": 1134.773, "learn_throughput": 38703.784, "synch_weights_time_ms": 0.939}, "counters": {"num_env_steps_sampled": 10521120, "num_env_steps_trained": 10521120, "num_agent_steps_sampled": 10521120, "num_agent_steps_trained": 10521120}, "done": false, "episodes_total": 7692, "training_iteration": 1869, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-17-06", "timestamp": 1691302626, "time_this_iter_s": 61.37131595611572, "time_total_s": 28498.52992796898, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6218.914231777191, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 18.77241379310345, "ram_util_percent": 71.36551724137932}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.2295681255552, "policy_loss": -1748108.3477473578, "vf_loss": 4514723.722849854}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 99127.5, "diff_num_grad_updates_vs_sampler_policy": 99126.5}}, "num_env_steps_sampled": 10565040, "num_env_steps_trained": 10565040, "num_agent_steps_sampled": 10565040, "num_agent_steps_trained": 10565040}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154607.2807882987, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13618532247455473, "mean_inference_ms": 0.2323271394420579, "mean_action_processing_ms": 0.05685782080918208, "mean_env_wait_ms": 0.44984796976725167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028257369995117188, "StateBufferConnector_ms": 0.0020809173583984375, "ViewRequirementAgentConnector_ms": 0.05026865005493164}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154607.2807882987, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154903.63872993554, -153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13618532247455473, "mean_inference_ms": 0.2323271394420579, "mean_action_processing_ms": 0.05685782080918208, "mean_env_wait_ms": 0.44984796976725167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028257369995117188, "StateBufferConnector_ms": 0.0020809173583984375, "ViewRequirementAgentConnector_ms": 0.05026865005493164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10565040, "num_agent_steps_trained": 10565040, "num_env_steps_sampled": 10565040, "num_env_steps_trained": 10565040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 720.2061229977705, "num_env_steps_trained_throughput_per_sec": 720.2061229977705, "timesteps_total": 10565040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10565040, "timers": {"training_iteration_time_ms": 61316.146, "sample_time_ms": 60162.801, "load_time_ms": 16.666, "load_throughput": 2635255.29, "learn_time_ms": 1135.58, "learn_throughput": 38676.276, "synch_weights_time_ms": 0.938}, "counters": {"num_env_steps_sampled": 10565040, "num_env_steps_trained": 10565040, "num_agent_steps_sampled": 10565040, "num_agent_steps_trained": 10565040}, "done": false, "episodes_total": 7693, "training_iteration": 1870, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-18-07", "timestamp": 1691302687, "time_this_iter_s": 60.98562502861023, "time_total_s": 28559.51555299759, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6279.899856805801, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 17.12093023255814, "ram_util_percent": 71.60348837209304}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.00654192777137, "policy_loss": -2237678.3479352677, "vf_loss": 4609162.286078718}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 99813.5, "diff_num_grad_updates_vs_sampler_policy": 99812.5}}, "num_env_steps_sampled": 10608960, "num_env_steps_trained": 10608960, "num_agent_steps_sampled": 10608960, "num_agent_steps_trained": 10608960}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154633.0049184774, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13635367866780054, "mean_inference_ms": 0.23259581509141283, "mean_action_processing_ms": 0.056925493048101954, "mean_env_wait_ms": 0.4503275139424687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028345584869384766, "StateBufferConnector_ms": 0.0020885467529296875, "ViewRequirementAgentConnector_ms": 0.05047106742858887}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154633.0049184774, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-153256.77914868365, -154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13635367866780054, "mean_inference_ms": 0.23259581509141283, "mean_action_processing_ms": 0.056925493048101954, "mean_env_wait_ms": 0.4503275139424687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028345584869384766, "StateBufferConnector_ms": 0.0020885467529296875, "ViewRequirementAgentConnector_ms": 0.05047106742858887}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10608960, "num_agent_steps_trained": 10608960, "num_env_steps_sampled": 10608960, "num_env_steps_trained": 10608960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.8596463591654, "num_env_steps_trained_throughput_per_sec": 717.8596463591654, "timesteps_total": 10608960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10608960, "timers": {"training_iteration_time_ms": 61290.768, "sample_time_ms": 60138.409, "load_time_ms": 16.57, "load_throughput": 2650600.681, "learn_time_ms": 1134.694, "learn_throughput": 38706.457, "synch_weights_time_ms": 0.934}, "counters": {"num_env_steps_sampled": 10608960, "num_env_steps_trained": 10608960, "num_agent_steps_sampled": 10608960, "num_agent_steps_trained": 10608960}, "done": false, "episodes_total": 7694, "training_iteration": 1871, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-19-08", "timestamp": 1691302748, "time_this_iter_s": 61.185017108917236, "time_total_s": 28620.700570106506, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6341.084873914719, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 17.505747126436784, "ram_util_percent": 71.66206896551724}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.687500000000001e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.1677589082857, "policy_loss": -1993451.7545240752, "vf_loss": 4642632.724125365}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 100499.5, "diff_num_grad_updates_vs_sampler_policy": 100498.5}}, "num_env_steps_sampled": 10652880, "num_env_steps_trained": 10652880, "num_agent_steps_sampled": 10652880, "num_agent_steps_trained": 10652880}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154678.06072928876, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1365267890906919, "mean_inference_ms": 0.2328716448961821, "mean_action_processing_ms": 0.056994983848953226, "mean_env_wait_ms": 0.4508193312271304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028464794158935547, "StateBufferConnector_ms": 0.0020961761474609375, "ViewRequirementAgentConnector_ms": 0.05073070526123047}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154678.06072928876, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154784.35873527516, -155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1365267890906919, "mean_inference_ms": 0.2328716448961821, "mean_action_processing_ms": 0.056994983848953226, "mean_env_wait_ms": 0.4508193312271304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028464794158935547, "StateBufferConnector_ms": 0.0020961761474609375, "ViewRequirementAgentConnector_ms": 0.05073070526123047}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10652880, "num_agent_steps_trained": 10652880, "num_env_steps_sampled": 10652880, "num_env_steps_trained": 10652880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 718.5717401743258, "num_env_steps_trained_throughput_per_sec": 718.5717401743258, "timesteps_total": 10652880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10652880, "timers": {"training_iteration_time_ms": 61298.851, "sample_time_ms": 60146.441, "load_time_ms": 16.597, "load_throughput": 2646336.015, "learn_time_ms": 1134.717, "learn_throughput": 38705.678, "synch_weights_time_ms": 0.936}, "counters": {"num_env_steps_sampled": 10652880, "num_env_steps_trained": 10652880, "num_agent_steps_sampled": 10652880, "num_agent_steps_trained": 10652880}, "done": false, "episodes_total": 7695, "training_iteration": 1872, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-20-09", "timestamp": 1691302809, "time_this_iter_s": 61.124067068099976, "time_total_s": 28681.824637174606, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6402.208940982819, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 17.251724137931035, "ram_util_percent": 71.63563218390804}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.3750000000000005e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0134234636935, "policy_loss": -2335758.100904815, "vf_loss": 4479744.006741983}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 101185.5, "diff_num_grad_updates_vs_sampler_policy": 101184.5}}, "num_env_steps_sampled": 10696800, "num_env_steps_trained": 10696800, "num_agent_steps_sampled": 10696800, "num_agent_steps_trained": 10696800}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154686.4705981111, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13670420904496114, "mean_inference_ms": 0.23315462207809412, "mean_action_processing_ms": 0.05706628119623682, "mean_env_wait_ms": 0.4513240136394805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028617382049560547, "StateBufferConnector_ms": 0.0021092891693115234, "ViewRequirementAgentConnector_ms": 0.05099821090698242}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154686.4705981111, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155616.79826775737, -155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13670420904496114, "mean_inference_ms": 0.23315462207809412, "mean_action_processing_ms": 0.05706628119623682, "mean_env_wait_ms": 0.4513240136394805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028617382049560547, "StateBufferConnector_ms": 0.0021092891693115234, "ViewRequirementAgentConnector_ms": 0.05099821090698242}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10696800, "num_agent_steps_trained": 10696800, "num_env_steps_sampled": 10696800, "num_env_steps_trained": 10696800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.9864587787607, "num_env_steps_trained_throughput_per_sec": 717.9864587787607, "timesteps_total": 10696800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10696800, "timers": {"training_iteration_time_ms": 61253.464, "sample_time_ms": 60101.659, "load_time_ms": 16.513, "load_throughput": 2659778.017, "learn_time_ms": 1134.2, "learn_throughput": 38723.332, "synch_weights_time_ms": 0.931}, "counters": {"num_env_steps_sampled": 10696800, "num_env_steps_trained": 10696800, "num_agent_steps_sampled": 10696800, "num_agent_steps_trained": 10696800}, "done": false, "episodes_total": 7696, "training_iteration": 1873, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-21-10", "timestamp": 1691302870, "time_this_iter_s": 61.17419695854187, "time_total_s": 28742.99883413315, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6463.3831379413605, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 17.226744186046513, "ram_util_percent": 71.67209302325581}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.062500000000002e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.14965219747916, "policy_loss": -2090045.3092001867, "vf_loss": 4634210.649781341}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 101871.5, "diff_num_grad_updates_vs_sampler_policy": 101870.5}}, "num_env_steps_sampled": 10740720, "num_env_steps_trained": 10740720, "num_agent_steps_sampled": 10740720, "num_agent_steps_trained": 10740720}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154706.61671466494, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13688574708435897, "mean_inference_ms": 0.23344460960749622, "mean_action_processing_ms": 0.057139381493540975, "mean_env_wait_ms": 0.45184252048012497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002877473831176758, "StateBufferConnector_ms": 0.0021209716796875, "ViewRequirementAgentConnector_ms": 0.051241159439086914}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154706.61671466494, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155825.28570526902, -153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13688574708435897, "mean_inference_ms": 0.23344460960749622, "mean_action_processing_ms": 0.057139381493540975, "mean_env_wait_ms": 0.45184252048012497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002877473831176758, "StateBufferConnector_ms": 0.0021209716796875, "ViewRequirementAgentConnector_ms": 0.051241159439086914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10740720, "num_agent_steps_trained": 10740720, "num_env_steps_sampled": 10740720, "num_env_steps_trained": 10740720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 719.3411676408641, "num_env_steps_trained_throughput_per_sec": 719.3411676408641, "timesteps_total": 10740720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10740720, "timers": {"training_iteration_time_ms": 61219.07, "sample_time_ms": 60067.8, "load_time_ms": 16.566, "load_throughput": 2651214.857, "learn_time_ms": 1133.601, "learn_throughput": 38743.776, "synch_weights_time_ms": 0.943}, "counters": {"num_env_steps_sampled": 10740720, "num_env_steps_trained": 10740720, "num_agent_steps_sampled": 10740720, "num_agent_steps_trained": 10740720}, "done": false, "episodes_total": 7697, "training_iteration": 1874, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-22-11", "timestamp": 1691302931, "time_this_iter_s": 61.05899691581726, "time_total_s": 28804.057831048965, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6524.442134857178, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 18.0367816091954, "ram_util_percent": 71.70114942528737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.75e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0056584305388, "policy_loss": -2010266.067851164, "vf_loss": 4308987.700983965}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 102557.5, "diff_num_grad_updates_vs_sampler_policy": 102556.5}}, "num_env_steps_sampled": 10784640, "num_env_steps_trained": 10784640, "num_agent_steps_sampled": 10784640, "num_agent_steps_trained": 10784640}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154680.70125785342, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13707178240648962, "mean_inference_ms": 0.23374148831384953, "mean_action_processing_ms": 0.05721422943021726, "mean_env_wait_ms": 0.45237399500788217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028815269470214844, "StateBufferConnector_ms": 0.002126455307006836, "ViewRequirementAgentConnector_ms": 0.051451683044433594}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154680.70125785342, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-153614.3340744147, -155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13707178240648962, "mean_inference_ms": 0.23374148831384953, "mean_action_processing_ms": 0.05721422943021726, "mean_env_wait_ms": 0.45237399500788217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028815269470214844, "StateBufferConnector_ms": 0.002126455307006836, "ViewRequirementAgentConnector_ms": 0.051451683044433594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10784640, "num_agent_steps_trained": 10784640, "num_env_steps_sampled": 10784640, "num_env_steps_trained": 10784640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 707.5313611620858, "num_env_steps_trained_throughput_per_sec": 707.5313611620858, "timesteps_total": 10784640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10784640, "timers": {"training_iteration_time_ms": 61298.062, "sample_time_ms": 60147.696, "load_time_ms": 16.581, "load_throughput": 2648862.695, "learn_time_ms": 1132.675, "learn_throughput": 38775.478, "synch_weights_time_ms": 0.952}, "counters": {"num_env_steps_sampled": 10784640, "num_env_steps_trained": 10784640, "num_agent_steps_sampled": 10784640, "num_agent_steps_trained": 10784640}, "done": false, "episodes_total": 7698, "training_iteration": 1875, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-23-13", "timestamp": 1691302993, "time_this_iter_s": 62.07794380187988, "time_total_s": 28866.135774850845, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6586.520078659058, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 17.255172413793105, "ram_util_percent": 71.65287356321838}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.4375e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.88053965220996, "policy_loss": -2343822.0213163947, "vf_loss": 4339849.176931486}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 103243.5, "diff_num_grad_updates_vs_sampler_policy": 103242.5}}, "num_env_steps_sampled": 10828560, "num_env_steps_trained": 10828560, "num_agent_steps_sampled": 10828560, "num_agent_steps_trained": 10828560}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154683.0645288193, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13726236116332377, "mean_inference_ms": 0.23404530444901403, "mean_action_processing_ms": 0.057290819168120594, "mean_env_wait_ms": 0.45291793248028833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028934478759765625, "StateBufferConnector_ms": 0.0021376609802246094, "ViewRequirementAgentConnector_ms": 0.05167531967163086}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154683.0645288193, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155132.62895061407, -153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13726236116332377, "mean_inference_ms": 0.23404530444901403, "mean_action_processing_ms": 0.057290819168120594, "mean_env_wait_ms": 0.45291793248028833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028934478759765625, "StateBufferConnector_ms": 0.0021376609802246094, "ViewRequirementAgentConnector_ms": 0.05167531967163086}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10828560, "num_agent_steps_trained": 10828560, "num_env_steps_sampled": 10828560, "num_env_steps_trained": 10828560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 709.5706739126805, "num_env_steps_trained_throughput_per_sec": 709.5706739126805, "timesteps_total": 10828560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10828560, "timers": {"training_iteration_time_ms": 61349.643, "sample_time_ms": 60198.043, "load_time_ms": 16.747, "load_throughput": 2622533.469, "learn_time_ms": 1133.73, "learn_throughput": 38739.376, "synch_weights_time_ms": 0.962}, "counters": {"num_env_steps_sampled": 10828560, "num_env_steps_trained": 10828560, "num_agent_steps_sampled": 10828560, "num_agent_steps_trained": 10828560}, "done": false, "episodes_total": 7699, "training_iteration": 1876, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-24-15", "timestamp": 1691303055, "time_this_iter_s": 61.89960718154907, "time_total_s": 28928.035382032394, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6648.419685840607, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 17.220454545454547, "ram_util_percent": 71.6784090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.125000000000001e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.8919238654935, "policy_loss": -2051090.2674300747, "vf_loss": 4458541.59375}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 103929.5, "diff_num_grad_updates_vs_sampler_policy": 103928.5}}, "num_env_steps_sampled": 10872480, "num_env_steps_trained": 10872480, "num_agent_steps_sampled": 10872480, "num_agent_steps_trained": 10872480}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154679.58707861428, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13745744631161755, "mean_inference_ms": 0.23435598418035702, "mean_action_processing_ms": 0.05736911201634931, "mean_env_wait_ms": 0.45347483222735696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002904653549194336, "StateBufferConnector_ms": 0.0021424293518066406, "ViewRequirementAgentConnector_ms": 0.051873207092285156}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154679.58707861428, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-153439.55236960054, -153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13745744631161755, "mean_inference_ms": 0.23435598418035702, "mean_action_processing_ms": 0.05736911201634931, "mean_env_wait_ms": 0.45347483222735696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002904653549194336, "StateBufferConnector_ms": 0.0021424293518066406, "ViewRequirementAgentConnector_ms": 0.051873207092285156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10872480, "num_agent_steps_trained": 10872480, "num_env_steps_sampled": 10872480, "num_env_steps_trained": 10872480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.9002164974316, "num_env_steps_trained_throughput_per_sec": 713.9002164974316, "timesteps_total": 10872480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10872480, "timers": {"training_iteration_time_ms": 61368.106, "sample_time_ms": 60216.83, "load_time_ms": 16.737, "load_throughput": 2624180.991, "learn_time_ms": 1133.424, "learn_throughput": 38749.851, "synch_weights_time_ms": 0.956}, "counters": {"num_env_steps_sampled": 10872480, "num_env_steps_trained": 10872480, "num_agent_steps_sampled": 10872480, "num_agent_steps_trained": 10872480}, "done": false, "episodes_total": 7700, "training_iteration": 1877, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-25-17", "timestamp": 1691303117, "time_this_iter_s": 61.52400612831116, "time_total_s": 28989.559388160706, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6709.943691968918, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 17.37816091954023, "ram_util_percent": 71.64597701149427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.8124999999999994e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9332262489608, "policy_loss": -2298400.530822932, "vf_loss": 4445808.3946793005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 104615.5, "diff_num_grad_updates_vs_sampler_policy": 104614.5}}, "num_env_steps_sampled": 10916400, "num_env_steps_trained": 10916400, "num_agent_steps_sampled": 10916400, "num_agent_steps_trained": 10916400}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154700.05075473228, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13765680372373074, "mean_inference_ms": 0.23467339912953336, "mean_action_processing_ms": 0.057449103596432946, "mean_env_wait_ms": 0.45404698683833933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002914905548095703, "StateBufferConnector_ms": 0.0021505355834960938, "ViewRequirementAgentConnector_ms": 0.052109479904174805}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154700.05075473228, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-153540.118573851, -156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13765680372373074, "mean_inference_ms": 0.23467339912953336, "mean_action_processing_ms": 0.057449103596432946, "mean_env_wait_ms": 0.45404698683833933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002914905548095703, "StateBufferConnector_ms": 0.0021505355834960938, "ViewRequirementAgentConnector_ms": 0.052109479904174805}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10916400, "num_agent_steps_trained": 10916400, "num_env_steps_sampled": 10916400, "num_env_steps_trained": 10916400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.2741767105852, "num_env_steps_trained_throughput_per_sec": 716.2741767105852, "timesteps_total": 10916400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10916400, "timers": {"training_iteration_time_ms": 61369.027, "sample_time_ms": 60216.821, "load_time_ms": 16.77, "load_throughput": 2618943.0, "learn_time_ms": 1134.313, "learn_throughput": 38719.474, "synch_weights_time_ms": 0.963}, "counters": {"num_env_steps_sampled": 10916400, "num_env_steps_trained": 10916400, "num_agent_steps_sampled": 10916400, "num_agent_steps_trained": 10916400}, "done": false, "episodes_total": 7701, "training_iteration": 1878, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-26-18", "timestamp": 1691303178, "time_this_iter_s": 61.32015299797058, "time_total_s": 29050.879541158676, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6771.263844966888, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 17.14022988505747, "ram_util_percent": 71.65287356321838}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999994e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9438323084884, "policy_loss": -1914781.715122768, "vf_loss": 4287215.315233236}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 105301.5, "diff_num_grad_updates_vs_sampler_policy": 105300.5}}, "num_env_steps_sampled": 10960320, "num_env_steps_trained": 10960320, "num_agent_steps_sampled": 10960320, "num_agent_steps_trained": 10960320}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154691.3652852764, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1378602930658123, "mean_inference_ms": 0.23499720887339887, "mean_action_processing_ms": 0.05753073511506039, "mean_env_wait_ms": 0.45463147825060474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029218196868896484, "StateBufferConnector_ms": 0.002153635025024414, "ViewRequirementAgentConnector_ms": 0.052329063415527344}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154691.3652852764, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-156278.9354598521, -155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1378602930658123, "mean_inference_ms": 0.23499720887339887, "mean_action_processing_ms": 0.05753073511506039, "mean_env_wait_ms": 0.45463147825060474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029218196868896484, "StateBufferConnector_ms": 0.002153635025024414, "ViewRequirementAgentConnector_ms": 0.052329063415527344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10960320, "num_agent_steps_trained": 10960320, "num_env_steps_sampled": 10960320, "num_env_steps_trained": 10960320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.8716166960644, "num_env_steps_trained_throughput_per_sec": 717.8716166960644, "timesteps_total": 10960320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 10960320, "timers": {"training_iteration_time_ms": 61350.333, "sample_time_ms": 60198.771, "load_time_ms": 16.755, "load_throughput": 2621354.203, "learn_time_ms": 1133.689, "learn_throughput": 38740.777, "synch_weights_time_ms": 0.958}, "counters": {"num_env_steps_sampled": 10960320, "num_env_steps_trained": 10960320, "num_agent_steps_sampled": 10960320, "num_agent_steps_trained": 10960320}, "done": false, "episodes_total": 7702, "training_iteration": 1879, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-27-19", "timestamp": 1691303239, "time_this_iter_s": 61.1844642162323, "time_total_s": 29112.06400537491, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6832.448309183121, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 17.028735632183906, "ram_util_percent": 71.61034482758622}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999994e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.02054331253987, "policy_loss": -1964235.8926549973, "vf_loss": 4324641.515670554}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 105987.5, "diff_num_grad_updates_vs_sampler_policy": 105986.5}}, "num_env_steps_sampled": 11004240, "num_env_steps_trained": 11004240, "num_agent_steps_sampled": 11004240, "num_agent_steps_trained": 11004240}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154661.018305469, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1380678764867288, "mean_inference_ms": 0.2353276025174177, "mean_action_processing_ms": 0.05761402970939905, "mean_env_wait_ms": 0.4552293743497178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029327869415283203, "StateBufferConnector_ms": 0.0021619796752929688, "ViewRequirementAgentConnector_ms": 0.05256319046020508}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154661.018305469, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155648.35126608246, -157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1380678764867288, "mean_inference_ms": 0.2353276025174177, "mean_action_processing_ms": 0.05761402970939905, "mean_env_wait_ms": 0.4552293743497178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029327869415283203, "StateBufferConnector_ms": 0.0021619796752929688, "ViewRequirementAgentConnector_ms": 0.05256319046020508}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11004240, "num_agent_steps_trained": 11004240, "num_env_steps_sampled": 11004240, "num_env_steps_trained": 11004240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.361778519338, "num_env_steps_trained_throughput_per_sec": 712.361778519338, "timesteps_total": 11004240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11004240, "timers": {"training_iteration_time_ms": 61417.485, "sample_time_ms": 60266.365, "load_time_ms": 16.687, "load_throughput": 2631975.844, "learn_time_ms": 1133.317, "learn_throughput": 38753.494, "synch_weights_time_ms": 0.955}, "counters": {"num_env_steps_sampled": 11004240, "num_env_steps_trained": 11004240, "num_agent_steps_sampled": 11004240, "num_agent_steps_trained": 11004240}, "done": false, "episodes_total": 7703, "training_iteration": 1880, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-28-21", "timestamp": 1691303301, "time_this_iter_s": 61.65701198577881, "time_total_s": 29173.721017360687, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6894.1053211688995, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 17.289655172413795, "ram_util_percent": 71.66436781609197}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999994e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.89663496100866, "policy_loss": -2061626.155099763, "vf_loss": 4376199.240980321}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 106673.5, "diff_num_grad_updates_vs_sampler_policy": 106672.5}}, "num_env_steps_sampled": 11048160, "num_env_steps_trained": 11048160, "num_agent_steps_sampled": 11048160, "num_agent_steps_trained": 11048160}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154645.48377584756, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13827944593816277, "mean_inference_ms": 0.23566400405024396, "mean_action_processing_ms": 0.05769894467137848, "mean_env_wait_ms": 0.45583994128548894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029463768005371094, "StateBufferConnector_ms": 0.002175569534301758, "ViewRequirementAgentConnector_ms": 0.05277705192565918}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154645.48377584756, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157094.75321621774, -154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13827944593816277, "mean_inference_ms": 0.23566400405024396, "mean_action_processing_ms": 0.05769894467137848, "mean_env_wait_ms": 0.45583994128548894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029463768005371094, "StateBufferConnector_ms": 0.002175569534301758, "ViewRequirementAgentConnector_ms": 0.05277705192565918}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11048160, "num_agent_steps_trained": 11048160, "num_env_steps_sampled": 11048160, "num_env_steps_trained": 11048160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.5384983371928, "num_env_steps_trained_throughput_per_sec": 713.5384983371928, "timesteps_total": 11048160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11048160, "timers": {"training_iteration_time_ms": 61454.537, "sample_time_ms": 60301.515, "load_time_ms": 16.744, "load_throughput": 2623097.353, "learn_time_ms": 1135.161, "learn_throughput": 38690.553, "synch_weights_time_ms": 0.956}, "counters": {"num_env_steps_sampled": 11048160, "num_env_steps_trained": 11048160, "num_agent_steps_sampled": 11048160, "num_agent_steps_trained": 11048160}, "done": false, "episodes_total": 7704, "training_iteration": 1881, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-29-23", "timestamp": 1691303363, "time_this_iter_s": 61.55558896064758, "time_total_s": 29235.276606321335, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6955.660910129547, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 17.832183908045977, "ram_util_percent": 71.66896551724138}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999994e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.95813766790894, "policy_loss": -1965008.1736800747, "vf_loss": 4409590.8102223035}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 107359.5, "diff_num_grad_updates_vs_sampler_policy": 107358.5}}, "num_env_steps_sampled": 11092080, "num_env_steps_trained": 11092080, "num_agent_steps_sampled": 11092080, "num_agent_steps_trained": 11092080}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154618.9520246701, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13849501092125874, "mean_inference_ms": 0.2360064146063817, "mean_action_processing_ms": 0.05778544256256643, "mean_env_wait_ms": 0.45646198311499864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029556751251220703, "StateBufferConnector_ms": 0.002189159393310547, "ViewRequirementAgentConnector_ms": 0.052999258041381836}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154618.9520246701, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154643.2898001583, -154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13849501092125874, "mean_inference_ms": 0.2360064146063817, "mean_action_processing_ms": 0.05778544256256643, "mean_env_wait_ms": 0.45646198311499864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029556751251220703, "StateBufferConnector_ms": 0.002189159393310547, "ViewRequirementAgentConnector_ms": 0.052999258041381836}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11092080, "num_agent_steps_trained": 11092080, "num_env_steps_sampled": 11092080, "num_env_steps_trained": 11092080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.5288463488046, "num_env_steps_trained_throughput_per_sec": 715.5288463488046, "timesteps_total": 11092080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11092080, "timers": {"training_iteration_time_ms": 61480.53, "sample_time_ms": 60326.32, "load_time_ms": 16.719, "load_throughput": 2626894.005, "learn_time_ms": 1136.364, "learn_throughput": 38649.574, "synch_weights_time_ms": 0.962}, "counters": {"num_env_steps_sampled": 11092080, "num_env_steps_trained": 11092080, "num_agent_steps_sampled": 11092080, "num_agent_steps_trained": 11092080}, "done": false, "episodes_total": 7705, "training_iteration": 1882, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-30-24", "timestamp": 1691303424, "time_this_iter_s": 61.38399314880371, "time_total_s": 29296.66059947014, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7017.044903278351, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 17.114942528735636, "ram_util_percent": 71.66896551724139}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999994e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.00924811627357, "policy_loss": -2016019.1115445062, "vf_loss": 4253288.16180758}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 108045.5, "diff_num_grad_updates_vs_sampler_policy": 108044.5}}, "num_env_steps_sampled": 11136000, "num_env_steps_trained": 11136000, "num_agent_steps_sampled": 11136000, "num_agent_steps_trained": 11136000}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154593.99159628816, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13871457899539075, "mean_inference_ms": 0.2363549846006758, "mean_action_processing_ms": 0.05787354540698644, "mean_env_wait_ms": 0.45709573584209606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002966165542602539, "StateBufferConnector_ms": 0.002199411392211914, "ViewRequirementAgentConnector_ms": 0.053223371505737305}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154593.99159628816, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154176.4024899428, -158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13871457899539075, "mean_inference_ms": 0.2363549846006758, "mean_action_processing_ms": 0.05787354540698644, "mean_env_wait_ms": 0.45709573584209606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002966165542602539, "StateBufferConnector_ms": 0.002199411392211914, "ViewRequirementAgentConnector_ms": 0.053223371505737305}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11136000, "num_agent_steps_trained": 11136000, "num_env_steps_sampled": 11136000, "num_env_steps_trained": 11136000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 718.5225991095615, "num_env_steps_trained_throughput_per_sec": 718.5225991095615, "timesteps_total": 11136000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11136000, "timers": {"training_iteration_time_ms": 61475.965, "sample_time_ms": 60321.224, "load_time_ms": 16.74, "load_throughput": 2623680.164, "learn_time_ms": 1136.877, "learn_throughput": 38632.141, "synch_weights_time_ms": 0.961}, "counters": {"num_env_steps_sampled": 11136000, "num_env_steps_trained": 11136000, "num_agent_steps_sampled": 11136000, "num_agent_steps_trained": 11136000}, "done": false, "episodes_total": 7706, "training_iteration": 1883, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-31-25", "timestamp": 1691303485, "time_this_iter_s": 61.128482818603516, "time_total_s": 29357.789082288742, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7078.173386096954, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 17.324418604651164, "ram_util_percent": 71.61976744186046}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999994e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.1718684160327, "policy_loss": -2070995.926065962, "vf_loss": 4620302.766581632}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 108731.5, "diff_num_grad_updates_vs_sampler_policy": 108730.5}}, "num_env_steps_sampled": 11179920, "num_env_steps_trained": 11179920, "num_agent_steps_sampled": 11179920, "num_agent_steps_trained": 11179920}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154626.47753270133, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1389380002274126, "mean_inference_ms": 0.23670950418312525, "mean_action_processing_ms": 0.05796318869767528, "mean_env_wait_ms": 0.45774130183148887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029692649841308594, "StateBufferConnector_ms": 0.002206563949584961, "ViewRequirementAgentConnector_ms": 0.05342221260070801}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154626.47753270133, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-158743.83548622596, -154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1389380002274126, "mean_inference_ms": 0.23670950418312525, "mean_action_processing_ms": 0.05796318869767528, "mean_env_wait_ms": 0.45774130183148887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029692649841308594, "StateBufferConnector_ms": 0.002206563949584961, "ViewRequirementAgentConnector_ms": 0.05342221260070801}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11179920, "num_agent_steps_trained": 11179920, "num_env_steps_sampled": 11179920, "num_env_steps_trained": 11179920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 711.6413856632435, "num_env_steps_trained_throughput_per_sec": 711.6413856632435, "timesteps_total": 11179920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11179920, "timers": {"training_iteration_time_ms": 61542.026, "sample_time_ms": 60386.333, "load_time_ms": 16.678, "load_throughput": 2633420.655, "learn_time_ms": 1137.881, "learn_throughput": 38598.053, "synch_weights_time_ms": 0.971}, "counters": {"num_env_steps_sampled": 11179920, "num_env_steps_trained": 11179920, "num_agent_steps_sampled": 11179920, "num_agent_steps_trained": 11179920}, "done": false, "episodes_total": 7707, "training_iteration": 1884, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-32-27", "timestamp": 1691303547, "time_this_iter_s": 61.719701051712036, "time_total_s": 29419.508783340454, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7139.893087148666, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 17.46590909090909, "ram_util_percent": 71.675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999994e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9683712884219, "policy_loss": -1619079.7352860786, "vf_loss": 4094453.8510386297}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 109417.5, "diff_num_grad_updates_vs_sampler_policy": 109416.5}}, "num_env_steps_sampled": 11223840, "num_env_steps_trained": 11223840, "num_agent_steps_sampled": 11223840, "num_agent_steps_trained": 11223840}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154539.44061835637, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13916531677101412, "mean_inference_ms": 0.2370702329748666, "mean_action_processing_ms": 0.05805437074595277, "mean_env_wait_ms": 0.4583975684532383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002979278564453125, "StateBufferConnector_ms": 0.0022149085998535156, "ViewRequirementAgentConnector_ms": 0.053635597229003906}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154539.44061835637, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154139.12096379546, -154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13916531677101412, "mean_inference_ms": 0.2370702329748666, "mean_action_processing_ms": 0.05805437074595277, "mean_env_wait_ms": 0.4583975684532383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002979278564453125, "StateBufferConnector_ms": 0.0022149085998535156, "ViewRequirementAgentConnector_ms": 0.053635597229003906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11223840, "num_agent_steps_trained": 11223840, "num_env_steps_sampled": 11223840, "num_env_steps_trained": 11223840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.9503781374358, "num_env_steps_trained_throughput_per_sec": 716.9503781374358, "timesteps_total": 11223840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11223840, "timers": {"training_iteration_time_ms": 61460.473, "sample_time_ms": 60311.201, "load_time_ms": 16.792, "load_throughput": 2615462.608, "learn_time_ms": 1131.356, "learn_throughput": 38820.684, "synch_weights_time_ms": 0.961}, "counters": {"num_env_steps_sampled": 11223840, "num_env_steps_trained": 11223840, "num_agent_steps_sampled": 11223840, "num_agent_steps_trained": 11223840}, "done": false, "episodes_total": 7708, "training_iteration": 1885, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-33-28", "timestamp": 1691303608, "time_this_iter_s": 61.26264500617981, "time_total_s": 29480.771428346634, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7201.155732154846, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 19.28275862068966, "ram_util_percent": 71.57241379310345}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999994e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9100343576326, "policy_loss": -2319535.8212691327, "vf_loss": 4348975.507653061}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 110103.5, "diff_num_grad_updates_vs_sampler_policy": 110102.5}}, "num_env_steps_sampled": 11267760, "num_env_steps_trained": 11267760, "num_agent_steps_sampled": 11267760, "num_agent_steps_trained": 11267760}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154536.96468657316, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13939650048598695, "mean_inference_ms": 0.23743680285048196, "mean_action_processing_ms": 0.05814704865504985, "mean_env_wait_ms": 0.45906514703149126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002985715866088867, "StateBufferConnector_ms": 0.0022242069244384766, "ViewRequirementAgentConnector_ms": 0.05387234687805176}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154536.96468657316, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154486.54103383175, -153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13939650048598695, "mean_inference_ms": 0.23743680285048196, "mean_action_processing_ms": 0.05814704865504985, "mean_env_wait_ms": 0.45906514703149126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002985715866088867, "StateBufferConnector_ms": 0.0022242069244384766, "ViewRequirementAgentConnector_ms": 0.05387234687805176}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11267760, "num_agent_steps_trained": 11267760, "num_env_steps_sampled": 11267760, "num_env_steps_trained": 11267760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.5424491980101, "num_env_steps_trained_throughput_per_sec": 712.5424491980101, "timesteps_total": 11267760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11267760, "timers": {"training_iteration_time_ms": 61434.658, "sample_time_ms": 60286.252, "load_time_ms": 16.713, "load_throughput": 2627823.331, "learn_time_ms": 1130.577, "learn_throughput": 38847.412, "synch_weights_time_ms": 0.953}, "counters": {"num_env_steps_sampled": 11267760, "num_env_steps_trained": 11267760, "num_agent_steps_sampled": 11267760, "num_agent_steps_trained": 11267760}, "done": false, "episodes_total": 7709, "training_iteration": 1886, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-34-30", "timestamp": 1691303670, "time_this_iter_s": 61.641385078430176, "time_total_s": 29542.412813425064, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7262.797117233276, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 18.065517241379307, "ram_util_percent": 71.56206896551724}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999994e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.05424063546315, "policy_loss": -2061169.6792945974, "vf_loss": 4452391.761752916}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 110789.5, "diff_num_grad_updates_vs_sampler_policy": 110788.5}}, "num_env_steps_sampled": 11311680, "num_env_steps_trained": 11311680, "num_agent_steps_sampled": 11311680, "num_agent_steps_trained": 11311680}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154542.35735518107, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13963157442200003, "mean_inference_ms": 0.23780921962234203, "mean_action_processing_ms": 0.05824122811880076, "mean_env_wait_ms": 0.45974370374953694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030066967010498047, "StateBufferConnector_ms": 0.0022323131561279297, "ViewRequirementAgentConnector_ms": 0.0540623664855957}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154542.35735518107, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-153330.64624219108, -155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13963157442200003, "mean_inference_ms": 0.23780921962234203, "mean_action_processing_ms": 0.05824122811880076, "mean_env_wait_ms": 0.45974370374953694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030066967010498047, "StateBufferConnector_ms": 0.0022323131561279297, "ViewRequirementAgentConnector_ms": 0.0540623664855957}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11311680, "num_agent_steps_trained": 11311680, "num_env_steps_sampled": 11311680, "num_env_steps_trained": 11311680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.1845802581471, "num_env_steps_trained_throughput_per_sec": 717.1845802581471, "timesteps_total": 11311680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11311680, "timers": {"training_iteration_time_ms": 61406.484, "sample_time_ms": 60257.142, "load_time_ms": 16.863, "load_throughput": 2604509.502, "learn_time_ms": 1131.362, "learn_throughput": 38820.467, "synch_weights_time_ms": 0.954}, "counters": {"num_env_steps_sampled": 11311680, "num_env_steps_trained": 11311680, "num_agent_steps_sampled": 11311680, "num_agent_steps_trained": 11311680}, "done": false, "episodes_total": 7710, "training_iteration": 1887, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-35-31", "timestamp": 1691303731, "time_this_iter_s": 61.24287700653076, "time_total_s": 29603.655690431595, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7324.039994239807, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 17.67241379310345, "ram_util_percent": 71.68160919540229}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.3124999999999995e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.12428261448275, "policy_loss": -1918316.3835470572, "vf_loss": 4515207.66654519}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 111475.5, "diff_num_grad_updates_vs_sampler_policy": 111474.5}}, "num_env_steps_sampled": 11355600, "num_env_steps_trained": 11355600, "num_agent_steps_sampled": 11355600, "num_agent_steps_trained": 11355600}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154566.7122792031, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13987004034765682, "mean_inference_ms": 0.2381875142058963, "mean_action_processing_ms": 0.05833692696116078, "mean_env_wait_ms": 0.46043307592448085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030171871185302734, "StateBufferConnector_ms": 0.0022406578063964844, "ViewRequirementAgentConnector_ms": 0.054282188415527344}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154566.7122792031, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155953.4540528231, -152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13987004034765682, "mean_inference_ms": 0.2381875142058963, "mean_action_processing_ms": 0.05833692696116078, "mean_env_wait_ms": 0.46043307592448085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030171871185302734, "StateBufferConnector_ms": 0.0022406578063964844, "ViewRequirementAgentConnector_ms": 0.054282188415527344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11355600, "num_agent_steps_trained": 11355600, "num_env_steps_sampled": 11355600, "num_env_steps_trained": 11355600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.5706074445026, "num_env_steps_trained_throughput_per_sec": 715.5706074445026, "timesteps_total": 11355600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11355600, "timers": {"training_iteration_time_ms": 61412.513, "sample_time_ms": 60263.76, "load_time_ms": 16.799, "load_throughput": 2614367.606, "learn_time_ms": 1130.836, "learn_throughput": 38838.528, "synch_weights_time_ms": 0.955}, "counters": {"num_env_steps_sampled": 11355600, "num_env_steps_trained": 11355600, "num_agent_steps_sampled": 11355600, "num_agent_steps_trained": 11355600}, "done": false, "episodes_total": 7711, "training_iteration": 1888, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-36-33", "timestamp": 1691303793, "time_this_iter_s": 61.3805148601532, "time_total_s": 29665.036205291748, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7385.42050909996, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 17.5625, "ram_util_percent": 71.67500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.1250000000000003e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.09988554573613, "policy_loss": -2253940.8515084046, "vf_loss": 4663571.178206997}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 112161.5, "diff_num_grad_updates_vs_sampler_policy": 112160.5}}, "num_env_steps_sampled": 11399520, "num_env_steps_trained": 11399520, "num_agent_steps_sampled": 11399520, "num_agent_steps_trained": 11399520}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154587.1167734451, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1401097974091132, "mean_inference_ms": 0.23856981453139525, "mean_action_processing_ms": 0.058433650372897626, "mean_env_wait_ms": 0.4611302862207369, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030269622802734375, "StateBufferConnector_ms": 0.0022466182708740234, "ViewRequirementAgentConnector_ms": 0.05448508262634277}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154587.1167734451, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152101.90695855187, -153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1401097974091132, "mean_inference_ms": 0.23856981453139525, "mean_action_processing_ms": 0.058433650372897626, "mean_env_wait_ms": 0.4611302862207369, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030269622802734375, "StateBufferConnector_ms": 0.0022466182708740234, "ViewRequirementAgentConnector_ms": 0.05448508262634277}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11399520, "num_agent_steps_trained": 11399520, "num_env_steps_sampled": 11399520, "num_env_steps_trained": 11399520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 718.5356705988329, "num_env_steps_trained_throughput_per_sec": 718.5356705988329, "timesteps_total": 11399520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11399520, "timers": {"training_iteration_time_ms": 61406.859, "sample_time_ms": 60257.312, "load_time_ms": 16.765, "load_throughput": 2619665.523, "learn_time_ms": 1131.651, "learn_throughput": 38810.563, "synch_weights_time_ms": 0.964}, "counters": {"num_env_steps_sampled": 11399520, "num_env_steps_trained": 11399520, "num_agent_steps_sampled": 11399520, "num_agent_steps_trained": 11399520}, "done": false, "episodes_total": 7712, "training_iteration": 1889, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-37-34", "timestamp": 1691303854, "time_this_iter_s": 61.12737202644348, "time_total_s": 29726.16357731819, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7446.547881126404, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 17.45287356321839, "ram_util_percent": 71.73103448275864}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.9375000000000003e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.02601823723353, "policy_loss": -2005483.2634725766, "vf_loss": 4390203.188684402}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 112847.5, "diff_num_grad_updates_vs_sampler_policy": 112846.5}}, "num_env_steps_sampled": 11443440, "num_env_steps_trained": 11443440, "num_agent_steps_sampled": 11443440, "num_agent_steps_trained": 11443440}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154605.85805695574, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14034997470633237, "mean_inference_ms": 0.23895378094882827, "mean_action_processing_ms": 0.058530788533200415, "mean_env_wait_ms": 0.46183301616755545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003034830093383789, "StateBufferConnector_ms": 0.0022525787353515625, "ViewRequirementAgentConnector_ms": 0.05463910102844238}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154605.85805695574, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-153072.21774661518, -154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14034997470633237, "mean_inference_ms": 0.23895378094882827, "mean_action_processing_ms": 0.058530788533200415, "mean_env_wait_ms": 0.46183301616755545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003034830093383789, "StateBufferConnector_ms": 0.0022525787353515625, "ViewRequirementAgentConnector_ms": 0.05463910102844238}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11443440, "num_agent_steps_trained": 11443440, "num_env_steps_sampled": 11443440, "num_env_steps_trained": 11443440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.6657665295677, "num_env_steps_trained_throughput_per_sec": 714.6657665295677, "timesteps_total": 11443440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11443440, "timers": {"training_iteration_time_ms": 61386.983, "sample_time_ms": 60237.261, "load_time_ms": 16.864, "load_throughput": 2604395.353, "learn_time_ms": 1131.722, "learn_throughput": 38808.114, "synch_weights_time_ms": 0.969}, "counters": {"num_env_steps_sampled": 11443440, "num_env_steps_trained": 11443440, "num_agent_steps_sampled": 11443440, "num_agent_steps_trained": 11443440}, "done": false, "episodes_total": 7713, "training_iteration": 1890, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-38-35", "timestamp": 1691303915, "time_this_iter_s": 61.45840811729431, "time_total_s": 29787.621985435486, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7508.006289243698, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 18.10459770114943, "ram_util_percent": 71.77471264367814}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.7499999999999999e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0653302162104, "policy_loss": -2127293.5216893675, "vf_loss": 4739392.910349854}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 113533.5, "diff_num_grad_updates_vs_sampler_policy": 113532.5}}, "num_env_steps_sampled": 11487360, "num_env_steps_trained": 11487360, "num_agent_steps_sampled": 11487360, "num_agent_steps_trained": 11487360}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154666.07583147867, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14059123133215323, "mean_inference_ms": 0.23933998049891375, "mean_action_processing_ms": 0.05862841627805178, "mean_env_wait_ms": 0.46253974930111047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003039121627807617, "StateBufferConnector_ms": 0.0022575855255126953, "ViewRequirementAgentConnector_ms": 0.05480456352233887}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154666.07583147867, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154595.05478886433, -160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14059123133215323, "mean_inference_ms": 0.23933998049891375, "mean_action_processing_ms": 0.05862841627805178, "mean_env_wait_ms": 0.46253974930111047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003039121627807617, "StateBufferConnector_ms": 0.0022575855255126953, "ViewRequirementAgentConnector_ms": 0.05480456352233887}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11487360, "num_agent_steps_trained": 11487360, "num_env_steps_sampled": 11487360, "num_env_steps_trained": 11487360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.8490001617887, "num_env_steps_trained_throughput_per_sec": 716.8490001617887, "timesteps_total": 11487360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11487360, "timers": {"training_iteration_time_ms": 61358.557, "sample_time_ms": 60210.781, "load_time_ms": 16.825, "load_throughput": 2610340.703, "learn_time_ms": 1129.8, "learn_throughput": 38874.14, "synch_weights_time_ms": 0.985}, "counters": {"num_env_steps_sampled": 11487360, "num_env_steps_trained": 11487360, "num_agent_steps_sampled": 11487360, "num_agent_steps_trained": 11487360}, "done": false, "episodes_total": 7714, "training_iteration": 1891, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-39-37", "timestamp": 1691303977, "time_this_iter_s": 61.27135992050171, "time_total_s": 29848.893345355988, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7569.2776491642, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 17.24137931034483, "ram_util_percent": 71.7712643678161}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.5625000000000004e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9370770245877, "policy_loss": -2231921.4964638758, "vf_loss": 4423160.404610058}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 114219.5, "diff_num_grad_updates_vs_sampler_policy": 114218.5}}, "num_env_steps_sampled": 11531280, "num_env_steps_trained": 11531280, "num_agent_steps_sampled": 11531280, "num_agent_steps_trained": 11531280}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154667.71258794665, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14083321803938817, "mean_inference_ms": 0.23972877380897553, "mean_action_processing_ms": 0.058726657080563405, "mean_env_wait_ms": 0.4632521540452674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030379295349121094, "StateBufferConnector_ms": 0.0022644996643066406, "ViewRequirementAgentConnector_ms": 0.054973602294921875}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160243.18539922353, "episode_reward_mean": -154667.71258794665, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160243.18539922353, -154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14083321803938817, "mean_inference_ms": 0.23972877380897553, "mean_action_processing_ms": 0.058726657080563405, "mean_env_wait_ms": 0.4632521540452674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030379295349121094, "StateBufferConnector_ms": 0.0022644996643066406, "ViewRequirementAgentConnector_ms": 0.054973602294921875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11531280, "num_agent_steps_trained": 11531280, "num_env_steps_sampled": 11531280, "num_env_steps_trained": 11531280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.7383616304929, "num_env_steps_trained_throughput_per_sec": 716.7383616304929, "timesteps_total": 11531280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11531280, "timers": {"training_iteration_time_ms": 61348.199, "sample_time_ms": 60202.138, "load_time_ms": 16.87, "load_throughput": 2603375.82, "learn_time_ms": 1128.059, "learn_throughput": 38934.12, "synch_weights_time_ms": 0.968}, "counters": {"num_env_steps_sampled": 11531280, "num_env_steps_trained": 11531280, "num_agent_steps_sampled": 11531280, "num_agent_steps_trained": 11531280}, "done": false, "episodes_total": 7715, "training_iteration": 1892, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-40-38", "timestamp": 1691304038, "time_this_iter_s": 61.28048276901245, "time_total_s": 29910.173828125, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7630.558131933212, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 18.08023255813953, "ram_util_percent": 71.79651162790698}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.3749999999999997e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.1956900549352, "policy_loss": -2278835.8226656453, "vf_loss": 4582643.087463557}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 114905.5, "diff_num_grad_updates_vs_sampler_policy": 114904.5}}, "num_env_steps_sampled": 11575200, "num_env_steps_trained": 11575200, "num_agent_steps_sampled": 11575200, "num_agent_steps_trained": 11575200}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -159093.9951989073, "episode_reward_mean": -154634.70765710025, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14107634479063347, "mean_inference_ms": 0.2401203237537742, "mean_action_processing_ms": 0.05882555012595159, "mean_env_wait_ms": 0.4639706814391316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030472278594970703, "StateBufferConnector_ms": 0.002272367477416992, "ViewRequirementAgentConnector_ms": 0.05516624450683594}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -159093.9951989073, "episode_reward_mean": -154634.70765710025, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154643.9649440542, -154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14107634479063347, "mean_inference_ms": 0.2401203237537742, "mean_action_processing_ms": 0.05882555012595159, "mean_env_wait_ms": 0.4639706814391316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030472278594970703, "StateBufferConnector_ms": 0.002272367477416992, "ViewRequirementAgentConnector_ms": 0.05516624450683594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11575200, "num_agent_steps_trained": 11575200, "num_env_steps_sampled": 11575200, "num_env_steps_trained": 11575200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.8762634068415, "num_env_steps_trained_throughput_per_sec": 716.8762634068415, "timesteps_total": 11575200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11575200, "timers": {"training_iteration_time_ms": 61362.237, "sample_time_ms": 60216.428, "load_time_ms": 16.936, "load_throughput": 2593293.583, "learn_time_ms": 1127.746, "learn_throughput": 38944.949, "synch_weights_time_ms": 0.963}, "counters": {"num_env_steps_sampled": 11575200, "num_env_steps_trained": 11575200, "num_agent_steps_sampled": 11575200, "num_agent_steps_trained": 11575200}, "done": false, "episodes_total": 7716, "training_iteration": 1893, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-41-39", "timestamp": 1691304099, "time_this_iter_s": 61.26958203315735, "time_total_s": 29971.443410158157, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7691.82771396637, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 18.128735632183908, "ram_util_percent": 71.2310344827586}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.1875000000000002e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.99368045906976, "policy_loss": -2169039.26583284, "vf_loss": 4412709.970845481}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 115591.5, "diff_num_grad_updates_vs_sampler_policy": 115590.5}}, "num_env_steps_sampled": 11619120, "num_env_steps_trained": 11619120, "num_agent_steps_sampled": 11619120, "num_agent_steps_trained": 11619120}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -159093.9951989073, "episode_reward_mean": -154634.24610559698, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14132104151403785, "mean_inference_ms": 0.24051504239343668, "mean_action_processing_ms": 0.05892516084304938, "mean_env_wait_ms": 0.4646962225912377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030570030212402344, "StateBufferConnector_ms": 0.002286195755004883, "ViewRequirementAgentConnector_ms": 0.055374860763549805}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -159093.9951989073, "episode_reward_mean": -154634.24610559698, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154788.74980616066, -156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14132104151403785, "mean_inference_ms": 0.24051504239343668, "mean_action_processing_ms": 0.05892516084304938, "mean_env_wait_ms": 0.4646962225912377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030570030212402344, "StateBufferConnector_ms": 0.002286195755004883, "ViewRequirementAgentConnector_ms": 0.055374860763549805}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11619120, "num_agent_steps_trained": 11619120, "num_env_steps_sampled": 11619120, "num_env_steps_trained": 11619120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 706.1926589746593, "num_env_steps_trained_throughput_per_sec": 706.1926589746593, "timesteps_total": 11619120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11619120, "timers": {"training_iteration_time_ms": 61409.855, "sample_time_ms": 60259.098, "load_time_ms": 16.982, "load_throughput": 2586205.018, "learn_time_ms": 1132.664, "learn_throughput": 38775.831, "synch_weights_time_ms": 0.946}, "counters": {"num_env_steps_sampled": 11619120, "num_env_steps_trained": 11619120, "num_agent_steps_sampled": 11619120, "num_agent_steps_trained": 11619120}, "done": false, "episodes_total": 7717, "training_iteration": 1894, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-42-41", "timestamp": 1691304161, "time_this_iter_s": 62.19571399688721, "time_total_s": 30033.639124155045, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7754.023427963257, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 17.213636363636365, "ram_util_percent": 71.42386363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.88421848842074, "policy_loss": -2122322.4329531477, "vf_loss": 4280763.512208455}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 116277.5, "diff_num_grad_updates_vs_sampler_policy": 116276.5}}, "num_env_steps_sampled": 11663040, "num_env_steps_trained": 11663040, "num_agent_steps_sampled": 11663040, "num_agent_steps_trained": 11663040}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -159093.9951989073, "episode_reward_mean": -154613.515141896, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1415678374279268, "mean_inference_ms": 0.24091352860652623, "mean_action_processing_ms": 0.0590256188138767, "mean_env_wait_ms": 0.4654303036547935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030705928802490234, "StateBufferConnector_ms": 0.002294778823852539, "ViewRequirementAgentConnector_ms": 0.055609941482543945}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -159093.9951989073, "episode_reward_mean": -154613.515141896, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-156547.79727656464, -154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1415678374279268, "mean_inference_ms": 0.24091352860652623, "mean_action_processing_ms": 0.0590256188138767, "mean_env_wait_ms": 0.4654303036547935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030705928802490234, "StateBufferConnector_ms": 0.002294778823852539, "ViewRequirementAgentConnector_ms": 0.055609941482543945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11663040, "num_agent_steps_trained": 11663040, "num_env_steps_sampled": 11663040, "num_env_steps_trained": 11663040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 709.860529044992, "num_env_steps_trained_throughput_per_sec": 709.860529044992, "timesteps_total": 11663040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11663040, "timers": {"training_iteration_time_ms": 61471.039, "sample_time_ms": 60321.762, "load_time_ms": 16.821, "load_throughput": 2611054.785, "learn_time_ms": 1131.355, "learn_throughput": 38820.709, "synch_weights_time_ms": 0.941}, "counters": {"num_env_steps_sampled": 11663040, "num_env_steps_trained": 11663040, "num_agent_steps_sampled": 11663040, "num_agent_steps_trained": 11663040}, "done": false, "episodes_total": 7718, "training_iteration": 1895, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-43-43", "timestamp": 1691304223, "time_this_iter_s": 61.87490892410278, "time_total_s": 30095.514033079147, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7815.89833688736, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 17.84659090909091, "ram_util_percent": 71.42840909090908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.1817659428099, "policy_loss": -2258705.637305257, "vf_loss": 4587923.147412537}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 116963.5, "diff_num_grad_updates_vs_sampler_policy": 116962.5}}, "num_env_steps_sampled": 11706960, "num_env_steps_trained": 11706960, "num_agent_steps_sampled": 11706960, "num_agent_steps_trained": 11706960}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -159093.9951989073, "episode_reward_mean": -154616.0907852891, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1418183097195156, "mean_inference_ms": 0.241317629852163, "mean_action_processing_ms": 0.05912746917730488, "mean_env_wait_ms": 0.4661741974826726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003082275390625, "StateBufferConnector_ms": 0.0022995471954345703, "ViewRequirementAgentConnector_ms": 0.05582404136657715}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -159093.9951989073, "episode_reward_mean": -154616.0907852891, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154553.8245226547, -155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1418183097195156, "mean_inference_ms": 0.241317629852163, "mean_action_processing_ms": 0.05912746917730488, "mean_env_wait_ms": 0.4661741974826726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003082275390625, "StateBufferConnector_ms": 0.0022995471954345703, "ViewRequirementAgentConnector_ms": 0.05582404136657715}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11706960, "num_agent_steps_trained": 11706960, "num_env_steps_sampled": 11706960, "num_env_steps_trained": 11706960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.1817521144, "num_env_steps_trained_throughput_per_sec": 716.1817521144, "timesteps_total": 11706960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11706960, "timers": {"training_iteration_time_ms": 61439.718, "sample_time_ms": 60290.176, "load_time_ms": 16.849, "load_throughput": 2606621.222, "learn_time_ms": 1131.605, "learn_throughput": 38812.119, "synch_weights_time_ms": 0.928}, "counters": {"num_env_steps_sampled": 11706960, "num_env_steps_trained": 11706960, "num_agent_steps_sampled": 11706960, "num_agent_steps_trained": 11706960}, "done": false, "episodes_total": 7719, "training_iteration": 1896, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-44-45", "timestamp": 1691304285, "time_this_iter_s": 61.32850003242493, "time_total_s": 30156.842533111572, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7877.226836919785, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 17.744186046511622, "ram_util_percent": 71.47674418604652}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9936074126219, "policy_loss": -2082563.9299323524, "vf_loss": 4297878.161989796}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 117649.5, "diff_num_grad_updates_vs_sampler_policy": 117648.5}}, "num_env_steps_sampled": 11750880, "num_env_steps_trained": 11750880, "num_agent_steps_sampled": 11750880, "num_agent_steps_trained": 11750880}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -159093.9951989073, "episode_reward_mean": -154603.13484089897, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14207226617252755, "mean_inference_ms": 0.24172706434318963, "mean_action_processing_ms": 0.059230726137970986, "mean_env_wait_ms": 0.46692776421874244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030913352966308594, "StateBufferConnector_ms": 0.002310037612915039, "ViewRequirementAgentConnector_ms": 0.05604243278503418}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -159093.9951989073, "episode_reward_mean": -154603.13484089897, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155208.01661037453, -152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14207226617252755, "mean_inference_ms": 0.24172706434318963, "mean_action_processing_ms": 0.059230726137970986, "mean_env_wait_ms": 0.46692776421874244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030913352966308594, "StateBufferConnector_ms": 0.002310037612915039, "ViewRequirementAgentConnector_ms": 0.05604243278503418}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11750880, "num_agent_steps_trained": 11750880, "num_env_steps_sampled": 11750880, "num_env_steps_trained": 11750880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.5878620429814, "num_env_steps_trained_throughput_per_sec": 712.5878620429814, "timesteps_total": 11750880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11750880, "timers": {"training_iteration_time_ms": 61479.221, "sample_time_ms": 60330.811, "load_time_ms": 16.713, "load_throughput": 2627939.543, "learn_time_ms": 1130.616, "learn_throughput": 38846.094, "synch_weights_time_ms": 0.923}, "counters": {"num_env_steps_sampled": 11750880, "num_env_steps_trained": 11750880, "num_agent_steps_sampled": 11750880, "num_agent_steps_trained": 11750880}, "done": false, "episodes_total": 7720, "training_iteration": 1897, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-45-46", "timestamp": 1691304346, "time_this_iter_s": 61.637587785720825, "time_total_s": 30218.480120897293, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7938.864424705505, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 16.9375, "ram_util_percent": 71.7534090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0800987666272, "policy_loss": -2185069.7177791316, "vf_loss": 4266543.871720117}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 118335.5, "diff_num_grad_updates_vs_sampler_policy": 118334.5}}, "num_env_steps_sampled": 11794800, "num_env_steps_trained": 11794800, "num_agent_steps_sampled": 11794800, "num_agent_steps_trained": 11794800}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -159093.9951989073, "episode_reward_mean": -154574.95621381036, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14232974198085635, "mean_inference_ms": 0.2421420134165442, "mean_action_processing_ms": 0.059335369029729676, "mean_env_wait_ms": 0.46769087126702935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003101348876953125, "StateBufferConnector_ms": 0.0023193359375, "ViewRequirementAgentConnector_ms": 0.056267499923706055}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -159093.9951989073, "episode_reward_mean": -154574.95621381036, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152627.13032003376, -156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14232974198085635, "mean_inference_ms": 0.2421420134165442, "mean_action_processing_ms": 0.059335369029729676, "mean_env_wait_ms": 0.46769087126702935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003101348876953125, "StateBufferConnector_ms": 0.0023193359375, "ViewRequirementAgentConnector_ms": 0.056267499923706055}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11794800, "num_agent_steps_trained": 11794800, "num_env_steps_sampled": 11794800, "num_env_steps_trained": 11794800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.1561097755092, "num_env_steps_trained_throughput_per_sec": 717.1561097755092, "timesteps_total": 11794800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11794800, "timers": {"training_iteration_time_ms": 61465.651, "sample_time_ms": 60318.301, "load_time_ms": 16.773, "load_throughput": 2618488.834, "learn_time_ms": 1129.487, "learn_throughput": 38884.921, "synch_weights_time_ms": 0.928}, "counters": {"num_env_steps_sampled": 11794800, "num_env_steps_trained": 11794800, "num_agent_steps_sampled": 11794800, "num_agent_steps_trained": 11794800}, "done": false, "episodes_total": 7721, "training_iteration": 1898, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-46-48", "timestamp": 1691304408, "time_this_iter_s": 61.24485182762146, "time_total_s": 30279.724972724915, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8000.109276533127, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 17.55813953488372, "ram_util_percent": 71.75348837209302}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0369970916659, "policy_loss": -2247376.834428526, "vf_loss": 4518024.966107871}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 119021.5, "diff_num_grad_updates_vs_sampler_policy": 119020.5}}, "num_env_steps_sampled": 11838720, "num_env_steps_trained": 11838720, "num_agent_steps_sampled": 11838720, "num_agent_steps_trained": 11838720}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -159093.9951989073, "episode_reward_mean": -154609.7284384289, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1425907983793937, "mean_inference_ms": 0.24256238294938193, "mean_action_processing_ms": 0.05944139393986198, "mean_env_wait_ms": 0.4684634526579742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003117084503173828, "StateBufferConnector_ms": 0.0023300647735595703, "ViewRequirementAgentConnector_ms": 0.05652046203613281}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -159093.9951989073, "episode_reward_mean": -154609.7284384289, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-156345.99603611496, -153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1425907983793937, "mean_inference_ms": 0.24256238294938193, "mean_action_processing_ms": 0.05944139393986198, "mean_env_wait_ms": 0.4684634526579742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003117084503173828, "StateBufferConnector_ms": 0.0023300647735595703, "ViewRequirementAgentConnector_ms": 0.05652046203613281}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11838720, "num_agent_steps_trained": 11838720, "num_env_steps_sampled": 11838720, "num_env_steps_trained": 11838720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.152254822717, "num_env_steps_trained_throughput_per_sec": 712.152254822717, "timesteps_total": 11838720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11838720, "timers": {"training_iteration_time_ms": 61520.44, "sample_time_ms": 60374.891, "load_time_ms": 16.86, "load_throughput": 2605036.19, "learn_time_ms": 1127.613, "learn_throughput": 38949.535, "synch_weights_time_ms": 0.919}, "counters": {"num_env_steps_sampled": 11838720, "num_env_steps_trained": 11838720, "num_agent_steps_sampled": 11838720, "num_agent_steps_trained": 11838720}, "done": false, "episodes_total": 7722, "training_iteration": 1899, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-47-49", "timestamp": 1691304469, "time_this_iter_s": 61.675169944763184, "time_total_s": 30341.400142669678, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8061.78444647789, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 17.11704545454546, "ram_util_percent": 71.70340909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9977347148751, "policy_loss": -1839356.557039222, "vf_loss": 4232527.821975219}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 119707.5, "diff_num_grad_updates_vs_sampler_policy": 119706.5}}, "num_env_steps_sampled": 11882640, "num_env_steps_trained": 11882640, "num_agent_steps_sampled": 11882640, "num_agent_steps_trained": 11882640}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -159093.9951989073, "episode_reward_mean": -154566.87020182732, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14285526676037408, "mean_inference_ms": 0.24298797487684415, "mean_action_processing_ms": 0.05954873262658628, "mean_env_wait_ms": 0.46924626235789973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003127574920654297, "StateBufferConnector_ms": 0.0023348331451416016, "ViewRequirementAgentConnector_ms": 0.0567471981048584}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -159093.9951989073, "episode_reward_mean": -154566.87020182732, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-153450.34539910112, -153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14285526676037408, "mean_inference_ms": 0.24298797487684415, "mean_action_processing_ms": 0.05954873262658628, "mean_env_wait_ms": 0.46924626235789973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003127574920654297, "StateBufferConnector_ms": 0.0023348331451416016, "ViewRequirementAgentConnector_ms": 0.0567471981048584}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11882640, "num_agent_steps_trained": 11882640, "num_env_steps_sampled": 11882640, "num_env_steps_trained": 11882640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.6664455177056, "num_env_steps_trained_throughput_per_sec": 713.6664455177056, "timesteps_total": 11882640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11882640, "timers": {"training_iteration_time_ms": 61529.045, "sample_time_ms": 60384.013, "load_time_ms": 16.896, "load_throughput": 2599419.361, "learn_time_ms": 1127.056, "learn_throughput": 38968.77, "synch_weights_time_ms": 0.922}, "counters": {"num_env_steps_sampled": 11882640, "num_env_steps_trained": 11882640, "num_agent_steps_sampled": 11882640, "num_agent_steps_trained": 11882640}, "done": false, "episodes_total": 7723, "training_iteration": 1900, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-48-51", "timestamp": 1691304531, "time_this_iter_s": 61.54441690444946, "time_total_s": 30402.944559574127, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8123.3288633823395, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 17.380459770114943, "ram_util_percent": 71.72528735632184}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.03732909266523, "policy_loss": -1918955.0071576622, "vf_loss": 4402567.9641034985}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 120393.5, "diff_num_grad_updates_vs_sampler_policy": 120392.5}}, "num_env_steps_sampled": 11926560, "num_env_steps_trained": 11926560, "num_agent_steps_sampled": 11926560, "num_agent_steps_trained": 11926560}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -159093.9951989073, "episode_reward_mean": -154572.79749287193, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14312293182230643, "mean_inference_ms": 0.24341889749635548, "mean_action_processing_ms": 0.05965742731363554, "mean_env_wait_ms": 0.47003806282669125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031404495239257812, "StateBufferConnector_ms": 0.0023419857025146484, "ViewRequirementAgentConnector_ms": 0.056998252868652344}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -159093.9951989073, "episode_reward_mean": -154572.79749287193, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-153090.36860059292, -155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14312293182230643, "mean_inference_ms": 0.24341889749635548, "mean_action_processing_ms": 0.05965742731363554, "mean_env_wait_ms": 0.47003806282669125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031404495239257812, "StateBufferConnector_ms": 0.0023419857025146484, "ViewRequirementAgentConnector_ms": 0.056998252868652344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11926560, "num_agent_steps_trained": 11926560, "num_env_steps_sampled": 11926560, "num_env_steps_trained": 11926560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 721.0221362929959, "num_env_steps_trained_throughput_per_sec": 721.0221362929959, "timesteps_total": 11926560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11926560, "timers": {"training_iteration_time_ms": 61493.585, "sample_time_ms": 60348.661, "load_time_ms": 16.878, "load_throughput": 2602250.476, "learn_time_ms": 1126.986, "learn_throughput": 38971.209, "synch_weights_time_ms": 0.903}, "counters": {"num_env_steps_sampled": 11926560, "num_env_steps_trained": 11926560, "num_agent_steps_sampled": 11926560, "num_agent_steps_trained": 11926560}, "done": false, "episodes_total": 7724, "training_iteration": 1901, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-49-52", "timestamp": 1691304592, "time_this_iter_s": 60.91669464111328, "time_total_s": 30463.86125421524, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8184.245558023453, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 17.398837209302325, "ram_util_percent": 71.7639534883721}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0142489953222, "policy_loss": -2029946.1674135614, "vf_loss": 4477251.744169096}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 121079.5, "diff_num_grad_updates_vs_sampler_policy": 121078.5}}, "num_env_steps_sampled": 11970480, "num_env_steps_trained": 11970480, "num_agent_steps_sampled": 11970480, "num_agent_steps_trained": 11970480}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -159093.9951989073, "episode_reward_mean": -154590.751014233, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14339370245098093, "mean_inference_ms": 0.24385484724540313, "mean_action_processing_ms": 0.05976744865611796, "mean_env_wait_ms": 0.4708391606417219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003153562545776367, "StateBufferConnector_ms": 0.002354860305786133, "ViewRequirementAgentConnector_ms": 0.05719113349914551}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -159093.9951989073, "episode_reward_mean": -154590.751014233, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155193.16841881734, -156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14339370245098093, "mean_inference_ms": 0.24385484724540313, "mean_action_processing_ms": 0.05976744865611796, "mean_env_wait_ms": 0.4708391606417219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003153562545776367, "StateBufferConnector_ms": 0.002354860305786133, "ViewRequirementAgentConnector_ms": 0.05719113349914551}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11970480, "num_agent_steps_trained": 11970480, "num_env_steps_sampled": 11970480, "num_env_steps_trained": 11970480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 721.7784149917402, "num_env_steps_trained_throughput_per_sec": 721.7784149917402, "timesteps_total": 11970480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 11970480, "timers": {"training_iteration_time_ms": 61450.796, "sample_time_ms": 60305.756, "load_time_ms": 16.9, "load_throughput": 2598832.612, "learn_time_ms": 1127.072, "learn_throughput": 38968.242, "synch_weights_time_ms": 0.91}, "counters": {"num_env_steps_sampled": 11970480, "num_env_steps_trained": 11970480, "num_agent_steps_sampled": 11970480, "num_agent_steps_trained": 11970480}, "done": false, "episodes_total": 7725, "training_iteration": 1902, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-50-53", "timestamp": 1691304653, "time_this_iter_s": 60.85273718833923, "time_total_s": 30524.71399140358, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8245.098295211792, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 17.505813953488378, "ram_util_percent": 71.74186046511629}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.092150941187, "policy_loss": -2292802.4730719295, "vf_loss": 4659719.96920554}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 121765.5, "diff_num_grad_updates_vs_sampler_policy": 121764.5}}, "num_env_steps_sampled": 12014400, "num_env_steps_trained": 12014400, "num_agent_steps_sampled": 12014400, "num_agent_steps_trained": 12014400}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -159093.9951989073, "episode_reward_mean": -154622.39099533754, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1436677474113314, "mean_inference_ms": 0.24429603887465773, "mean_action_processing_ms": 0.059878820748334054, "mean_env_wait_ms": 0.47165017141898113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003165006637573242, "StateBufferConnector_ms": 0.0023658275604248047, "ViewRequirementAgentConnector_ms": 0.05743718147277832}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -159093.9951989073, "episode_reward_mean": -154622.39099533754, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-156656.77423692675, -154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1436677474113314, "mean_inference_ms": 0.24429603887465773, "mean_action_processing_ms": 0.059878820748334054, "mean_env_wait_ms": 0.47165017141898113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003165006637573242, "StateBufferConnector_ms": 0.0023658275604248047, "ViewRequirementAgentConnector_ms": 0.05743718147277832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12014400, "num_agent_steps_trained": 12014400, "num_env_steps_sampled": 12014400, "num_env_steps_trained": 12014400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.6328092446943, "num_env_steps_trained_throughput_per_sec": 715.6328092446943, "timesteps_total": 12014400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12014400, "timers": {"training_iteration_time_ms": 61461.441, "sample_time_ms": 60317.225, "load_time_ms": 16.779, "load_throughput": 2617633.048, "learn_time_ms": 1126.363, "learn_throughput": 38992.758, "synch_weights_time_ms": 0.917}, "counters": {"num_env_steps_sampled": 12014400, "num_env_steps_trained": 12014400, "num_agent_steps_sampled": 12014400, "num_agent_steps_trained": 12014400}, "done": false, "episodes_total": 7726, "training_iteration": 1903, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-51-54", "timestamp": 1691304714, "time_this_iter_s": 61.375441789627075, "time_total_s": 30586.089433193207, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8306.473737001419, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 17.039080459770116, "ram_util_percent": 71.69540229885058}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.375e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.01605558256364, "policy_loss": -1988401.7901557945, "vf_loss": 4250564.527879009}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 122451.5, "diff_num_grad_updates_vs_sampler_policy": 122450.5}}, "num_env_steps_sampled": 12058320, "num_env_steps_trained": 12058320, "num_agent_steps_sampled": 12058320, "num_agent_steps_trained": 12058320}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -159093.9951989073, "episode_reward_mean": -154578.66316983046, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14394508669072698, "mean_inference_ms": 0.24474248242964447, "mean_action_processing_ms": 0.059991502454200034, "mean_env_wait_ms": 0.47247145366931453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003177165985107422, "StateBufferConnector_ms": 0.0023741722106933594, "ViewRequirementAgentConnector_ms": 0.05766892433166504}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -159093.9951989073, "episode_reward_mean": -154578.66316983046, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154441.6894089965, -153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14394508669072698, "mean_inference_ms": 0.24474248242964447, "mean_action_processing_ms": 0.059991502454200034, "mean_env_wait_ms": 0.47247145366931453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003177165985107422, "StateBufferConnector_ms": 0.0023741722106933594, "ViewRequirementAgentConnector_ms": 0.05766892433166504}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12058320, "num_agent_steps_trained": 12058320, "num_env_steps_sampled": 12058320, "num_env_steps_trained": 12058320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.7306677556353, "num_env_steps_trained_throughput_per_sec": 715.7306677556353, "timesteps_total": 12058320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12058320, "timers": {"training_iteration_time_ms": 61378.562, "sample_time_ms": 60234.743, "load_time_ms": 16.822, "load_throughput": 2610910.457, "learn_time_ms": 1125.929, "learn_throughput": 39007.781, "synch_weights_time_ms": 0.91}, "counters": {"num_env_steps_sampled": 12058320, "num_env_steps_trained": 12058320, "num_agent_steps_sampled": 12058320, "num_agent_steps_trained": 12058320}, "done": false, "episodes_total": 7727, "training_iteration": 1904, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-52-55", "timestamp": 1691304775, "time_this_iter_s": 61.366952896118164, "time_total_s": 30647.456386089325, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8367.840689897537, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 18.559770114942523, "ram_util_percent": 71.8528735632184}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.749999999999999e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.08936316487393, "policy_loss": -2317635.6394605273, "vf_loss": 4578053.643221574}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 123137.5, "diff_num_grad_updates_vs_sampler_policy": 123136.5}}, "num_env_steps_sampled": 12102240, "num_env_steps_trained": 12102240, "num_agent_steps_sampled": 12102240, "num_agent_steps_trained": 12102240}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -159093.9951989073, "episode_reward_mean": -154604.11552938403, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14422543401684734, "mean_inference_ms": 0.2451941287558199, "mean_action_processing_ms": 0.06010546531592951, "mean_env_wait_ms": 0.4733016510192654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003186464309692383, "StateBufferConnector_ms": 0.0023827552795410156, "ViewRequirementAgentConnector_ms": 0.05785417556762695}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -159093.9951989073, "episode_reward_mean": -154604.11552938403, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-153257.58464680534, -150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14422543401684734, "mean_inference_ms": 0.2451941287558199, "mean_action_processing_ms": 0.06010546531592951, "mean_env_wait_ms": 0.4733016510192654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003186464309692383, "StateBufferConnector_ms": 0.0023827552795410156, "ViewRequirementAgentConnector_ms": 0.05785417556762695}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12102240, "num_agent_steps_trained": 12102240, "num_env_steps_sampled": 12102240, "num_env_steps_trained": 12102240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.6989149355246, "num_env_steps_trained_throughput_per_sec": 717.6989149355246, "timesteps_total": 12102240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12102240, "timers": {"training_iteration_time_ms": 61310.989, "sample_time_ms": 60166.964, "load_time_ms": 16.935, "load_throughput": 2593425.016, "learn_time_ms": 1126.022, "learn_throughput": 39004.57, "synch_weights_time_ms": 0.911}, "counters": {"num_env_steps_sampled": 12102240, "num_env_steps_trained": 12102240, "num_agent_steps_sampled": 12102240, "num_agent_steps_trained": 12102240}, "done": false, "episodes_total": 7728, "training_iteration": 1905, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-53-57", "timestamp": 1691304837, "time_this_iter_s": 61.1986129283905, "time_total_s": 30708.654999017715, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8429.039302825928, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 17.174712643678163, "ram_util_percent": 72.01264367816093}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.125e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.06866762033354, "policy_loss": -1968076.0594194152, "vf_loss": 4470449.3321793005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 123823.5, "diff_num_grad_updates_vs_sampler_policy": 123822.5}}, "num_env_steps_sampled": 12146160, "num_env_steps_trained": 12146160, "num_agent_steps_sampled": 12146160, "num_agent_steps_trained": 12146160}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -159093.9951989073, "episode_reward_mean": -154627.17698268843, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1445090094257765, "mean_inference_ms": 0.24565075204756875, "mean_action_processing_ms": 0.06022068391382986, "mean_env_wait_ms": 0.474141222703443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032041072845458984, "StateBufferConnector_ms": 0.0023899078369140625, "ViewRequirementAgentConnector_ms": 0.05806779861450195}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -159093.9951989073, "episode_reward_mean": -154627.17698268843, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-150890.37279502169, -157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1445090094257765, "mean_inference_ms": 0.24565075204756875, "mean_action_processing_ms": 0.06022068391382986, "mean_env_wait_ms": 0.474141222703443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032041072845458984, "StateBufferConnector_ms": 0.0023899078369140625, "ViewRequirementAgentConnector_ms": 0.05806779861450195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12146160, "num_agent_steps_trained": 12146160, "num_env_steps_sampled": 12146160, "num_env_steps_trained": 12146160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.3202578356113, "num_env_steps_trained_throughput_per_sec": 713.3202578356113, "timesteps_total": 12146160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12146160, "timers": {"training_iteration_time_ms": 61335.59, "sample_time_ms": 60191.666, "load_time_ms": 16.879, "load_throughput": 2602121.823, "learn_time_ms": 1125.961, "learn_throughput": 39006.668, "synch_weights_time_ms": 0.925}, "counters": {"num_env_steps_sampled": 12146160, "num_env_steps_trained": 12146160, "num_agent_steps_sampled": 12146160, "num_agent_steps_trained": 12146160}, "done": false, "episodes_total": 7729, "training_iteration": 1906, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-54-58", "timestamp": 1691304898, "time_this_iter_s": 61.574033975601196, "time_total_s": 30770.229032993317, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8490.613336801529, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 17.768965517241377, "ram_util_percent": 71.99310344827586}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.5e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.99432470916656, "policy_loss": -2137974.9994704355, "vf_loss": 4492292.221574344}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 124509.5, "diff_num_grad_updates_vs_sampler_policy": 124508.5}}, "num_env_steps_sampled": 12190080, "num_env_steps_trained": 12190080, "num_agent_steps_sampled": 12190080, "num_agent_steps_trained": 12190080}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -159093.9951989073, "episode_reward_mean": -154674.6127075417, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14479580063373268, "mean_inference_ms": 0.24611227609910913, "mean_action_processing_ms": 0.06033714656898935, "mean_env_wait_ms": 0.47498936228962907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032110214233398438, "StateBufferConnector_ms": 0.0024030208587646484, "ViewRequirementAgentConnector_ms": 0.058295249938964844}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -159093.9951989073, "episode_reward_mean": -154674.6127075417, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157547.46344490416, -154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14479580063373268, "mean_inference_ms": 0.24611227609910913, "mean_action_processing_ms": 0.06033714656898935, "mean_env_wait_ms": 0.47498936228962907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032110214233398438, "StateBufferConnector_ms": 0.0024030208587646484, "ViewRequirementAgentConnector_ms": 0.058295249938964844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12190080, "num_agent_steps_trained": 12190080, "num_env_steps_sampled": 12190080, "num_env_steps_trained": 12190080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.0313376151759, "num_env_steps_trained_throughput_per_sec": 717.0313376151759, "timesteps_total": 12190080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12190080, "timers": {"training_iteration_time_ms": 61297.395, "sample_time_ms": 60153.085, "load_time_ms": 16.817, "load_throughput": 2611702.607, "learn_time_ms": 1126.399, "learn_throughput": 38991.511, "synch_weights_time_ms": 0.936}, "counters": {"num_env_steps_sampled": 12190080, "num_env_steps_trained": 12190080, "num_agent_steps_sampled": 12190080, "num_agent_steps_trained": 12190080}, "done": false, "episodes_total": 7730, "training_iteration": 1907, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-56-00", "timestamp": 1691304960, "time_this_iter_s": 61.25555205345154, "time_total_s": 30831.48458504677, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8551.86888885498, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 17.517441860465123, "ram_util_percent": 71.94302325581394}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.874999999999998e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.00097375986525, "policy_loss": -2458685.751600082, "vf_loss": 4810458.442602041}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 125195.5, "diff_num_grad_updates_vs_sampler_policy": 125194.5}}, "num_env_steps_sampled": 12234000, "num_env_steps_trained": 12234000, "num_agent_steps_sampled": 12234000, "num_agent_steps_trained": 12234000}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154699.2685364998, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1450854615352609, "mean_inference_ms": 0.24657868063518254, "mean_action_processing_ms": 0.060454844303074545, "mean_env_wait_ms": 0.4758464269267158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003226041793823242, "StateBufferConnector_ms": 0.0024137496948242188, "ViewRequirementAgentConnector_ms": 0.05854368209838867}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154699.2685364998, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154427.9045242138, -154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1450854615352609, "mean_inference_ms": 0.24657868063518254, "mean_action_processing_ms": 0.060454844303074545, "mean_env_wait_ms": 0.4758464269267158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003226041793823242, "StateBufferConnector_ms": 0.0024137496948242188, "ViewRequirementAgentConnector_ms": 0.05854368209838867}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12234000, "num_agent_steps_trained": 12234000, "num_env_steps_sampled": 12234000, "num_env_steps_trained": 12234000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 718.4843879097845, "num_env_steps_trained_throughput_per_sec": 718.4843879097845, "timesteps_total": 12234000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12234000, "timers": {"training_iteration_time_ms": 61286.073, "sample_time_ms": 60140.311, "load_time_ms": 16.778, "load_throughput": 2617733.481, "learn_time_ms": 1127.906, "learn_throughput": 38939.424, "synch_weights_time_ms": 0.923}, "counters": {"num_env_steps_sampled": 12234000, "num_env_steps_trained": 12234000, "num_agent_steps_sampled": 12234000, "num_agent_steps_trained": 12234000}, "done": false, "episodes_total": 7731, "training_iteration": 1908, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-57-01", "timestamp": 1691305021, "time_this_iter_s": 61.13178300857544, "time_total_s": 30892.616368055344, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8613.000671863556, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 17.363218390804597, "ram_util_percent": 72.00344827586206}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.249999999999999e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.04161071777344, "policy_loss": -1849013.63803412, "vf_loss": 4304676.683035715}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 125881.5, "diff_num_grad_updates_vs_sampler_policy": 125880.5}}, "num_env_steps_sampled": 12277920, "num_env_steps_trained": 12277920, "num_agent_steps_sampled": 12277920, "num_agent_steps_trained": 12277920}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154686.85237177808, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14537789719875885, "mean_inference_ms": 0.24704995337424304, "mean_action_processing_ms": 0.060573776792672625, "mean_env_wait_ms": 0.4767124748861086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032362937927246094, "StateBufferConnector_ms": 0.0024263858795166016, "ViewRequirementAgentConnector_ms": 0.05875587463378906}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154686.85237177808, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154242.6019684485, -155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14537789719875885, "mean_inference_ms": 0.24704995337424304, "mean_action_processing_ms": 0.060573776792672625, "mean_env_wait_ms": 0.4767124748861086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032362937927246094, "StateBufferConnector_ms": 0.0024263858795166016, "ViewRequirementAgentConnector_ms": 0.05875587463378906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12277920, "num_agent_steps_trained": 12277920, "num_env_steps_sampled": 12277920, "num_env_steps_trained": 12277920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.2903124472404, "num_env_steps_trained_throughput_per_sec": 717.2903124472404, "timesteps_total": 12277920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12277920, "timers": {"training_iteration_time_ms": 61241.897, "sample_time_ms": 60095.395, "load_time_ms": 16.913, "load_throughput": 2596872.592, "learn_time_ms": 1128.505, "learn_throughput": 38918.741, "synch_weights_time_ms": 0.928}, "counters": {"num_env_steps_sampled": 12277920, "num_env_steps_trained": 12277920, "num_agent_steps_sampled": 12277920, "num_agent_steps_trained": 12277920}, "done": false, "episodes_total": 7732, "training_iteration": 1909, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-58-02", "timestamp": 1691305082, "time_this_iter_s": 61.23322010040283, "time_total_s": 30953.849588155746, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8674.233891963959, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 16.968965517241383, "ram_util_percent": 71.98160919540229}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.6250000000000006e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0572446595128, "policy_loss": -2244474.702322112, "vf_loss": 4565665.200163994}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 126567.5, "diff_num_grad_updates_vs_sampler_policy": 126566.5}}, "num_env_steps_sampled": 12321840, "num_env_steps_trained": 12321840, "num_agent_steps_sampled": 12321840, "num_agent_steps_trained": 12321840}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154711.2784669941, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14567326566289407, "mean_inference_ms": 0.2475258562621241, "mean_action_processing_ms": 0.060693912681161546, "mean_env_wait_ms": 0.4775867489301958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003247499465942383, "StateBufferConnector_ms": 0.002438068389892578, "ViewRequirementAgentConnector_ms": 0.058980703353881836}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154711.2784669941, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155766.17058155427, -153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14567326566289407, "mean_inference_ms": 0.2475258562621241, "mean_action_processing_ms": 0.060693912681161546, "mean_env_wait_ms": 0.4775867489301958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003247499465942383, "StateBufferConnector_ms": 0.002438068389892578, "ViewRequirementAgentConnector_ms": 0.058980703353881836}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12321840, "num_agent_steps_trained": 12321840, "num_env_steps_sampled": 12321840, "num_env_steps_trained": 12321840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 718.4285875231943, "num_env_steps_trained_throughput_per_sec": 718.4285875231943, "timesteps_total": 12321840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12321840, "timers": {"training_iteration_time_ms": 61201.104, "sample_time_ms": 60054.655, "load_time_ms": 16.777, "load_throughput": 2617878.565, "learn_time_ms": 1128.598, "learn_throughput": 38915.523, "synch_weights_time_ms": 0.916}, "counters": {"num_env_steps_sampled": 12321840, "num_env_steps_trained": 12321840, "num_agent_steps_sampled": 12321840, "num_agent_steps_trained": 12321840}, "done": false, "episodes_total": 7733, "training_iteration": 1910, "trial_id": "5f2ac_00000", "date": "2023-08-06_09-59-03", "timestamp": 1691305143, "time_this_iter_s": 61.13656711578369, "time_total_s": 31014.98615527153, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8735.370459079742, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 17.37790697674419, "ram_util_percent": 71.89302325581397}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.214906920497, "policy_loss": -2224853.33744078, "vf_loss": 4547535.189048834}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 127253.5, "diff_num_grad_updates_vs_sampler_policy": 127252.5}}, "num_env_steps_sampled": 12365760, "num_env_steps_trained": 12365760, "num_agent_steps_sampled": 12365760, "num_agent_steps_trained": 12365760}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154712.4108846027, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1459715812402032, "mean_inference_ms": 0.2480062371958719, "mean_action_processing_ms": 0.06081525354620381, "mean_env_wait_ms": 0.47846935000668755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003270387649536133, "StateBufferConnector_ms": 0.0024428367614746094, "ViewRequirementAgentConnector_ms": 0.05919647216796875}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154712.4108846027, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-153206.99878633398, -155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1459715812402032, "mean_inference_ms": 0.2480062371958719, "mean_action_processing_ms": 0.06081525354620381, "mean_env_wait_ms": 0.47846935000668755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003270387649536133, "StateBufferConnector_ms": 0.0024428367614746094, "ViewRequirementAgentConnector_ms": 0.05919647216796875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12365760, "num_agent_steps_trained": 12365760, "num_env_steps_sampled": 12365760, "num_env_steps_trained": 12365760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.9036933338695, "num_env_steps_trained_throughput_per_sec": 716.9036933338695, "timesteps_total": 12365760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12365760, "timers": {"training_iteration_time_ms": 61236.097, "sample_time_ms": 60089.861, "load_time_ms": 16.784, "load_throughput": 2616770.388, "learn_time_ms": 1128.363, "learn_throughput": 38923.659, "synch_weights_time_ms": 0.932}, "counters": {"num_env_steps_sampled": 12365760, "num_env_steps_trained": 12365760, "num_agent_steps_sampled": 12365760, "num_agent_steps_trained": 12365760}, "done": false, "episodes_total": 7734, "training_iteration": 1911, "trial_id": "5f2ac_00000", "date": "2023-08-06_10-00-04", "timestamp": 1691305204, "time_this_iter_s": 61.266361951828, "time_total_s": 31076.252517223358, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8796.63682103157, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 17.77701149425287, "ram_util_percent": 71.86896551724138}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.84971618652344, "policy_loss": -2142912.0165303843, "vf_loss": 4330099.50728863}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 127939.5, "diff_num_grad_updates_vs_sampler_policy": 127938.5}}, "num_env_steps_sampled": 12409680, "num_env_steps_trained": 12409680, "num_agent_steps_sampled": 12409680, "num_agent_steps_trained": 12409680}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154716.1501517397, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14627274030093398, "mean_inference_ms": 0.2484910819817038, "mean_action_processing_ms": 0.06093774996559942, "mean_env_wait_ms": 0.4793606433233968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032842159271240234, "StateBufferConnector_ms": 0.0024538040161132812, "ViewRequirementAgentConnector_ms": 0.059391021728515625}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154716.1501517397, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155264.4895055628, -152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14627274030093398, "mean_inference_ms": 0.2484910819817038, "mean_action_processing_ms": 0.06093774996559942, "mean_env_wait_ms": 0.4793606433233968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032842159271240234, "StateBufferConnector_ms": 0.0024538040161132812, "ViewRequirementAgentConnector_ms": 0.059391021728515625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12409680, "num_agent_steps_trained": 12409680, "num_env_steps_sampled": 12409680, "num_env_steps_trained": 12409680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 719.4840575866483, "num_env_steps_trained_throughput_per_sec": 719.4840575866483, "timesteps_total": 12409680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12409680, "timers": {"training_iteration_time_ms": 61255.501, "sample_time_ms": 60109.278, "load_time_ms": 16.791, "load_throughput": 2615681.718, "learn_time_ms": 1128.342, "learn_throughput": 38924.366, "synch_weights_time_ms": 0.933}, "counters": {"num_env_steps_sampled": 12409680, "num_env_steps_trained": 12409680, "num_agent_steps_sampled": 12409680, "num_agent_steps_trained": 12409680}, "done": false, "episodes_total": 7735, "training_iteration": 1912, "trial_id": "5f2ac_00000", "date": "2023-08-06_10-01-06", "timestamp": 1691305266, "time_this_iter_s": 61.046929121017456, "time_total_s": 31137.299446344376, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8857.683750152588, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 19.540697674418606, "ram_util_percent": 71.89651162790697}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9266643468562, "policy_loss": -2035426.4015010023, "vf_loss": 4404038.4664723035}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 128625.5, "diff_num_grad_updates_vs_sampler_policy": 128624.5}}, "num_env_steps_sampled": 12453600, "num_env_steps_trained": 12453600, "num_agent_steps_sampled": 12453600, "num_agent_steps_trained": 12453600}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154707.65731812984, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14657682336522004, "mean_inference_ms": 0.2489804080566345, "mean_action_processing_ms": 0.061061407963068144, "mean_env_wait_ms": 0.4802604065614958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032935142517089844, "StateBufferConnector_ms": 0.0024635791778564453, "ViewRequirementAgentConnector_ms": 0.05959486961364746}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154707.65731812984, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152033.5937491229, -154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14657682336522004, "mean_inference_ms": 0.2489804080566345, "mean_action_processing_ms": 0.061061407963068144, "mean_env_wait_ms": 0.4802604065614958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032935142517089844, "StateBufferConnector_ms": 0.0024635791778564453, "ViewRequirementAgentConnector_ms": 0.05959486961364746}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12453600, "num_agent_steps_trained": 12453600, "num_env_steps_sampled": 12453600, "num_env_steps_trained": 12453600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 720.139461071832, "num_env_steps_trained_throughput_per_sec": 720.139461071832, "timesteps_total": 12453600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12453600, "timers": {"training_iteration_time_ms": 61217.094, "sample_time_ms": 60071.134, "load_time_ms": 16.871, "load_throughput": 2603309.596, "learn_time_ms": 1127.957, "learn_throughput": 38937.647, "synch_weights_time_ms": 0.966}, "counters": {"num_env_steps_sampled": 12453600, "num_env_steps_trained": 12453600, "num_agent_steps_sampled": 12453600, "num_agent_steps_trained": 12453600}, "done": false, "episodes_total": 7736, "training_iteration": 1913, "trial_id": "5f2ac_00000", "date": "2023-08-06_10-02-07", "timestamp": 1691305327, "time_this_iter_s": 60.99206876754761, "time_total_s": 31198.291515111923, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8918.675818920135, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 16.78488372093023, "ram_util_percent": 71.83023255813954}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0373079616891, "policy_loss": -2092811.4585003643, "vf_loss": 4457411.673378279}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 129311.5, "diff_num_grad_updates_vs_sampler_policy": 129310.5}}, "num_env_steps_sampled": 12497520, "num_env_steps_trained": 12497520, "num_agent_steps_sampled": 12497520, "num_agent_steps_trained": 12497520}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154737.77447413653, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14688380108089924, "mean_inference_ms": 0.24947417154965937, "mean_action_processing_ms": 0.06118620185002571, "mean_env_wait_ms": 0.48116837333983464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003305673599243164, "StateBufferConnector_ms": 0.0024755001068115234, "ViewRequirementAgentConnector_ms": 0.05979561805725098}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154737.77447413653, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154999.65340624642, -157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14688380108089924, "mean_inference_ms": 0.24947417154965937, "mean_action_processing_ms": 0.06118620185002571, "mean_env_wait_ms": 0.48116837333983464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003305673599243164, "StateBufferConnector_ms": 0.0024755001068115234, "ViewRequirementAgentConnector_ms": 0.05979561805725098}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12497520, "num_agent_steps_trained": 12497520, "num_env_steps_sampled": 12497520, "num_env_steps_trained": 12497520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.0617332118784, "num_env_steps_trained_throughput_per_sec": 716.0617332118784, "timesteps_total": 12497520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12497520, "timers": {"training_iteration_time_ms": 61214.257, "sample_time_ms": 60067.355, "load_time_ms": 16.806, "load_throughput": 2613362.496, "learn_time_ms": 1128.96, "learn_throughput": 38903.064, "synch_weights_time_ms": 0.97}, "counters": {"num_env_steps_sampled": 12497520, "num_env_steps_trained": 12497520, "num_agent_steps_sampled": 12497520, "num_agent_steps_trained": 12497520}, "done": false, "episodes_total": 7737, "training_iteration": 1914, "trial_id": "5f2ac_00000", "date": "2023-08-06_10-03-08", "timestamp": 1691305388, "time_this_iter_s": 61.33848190307617, "time_total_s": 31259.629997015, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8980.014300823212, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 17.486206896551725, "ram_util_percent": 71.86321839080459}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9323115668561, "policy_loss": -1989561.124977223, "vf_loss": 4350416.012572886}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 129997.5, "diff_num_grad_updates_vs_sampler_policy": 129996.5}}, "num_env_steps_sampled": 12541440, "num_env_steps_trained": 12541440, "num_agent_steps_sampled": 12541440, "num_agent_steps_trained": 12541440}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154722.8442215495, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14719341620807896, "mean_inference_ms": 0.24997234608583885, "mean_action_processing_ms": 0.06131212496280876, "mean_env_wait_ms": 0.4820849679878604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033168792724609375, "StateBufferConnector_ms": 0.002488851547241211, "ViewRequirementAgentConnector_ms": 0.059996843338012695}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154722.8442215495, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157367.72372167534, -153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14719341620807896, "mean_inference_ms": 0.24997234608583885, "mean_action_processing_ms": 0.06131212496280876, "mean_env_wait_ms": 0.4820849679878604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033168792724609375, "StateBufferConnector_ms": 0.002488851547241211, "ViewRequirementAgentConnector_ms": 0.059996843338012695}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12541440, "num_agent_steps_trained": 12541440, "num_env_steps_sampled": 12541440, "num_env_steps_trained": 12541440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.9559538414247, "num_env_steps_trained_throughput_per_sec": 715.9559538414247, "timesteps_total": 12541440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12541440, "timers": {"training_iteration_time_ms": 61229.155, "sample_time_ms": 60081.749, "load_time_ms": 16.746, "load_throughput": 2622679.084, "learn_time_ms": 1129.532, "learn_throughput": 38883.366, "synch_weights_time_ms": 0.962}, "counters": {"num_env_steps_sampled": 12541440, "num_env_steps_trained": 12541440, "num_agent_steps_sampled": 12541440, "num_agent_steps_trained": 12541440}, "done": false, "episodes_total": 7738, "training_iteration": 1915, "trial_id": "5f2ac_00000", "date": "2023-08-06_10-04-09", "timestamp": 1691305449, "time_this_iter_s": 61.34763503074646, "time_total_s": 31320.977632045746, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9041.361935853958, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 17.383908045977012, "ram_util_percent": 71.84367816091955}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.09679637497436, "policy_loss": -1952503.6900140077, "vf_loss": 4486910.095207726}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 130683.5, "diff_num_grad_updates_vs_sampler_policy": 130682.5}}, "num_env_steps_sampled": 12585360, "num_env_steps_trained": 12585360, "num_agent_steps_sampled": 12585360, "num_agent_steps_trained": 12585360}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154702.30308282335, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166, -155313.6098490627], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1475059629926085, "mean_inference_ms": 0.25047487106799393, "mean_action_processing_ms": 0.061439178384674206, "mean_env_wait_ms": 0.48300971891691513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003328561782836914, "StateBufferConnector_ms": 0.0024988651275634766, "ViewRequirementAgentConnector_ms": 0.060211896896362305}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154702.30308282335, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-153311.75291459326, -155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166, -155313.6098490627], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1475059629926085, "mean_inference_ms": 0.25047487106799393, "mean_action_processing_ms": 0.061439178384674206, "mean_env_wait_ms": 0.48300971891691513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003328561782836914, "StateBufferConnector_ms": 0.0024988651275634766, "ViewRequirementAgentConnector_ms": 0.060211896896362305}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12585360, "num_agent_steps_trained": 12585360, "num_env_steps_sampled": 12585360, "num_env_steps_trained": 12585360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 718.2236121981019, "num_env_steps_trained_throughput_per_sec": 718.2236121981019, "timesteps_total": 12585360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12585360, "timers": {"training_iteration_time_ms": 61187.12, "sample_time_ms": 60039.952, "load_time_ms": 16.729, "load_throughput": 2625362.801, "learn_time_ms": 1129.317, "learn_throughput": 38890.766, "synch_weights_time_ms": 0.956}, "counters": {"num_env_steps_sampled": 12585360, "num_env_steps_trained": 12585360, "num_agent_steps_sampled": 12585360, "num_agent_steps_trained": 12585360}, "done": false, "episodes_total": 7739, "training_iteration": 1916, "trial_id": "5f2ac_00000", "date": "2023-08-06_10-05-10", "timestamp": 1691305510, "time_this_iter_s": 61.15387010574341, "time_total_s": 31382.13150215149, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9102.515805959702, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 17.560919540229886, "ram_util_percent": 71.77471264367814}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.92380121080936, "policy_loss": -2169595.962971768, "vf_loss": 4380747.850947522}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 131369.5, "diff_num_grad_updates_vs_sampler_policy": 131368.5}}, "num_env_steps_sampled": 12629280, "num_env_steps_trained": 12629280, "num_agent_steps_sampled": 12629280, "num_agent_steps_trained": 12629280}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154712.54474774972, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166, -155313.6098490627, -154335.91940723156], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14782131107608623, "mean_inference_ms": 0.2509818658507888, "mean_action_processing_ms": 0.0615673304968207, "mean_env_wait_ms": 0.4839418693056638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003339052200317383, "StateBufferConnector_ms": 0.0025081634521484375, "ViewRequirementAgentConnector_ms": 0.06043410301208496}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154712.54474774972, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155452.63123587306, -153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166, -155313.6098490627, -154335.91940723156], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14782131107608623, "mean_inference_ms": 0.2509818658507888, "mean_action_processing_ms": 0.0615673304968207, "mean_env_wait_ms": 0.4839418693056638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003339052200317383, "StateBufferConnector_ms": 0.0025081634521484375, "ViewRequirementAgentConnector_ms": 0.06043410301208496}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12629280, "num_agent_steps_trained": 12629280, "num_env_steps_sampled": 12629280, "num_env_steps_trained": 12629280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 721.2561176925489, "num_env_steps_trained_throughput_per_sec": 721.2561176925489, "timesteps_total": 12629280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12629280, "timers": {"training_iteration_time_ms": 61151.241, "sample_time_ms": 60004.339, "load_time_ms": 16.749, "load_throughput": 2622272.147, "learn_time_ms": 1129.031, "learn_throughput": 38900.606, "synch_weights_time_ms": 0.956}, "counters": {"num_env_steps_sampled": 12629280, "num_env_steps_trained": 12629280, "num_agent_steps_sampled": 12629280, "num_agent_steps_trained": 12629280}, "done": false, "episodes_total": 7740, "training_iteration": 1917, "trial_id": "5f2ac_00000", "date": "2023-08-06_10-06-11", "timestamp": 1691305571, "time_this_iter_s": 60.89668416976929, "time_total_s": 31443.02818632126, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9163.41249012947, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 17.584883720930236, "ram_util_percent": 71.84651162790696}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.95253226499864, "policy_loss": -2057293.5364203716, "vf_loss": 4328828.636479592}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 132055.5, "diff_num_grad_updates_vs_sampler_policy": 132054.5}}, "num_env_steps_sampled": 12673200, "num_env_steps_trained": 12673200, "num_agent_steps_sampled": 12673200, "num_agent_steps_trained": 12673200}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154689.65290544892, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166, -155313.6098490627, -154335.91940723156, -153163.44700579415], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14813960949367283, "mean_inference_ms": 0.25149312273239605, "mean_action_processing_ms": 0.06169657107001058, "mean_env_wait_ms": 0.4848822617854116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033502578735351562, "StateBufferConnector_ms": 0.0025205612182617188, "ViewRequirementAgentConnector_ms": 0.06069302558898926}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154689.65290544892, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-153447.26633855005, -153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166, -155313.6098490627, -154335.91940723156, -153163.44700579415], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14813960949367283, "mean_inference_ms": 0.25149312273239605, "mean_action_processing_ms": 0.06169657107001058, "mean_env_wait_ms": 0.4848822617854116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033502578735351562, "StateBufferConnector_ms": 0.0025205612182617188, "ViewRequirementAgentConnector_ms": 0.06069302558898926}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12673200, "num_agent_steps_trained": 12673200, "num_env_steps_sampled": 12673200, "num_env_steps_trained": 12673200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.8585920456943, "num_env_steps_trained_throughput_per_sec": 713.8585920456943, "timesteps_total": 12673200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12673200, "timers": {"training_iteration_time_ms": 61190.852, "sample_time_ms": 60045.673, "load_time_ms": 16.699, "load_throughput": 2630055.648, "learn_time_ms": 1127.359, "learn_throughput": 38958.307, "synch_weights_time_ms": 0.956}, "counters": {"num_env_steps_sampled": 12673200, "num_env_steps_trained": 12673200, "num_agent_steps_sampled": 12673200, "num_agent_steps_trained": 12673200}, "done": false, "episodes_total": 7741, "training_iteration": 1918, "trial_id": "5f2ac_00000", "date": "2023-08-06_10-07-13", "timestamp": 1691305633, "time_this_iter_s": 61.527791023254395, "time_total_s": 31504.555977344513, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9224.940281152725, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 17.750574712643676, "ram_util_percent": 71.87011494252872}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0761817954372, "policy_loss": -2177057.4448526897, "vf_loss": 4439856.849125365}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 132741.5, "diff_num_grad_updates_vs_sampler_policy": 132740.5}}, "num_env_steps_sampled": 12717120, "num_env_steps_trained": 12717120, "num_agent_steps_sampled": 12717120, "num_agent_steps_trained": 12717120}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154706.000210248, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166, -155313.6098490627, -154335.91940723156, -153163.44700579415, -155081.9968184573], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14846081775198092, "mean_inference_ms": 0.25200866734616756, "mean_action_processing_ms": 0.06182690572703749, "mean_env_wait_ms": 0.4858310979215441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033597946166992188, "StateBufferConnector_ms": 0.0025293827056884766, "ViewRequirementAgentConnector_ms": 0.06090998649597168}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154706.000210248, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-153725.8480136925, -154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166, -155313.6098490627, -154335.91940723156, -153163.44700579415, -155081.9968184573], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14846081775198092, "mean_inference_ms": 0.25200866734616756, "mean_action_processing_ms": 0.06182690572703749, "mean_env_wait_ms": 0.4858310979215441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033597946166992188, "StateBufferConnector_ms": 0.0025293827056884766, "ViewRequirementAgentConnector_ms": 0.06090998649597168}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12717120, "num_agent_steps_trained": 12717120, "num_env_steps_sampled": 12717120, "num_env_steps_trained": 12717120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.0945560216369, "num_env_steps_trained_throughput_per_sec": 715.0945560216369, "timesteps_total": 12717120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12717120, "timers": {"training_iteration_time_ms": 61209.653, "sample_time_ms": 60064.929, "load_time_ms": 16.51, "load_throughput": 2660192.838, "learn_time_ms": 1127.099, "learn_throughput": 38967.294, "synch_weights_time_ms": 0.95}, "counters": {"num_env_steps_sampled": 12717120, "num_env_steps_trained": 12717120, "num_agent_steps_sampled": 12717120, "num_agent_steps_trained": 12717120}, "done": false, "episodes_total": 7742, "training_iteration": 1919, "trial_id": "5f2ac_00000", "date": "2023-08-06_10-08-14", "timestamp": 1691305694, "time_this_iter_s": 61.42148780822754, "time_total_s": 31565.97746515274, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9286.361768960953, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 17.473563218390805, "ram_util_percent": 71.78735632183908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.500000000000001e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0140516097622, "policy_loss": -2164886.049958432, "vf_loss": 4332010.731960641}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 133427.5, "diff_num_grad_updates_vs_sampler_policy": 133426.5}}, "num_env_steps_sampled": 12761040, "num_env_steps_trained": 12761040, "num_agent_steps_sampled": 12761040, "num_agent_steps_trained": 12761040}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154704.08644984214, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166, -155313.6098490627, -154335.91940723156, -153163.44700579415, -155081.9968184573, -153534.47197310714], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1487847519294658, "mean_inference_ms": 0.2525283860899151, "mean_action_processing_ms": 0.06195831600492662, "mean_env_wait_ms": 0.4867879806365316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033729076385498047, "StateBufferConnector_ms": 0.002538919448852539, "ViewRequirementAgentConnector_ms": 0.06112170219421387}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154704.08644984214, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154764.69176313517, -154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166, -155313.6098490627, -154335.91940723156, -153163.44700579415, -155081.9968184573, -153534.47197310714], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1487847519294658, "mean_inference_ms": 0.2525283860899151, "mean_action_processing_ms": 0.06195831600492662, "mean_env_wait_ms": 0.4867879806365316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033729076385498047, "StateBufferConnector_ms": 0.002538919448852539, "ViewRequirementAgentConnector_ms": 0.06112170219421387}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12761040, "num_agent_steps_trained": 12761040, "num_env_steps_sampled": 12761040, "num_env_steps_trained": 12761040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 711.4253287444825, "num_env_steps_trained_throughput_per_sec": 711.4253287444825, "timesteps_total": 12761040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12761040, "timers": {"training_iteration_time_ms": 61269.832, "sample_time_ms": 60125.382, "load_time_ms": 16.6, "load_throughput": 2645724.097, "learn_time_ms": 1126.736, "learn_throughput": 38979.866, "synch_weights_time_ms": 0.951}, "counters": {"num_env_steps_sampled": 12761040, "num_env_steps_trained": 12761040, "num_agent_steps_sampled": 12761040, "num_agent_steps_trained": 12761040}, "done": false, "episodes_total": 7743, "training_iteration": 1920, "trial_id": "5f2ac_00000", "date": "2023-08-06_10-09-16", "timestamp": 1691305756, "time_this_iter_s": 61.73829388618469, "time_total_s": 31627.715759038925, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9348.100062847137, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 17.348275862068967, "ram_util_percent": 71.72643678160918}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.9999999999999994e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.1645280487683, "policy_loss": -1988221.071701895, "vf_loss": 4567664.11643586}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 134113.5, "diff_num_grad_updates_vs_sampler_policy": 134112.5}}, "num_env_steps_sampled": 12804960, "num_env_steps_trained": 12804960, "num_agent_steps_sampled": 12804960, "num_agent_steps_trained": 12804960}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154725.63626028478, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166, -155313.6098490627, -154335.91940723156, -153163.44700579415, -155081.9968184573, -153534.47197310714, -156919.67280739898], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14911147470189431, "mean_inference_ms": 0.25305232206237444, "mean_action_processing_ms": 0.062090796507238366, "mean_env_wait_ms": 0.4877523668683862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003377199172973633, "StateBufferConnector_ms": 0.002549409866333008, "ViewRequirementAgentConnector_ms": 0.06132793426513672}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154725.63626028478, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154022.2011086379, -155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166, -155313.6098490627, -154335.91940723156, -153163.44700579415, -155081.9968184573, -153534.47197310714, -156919.67280739898], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14911147470189431, "mean_inference_ms": 0.25305232206237444, "mean_action_processing_ms": 0.062090796507238366, "mean_env_wait_ms": 0.4877523668683862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003377199172973633, "StateBufferConnector_ms": 0.002549409866333008, "ViewRequirementAgentConnector_ms": 0.06132793426513672}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12804960, "num_agent_steps_trained": 12804960, "num_env_steps_sampled": 12804960, "num_env_steps_trained": 12804960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.730233317514, "num_env_steps_trained_throughput_per_sec": 717.730233317514, "timesteps_total": 12804960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12804960, "timers": {"training_iteration_time_ms": 61262.777, "sample_time_ms": 60118.245, "load_time_ms": 16.638, "load_throughput": 2639669.617, "learn_time_ms": 1126.783, "learn_throughput": 38978.232, "synch_weights_time_ms": 0.947}, "counters": {"num_env_steps_sampled": 12804960, "num_env_steps_trained": 12804960, "num_agent_steps_sampled": 12804960, "num_agent_steps_trained": 12804960}, "done": false, "episodes_total": 7744, "training_iteration": 1921, "trial_id": "5f2ac_00000", "date": "2023-08-06_10-10-17", "timestamp": 1691305817, "time_this_iter_s": 61.195815086364746, "time_total_s": 31688.91157412529, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9409.295877933502, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 17.002298850574718, "ram_util_percent": 71.72643678160921}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.5e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.90566700749076, "policy_loss": -2264213.9840845936, "vf_loss": 4456926.043549563}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 134799.5, "diff_num_grad_updates_vs_sampler_policy": 134798.5}}, "num_env_steps_sampled": 12848880, "num_env_steps_trained": 12848880, "num_agent_steps_sampled": 12848880, "num_agent_steps_trained": 12848880}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154738.45358660846, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166, -155313.6098490627, -154335.91940723156, -153163.44700579415, -155081.9968184573, -153534.47197310714, -156919.67280739898, -155303.933741006], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1494407394428206, "mean_inference_ms": 0.2535804414062924, "mean_action_processing_ms": 0.06222432904459186, "mean_env_wait_ms": 0.4887238485512104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033905506134033203, "StateBufferConnector_ms": 0.0025615692138671875, "ViewRequirementAgentConnector_ms": 0.06154203414916992}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154738.45358660846, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155702.97283894598, -154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166, -155313.6098490627, -154335.91940723156, -153163.44700579415, -155081.9968184573, -153534.47197310714, -156919.67280739898, -155303.933741006], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1494407394428206, "mean_inference_ms": 0.2535804414062924, "mean_action_processing_ms": 0.06222432904459186, "mean_env_wait_ms": 0.4887238485512104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033905506134033203, "StateBufferConnector_ms": 0.0025615692138671875, "ViewRequirementAgentConnector_ms": 0.06154203414916992}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12848880, "num_agent_steps_trained": 12848880, "num_env_steps_sampled": 12848880, "num_env_steps_trained": 12848880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 719.6753687377601, "num_env_steps_trained_throughput_per_sec": 719.6753687377601, "timesteps_total": 12848880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12848880, "timers": {"training_iteration_time_ms": 61261.155, "sample_time_ms": 60116.623, "load_time_ms": 16.575, "load_throughput": 2649735.214, "learn_time_ms": 1126.849, "learn_throughput": 38975.936, "synch_weights_time_ms": 0.944}, "counters": {"num_env_steps_sampled": 12848880, "num_env_steps_trained": 12848880, "num_agent_steps_sampled": 12848880, "num_agent_steps_trained": 12848880}, "done": false, "episodes_total": 7745, "training_iteration": 1922, "trial_id": "5f2ac_00000", "date": "2023-08-06_10-11-18", "timestamp": 1691305878, "time_this_iter_s": 61.03054213523865, "time_total_s": 31749.94211626053, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9470.32642006874, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 17.901162790697672, "ram_util_percent": 71.75697674418605}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.999999999999999e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.10370998549394, "policy_loss": -1947429.6774681692, "vf_loss": 4441911.457725948}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 135485.5, "diff_num_grad_updates_vs_sampler_policy": 135484.5}}, "num_env_steps_sampled": 12892800, "num_env_steps_trained": 12892800, "num_agent_steps_sampled": 12892800, "num_agent_steps_trained": 12892800}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154731.41091800624, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166, -155313.6098490627, -154335.91940723156, -153163.44700579415, -155081.9968184573, -153534.47197310714, -156919.67280739898, -155303.933741006, -154998.7059787241], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14977258003083438, "mean_inference_ms": 0.25411269263609904, "mean_action_processing_ms": 0.062358907408031856, "mean_env_wait_ms": 0.4897027855501414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003400087356567383, "StateBufferConnector_ms": 0.0025708675384521484, "ViewRequirementAgentConnector_ms": 0.06173992156982422}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154731.41091800624, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154180.46578546535, -154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166, -155313.6098490627, -154335.91940723156, -153163.44700579415, -155081.9968184573, -153534.47197310714, -156919.67280739898, -155303.933741006, -154998.7059787241], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14977258003083438, "mean_inference_ms": 0.25411269263609904, "mean_action_processing_ms": 0.062358907408031856, "mean_env_wait_ms": 0.4897027855501414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003400087356567383, "StateBufferConnector_ms": 0.0025708675384521484, "ViewRequirementAgentConnector_ms": 0.06173992156982422}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12892800, "num_agent_steps_trained": 12892800, "num_env_steps_sampled": 12892800, "num_env_steps_trained": 12892800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.3608502678381, "num_env_steps_trained_throughput_per_sec": 716.3608502678381, "timesteps_total": 12892800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12892800, "timers": {"training_iteration_time_ms": 61293.325, "sample_time_ms": 60148.563, "load_time_ms": 16.503, "load_throughput": 2661295.813, "learn_time_ms": 1127.199, "learn_throughput": 38963.855, "synch_weights_time_ms": 0.905}, "counters": {"num_env_steps_sampled": 12892800, "num_env_steps_trained": 12892800, "num_agent_steps_sampled": 12892800, "num_agent_steps_trained": 12892800}, "done": false, "episodes_total": 7746, "training_iteration": 1923, "trial_id": "5f2ac_00000", "date": "2023-08-06_10-12-20", "timestamp": 1691305940, "time_this_iter_s": 61.31275701522827, "time_total_s": 31811.254873275757, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9531.63917708397, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 16.901149425287354, "ram_util_percent": 71.72413793103448}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0281332922399, "policy_loss": -2036216.6905805848, "vf_loss": 4580654.386206268}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 136171.5, "diff_num_grad_updates_vs_sampler_policy": 136170.5}}, "num_env_steps_sampled": 12936720, "num_env_steps_trained": 12936720, "num_agent_steps_sampled": 12936720, "num_agent_steps_trained": 12936720}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154753.5683847284, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166, -155313.6098490627, -154335.91940723156, -153163.44700579415, -155081.9968184573, -153534.47197310714, -156919.67280739898, -155303.933741006, -154998.7059787241, -156396.21245767956], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15010691525461461, "mean_inference_ms": 0.25464893528090987, "mean_action_processing_ms": 0.06249450651478471, "mean_env_wait_ms": 0.490688615338613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003408670425415039, "StateBufferConnector_ms": 0.0025811195373535156, "ViewRequirementAgentConnector_ms": 0.0619664192199707}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154753.5683847284, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154873.0270456099, -150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166, -155313.6098490627, -154335.91940723156, -153163.44700579415, -155081.9968184573, -153534.47197310714, -156919.67280739898, -155303.933741006, -154998.7059787241, -156396.21245767956], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15010691525461461, "mean_inference_ms": 0.25464893528090987, "mean_action_processing_ms": 0.06249450651478471, "mean_env_wait_ms": 0.490688615338613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003408670425415039, "StateBufferConnector_ms": 0.0025811195373535156, "ViewRequirementAgentConnector_ms": 0.0619664192199707}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12936720, "num_agent_steps_trained": 12936720, "num_env_steps_sampled": 12936720, "num_env_steps_trained": 12936720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 718.8013232677228, "num_env_steps_trained_throughput_per_sec": 718.8013232677228, "timesteps_total": 12936720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12936720, "timers": {"training_iteration_time_ms": 61269.948, "sample_time_ms": 60121.726, "load_time_ms": 16.548, "load_throughput": 2654106.448, "learn_time_ms": 1130.603, "learn_throughput": 38846.512, "synch_weights_time_ms": 0.916}, "counters": {"num_env_steps_sampled": 12936720, "num_env_steps_trained": 12936720, "num_agent_steps_sampled": 12936720, "num_agent_steps_trained": 12936720}, "done": false, "episodes_total": 7747, "training_iteration": 1924, "trial_id": "5f2ac_00000", "date": "2023-08-06_10-13-21", "timestamp": 1691306001, "time_this_iter_s": 61.10491180419922, "time_total_s": 31872.359785079956, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9592.744088888168, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 17.0453488372093, "ram_util_percent": 71.7232558139535}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.0000000000000006e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.15795377948194, "policy_loss": -2117951.1467520045, "vf_loss": 4514386.61944242}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 136857.5, "diff_num_grad_updates_vs_sampler_policy": 136856.5}}, "num_env_steps_sampled": 12980640, "num_env_steps_trained": 12980640, "num_agent_steps_sampled": 12980640, "num_agent_steps_trained": 12980640}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154763.92245741037, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166, -155313.6098490627, -154335.91940723156, -153163.44700579415, -155081.9968184573, -153534.47197310714, -156919.67280739898, -155303.933741006, -154998.7059787241, -156396.21245767956, -155908.43431380688], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15044399816508303, "mean_inference_ms": 0.2551892749598297, "mean_action_processing_ms": 0.06263113580286006, "mean_env_wait_ms": 0.49168320197675064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034220218658447266, "StateBufferConnector_ms": 0.0025904178619384766, "ViewRequirementAgentConnector_ms": 0.06217503547668457}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154763.92245741037, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-150390.6323756756, -150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166, -155313.6098490627, -154335.91940723156, -153163.44700579415, -155081.9968184573, -153534.47197310714, -156919.67280739898, -155303.933741006, -154998.7059787241, -156396.21245767956, -155908.43431380688], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15044399816508303, "mean_inference_ms": 0.2551892749598297, "mean_action_processing_ms": 0.06263113580286006, "mean_env_wait_ms": 0.49168320197675064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034220218658447266, "StateBufferConnector_ms": 0.0025904178619384766, "ViewRequirementAgentConnector_ms": 0.06217503547668457}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12980640, "num_agent_steps_trained": 12980640, "num_env_steps_sampled": 12980640, "num_env_steps_trained": 12980640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 706.7688360767672, "num_env_steps_trained_throughput_per_sec": 706.7688360767672, "timesteps_total": 12980640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 12980640, "timers": {"training_iteration_time_ms": 61349.688, "sample_time_ms": 60201.148, "load_time_ms": 16.725, "load_throughput": 2626036.461, "learn_time_ms": 1130.742, "learn_throughput": 38841.737, "synch_weights_time_ms": 0.918}, "counters": {"num_env_steps_sampled": 12980640, "num_env_steps_trained": 12980640, "num_agent_steps_sampled": 12980640, "num_agent_steps_trained": 12980640}, "done": false, "episodes_total": 7748, "training_iteration": 1925, "trial_id": "5f2ac_00000", "date": "2023-08-06_10-14-23", "timestamp": 1691306063, "time_this_iter_s": 62.14495897293091, "time_total_s": 31934.504744052887, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9654.8890478611, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 17.37840909090909, "ram_util_percent": 71.69545454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.4999999999999996e-14, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.9920846032679, "policy_loss": -2031675.1496560678, "vf_loss": 4438588.037536443}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 137543.5, "diff_num_grad_updates_vs_sampler_policy": 137542.5}}, "num_env_steps_sampled": 13024560, "num_env_steps_trained": 13024560, "num_agent_steps_sampled": 13024560, "num_agent_steps_trained": 13024560}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154809.96550494188, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166, -155313.6098490627, -154335.91940723156, -153163.44700579415, -155081.9968184573, -153534.47197310714, -156919.67280739898, -155303.933741006, -154998.7059787241, -156396.21245767956, -155908.43431380688, -154994.93712882744], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1507837889640454, "mean_inference_ms": 0.2557336022651752, "mean_action_processing_ms": 0.06276879829138561, "mean_env_wait_ms": 0.4926861775944937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003437042236328125, "StateBufferConnector_ms": 0.0025997161865234375, "ViewRequirementAgentConnector_ms": 0.06240653991699219}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154809.96550494188, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-150222.07262357147, -154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166, -155313.6098490627, -154335.91940723156, -153163.44700579415, -155081.9968184573, -153534.47197310714, -156919.67280739898, -155303.933741006, -154998.7059787241, -156396.21245767956, -155908.43431380688, -154994.93712882744], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1507837889640454, "mean_inference_ms": 0.2557336022651752, "mean_action_processing_ms": 0.06276879829138561, "mean_env_wait_ms": 0.4926861775944937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003437042236328125, "StateBufferConnector_ms": 0.0025997161865234375, "ViewRequirementAgentConnector_ms": 0.06240653991699219}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13024560, "num_agent_steps_trained": 13024560, "num_env_steps_sampled": 13024560, "num_env_steps_trained": 13024560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 706.9975748196351, "num_env_steps_trained_throughput_per_sec": 706.9975748196351, "timesteps_total": 13024560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 13024560, "timers": {"training_iteration_time_ms": 61446.786, "sample_time_ms": 60297.727, "load_time_ms": 16.725, "load_throughput": 2626032.717, "learn_time_ms": 1131.272, "learn_throughput": 38823.556, "synch_weights_time_ms": 0.908}, "counters": {"num_env_steps_sampled": 13024560, "num_env_steps_trained": 13024560, "num_agent_steps_sampled": 13024560, "num_agent_steps_trained": 13024560}, "done": false, "episodes_total": 7749, "training_iteration": 1926, "trial_id": "5f2ac_00000", "date": "2023-08-06_10-15-25", "timestamp": 1691306125, "time_this_iter_s": 62.12524080276489, "time_total_s": 31996.629984855652, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9717.014288663864, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 17.553409090909096, "ram_util_percent": 71.67954545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0461643319088, "policy_loss": -2033719.1454850356, "vf_loss": 4466949.613520408}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 138229.5, "diff_num_grad_updates_vs_sampler_policy": 138228.5}}, "num_env_steps_sampled": 13068480, "num_env_steps_trained": 13068480, "num_agent_steps_sampled": 13068480, "num_agent_steps_trained": 13068480}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154860.72475213822, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166, -155313.6098490627, -154335.91940723156, -153163.44700579415, -155081.9968184573, -153534.47197310714, -156919.67280739898, -155303.933741006, -154998.7059787241, -156396.21245767956, -155908.43431380688, -154994.93712882744, -155297.9973432041], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15112628094399475, "mean_inference_ms": 0.2562816246763301, "mean_action_processing_ms": 0.06290747766879433, "mean_env_wait_ms": 0.4936960803960686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003445863723754883, "StateBufferConnector_ms": 0.002605438232421875, "ViewRequirementAgentConnector_ms": 0.06262445449829102}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154860.72475213822, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154009.91573663757, -149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166, -155313.6098490627, -154335.91940723156, -153163.44700579415, -155081.9968184573, -153534.47197310714, -156919.67280739898, -155303.933741006, -154998.7059787241, -156396.21245767956, -155908.43431380688, -154994.93712882744, -155297.9973432041], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15112628094399475, "mean_inference_ms": 0.2562816246763301, "mean_action_processing_ms": 0.06290747766879433, "mean_env_wait_ms": 0.4936960803960686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003445863723754883, "StateBufferConnector_ms": 0.002605438232421875, "ViewRequirementAgentConnector_ms": 0.06262445449829102}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13068480, "num_agent_steps_trained": 13068480, "num_env_steps_sampled": 13068480, "num_env_steps_trained": 13068480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.2757436445416, "num_env_steps_trained_throughput_per_sec": 715.2757436445416, "timesteps_total": 13068480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 13068480, "timers": {"training_iteration_time_ms": 61497.699, "sample_time_ms": 60349.015, "load_time_ms": 16.944, "load_throughput": 2592016.453, "learn_time_ms": 1130.688, "learn_throughput": 38843.619, "synch_weights_time_ms": 0.898}, "counters": {"num_env_steps_sampled": 13068480, "num_env_steps_trained": 13068480, "num_agent_steps_sampled": 13068480, "num_agent_steps_trained": 13068480}, "done": false, "episodes_total": 7750, "training_iteration": 1927, "trial_id": "5f2ac_00000", "date": "2023-08-06_10-16-27", "timestamp": 1691306187, "time_this_iter_s": 61.40589427947998, "time_total_s": 32058.035879135132, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9778.420182943344, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 17.628735632183908, "ram_util_percent": 71.6655172413793}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0059805555872, "policy_loss": -1978173.2374071837, "vf_loss": 4354835.04919825}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 138914.5}}, "num_env_steps_sampled": 13112400, "num_env_steps_trained": 13112400, "num_agent_steps_sampled": 13112400, "num_agent_steps_trained": 13112400}, "sampler_results": {"episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154857.0899166181, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166, -155313.6098490627, -154335.91940723156, -153163.44700579415, -155081.9968184573, -153534.47197310714, -156919.67280739898, -155303.933741006, -154998.7059787241, -156396.21245767956, -155908.43431380688, -154994.93712882744, -155297.9973432041, -153646.4321846235], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15147131300376582, "mean_inference_ms": 0.25683361411521216, "mean_action_processing_ms": 0.06304715637104319, "mean_env_wait_ms": 0.49471319762758625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003452777862548828, "StateBufferConnector_ms": 0.002611398696899414, "ViewRequirementAgentConnector_ms": 0.0627894401550293}}, "episode_reward_max": -149369.81254280143, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154857.0899166181, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-149369.81254280143, -154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166, -155313.6098490627, -154335.91940723156, -153163.44700579415, -155081.9968184573, -153534.47197310714, -156919.67280739898, -155303.933741006, -154998.7059787241, -156396.21245767956, -155908.43431380688, -154994.93712882744, -155297.9973432041, -153646.4321846235], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15147131300376582, "mean_inference_ms": 0.25683361411521216, "mean_action_processing_ms": 0.06304715637104319, "mean_env_wait_ms": 0.49471319762758625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003452777862548828, "StateBufferConnector_ms": 0.002611398696899414, "ViewRequirementAgentConnector_ms": 0.0627894401550293}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13112400, "num_agent_steps_trained": 13112400, "num_env_steps_sampled": 13112400, "num_env_steps_trained": 13112400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.2360775126879, "num_env_steps_trained_throughput_per_sec": 713.2360775126879, "timesteps_total": 13112400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 13112400, "timers": {"training_iteration_time_ms": 61503.069, "sample_time_ms": 60354.741, "load_time_ms": 16.966, "load_throughput": 2588763.637, "learn_time_ms": 1130.296, "learn_throughput": 38857.078, "synch_weights_time_ms": 0.913}, "counters": {"num_env_steps_sampled": 13112400, "num_env_steps_trained": 13112400, "num_agent_steps_sampled": 13112400, "num_agent_steps_trained": 13112400}, "done": false, "episodes_total": 7751, "training_iteration": 1928, "trial_id": "5f2ac_00000", "date": "2023-08-06_10-17-28", "timestamp": 1691306248, "time_this_iter_s": 61.581459045410156, "time_total_s": 32119.617338180542, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9840.001641988754, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 18.026136363636365, "ram_util_percent": 71.64431818181819}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.98505724136754, "policy_loss": -2289162.9229910714, "vf_loss": 4439749.124817784}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 139601.5, "diff_num_grad_updates_vs_sampler_policy": 139600.5}}, "num_env_steps_sampled": 13156320, "num_env_steps_trained": 13156320, "num_agent_steps_sampled": 13156320, "num_agent_steps_trained": 13156320}, "sampler_results": {"episode_reward_max": -150040.14405173154, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154913.78807349416, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166, -155313.6098490627, -154335.91940723156, -153163.44700579415, -155081.9968184573, -153534.47197310714, -156919.67280739898, -155303.933741006, -154998.7059787241, -156396.21245767956, -155908.43431380688, -154994.93712882744, -155297.9973432041, -153646.4321846235, -155039.62823040772], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15181877517820622, "mean_inference_ms": 0.2573893729416729, "mean_action_processing_ms": 0.0631878347832489, "mean_env_wait_ms": 0.4957370426231911, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003467559814453125, "StateBufferConnector_ms": 0.002622842788696289, "ViewRequirementAgentConnector_ms": 0.06302642822265625}}, "episode_reward_max": -150040.14405173154, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154913.78807349416, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-154486.32535394747, -152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166, -155313.6098490627, -154335.91940723156, -153163.44700579415, -155081.9968184573, -153534.47197310714, -156919.67280739898, -155303.933741006, -154998.7059787241, -156396.21245767956, -155908.43431380688, -154994.93712882744, -155297.9973432041, -153646.4321846235, -155039.62823040772], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15181877517820622, "mean_inference_ms": 0.2573893729416729, "mean_action_processing_ms": 0.0631878347832489, "mean_env_wait_ms": 0.4957370426231911, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003467559814453125, "StateBufferConnector_ms": 0.002622842788696289, "ViewRequirementAgentConnector_ms": 0.06302642822265625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13156320, "num_agent_steps_trained": 13156320, "num_env_steps_sampled": 13156320, "num_env_steps_trained": 13156320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.9199711004575, "num_env_steps_trained_throughput_per_sec": 715.9199711004575, "timesteps_total": 13156320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 13156320, "timers": {"training_iteration_time_ms": 61495.987, "sample_time_ms": 60348.148, "load_time_ms": 17.039, "load_throughput": 2577642.959, "learn_time_ms": 1129.728, "learn_throughput": 38876.6, "synch_weights_time_ms": 0.913}, "counters": {"num_env_steps_sampled": 13156320, "num_env_steps_trained": 13156320, "num_agent_steps_sampled": 13156320, "num_agent_steps_trained": 13156320}, "done": false, "episodes_total": 7752, "training_iteration": 1929, "trial_id": "5f2ac_00000", "date": "2023-08-06_10-18-30", "timestamp": 1691306310, "time_this_iter_s": 61.35065484046936, "time_total_s": 32180.96799302101, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9901.352296829224, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 16.889534883720927, "ram_util_percent": 71.62558139534883}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.01527524898074, "policy_loss": -2268840.7119169096, "vf_loss": 4498670.452532799}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 140287.5, "diff_num_grad_updates_vs_sampler_policy": 140286.5}}, "num_env_steps_sampled": 13200240, "num_env_steps_trained": 13200240, "num_agent_steps_sampled": 13200240, "num_agent_steps_trained": 13200240}, "sampler_results": {"episode_reward_max": -150040.14405173154, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154924.7705929092, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166, -155313.6098490627, -154335.91940723156, -153163.44700579415, -155081.9968184573, -153534.47197310714, -156919.67280739898, -155303.933741006, -154998.7059787241, -156396.21245767956, -155908.43431380688, -154994.93712882744, -155297.9973432041, -153646.4321846235, -155039.62823040772, -155584.57729544895], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15216871551875608, "mean_inference_ms": 0.2579489706602431, "mean_action_processing_ms": 0.06332950571609319, "mean_env_wait_ms": 0.49676852644399866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003491640090942383, "StateBufferConnector_ms": 0.0026369094848632812, "ViewRequirementAgentConnector_ms": 0.06325316429138184}}, "episode_reward_max": -150040.14405173154, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154924.7705929092, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152670.02161628156, -156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166, -155313.6098490627, -154335.91940723156, -153163.44700579415, -155081.9968184573, -153534.47197310714, -156919.67280739898, -155303.933741006, -154998.7059787241, -156396.21245767956, -155908.43431380688, -154994.93712882744, -155297.9973432041, -153646.4321846235, -155039.62823040772, -155584.57729544895], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15216871551875608, "mean_inference_ms": 0.2579489706602431, "mean_action_processing_ms": 0.06332950571609319, "mean_env_wait_ms": 0.49676852644399866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003491640090942383, "StateBufferConnector_ms": 0.0026369094848632812, "ViewRequirementAgentConnector_ms": 0.06325316429138184}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13200240, "num_agent_steps_trained": 13200240, "num_env_steps_sampled": 13200240, "num_env_steps_trained": 13200240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.8715592640273, "num_env_steps_trained_throughput_per_sec": 715.8715592640273, "timesteps_total": 13200240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 13200240, "timers": {"training_iteration_time_ms": 61457.644, "sample_time_ms": 60309.989, "load_time_ms": 16.999, "load_throughput": 2583691.311, "learn_time_ms": 1129.572, "learn_throughput": 38881.98, "synch_weights_time_ms": 0.924}, "counters": {"num_env_steps_sampled": 13200240, "num_env_steps_trained": 13200240, "num_agent_steps_sampled": 13200240, "num_agent_steps_trained": 13200240}, "done": false, "episodes_total": 7753, "training_iteration": 1930, "trial_id": "5f2ac_00000", "date": "2023-08-06_10-19-31", "timestamp": 1691306371, "time_this_iter_s": 61.354655027389526, "time_total_s": 32242.3226480484, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9962.706951856613, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 17.268965517241377, "ram_util_percent": 71.67471264367816}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.2427439342087, "policy_loss": -2079495.5555274007, "vf_loss": 4568781.701166181}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 140973.5, "diff_num_grad_updates_vs_sampler_policy": 140972.5}}, "num_env_steps_sampled": 13244160, "num_env_steps_trained": 13244160, "num_agent_steps_sampled": 13244160, "num_agent_steps_trained": 13244160}, "sampler_results": {"episode_reward_max": -150040.14405173154, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154961.6429830418, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166, -155313.6098490627, -154335.91940723156, -153163.44700579415, -155081.9968184573, -153534.47197310714, -156919.67280739898, -155303.933741006, -154998.7059787241, -156396.21245767956, -155908.43431380688, -154994.93712882744, -155297.9973432041, -153646.4321846235, -155039.62823040772, -155584.57729544895, -156357.260629546], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15252106530720716, "mean_inference_ms": 0.2585122000474773, "mean_action_processing_ms": 0.06347213224629972, "mean_env_wait_ms": 0.4978072813955656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034999847412109375, "StateBufferConnector_ms": 0.002649068832397461, "ViewRequirementAgentConnector_ms": 0.06345367431640625}}, "episode_reward_max": -150040.14405173154, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154961.6429830418, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-156284.61701922212, -152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166, -155313.6098490627, -154335.91940723156, -153163.44700579415, -155081.9968184573, -153534.47197310714, -156919.67280739898, -155303.933741006, -154998.7059787241, -156396.21245767956, -155908.43431380688, -154994.93712882744, -155297.9973432041, -153646.4321846235, -155039.62823040772, -155584.57729544895, -156357.260629546], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15252106530720716, "mean_inference_ms": 0.2585122000474773, "mean_action_processing_ms": 0.06347213224629972, "mean_env_wait_ms": 0.4978072813955656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034999847412109375, "StateBufferConnector_ms": 0.002649068832397461, "ViewRequirementAgentConnector_ms": 0.06345367431640625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13244160, "num_agent_steps_trained": 13244160, "num_env_steps_sampled": 13244160, "num_env_steps_trained": 13244160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.0181419084737, "num_env_steps_trained_throughput_per_sec": 714.0181419084737, "timesteps_total": 13244160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 13244160, "timers": {"training_iteration_time_ms": 61489.457, "sample_time_ms": 60338.804, "load_time_ms": 17.157, "load_throughput": 2559926.289, "learn_time_ms": 1132.416, "learn_throughput": 38784.337, "synch_weights_time_ms": 0.921}, "counters": {"num_env_steps_sampled": 13244160, "num_env_steps_trained": 13244160, "num_agent_steps_sampled": 13244160, "num_agent_steps_trained": 13244160}, "done": false, "episodes_total": 7754, "training_iteration": 1931, "trial_id": "5f2ac_00000", "date": "2023-08-06_10-20-33", "timestamp": 1691306433, "time_this_iter_s": 61.51413607597351, "time_total_s": 32303.836784124374, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10024.221087932587, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 17.20344827586207, "ram_util_percent": 71.63103448275861}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -326.70006416698936, "policy_loss": -2261168.2285270137, "vf_loss": 4219089.987427114}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 141659.5, "diff_num_grad_updates_vs_sampler_policy": 141658.5}}, "num_env_steps_sampled": 13288080, "num_env_steps_trained": 13288080, "num_agent_steps_sampled": 13288080, "num_agent_steps_trained": 13288080}, "sampler_results": {"episode_reward_max": -150040.14405173154, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154921.16613521098, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166, -155313.6098490627, -154335.91940723156, -153163.44700579415, -155081.9968184573, -153534.47197310714, -156919.67280739898, -155303.933741006, -154998.7059787241, -156396.21245767956, -155908.43431380688, -154994.93712882744, -155297.9973432041, -153646.4321846235, -155039.62823040772, -155584.57729544895, -156357.260629546, -152236.93223614187], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15287591615648266, "mean_inference_ms": 0.25907911658578325, "mean_action_processing_ms": 0.06361571498534416, "mean_env_wait_ms": 0.49885397205296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003509521484375, "StateBufferConnector_ms": 0.002660036087036133, "ViewRequirementAgentConnector_ms": 0.06366658210754395}}, "episode_reward_max": -150040.14405173154, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154921.16613521098, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-152093.54799503047, -155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166, -155313.6098490627, -154335.91940723156, -153163.44700579415, -155081.9968184573, -153534.47197310714, -156919.67280739898, -155303.933741006, -154998.7059787241, -156396.21245767956, -155908.43431380688, -154994.93712882744, -155297.9973432041, -153646.4321846235, -155039.62823040772, -155584.57729544895, -156357.260629546, -152236.93223614187], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15287591615648266, "mean_inference_ms": 0.25907911658578325, "mean_action_processing_ms": 0.06361571498534416, "mean_env_wait_ms": 0.49885397205296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003509521484375, "StateBufferConnector_ms": 0.002660036087036133, "ViewRequirementAgentConnector_ms": 0.06366658210754395}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13288080, "num_agent_steps_trained": 13288080, "num_env_steps_sampled": 13288080, "num_env_steps_trained": 13288080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 706.991665086673, "num_env_steps_trained_throughput_per_sec": 706.991665086673, "timesteps_total": 13288080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 13288080, "timers": {"training_iteration_time_ms": 61598.943, "sample_time_ms": 60441.836, "load_time_ms": 17.3, "load_throughput": 2538674.416, "learn_time_ms": 1138.712, "learn_throughput": 38569.899, "synch_weights_time_ms": 0.935}, "counters": {"num_env_steps_sampled": 13288080, "num_env_steps_trained": 13288080, "num_agent_steps_sampled": 13288080, "num_agent_steps_trained": 13288080}, "done": false, "episodes_total": 7755, "training_iteration": 1932, "trial_id": "5f2ac_00000", "date": "2023-08-06_10-21-35", "timestamp": 1691306495, "time_this_iter_s": 62.125670194625854, "time_total_s": 32365.962454319, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10086.346758127213, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 17.61818181818182, "ram_util_percent": 71.61136363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.09999999999999999, "policy_entropy": -327.0607031552507, "policy_loss": -2320101.826527765, "vf_loss": 4619435.960914723}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 142345.5, "diff_num_grad_updates_vs_sampler_policy": 142344.5}}, "num_env_steps_sampled": 13332000, "num_env_steps_trained": 13332000, "num_agent_steps_sampled": 13332000, "num_agent_steps_trained": 13332000}, "sampler_results": {"episode_reward_max": -150040.14405173154, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154976.34346513913, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166, -155313.6098490627, -154335.91940723156, -153163.44700579415, -155081.9968184573, -153534.47197310714, -156919.67280739898, -155303.933741006, -154998.7059787241, -156396.21245767956, -155908.43431380688, -154994.93712882744, -155297.9973432041, -153646.4321846235, -155039.62823040772, -155584.57729544895, -156357.260629546, -152236.93223614187, -157611.28098784437], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15323303765287494, "mean_inference_ms": 0.25964968360395935, "mean_action_processing_ms": 0.06376025182992169, "mean_env_wait_ms": 0.4999071112671926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003519296646118164, "StateBufferConnector_ms": 0.002668619155883789, "ViewRequirementAgentConnector_ms": 0.0639040470123291}}, "episode_reward_max": -150040.14405173154, "episode_reward_min": -160013.04634071543, "episode_reward_mean": -154976.34346513913, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-155338.1945240724, -155050.9156964917, -156263.71931689008, -155162.17091065922, -155885.4723960127, -154511.50426294305, -156875.16728573915, -152897.33290475205, -152551.53417559215, -153238.21442222563, -155627.10335978493, -157112.17241812765, -154453.37967509203, -155416.48335549072, -153827.1066265665, -151913.86746972238, -154051.51884375428, -155382.22478359126, -155646.71478705437, -156942.97004288877, -155420.87732016758, -158144.9782501521, -152671.83590733033, -157834.47354595657, -154658.05556185768, -153088.65130854255, -152858.86987716967, -154876.35639539117, -154164.78351280093, -157663.40607152873, -154835.62207995646, -153450.58783676865, -152639.2341744579, -155692.20318200294, -157033.58709380362, -151854.86756986746, -155510.54740693656, -157476.05174780855, -157762.36022981652, -155625.34561750968, -157631.40992314, -153233.740024119, -153850.66117099777, -154784.8839301148, -155485.91998140013, -152671.5716282637, -153244.237479114, -154094.89830393708, -154441.57809847154, -152147.24696196237, -157424.99613126228, -150040.14405173154, -153891.52778547216, -155025.80789462515, -155766.13864439036, -157993.90347702458, -153976.0353096172, -159093.9951989073, -154758.7304356594, -156942.69231458748, -154597.80979372535, -152715.65343606097, -156805.36161587588, -153258.23008364328, -152390.15390151576, -156104.35278188353, -152060.17237595867, -154043.07450356206, -154885.72073669825, -158357.16652927455, -152283.99168621292, -156986.9253643571, -155563.72997724314, -155633.94528035147, -160013.04634071543, -153186.28805204143, -156685.2114900504, -155879.41234241382, -153580.9255000352, -154415.20614457576, -155045.30934979016, -153506.62814754166, -155313.6098490627, -154335.91940723156, -153163.44700579415, -155081.9968184573, -153534.47197310714, -156919.67280739898, -155303.933741006, -154998.7059787241, -156396.21245767956, -155908.43431380688, -154994.93712882744, -155297.9973432041, -153646.4321846235, -155039.62823040772, -155584.57729544895, -156357.260629546, -152236.93223614187, -157611.28098784437], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15323303765287494, "mean_inference_ms": 0.25964968360395935, "mean_action_processing_ms": 0.06376025182992169, "mean_env_wait_ms": 0.4999071112671926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003519296646118164, "StateBufferConnector_ms": 0.002668619155883789, "ViewRequirementAgentConnector_ms": 0.0639040470123291}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13332000, "num_agent_steps_trained": 13332000, "num_env_steps_sampled": 13332000, "num_env_steps_trained": 13332000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 718.1259078961886, "num_env_steps_trained_throughput_per_sec": 718.1259078961886, "timesteps_total": 13332000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 13332000, "timers": {"training_iteration_time_ms": 61583.874, "sample_time_ms": 60427.206, "load_time_ms": 17.363, "load_throughput": 2529551.535, "learn_time_ms": 1138.206, "learn_throughput": 38587.052, "synch_weights_time_ms": 0.939}, "counters": {"num_env_steps_sampled": 13332000, "num_env_steps_trained": 13332000, "num_agent_steps_sampled": 13332000, "num_agent_steps_trained": 13332000}, "done": true, "episodes_total": 7756, "training_iteration": 1933, "trial_id": "5f2ac_00000", "date": "2023-08-06_10-22-36", "timestamp": 1691306556, "time_this_iter_s": 61.162038803100586, "time_total_s": 32427.1244931221, "pid": 76986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[4240560, 5e-10], [4591920, 8e-11], [4943280, 2.5e-11], [5294640, 2.5e-11], [5646000, 2.5e-11], [5997360, 2.5e-11], [6348720, 1e-11], [6700080, 1e-11], [7051440, 1e-11], [7402800, 5e-12], [7754160, 5e-12], [8105520, 5e-12], [8456880, 5e-12], [8808240, 1e-12], [9159600, 1e-12], [9510960, 1e-12], [9862320, 1e-12], [10213680, 5e-13], [10565040, 5e-13], [10916400, 2.5e-13], [11267760, 2.5e-13], [11619120, 1e-13], [11970480, 1e-13], [12321840, 5e-14], [12673200, 5e-14], [13024560, 1e-14]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 4316688}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17d930c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10147.508796930313, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 17.57816091954023, "ram_util_percent": 71.46206896551723}}
