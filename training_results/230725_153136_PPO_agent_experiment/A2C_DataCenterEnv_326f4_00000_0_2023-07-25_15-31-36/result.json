{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0028, "entropy_coeff": 0.125, "policy_entropy": -879.4564208984375, "policy_loss": -9.042431822105645e+18, "vf_loss": 1167975402.6666667}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}}, "num_env_steps_sampled": 5100720, "num_env_steps_trained": 5100720, "num_agent_steps_sampled": 5100720, "num_agent_steps_trained": 5100720}, "sampler_results": {"episode_reward_max": -25383.11288163201, "episode_reward_min": -25480.726216058833, "episode_reward_mean": -25430.266739000275, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201], "episode_lengths": [360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.421934661229893, "mean_inference_ms": 0.25302382660441564, "mean_action_processing_ms": 0.06006626020612856, "mean_env_wait_ms": 2.3260672501108037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022470951080322266, "StateBufferConnector_ms": 0.002002716064453125, "ViewRequirementAgentConnector_ms": 0.0453948974609375}}, "episode_reward_max": -25383.11288163201, "episode_reward_min": -25480.726216058833, "episode_reward_mean": -25430.266739000275, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201], "episode_lengths": [360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.421934661229893, "mean_inference_ms": 0.25302382660441564, "mean_action_processing_ms": 0.06006626020612856, "mean_env_wait_ms": 2.3260672501108037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022470951080322266, "StateBufferConnector_ms": 0.002002716064453125, "ViewRequirementAgentConnector_ms": 0.0453948974609375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5100720, "num_agent_steps_trained": 5100720, "num_env_steps_sampled": 5100720, "num_env_steps_trained": 5100720, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 140.71012768730105, "num_env_steps_trained_throughput_per_sec": 140.71012768730105, "timesteps_total": 5100720, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 5100720, "timers": {"training_iteration_time_ms": 2558.439, "sample_time_ms": 2551.048, "load_time_ms": 0.25, "load_throughput": 1441479.179, "learn_time_ms": 6.551, "learn_throughput": 54956.713, "synch_weights_time_ms": 0.558}, "counters": {"num_env_steps_sampled": 5100720, "num_env_steps_trained": 5100720, "num_agent_steps_sampled": 5100720, "num_agent_steps_trained": 5100720}, "done": false, "episodes_total": 1213, "training_iteration": 581, "trial_id": "326f4_00000", "date": "2023-07-25_15-31-51", "timestamp": 1690288311, "time_this_iter_s": 10.23612904548645, "time_total_s": 10189.867672681808, "pid": 66278, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.125, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fcd4310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10.23612904548645, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 28.166666666666668, "ram_util_percent": 80.88000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0018000000000000002, "entropy_coeff": 0.125, "policy_entropy": -958.8154500325521, "policy_loss": -2.372124796372298e+18, "vf_loss": 1179942698.6666667}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26.0, "diff_num_grad_updates_vs_sampler_policy": 25.0}}, "num_env_steps_sampled": 5102520, "num_env_steps_trained": 5102520, "num_agent_steps_sampled": 5102520, "num_agent_steps_trained": 5102520}, "sampler_results": {"episode_reward_max": -25353.487437612243, "episode_reward_min": -25529.62933861321, "episode_reward_mean": -25430.146492184616, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4204514691638614, "mean_inference_ms": 0.2520579846588862, "mean_action_processing_ms": 0.05980384038995892, "mean_env_wait_ms": 1.939665567324761, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024980968899197048, "StateBufferConnector_ms": 0.0018570158216688368, "ViewRequirementAgentConnector_ms": 0.045310126410590276}}, "episode_reward_max": -25353.487437612243, "episode_reward_min": -25529.62933861321, "episode_reward_mean": -25430.146492184616, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4204514691638614, "mean_inference_ms": 0.2520579846588862, "mean_action_processing_ms": 0.05980384038995892, "mean_env_wait_ms": 1.939665567324761, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024980968899197048, "StateBufferConnector_ms": 0.0018570158216688368, "ViewRequirementAgentConnector_ms": 0.045310126410590276}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5102520, "num_agent_steps_trained": 5102520, "num_env_steps_sampled": 5102520, "num_env_steps_trained": 5102520, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 171.42047531062883, "num_env_steps_trained_throughput_per_sec": 171.42047531062883, "timesteps_total": 5102520, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5102520, "timers": {"training_iteration_time_ms": 2303.801, "sample_time_ms": 2297.833, "load_time_ms": 0.232, "load_throughput": 1550432.967, "learn_time_ms": 5.18, "learn_throughput": 69500.363, "synch_weights_time_ms": 0.523}, "counters": {"num_env_steps_sampled": 5102520, "num_env_steps_trained": 5102520, "num_agent_steps_sampled": 5102520, "num_agent_steps_trained": 5102520}, "done": false, "episodes_total": 1218, "training_iteration": 582, "trial_id": "326f4_00000", "date": "2023-07-25_15-32-01", "timestamp": 1690288321, "time_this_iter_s": 10.502434015274048, "time_total_s": 10200.370106697083, "pid": 66278, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.125, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fcd4310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 20.738563060760498, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 25.120000000000005, "ram_util_percent": 80.76666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0009750000000000001, "entropy_coeff": 0.125, "policy_entropy": -971.8181762695312, "policy_loss": -6.158563732404047e+18, "vf_loss": 1178121578.6666667}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}}, "num_env_steps_sampled": 5104320, "num_env_steps_trained": 5104320, "num_agent_steps_sampled": 5104320, "num_agent_steps_trained": 5104320}, "sampler_results": {"episode_reward_max": -25353.487437612243, "episode_reward_min": -25695.93337200107, "episode_reward_mean": -25445.87624416628, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417444974142028, "mean_inference_ms": 0.2519220159563872, "mean_action_processing_ms": 0.05975403292349583, "mean_env_wait_ms": 1.7557034810414345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025732176644461496, "StateBufferConnector_ms": 0.0018664768763950893, "ViewRequirementAgentConnector_ms": 0.0453012330191476}}, "episode_reward_max": -25353.487437612243, "episode_reward_min": -25695.93337200107, "episode_reward_mean": -25445.87624416628, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417444974142028, "mean_inference_ms": 0.2519220159563872, "mean_action_processing_ms": 0.05975403292349583, "mean_env_wait_ms": 1.7557034810414345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025732176644461496, "StateBufferConnector_ms": 0.0018664768763950893, "ViewRequirementAgentConnector_ms": 0.0453012330191476}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5104320, "num_agent_steps_trained": 5104320, "num_env_steps_sampled": 5104320, "num_env_steps_trained": 5104320, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 172.4628506007322, "num_env_steps_trained_throughput_per_sec": 172.4628506007322, "timesteps_total": 5104320, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5104320, "timers": {"training_iteration_time_ms": 2093.743, "sample_time_ms": 2088.907, "load_time_ms": 0.218, "load_throughput": 1652023.457, "learn_time_ms": 4.091, "learn_throughput": 87987.777, "synch_weights_time_ms": 0.494}, "counters": {"num_env_steps_sampled": 5104320, "num_env_steps_trained": 5104320, "num_agent_steps_sampled": 5104320, "num_agent_steps_trained": 5104320}, "done": false, "episodes_total": 1223, "training_iteration": 583, "trial_id": "326f4_00000", "date": "2023-07-25_15-32-12", "timestamp": 1690288332, "time_this_iter_s": 10.43886113166809, "time_total_s": 10210.80896782875, "pid": 66278, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.125, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fcd4310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 31.17742419242859, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 25.560000000000002, "ram_util_percent": 79.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0008500000000000001, "entropy_coeff": 0.125, "policy_entropy": -973.5329386393229, "policy_loss": -1.0809674940650093e+18, "vf_loss": 1181805738.6666667}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 56.0, "diff_num_grad_updates_vs_sampler_policy": 55.0}}, "num_env_steps_sampled": 5106120, "num_env_steps_trained": 5106120, "num_agent_steps_sampled": 5106120, "num_agent_steps_trained": 5106120}, "sampler_results": {"episode_reward_max": -25168.42411252718, "episode_reward_min": -25792.838951912123, "episode_reward_mean": -25449.2716744943, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.414649781485436, "mean_inference_ms": 0.25181404745247177, "mean_action_processing_ms": 0.059726367965089885, "mean_env_wait_ms": 1.6438248558991098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002473279049521998, "StateBufferConnector_ms": 0.0018408423975894326, "ViewRequirementAgentConnector_ms": 0.04483775088661596}}, "episode_reward_max": -25168.42411252718, "episode_reward_min": -25792.838951912123, "episode_reward_mean": -25449.2716744943, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.414649781485436, "mean_inference_ms": 0.25181404745247177, "mean_action_processing_ms": 0.059726367965089885, "mean_env_wait_ms": 1.6438248558991098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002473279049521998, "StateBufferConnector_ms": 0.0018408423975894326, "ViewRequirementAgentConnector_ms": 0.04483775088661596}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5106120, "num_agent_steps_trained": 5106120, "num_env_steps_sampled": 5106120, "num_env_steps_trained": 5106120, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 172.29465344029288, "num_env_steps_trained_throughput_per_sec": 172.29465344029288, "timesteps_total": 5106120, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5106120, "timers": {"training_iteration_time_ms": 2088.416, "sample_time_ms": 2083.57, "load_time_ms": 0.214, "load_throughput": 1679401.001, "learn_time_ms": 4.096, "learn_throughput": 87888.421, "synch_weights_time_ms": 0.502}, "counters": {"num_env_steps_sampled": 5106120, "num_env_steps_trained": 5106120, "num_agent_steps_sampled": 5106120, "num_agent_steps_trained": 5106120}, "done": false, "episodes_total": 1228, "training_iteration": 584, "trial_id": "326f4_00000", "date": "2023-07-25_15-32-22", "timestamp": 1690288342, "time_this_iter_s": 10.449239015579224, "time_total_s": 10221.25820684433, "pid": 66278, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.125, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fcd4310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 41.62666320800781, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 25.459999999999994, "ram_util_percent": 79.85999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0007250000000000001, "entropy_coeff": 0.125, "policy_entropy": -968.7625528971354, "policy_loss": -6.848134084246821e+17, "vf_loss": 1162005077.3333333}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 71.0, "diff_num_grad_updates_vs_sampler_policy": 70.0}}, "num_env_steps_sampled": 5107920, "num_env_steps_trained": 5107920, "num_agent_steps_sampled": 5107920, "num_agent_steps_trained": 5107920}, "sampler_results": {"episode_reward_max": -25168.42411252718, "episode_reward_min": -25792.838951912123, "episode_reward_mean": -25453.603614419884, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413809023563996, "mean_inference_ms": 0.2516115444305848, "mean_action_processing_ms": 0.05969163358865039, "mean_env_wait_ms": 1.5673810264142276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025103489557902017, "StateBufferConnector_ms": 0.001813968022664388, "ViewRequirementAgentConnector_ms": 0.044811765352884926}}, "episode_reward_max": -25168.42411252718, "episode_reward_min": -25792.838951912123, "episode_reward_mean": -25453.603614419884, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413809023563996, "mean_inference_ms": 0.2516115444305848, "mean_action_processing_ms": 0.05969163358865039, "mean_env_wait_ms": 1.5673810264142276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025103489557902017, "StateBufferConnector_ms": 0.001813968022664388, "ViewRequirementAgentConnector_ms": 0.044811765352884926}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5107920, "num_agent_steps_trained": 5107920, "num_env_steps_sampled": 5107920, "num_env_steps_trained": 5107920, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 171.25361663455914, "num_env_steps_trained_throughput_per_sec": 171.25361663455914, "timesteps_total": 5107920, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5107920, "timers": {"training_iteration_time_ms": 2095.785, "sample_time_ms": 2090.974, "load_time_ms": 0.213, "load_throughput": 1688037.384, "learn_time_ms": 4.056, "learn_throughput": 88762.599, "synch_weights_time_ms": 0.509}, "counters": {"num_env_steps_sampled": 5107920, "num_env_steps_trained": 5107920, "num_agent_steps_sampled": 5107920, "num_agent_steps_trained": 5107920}, "done": false, "episodes_total": 1233, "training_iteration": 585, "trial_id": "326f4_00000", "date": "2023-07-25_15-32-33", "timestamp": 1690288353, "time_this_iter_s": 10.512739181518555, "time_total_s": 10231.770946025848, "pid": 66278, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.125, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fcd4310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 52.13940238952637, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 25.34666666666666, "ram_util_percent": 80.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0006000000000000001, "entropy_coeff": 0.125, "policy_entropy": -930.8060913085938, "policy_loss": -2.795005352370067e+17, "vf_loss": 1227260757.3333333}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 86.0, "diff_num_grad_updates_vs_sampler_policy": 85.0}}, "num_env_steps_sampled": 5109720, "num_env_steps_trained": 5109720, "num_agent_steps_sampled": 5109720, "num_agent_steps_trained": 5109720}, "sampler_results": {"episode_reward_max": -25168.42411252718, "episode_reward_min": -26187.34400376406, "episode_reward_mean": -25546.243722192532, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413671844059907, "mean_inference_ms": 0.25152802425399345, "mean_action_processing_ms": 0.059674119747802616, "mean_env_wait_ms": 1.5123301527103723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025362804018217943, "StateBufferConnector_ms": 0.0018465107884900324, "ViewRequirementAgentConnector_ms": 0.04497725388099407}}, "episode_reward_max": -25168.42411252718, "episode_reward_min": -26187.34400376406, "episode_reward_mean": -25546.243722192532, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413671844059907, "mean_inference_ms": 0.25152802425399345, "mean_action_processing_ms": 0.059674119747802616, "mean_env_wait_ms": 1.5123301527103723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025362804018217943, "StateBufferConnector_ms": 0.0018465107884900324, "ViewRequirementAgentConnector_ms": 0.04497725388099407}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5109720, "num_agent_steps_trained": 5109720, "num_env_steps_sampled": 5109720, "num_env_steps_trained": 5109720, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 170.0344839227688, "num_env_steps_trained_throughput_per_sec": 170.0344839227688, "timesteps_total": 5109720, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5109720, "timers": {"training_iteration_time_ms": 2109.672, "sample_time_ms": 2104.624, "load_time_ms": 0.222, "load_throughput": 1620117.425, "learn_time_ms": 4.281, "learn_throughput": 84094.447, "synch_weights_time_ms": 0.512}, "counters": {"num_env_steps_sampled": 5109720, "num_env_steps_trained": 5109720, "num_agent_steps_sampled": 5109720, "num_agent_steps_trained": 5109720}, "done": false, "episodes_total": 1238, "training_iteration": 586, "trial_id": "326f4_00000", "date": "2023-07-25_15-32-43", "timestamp": 1690288363, "time_this_iter_s": 10.588017225265503, "time_total_s": 10242.358963251114, "pid": 66278, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.125, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fcd4310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 62.72741961479187, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 25.66, "ram_util_percent": 80.07999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.000475, "entropy_coeff": 0.125, "policy_entropy": -924.7185262044271, "policy_loss": -1.7510067414834214e+17, "vf_loss": 1198844608.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 101.0, "diff_num_grad_updates_vs_sampler_policy": 100.0}}, "num_env_steps_sampled": 5111520, "num_env_steps_trained": 5111520, "num_agent_steps_sampled": 5111520, "num_agent_steps_trained": 5111520}, "sampler_results": {"episode_reward_max": -25168.42411252718, "episode_reward_min": -26489.865240353585, "episode_reward_mean": -25634.89063117682, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.414141838251154, "mean_inference_ms": 0.2514083252785506, "mean_action_processing_ms": 0.05965163516234983, "mean_env_wait_ms": 1.471033748221524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002502693849451402, "StateBufferConnector_ms": 0.0018554575303021598, "ViewRequirementAgentConnector_ms": 0.045258858624626606}}, "episode_reward_max": -25168.42411252718, "episode_reward_min": -26489.865240353585, "episode_reward_mean": -25634.89063117682, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.414141838251154, "mean_inference_ms": 0.2514083252785506, "mean_action_processing_ms": 0.05965163516234983, "mean_env_wait_ms": 1.471033748221524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002502693849451402, "StateBufferConnector_ms": 0.0018554575303021598, "ViewRequirementAgentConnector_ms": 0.045258858624626606}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5111520, "num_agent_steps_trained": 5111520, "num_env_steps_sampled": 5111520, "num_env_steps_trained": 5111520, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 168.9729758401959, "num_env_steps_trained_throughput_per_sec": 168.9729758401959, "timesteps_total": 5111520, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5111520, "timers": {"training_iteration_time_ms": 2123.858, "sample_time_ms": 2118.372, "load_time_ms": 0.238, "load_throughput": 1512369.231, "learn_time_ms": 4.657, "learn_throughput": 77297.736, "synch_weights_time_ms": 0.556}, "counters": {"num_env_steps_sampled": 5111520, "num_env_steps_trained": 5111520, "num_agent_steps_sampled": 5111520, "num_agent_steps_trained": 5111520}, "done": false, "episodes_total": 1243, "training_iteration": 587, "trial_id": "326f4_00000", "date": "2023-07-25_15-32-54", "timestamp": 1690288374, "time_this_iter_s": 10.654627799987793, "time_total_s": 10253.013591051102, "pid": 66278, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.125, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fcd4310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 73.38204741477966, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 26.053333333333335, "ram_util_percent": 79.93333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00035000000000000005, "entropy_coeff": 0.125, "policy_entropy": -917.0860392252604, "policy_loss": -1.3368428661938586e+17, "vf_loss": 1211384021.3333333}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 116.0, "diff_num_grad_updates_vs_sampler_policy": 115.0}}, "num_env_steps_sampled": 5113320, "num_env_steps_trained": 5113320, "num_agent_steps_sampled": 5113320, "num_agent_steps_trained": 5113320}, "sampler_results": {"episode_reward_max": -25168.42411252718, "episode_reward_min": -26489.865240353585, "episode_reward_mean": -25648.7924300508, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413937779862109, "mean_inference_ms": 0.25140293946962855, "mean_action_processing_ms": 0.05964219948097765, "mean_env_wait_ms": 1.438549277768359, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025290709275465747, "StateBufferConnector_ms": 0.0018847294342823518, "ViewRequirementAgentConnector_ms": 0.046231807806552984}}, "episode_reward_max": -25168.42411252718, "episode_reward_min": -26489.865240353585, "episode_reward_mean": -25648.7924300508, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413937779862109, "mean_inference_ms": 0.25140293946962855, "mean_action_processing_ms": 0.05964219948097765, "mean_env_wait_ms": 1.438549277768359, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025290709275465747, "StateBufferConnector_ms": 0.0018847294342823518, "ViewRequirementAgentConnector_ms": 0.046231807806552984}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5113320, "num_agent_steps_trained": 5113320, "num_env_steps_sampled": 5113320, "num_env_steps_trained": 5113320, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 170.76099346327646, "num_env_steps_trained_throughput_per_sec": 170.76099346327646, "timesteps_total": 5113320, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5113320, "timers": {"training_iteration_time_ms": 2119.354, "sample_time_ms": 2114.146, "load_time_ms": 0.23, "load_throughput": 1562124.395, "learn_time_ms": 4.399, "learn_throughput": 81836.086, "synch_weights_time_ms": 0.545}, "counters": {"num_env_steps_sampled": 5113320, "num_env_steps_trained": 5113320, "num_agent_steps_sampled": 5113320, "num_agent_steps_trained": 5113320}, "done": false, "episodes_total": 1248, "training_iteration": 588, "trial_id": "326f4_00000", "date": "2023-07-25_15-33-04", "timestamp": 1690288384, "time_this_iter_s": 10.543118238449097, "time_total_s": 10263.55670928955, "pid": 66278, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.125, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fcd4310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 83.92516565322876, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 25.54, "ram_util_percent": 79.77333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.000235, "entropy_coeff": 0.125, "policy_entropy": -915.7413533528646, "policy_loss": -1.140451291691278e+16, "vf_loss": 1193041834.6666667}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 131.0, "diff_num_grad_updates_vs_sampler_policy": 130.0}}, "num_env_steps_sampled": 5115120, "num_env_steps_trained": 5115120, "num_agent_steps_sampled": 5115120, "num_agent_steps_trained": 5115120}, "sampler_results": {"episode_reward_max": -25168.42411252718, "episode_reward_min": -26489.865240353585, "episode_reward_mean": -25657.345324459984, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413850832716833, "mean_inference_ms": 0.2513752418928707, "mean_action_processing_ms": 0.05962906907449424, "mean_env_wait_ms": 1.41192855357515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002648071809248491, "StateBufferConnector_ms": 0.0019003044475208628, "ViewRequirementAgentConnector_ms": 0.046018578789450905}}, "episode_reward_max": -25168.42411252718, "episode_reward_min": -26489.865240353585, "episode_reward_mean": -25657.345324459984, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413850832716833, "mean_inference_ms": 0.2513752418928707, "mean_action_processing_ms": 0.05962906907449424, "mean_env_wait_ms": 1.41192855357515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002648071809248491, "StateBufferConnector_ms": 0.0019003044475208628, "ViewRequirementAgentConnector_ms": 0.046018578789450905}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5115120, "num_agent_steps_trained": 5115120, "num_env_steps_sampled": 5115120, "num_env_steps_trained": 5115120, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 170.64966218824767, "num_env_steps_trained_throughput_per_sec": 170.64966218824767, "timesteps_total": 5115120, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5115120, "timers": {"training_iteration_time_ms": 2108.888, "sample_time_ms": 2104.114, "load_time_ms": 0.214, "load_throughput": 1678467.586, "learn_time_ms": 4.028, "learn_throughput": 89367.273, "synch_weights_time_ms": 0.498}, "counters": {"num_env_steps_sampled": 5115120, "num_env_steps_trained": 5115120, "num_agent_steps_sampled": 5115120, "num_agent_steps_trained": 5115120}, "done": false, "episodes_total": 1253, "training_iteration": 589, "trial_id": "326f4_00000", "date": "2023-07-25_15-33-15", "timestamp": 1690288395, "time_this_iter_s": 10.549940824508667, "time_total_s": 10274.10665011406, "pid": 66278, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.125, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fcd4310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 94.47510647773743, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 24.486666666666668, "ram_util_percent": 80.14666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00015999999999999999, "entropy_coeff": 0.125, "policy_entropy": -906.0587158203125, "policy_loss": -1.3249930590946218e+16, "vf_loss": 1169746709.3333333}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 146.0, "diff_num_grad_updates_vs_sampler_policy": 145.0}}, "num_env_steps_sampled": 5116920, "num_env_steps_trained": 5116920, "num_agent_steps_sampled": 5116920, "num_agent_steps_trained": 5116920}, "sampler_results": {"episode_reward_max": -25168.42411252718, "episode_reward_min": -26489.865240353585, "episode_reward_mean": -25645.72374997732, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186, -25552.536900572424, -25731.969822607745, -25611.775598758017, -25431.826462254012, -25389.16068845698], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413564240937566, "mean_inference_ms": 0.2513359094086446, "mean_action_processing_ms": 0.05961629710457545, "mean_env_wait_ms": 1.3898207786702266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002651311913315131, "StateBufferConnector_ms": 0.00188496648048868, "ViewRequirementAgentConnector_ms": 0.045849839035345584}}, "episode_reward_max": -25168.42411252718, "episode_reward_min": -26489.865240353585, "episode_reward_mean": -25645.72374997732, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186, -25552.536900572424, -25731.969822607745, -25611.775598758017, -25431.826462254012, -25389.16068845698], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413564240937566, "mean_inference_ms": 0.2513359094086446, "mean_action_processing_ms": 0.05961629710457545, "mean_env_wait_ms": 1.3898207786702266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002651311913315131, "StateBufferConnector_ms": 0.00188496648048868, "ViewRequirementAgentConnector_ms": 0.045849839035345584}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5116920, "num_agent_steps_trained": 5116920, "num_env_steps_sampled": 5116920, "num_env_steps_trained": 5116920, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 170.92843715711993, "num_env_steps_trained_throughput_per_sec": 170.92843715711993, "timesteps_total": 5116920, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5116920, "timers": {"training_iteration_time_ms": 2107.856, "sample_time_ms": 2103.052, "load_time_ms": 0.214, "load_throughput": 1682394.919, "learn_time_ms": 4.058, "learn_throughput": 88706.802, "synch_weights_time_ms": 0.498}, "counters": {"num_env_steps_sampled": 5116920, "num_env_steps_trained": 5116920, "num_agent_steps_sampled": 5116920, "num_agent_steps_trained": 5116920}, "done": false, "episodes_total": 1258, "training_iteration": 590, "trial_id": "326f4_00000", "date": "2023-07-25_15-33-25", "timestamp": 1690288405, "time_this_iter_s": 10.532592058181763, "time_total_s": 10284.639242172241, "pid": 66278, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.125, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fcd4310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 105.00769853591919, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 25.313333333333333, "ram_util_percent": 80.07333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.75e-05, "entropy_coeff": 0.125, "policy_entropy": -900.1939900716146, "policy_loss": -6403757045367423.0, "vf_loss": 1214863594.6666667}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 161.0, "diff_num_grad_updates_vs_sampler_policy": 160.0}}, "num_env_steps_sampled": 5118720, "num_env_steps_trained": 5118720, "num_agent_steps_sampled": 5118720, "num_agent_steps_trained": 5118720}, "sampler_results": {"episode_reward_max": -25168.42411252718, "episode_reward_min": -26489.865240353585, "episode_reward_mean": -25649.256953035667, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186, -25552.536900572424, -25731.969822607745, -25611.775598758017, -25431.826462254012, -25389.16068845698, -25453.72926771981, -25621.1189127248, -25637.16425553349, -25823.780154535223, -25883.61912452381], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413517370956164, "mean_inference_ms": 0.2512935144528704, "mean_action_processing_ms": 0.059602829577805556, "mean_env_wait_ms": 1.3711770440720787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026270195289894386, "StateBufferConnector_ms": 0.0018888049655490452, "ViewRequirementAgentConnector_ms": 0.04614282537389685}}, "episode_reward_max": -25168.42411252718, "episode_reward_min": -26489.865240353585, "episode_reward_mean": -25649.256953035667, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186, -25552.536900572424, -25731.969822607745, -25611.775598758017, -25431.826462254012, -25389.16068845698, -25453.72926771981, -25621.1189127248, -25637.16425553349, -25823.780154535223, -25883.61912452381], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413517370956164, "mean_inference_ms": 0.2512935144528704, "mean_action_processing_ms": 0.059602829577805556, "mean_env_wait_ms": 1.3711770440720787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026270195289894386, "StateBufferConnector_ms": 0.0018888049655490452, "ViewRequirementAgentConnector_ms": 0.04614282537389685}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5118720, "num_agent_steps_trained": 5118720, "num_env_steps_sampled": 5118720, "num_env_steps_trained": 5118720, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 169.55709507573314, "num_env_steps_trained_throughput_per_sec": 169.55709507573314, "timesteps_total": 5118720, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5118720, "timers": {"training_iteration_time_ms": 2114.652, "sample_time_ms": 2109.709, "load_time_ms": 0.22, "load_throughput": 1637156.5, "learn_time_ms": 4.196, "learn_throughput": 85802.82, "synch_weights_time_ms": 0.494}, "counters": {"num_env_steps_sampled": 5118720, "num_env_steps_trained": 5118720, "num_agent_steps_sampled": 5118720, "num_agent_steps_trained": 5118720}, "done": false, "episodes_total": 1263, "training_iteration": 591, "trial_id": "326f4_00000", "date": "2023-07-25_15-33-36", "timestamp": 1690288416, "time_this_iter_s": 10.61811113357544, "time_total_s": 10295.257353305817, "pid": 66278, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.125, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fcd4310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 115.62580966949463, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 25.659999999999993, "ram_util_percent": 80.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.5e-05, "entropy_coeff": 0.125, "policy_entropy": -891.7616577148438, "policy_loss": -1.6124643277187754e+16, "vf_loss": 1233025450.6666667}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 176.0, "diff_num_grad_updates_vs_sampler_policy": 175.0}}, "num_env_steps_sampled": 5120520, "num_env_steps_trained": 5120520, "num_agent_steps_sampled": 5120520, "num_agent_steps_trained": 5120520}, "sampler_results": {"episode_reward_max": -25168.42411252718, "episode_reward_min": -26489.865240353585, "episode_reward_mean": -25669.752073192132, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186, -25552.536900572424, -25731.969822607745, -25611.775598758017, -25431.826462254012, -25389.16068845698, -25453.72926771981, -25621.1189127248, -25637.16425553349, -25823.780154535223, -25883.61912452381, -25766.206601240516, -25402.62826850981, -26133.496214266142, -25988.205624237813, -26164.960146155958], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413355066798503, "mean_inference_ms": 0.2512830646924528, "mean_action_processing_ms": 0.05959478004610253, "mean_env_wait_ms": 1.3550267610035904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002599570710780257, "StateBufferConnector_ms": 0.0018972461506471796, "ViewRequirementAgentConnector_ms": 0.04604388091523769}}, "episode_reward_max": -25168.42411252718, "episode_reward_min": -26489.865240353585, "episode_reward_mean": -25669.752073192132, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186, -25552.536900572424, -25731.969822607745, -25611.775598758017, -25431.826462254012, -25389.16068845698, -25453.72926771981, -25621.1189127248, -25637.16425553349, -25823.780154535223, -25883.61912452381, -25766.206601240516, -25402.62826850981, -26133.496214266142, -25988.205624237813, -26164.960146155958], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413355066798503, "mean_inference_ms": 0.2512830646924528, "mean_action_processing_ms": 0.05959478004610253, "mean_env_wait_ms": 1.3550267610035904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002599570710780257, "StateBufferConnector_ms": 0.0018972461506471796, "ViewRequirementAgentConnector_ms": 0.04604388091523769}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5120520, "num_agent_steps_trained": 5120520, "num_env_steps_sampled": 5120520, "num_env_steps_trained": 5120520, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 171.23404822048752, "num_env_steps_trained_throughput_per_sec": 171.23404822048752, "timesteps_total": 5120520, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5120520, "timers": {"training_iteration_time_ms": 2112.772, "sample_time_ms": 2107.719, "load_time_ms": 0.226, "load_throughput": 1589587.788, "learn_time_ms": 4.282, "learn_throughput": 84065.42, "synch_weights_time_ms": 0.51}, "counters": {"num_env_steps_sampled": 5120520, "num_env_steps_trained": 5120520, "num_agent_steps_sampled": 5120520, "num_agent_steps_trained": 5120520}, "done": false, "episodes_total": 1268, "training_iteration": 592, "trial_id": "326f4_00000", "date": "2023-07-25_15-33-47", "timestamp": 1690288427, "time_this_iter_s": 10.513939142227173, "time_total_s": 10305.771292448044, "pid": 66278, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.125, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fcd4310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 126.1397488117218, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 25.113333333333337, "ram_util_percent": 79.94666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.25e-05, "entropy_coeff": 0.125, "policy_entropy": -885.3515014648438, "policy_loss": -1.1217237698899158e+16, "vf_loss": 1239761728.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 191.0, "diff_num_grad_updates_vs_sampler_policy": 190.0}}, "num_env_steps_sampled": 5122320, "num_env_steps_trained": 5122320, "num_agent_steps_sampled": 5122320, "num_agent_steps_trained": 5122320}, "sampler_results": {"episode_reward_max": -25168.42411252718, "episode_reward_min": -26489.865240353585, "episode_reward_mean": -25703.389314403623, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186, -25552.536900572424, -25731.969822607745, -25611.775598758017, -25431.826462254012, -25389.16068845698, -25453.72926771981, -25621.1189127248, -25637.16425553349, -25823.780154535223, -25883.61912452381, -25766.206601240516, -25402.62826850981, -26133.496214266142, -25988.205624237813, -26164.960146155958, -25995.131633214467, -25997.76105141028, -26211.303688027547, -26130.569715325095, -26166.77771551865], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413206845242563, "mean_inference_ms": 0.25125967332801646, "mean_action_processing_ms": 0.0595847690352891, "mean_env_wait_ms": 1.3406782673224917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002610310912132263, "StateBufferConnector_ms": 0.0019051134586334229, "ViewRequirementAgentConnector_ms": 0.04596784710884094}}, "episode_reward_max": -25168.42411252718, "episode_reward_min": -26489.865240353585, "episode_reward_mean": -25703.389314403623, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186, -25552.536900572424, -25731.969822607745, -25611.775598758017, -25431.826462254012, -25389.16068845698, -25453.72926771981, -25621.1189127248, -25637.16425553349, -25823.780154535223, -25883.61912452381, -25766.206601240516, -25402.62826850981, -26133.496214266142, -25988.205624237813, -26164.960146155958, -25995.131633214467, -25997.76105141028, -26211.303688027547, -26130.569715325095, -26166.77771551865], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413206845242563, "mean_inference_ms": 0.25125967332801646, "mean_action_processing_ms": 0.0595847690352891, "mean_env_wait_ms": 1.3406782673224917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002610310912132263, "StateBufferConnector_ms": 0.0019051134586334229, "ViewRequirementAgentConnector_ms": 0.04596784710884094}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5122320, "num_agent_steps_trained": 5122320, "num_env_steps_sampled": 5122320, "num_env_steps_trained": 5122320, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 172.02044965554998, "num_env_steps_trained_throughput_per_sec": 172.02044965554998, "timesteps_total": 5122320, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5122320, "timers": {"training_iteration_time_ms": 2097.57, "sample_time_ms": 2092.636, "load_time_ms": 0.223, "load_throughput": 1616821.33, "learn_time_ms": 4.171, "learn_throughput": 86313.898, "synch_weights_time_ms": 0.507}, "counters": {"num_env_steps_sampled": 5122320, "num_env_steps_trained": 5122320, "num_agent_steps_sampled": 5122320, "num_agent_steps_trained": 5122320}, "done": false, "episodes_total": 1273, "training_iteration": 593, "trial_id": "326f4_00000", "date": "2023-07-25_15-33-57", "timestamp": 1690288437, "time_this_iter_s": 10.465861082077026, "time_total_s": 10316.23715353012, "pid": 66278, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.125, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fcd4310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 136.60560989379883, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 23.813333333333333, "ram_util_percent": 79.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6e-05, "entropy_coeff": 0.125, "policy_entropy": -881.4119873046875, "policy_loss": -1.0352427022115946e+16, "vf_loss": 1250350805.3333333}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 206.0, "diff_num_grad_updates_vs_sampler_policy": 205.0}}, "num_env_steps_sampled": 5124120, "num_env_steps_trained": 5124120, "num_agent_steps_sampled": 5124120, "num_agent_steps_trained": 5124120}, "sampler_results": {"episode_reward_max": -25168.42411252718, "episode_reward_min": -26489.865240353585, "episode_reward_mean": -25739.38467083785, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186, -25552.536900572424, -25731.969822607745, -25611.775598758017, -25431.826462254012, -25389.16068845698, -25453.72926771981, -25621.1189127248, -25637.16425553349, -25823.780154535223, -25883.61912452381, -25766.206601240516, -25402.62826850981, -26133.496214266142, -25988.205624237813, -26164.960146155958, -25995.131633214467, -25997.76105141028, -26211.303688027547, -26130.569715325095, -26166.77771551865, -26124.980088315282, -26326.641023071872, -26229.0180414901, -26021.90177146444, -26298.08524163815], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413112143308114, "mean_inference_ms": 0.25121342336205227, "mean_action_processing_ms": 0.05957136195009159, "mean_env_wait_ms": 1.327714816700286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026112017424210258, "StateBufferConnector_ms": 0.001890417458354563, "ViewRequirementAgentConnector_ms": 0.04580815633138021}}, "episode_reward_max": -25168.42411252718, "episode_reward_min": -26489.865240353585, "episode_reward_mean": -25739.38467083785, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186, -25552.536900572424, -25731.969822607745, -25611.775598758017, -25431.826462254012, -25389.16068845698, -25453.72926771981, -25621.1189127248, -25637.16425553349, -25823.780154535223, -25883.61912452381, -25766.206601240516, -25402.62826850981, -26133.496214266142, -25988.205624237813, -26164.960146155958, -25995.131633214467, -25997.76105141028, -26211.303688027547, -26130.569715325095, -26166.77771551865, -26124.980088315282, -26326.641023071872, -26229.0180414901, -26021.90177146444, -26298.08524163815], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413112143308114, "mean_inference_ms": 0.25121342336205227, "mean_action_processing_ms": 0.05957136195009159, "mean_env_wait_ms": 1.327714816700286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026112017424210258, "StateBufferConnector_ms": 0.001890417458354563, "ViewRequirementAgentConnector_ms": 0.04580815633138021}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5124120, "num_agent_steps_trained": 5124120, "num_env_steps_sampled": 5124120, "num_env_steps_trained": 5124120, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 172.57962627693485, "num_env_steps_trained_throughput_per_sec": 172.57962627693485, "timesteps_total": 5124120, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5124120, "timers": {"training_iteration_time_ms": 2089.374, "sample_time_ms": 2084.563, "load_time_ms": 0.22, "load_throughput": 1637511.593, "learn_time_ms": 4.064, "learn_throughput": 88586.582, "synch_weights_time_ms": 0.493}, "counters": {"num_env_steps_sampled": 5124120, "num_env_steps_trained": 5124120, "num_agent_steps_sampled": 5124120, "num_agent_steps_trained": 5124120}, "done": false, "episodes_total": 1278, "training_iteration": 594, "trial_id": "326f4_00000", "date": "2023-07-25_15-34-08", "timestamp": 1690288448, "time_this_iter_s": 10.432048797607422, "time_total_s": 10326.669202327728, "pid": 66278, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.125, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fcd4310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 147.03765869140625, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 26.680000000000003, "ram_util_percent": 79.76666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.7499999999999996e-05, "entropy_coeff": 0.125, "policy_entropy": -877.6445719401041, "policy_loss": -2891473441242864.0, "vf_loss": 1285595904.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 221.0, "diff_num_grad_updates_vs_sampler_policy": 220.0}}, "num_env_steps_sampled": 5125920, "num_env_steps_trained": 5125920, "num_agent_steps_sampled": 5125920, "num_agent_steps_trained": 5125920}, "sampler_results": {"episode_reward_max": -25168.42411252718, "episode_reward_min": -26816.306355614426, "episode_reward_mean": -25791.253160000546, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186, -25552.536900572424, -25731.969822607745, -25611.775598758017, -25431.826462254012, -25389.16068845698, -25453.72926771981, -25621.1189127248, -25637.16425553349, -25823.780154535223, -25883.61912452381, -25766.206601240516, -25402.62826850981, -26133.496214266142, -25988.205624237813, -26164.960146155958, -25995.131633214467, -25997.76105141028, -26211.303688027547, -26130.569715325095, -26166.77771551865, -26124.980088315282, -26326.641023071872, -26229.0180414901, -26021.90177146444, -26298.08524163815, -26327.769936707533, -26378.832563956214, -26816.306355614426, -26411.93973379822, -26600.342962152245], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.412949273457465, "mean_inference_ms": 0.25118312892313627, "mean_action_processing_ms": 0.059560911839078697, "mean_env_wait_ms": 1.3160561207463348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00258039783787083, "StateBufferConnector_ms": 0.0018835067749023438, "ViewRequirementAgentConnector_ms": 0.04574608158420872}}, "episode_reward_max": -25168.42411252718, "episode_reward_min": -26816.306355614426, "episode_reward_mean": -25791.253160000546, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186, -25552.536900572424, -25731.969822607745, -25611.775598758017, -25431.826462254012, -25389.16068845698, -25453.72926771981, -25621.1189127248, -25637.16425553349, -25823.780154535223, -25883.61912452381, -25766.206601240516, -25402.62826850981, -26133.496214266142, -25988.205624237813, -26164.960146155958, -25995.131633214467, -25997.76105141028, -26211.303688027547, -26130.569715325095, -26166.77771551865, -26124.980088315282, -26326.641023071872, -26229.0180414901, -26021.90177146444, -26298.08524163815, -26327.769936707533, -26378.832563956214, -26816.306355614426, -26411.93973379822, -26600.342962152245], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.412949273457465, "mean_inference_ms": 0.25118312892313627, "mean_action_processing_ms": 0.059560911839078697, "mean_env_wait_ms": 1.3160561207463348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00258039783787083, "StateBufferConnector_ms": 0.0018835067749023438, "ViewRequirementAgentConnector_ms": 0.04574608158420872}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5125920, "num_agent_steps_trained": 5125920, "num_env_steps_sampled": 5125920, "num_env_steps_trained": 5125920, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 172.29658013155822, "num_env_steps_trained_throughput_per_sec": 172.29658013155822, "timesteps_total": 5125920, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5125920, "timers": {"training_iteration_time_ms": 2087.697, "sample_time_ms": 2082.898, "load_time_ms": 0.227, "load_throughput": 1587582.21, "learn_time_ms": 4.039, "learn_throughput": 89127.258, "synch_weights_time_ms": 0.499}, "counters": {"num_env_steps_sampled": 5125920, "num_env_steps_trained": 5125920, "num_agent_steps_sampled": 5125920, "num_agent_steps_trained": 5125920}, "done": false, "episodes_total": 1283, "training_iteration": 595, "trial_id": "326f4_00000", "date": "2023-07-25_15-34-18", "timestamp": 1690288458, "time_this_iter_s": 10.449036836624146, "time_total_s": 10337.118239164352, "pid": 66278, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.125, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fcd4310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 157.4866955280304, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 25.45333333333333, "ram_util_percent": 79.88666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.5000000000000004e-05, "entropy_coeff": 0.125, "policy_entropy": -877.1191202799479, "policy_loss": -2584345353586282.5, "vf_loss": 1235861674.6666667}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 236.0, "diff_num_grad_updates_vs_sampler_policy": 235.0}}, "num_env_steps_sampled": 5127720, "num_env_steps_trained": 5127720, "num_agent_steps_sampled": 5127720, "num_agent_steps_trained": 5127720}, "sampler_results": {"episode_reward_max": -25168.42411252718, "episode_reward_min": -26816.306355614426, "episode_reward_mean": -25826.100959928724, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186, -25552.536900572424, -25731.969822607745, -25611.775598758017, -25431.826462254012, -25389.16068845698, -25453.72926771981, -25621.1189127248, -25637.16425553349, -25823.780154535223, -25883.61912452381, -25766.206601240516, -25402.62826850981, -26133.496214266142, -25988.205624237813, -26164.960146155958, -25995.131633214467, -25997.76105141028, -26211.303688027547, -26130.569715325095, -26166.77771551865, -26124.980088315282, -26326.641023071872, -26229.0180414901, -26021.90177146444, -26298.08524163815, -26327.769936707533, -26378.832563956214, -26816.306355614426, -26411.93973379822, -26600.342962152245, -26489.029628151697, -26457.498594314922, -26465.058899350362, -26212.3996767567, -26085.255195754733], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.412880232324439, "mean_inference_ms": 0.2511721968008082, "mean_action_processing_ms": 0.05955390834098722, "mean_env_wait_ms": 1.3055285410785087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00255832189246069, "StateBufferConnector_ms": 0.0018856193445905855, "ViewRequirementAgentConnector_ms": 0.045640559136113035}}, "episode_reward_max": -25168.42411252718, "episode_reward_min": -26816.306355614426, "episode_reward_mean": -25826.100959928724, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186, -25552.536900572424, -25731.969822607745, -25611.775598758017, -25431.826462254012, -25389.16068845698, -25453.72926771981, -25621.1189127248, -25637.16425553349, -25823.780154535223, -25883.61912452381, -25766.206601240516, -25402.62826850981, -26133.496214266142, -25988.205624237813, -26164.960146155958, -25995.131633214467, -25997.76105141028, -26211.303688027547, -26130.569715325095, -26166.77771551865, -26124.980088315282, -26326.641023071872, -26229.0180414901, -26021.90177146444, -26298.08524163815, -26327.769936707533, -26378.832563956214, -26816.306355614426, -26411.93973379822, -26600.342962152245, -26489.029628151697, -26457.498594314922, -26465.058899350362, -26212.3996767567, -26085.255195754733], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.412880232324439, "mean_inference_ms": 0.2511721968008082, "mean_action_processing_ms": 0.05955390834098722, "mean_env_wait_ms": 1.3055285410785087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00255832189246069, "StateBufferConnector_ms": 0.0018856193445905855, "ViewRequirementAgentConnector_ms": 0.045640559136113035}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5127720, "num_agent_steps_trained": 5127720, "num_env_steps_sampled": 5127720, "num_env_steps_trained": 5127720, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 171.03400655025544, "num_env_steps_trained_throughput_per_sec": 171.03400655025544, "timesteps_total": 5127720, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5127720, "timers": {"training_iteration_time_ms": 2097.123, "sample_time_ms": 2092.254, "load_time_ms": 0.229, "load_throughput": 1569920.399, "learn_time_ms": 4.098, "learn_throughput": 87847.515, "synch_weights_time_ms": 0.506}, "counters": {"num_env_steps_sampled": 5127720, "num_env_steps_trained": 5127720, "num_agent_steps_sampled": 5127720, "num_agent_steps_trained": 5127720}, "done": false, "episodes_total": 1288, "training_iteration": 596, "trial_id": "326f4_00000", "date": "2023-07-25_15-34-29", "timestamp": 1690288469, "time_this_iter_s": 10.526189088821411, "time_total_s": 10347.644428253174, "pid": 66278, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.125, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fcd4310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 168.0128846168518, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 26.246666666666666, "ram_util_percent": 80.04}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.3500000000000002e-05, "entropy_coeff": 0.125, "policy_entropy": -876.60400390625, "policy_loss": -1007287204315136.0, "vf_loss": 1268258048.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 251.0, "diff_num_grad_updates_vs_sampler_policy": 250.0}}, "num_env_steps_sampled": 5129520, "num_env_steps_trained": 5129520, "num_agent_steps_sampled": 5129520, "num_agent_steps_trained": 5129520}, "sampler_results": {"episode_reward_max": -25168.42411252718, "episode_reward_min": -26816.306355614426, "episode_reward_mean": -25869.331213679463, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186, -25552.536900572424, -25731.969822607745, -25611.775598758017, -25431.826462254012, -25389.16068845698, -25453.72926771981, -25621.1189127248, -25637.16425553349, -25823.780154535223, -25883.61912452381, -25766.206601240516, -25402.62826850981, -26133.496214266142, -25988.205624237813, -26164.960146155958, -25995.131633214467, -25997.76105141028, -26211.303688027547, -26130.569715325095, -26166.77771551865, -26124.980088315282, -26326.641023071872, -26229.0180414901, -26021.90177146444, -26298.08524163815, -26327.769936707533, -26378.832563956214, -26816.306355614426, -26411.93973379822, -26600.342962152245, -26489.029628151697, -26457.498594314922, -26465.058899350362, -26212.3996767567, -26085.255195754733, -26629.597425272714, -26324.251088606023, -26503.181616153397, -26802.068779382807, -26502.747205291456], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413301351273846, "mean_inference_ms": 0.2512599521287385, "mean_action_processing_ms": 0.059566760311434847, "mean_env_wait_ms": 1.2962655065145436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025885445731026785, "StateBufferConnector_ms": 0.0018948600405738467, "ViewRequirementAgentConnector_ms": 0.04605877967107864}}, "episode_reward_max": -25168.42411252718, "episode_reward_min": -26816.306355614426, "episode_reward_mean": -25869.331213679463, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186, -25552.536900572424, -25731.969822607745, -25611.775598758017, -25431.826462254012, -25389.16068845698, -25453.72926771981, -25621.1189127248, -25637.16425553349, -25823.780154535223, -25883.61912452381, -25766.206601240516, -25402.62826850981, -26133.496214266142, -25988.205624237813, -26164.960146155958, -25995.131633214467, -25997.76105141028, -26211.303688027547, -26130.569715325095, -26166.77771551865, -26124.980088315282, -26326.641023071872, -26229.0180414901, -26021.90177146444, -26298.08524163815, -26327.769936707533, -26378.832563956214, -26816.306355614426, -26411.93973379822, -26600.342962152245, -26489.029628151697, -26457.498594314922, -26465.058899350362, -26212.3996767567, -26085.255195754733, -26629.597425272714, -26324.251088606023, -26503.181616153397, -26802.068779382807, -26502.747205291456], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413301351273846, "mean_inference_ms": 0.2512599521287385, "mean_action_processing_ms": 0.059566760311434847, "mean_env_wait_ms": 1.2962655065145436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025885445731026785, "StateBufferConnector_ms": 0.0018948600405738467, "ViewRequirementAgentConnector_ms": 0.04605877967107864}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5129520, "num_agent_steps_trained": 5129520, "num_env_steps_sampled": 5129520, "num_env_steps_trained": 5129520, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 164.43280380930602, "num_env_steps_trained_throughput_per_sec": 164.43280380930602, "timesteps_total": 5129520, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5129520, "timers": {"training_iteration_time_ms": 2147.08, "sample_time_ms": 2141.957, "load_time_ms": 0.25, "load_throughput": 1442718.746, "learn_time_ms": 4.262, "learn_throughput": 84460.883, "synch_weights_time_ms": 0.557}, "counters": {"num_env_steps_sampled": 5129520, "num_env_steps_trained": 5129520, "num_agent_steps_sampled": 5129520, "num_agent_steps_trained": 5129520}, "done": false, "episodes_total": 1293, "training_iteration": 597, "trial_id": "326f4_00000", "date": "2023-07-25_15-34-40", "timestamp": 1690288480, "time_this_iter_s": 10.948974847793579, "time_total_s": 10358.593403100967, "pid": 66278, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.125, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fcd4310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 178.96185946464539, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 33.68, "ram_util_percent": 80.67333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.6000000000000003e-05, "entropy_coeff": 0.125, "policy_entropy": -875.5537109375, "policy_loss": -739566858326559.5, "vf_loss": 1278544213.3333333}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 266.0, "diff_num_grad_updates_vs_sampler_policy": 265.0}}, "num_env_steps_sampled": 5131320, "num_env_steps_trained": 5131320, "num_agent_steps_sampled": 5131320, "num_agent_steps_trained": 5131320}, "sampler_results": {"episode_reward_max": -25168.42411252718, "episode_reward_min": -26816.306355614426, "episode_reward_mean": -25909.466712085617, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186, -25552.536900572424, -25731.969822607745, -25611.775598758017, -25431.826462254012, -25389.16068845698, -25453.72926771981, -25621.1189127248, -25637.16425553349, -25823.780154535223, -25883.61912452381, -25766.206601240516, -25402.62826850981, -26133.496214266142, -25988.205624237813, -26164.960146155958, -25995.131633214467, -25997.76105141028, -26211.303688027547, -26130.569715325095, -26166.77771551865, -26124.980088315282, -26326.641023071872, -26229.0180414901, -26021.90177146444, -26298.08524163815, -26327.769936707533, -26378.832563956214, -26816.306355614426, -26411.93973379822, -26600.342962152245, -26489.029628151697, -26457.498594314922, -26465.058899350362, -26212.3996767567, -26085.255195754733, -26629.597425272714, -26324.251088606023, -26503.181616153397, -26802.068779382807, -26502.747205291456, -26734.620343608214, -26726.927579678162, -26273.409595240148, -26593.902898073866, -26589.855009944586], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.414327808903527, "mean_inference_ms": 0.2513965914024512, "mean_action_processing_ms": 0.05958657535138685, "mean_env_wait_ms": 1.2879739132651131, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025944763355040816, "StateBufferConnector_ms": 0.0018950258747915203, "ViewRequirementAgentConnector_ms": 0.045999516262097306}}, "episode_reward_max": -25168.42411252718, "episode_reward_min": -26816.306355614426, "episode_reward_mean": -25909.466712085617, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186, -25552.536900572424, -25731.969822607745, -25611.775598758017, -25431.826462254012, -25389.16068845698, -25453.72926771981, -25621.1189127248, -25637.16425553349, -25823.780154535223, -25883.61912452381, -25766.206601240516, -25402.62826850981, -26133.496214266142, -25988.205624237813, -26164.960146155958, -25995.131633214467, -25997.76105141028, -26211.303688027547, -26130.569715325095, -26166.77771551865, -26124.980088315282, -26326.641023071872, -26229.0180414901, -26021.90177146444, -26298.08524163815, -26327.769936707533, -26378.832563956214, -26816.306355614426, -26411.93973379822, -26600.342962152245, -26489.029628151697, -26457.498594314922, -26465.058899350362, -26212.3996767567, -26085.255195754733, -26629.597425272714, -26324.251088606023, -26503.181616153397, -26802.068779382807, -26502.747205291456, -26734.620343608214, -26726.927579678162, -26273.409595240148, -26593.902898073866, -26589.855009944586], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.414327808903527, "mean_inference_ms": 0.2513965914024512, "mean_action_processing_ms": 0.05958657535138685, "mean_env_wait_ms": 1.2879739132651131, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025944763355040816, "StateBufferConnector_ms": 0.0018950258747915203, "ViewRequirementAgentConnector_ms": 0.045999516262097306}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5131320, "num_agent_steps_trained": 5131320, "num_env_steps_sampled": 5131320, "num_env_steps_trained": 5131320, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 163.26761379182201, "num_env_steps_trained_throughput_per_sec": 163.26761379182201, "timesteps_total": 5131320, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5131320, "timers": {"training_iteration_time_ms": 2197.142, "sample_time_ms": 2191.909, "load_time_ms": 0.255, "load_throughput": 1410903.981, "learn_time_ms": 4.336, "learn_throughput": 83021.732, "synch_weights_time_ms": 0.588}, "counters": {"num_env_steps_sampled": 5131320, "num_env_steps_trained": 5131320, "num_agent_steps_sampled": 5131320, "num_agent_steps_trained": 5131320}, "done": false, "episodes_total": 1298, "training_iteration": 598, "trial_id": "326f4_00000", "date": "2023-07-25_15-34-51", "timestamp": 1690288491, "time_this_iter_s": 11.027671098709106, "time_total_s": 10369.621074199677, "pid": 66278, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.125, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fcd4310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 189.9895305633545, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 34.05625, "ram_util_percent": 78.98750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.750000000000002e-06, "entropy_coeff": 0.125, "policy_entropy": -874.5777994791666, "policy_loss": -453728859057653.3, "vf_loss": 1238042240.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 281.0, "diff_num_grad_updates_vs_sampler_policy": 280.0}}, "num_env_steps_sampled": 5133120, "num_env_steps_trained": 5133120, "num_agent_steps_sampled": 5133120, "num_agent_steps_trained": 5133120}, "sampler_results": {"episode_reward_max": -25168.42411252718, "episode_reward_min": -26816.306355614426, "episode_reward_mean": -25937.0162022205, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186, -25552.536900572424, -25731.969822607745, -25611.775598758017, -25431.826462254012, -25389.16068845698, -25453.72926771981, -25621.1189127248, -25637.16425553349, -25823.780154535223, -25883.61912452381, -25766.206601240516, -25402.62826850981, -26133.496214266142, -25988.205624237813, -26164.960146155958, -25995.131633214467, -25997.76105141028, -26211.303688027547, -26130.569715325095, -26166.77771551865, -26124.980088315282, -26326.641023071872, -26229.0180414901, -26021.90177146444, -26298.08524163815, -26327.769936707533, -26378.832563956214, -26816.306355614426, -26411.93973379822, -26600.342962152245, -26489.029628151697, -26457.498594314922, -26465.058899350362, -26212.3996767567, -26085.255195754733, -26629.597425272714, -26324.251088606023, -26503.181616153397, -26802.068779382807, -26502.747205291456, -26734.620343608214, -26726.927579678162, -26273.409595240148, -26593.902898073866, -26589.855009944586, -26711.878608257164, -26626.634676641428, -26107.335201327758, -26546.941505438415, -26144.19564144267], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4151580635201455, "mean_inference_ms": 0.25154720559703814, "mean_action_processing_ms": 0.059607020377064425, "mean_env_wait_ms": 1.280408888586357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025843052153891708, "StateBufferConnector_ms": 0.0018939058831397523, "ViewRequirementAgentConnector_ms": 0.04601072757802111}}, "episode_reward_max": -25168.42411252718, "episode_reward_min": -26816.306355614426, "episode_reward_mean": -25937.0162022205, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186, -25552.536900572424, -25731.969822607745, -25611.775598758017, -25431.826462254012, -25389.16068845698, -25453.72926771981, -25621.1189127248, -25637.16425553349, -25823.780154535223, -25883.61912452381, -25766.206601240516, -25402.62826850981, -26133.496214266142, -25988.205624237813, -26164.960146155958, -25995.131633214467, -25997.76105141028, -26211.303688027547, -26130.569715325095, -26166.77771551865, -26124.980088315282, -26326.641023071872, -26229.0180414901, -26021.90177146444, -26298.08524163815, -26327.769936707533, -26378.832563956214, -26816.306355614426, -26411.93973379822, -26600.342962152245, -26489.029628151697, -26457.498594314922, -26465.058899350362, -26212.3996767567, -26085.255195754733, -26629.597425272714, -26324.251088606023, -26503.181616153397, -26802.068779382807, -26502.747205291456, -26734.620343608214, -26726.927579678162, -26273.409595240148, -26593.902898073866, -26589.855009944586, -26711.878608257164, -26626.634676641428, -26107.335201327758, -26546.941505438415, -26144.19564144267], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4151580635201455, "mean_inference_ms": 0.25154720559703814, "mean_action_processing_ms": 0.059607020377064425, "mean_env_wait_ms": 1.280408888586357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025843052153891708, "StateBufferConnector_ms": 0.0018939058831397523, "ViewRequirementAgentConnector_ms": 0.04601072757802111}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5133120, "num_agent_steps_trained": 5133120, "num_env_steps_sampled": 5133120, "num_env_steps_trained": 5133120, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 170.86067940690305, "num_env_steps_trained_throughput_per_sec": 170.86067940690305, "timesteps_total": 5133120, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5133120, "timers": {"training_iteration_time_ms": 2155.964, "sample_time_ms": 2150.976, "load_time_ms": 0.227, "load_throughput": 1586414.625, "learn_time_ms": 4.191, "learn_throughput": 85890.673, "synch_weights_time_ms": 0.536}, "counters": {"num_env_steps_sampled": 5133120, "num_env_steps_trained": 5133120, "num_agent_steps_sampled": 5133120, "num_agent_steps_trained": 5133120}, "done": false, "episodes_total": 1303, "training_iteration": 599, "trial_id": "326f4_00000", "date": "2023-07-25_15-35-01", "timestamp": 1690288501, "time_this_iter_s": 10.53691291809082, "time_total_s": 10380.157987117767, "pid": 66278, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.125, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fcd4310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 200.5264434814453, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 32.3, "ram_util_percent": 74.90666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.5e-06, "entropy_coeff": 0.125, "policy_entropy": -874.4567464192709, "policy_loss": -210915491008542.66, "vf_loss": 1271333589.3333333}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 296.0, "diff_num_grad_updates_vs_sampler_policy": 295.0}}, "num_env_steps_sampled": 5134920, "num_env_steps_trained": 5134920, "num_agent_steps_sampled": 5134920, "num_agent_steps_trained": 5134920}, "sampler_results": {"episode_reward_max": -25168.42411252718, "episode_reward_min": -26816.306355614426, "episode_reward_mean": -25965.606717674356, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186, -25552.536900572424, -25731.969822607745, -25611.775598758017, -25431.826462254012, -25389.16068845698, -25453.72926771981, -25621.1189127248, -25637.16425553349, -25823.780154535223, -25883.61912452381, -25766.206601240516, -25402.62826850981, -26133.496214266142, -25988.205624237813, -26164.960146155958, -25995.131633214467, -25997.76105141028, -26211.303688027547, -26130.569715325095, -26166.77771551865, -26124.980088315282, -26326.641023071872, -26229.0180414901, -26021.90177146444, -26298.08524163815, -26327.769936707533, -26378.832563956214, -26816.306355614426, -26411.93973379822, -26600.342962152245, -26489.029628151697, -26457.498594314922, -26465.058899350362, -26212.3996767567, -26085.255195754733, -26629.597425272714, -26324.251088606023, -26503.181616153397, -26802.068779382807, -26502.747205291456, -26734.620343608214, -26726.927579678162, -26273.409595240148, -26593.902898073866, -26589.855009944586, -26711.878608257164, -26626.634676641428, -26107.335201327758, -26546.941505438415, -26144.19564144267, -26555.632671739015, -26455.20953644668, -26490.868185836465, -26525.40721963752, -26488.424427373615], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416231698600336, "mean_inference_ms": 0.2517310729099737, "mean_action_processing_ms": 0.05963453625939817, "mean_env_wait_ms": 1.273472686114836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002577810576467803, "StateBufferConnector_ms": 0.0018904907534820865, "ViewRequirementAgentConnector_ms": 0.04609209118467389}}, "episode_reward_max": -25168.42411252718, "episode_reward_min": -26816.306355614426, "episode_reward_mean": -25965.606717674356, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25411.502796092413, -25445.72506221785, -25480.726216058833, -25383.11288163201, -25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186, -25552.536900572424, -25731.969822607745, -25611.775598758017, -25431.826462254012, -25389.16068845698, -25453.72926771981, -25621.1189127248, -25637.16425553349, -25823.780154535223, -25883.61912452381, -25766.206601240516, -25402.62826850981, -26133.496214266142, -25988.205624237813, -26164.960146155958, -25995.131633214467, -25997.76105141028, -26211.303688027547, -26130.569715325095, -26166.77771551865, -26124.980088315282, -26326.641023071872, -26229.0180414901, -26021.90177146444, -26298.08524163815, -26327.769936707533, -26378.832563956214, -26816.306355614426, -26411.93973379822, -26600.342962152245, -26489.029628151697, -26457.498594314922, -26465.058899350362, -26212.3996767567, -26085.255195754733, -26629.597425272714, -26324.251088606023, -26503.181616153397, -26802.068779382807, -26502.747205291456, -26734.620343608214, -26726.927579678162, -26273.409595240148, -26593.902898073866, -26589.855009944586, -26711.878608257164, -26626.634676641428, -26107.335201327758, -26546.941505438415, -26144.19564144267, -26555.632671739015, -26455.20953644668, -26490.868185836465, -26525.40721963752, -26488.424427373615], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416231698600336, "mean_inference_ms": 0.2517310729099737, "mean_action_processing_ms": 0.05963453625939817, "mean_env_wait_ms": 1.273472686114836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002577810576467803, "StateBufferConnector_ms": 0.0018904907534820865, "ViewRequirementAgentConnector_ms": 0.04609209118467389}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5134920, "num_agent_steps_trained": 5134920, "num_env_steps_sampled": 5134920, "num_env_steps_trained": 5134920, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 166.06437609812372, "num_env_steps_trained_throughput_per_sec": 166.06437609812372, "timesteps_total": 5134920, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5134920, "timers": {"training_iteration_time_ms": 2137.397, "sample_time_ms": 2132.579, "load_time_ms": 0.219, "load_throughput": 1645183.526, "learn_time_ms": 4.075, "learn_throughput": 88349.186, "synch_weights_time_ms": 0.49}, "counters": {"num_env_steps_sampled": 5134920, "num_env_steps_trained": 5134920, "num_agent_steps_sampled": 5134920, "num_agent_steps_trained": 5134920}, "done": false, "episodes_total": 1308, "training_iteration": 600, "trial_id": "326f4_00000", "date": "2023-07-25_15-35-12", "timestamp": 1690288512, "time_this_iter_s": 10.841487884521484, "time_total_s": 10390.999475002289, "pid": 66278, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.125, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fcd4310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 211.3679313659668, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 30.9, "ram_util_percent": 74.34666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.25e-06, "entropy_coeff": 0.125, "policy_entropy": -874.4503580729166, "policy_loss": -88790446946566.67, "vf_loss": 1281118677.3333333}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 311.0, "diff_num_grad_updates_vs_sampler_policy": 310.0}}, "num_env_steps_sampled": 5136720, "num_env_steps_trained": 5136720, "num_agent_steps_sampled": 5136720, "num_agent_steps_trained": 5136720}, "sampler_results": {"episode_reward_max": -25168.42411252718, "episode_reward_min": -26816.306355614426, "episode_reward_mean": -26013.591803565818, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186, -25552.536900572424, -25731.969822607745, -25611.775598758017, -25431.826462254012, -25389.16068845698, -25453.72926771981, -25621.1189127248, -25637.16425553349, -25823.780154535223, -25883.61912452381, -25766.206601240516, -25402.62826850981, -26133.496214266142, -25988.205624237813, -26164.960146155958, -25995.131633214467, -25997.76105141028, -26211.303688027547, -26130.569715325095, -26166.77771551865, -26124.980088315282, -26326.641023071872, -26229.0180414901, -26021.90177146444, -26298.08524163815, -26327.769936707533, -26378.832563956214, -26816.306355614426, -26411.93973379822, -26600.342962152245, -26489.029628151697, -26457.498594314922, -26465.058899350362, -26212.3996767567, -26085.255195754733, -26629.597425272714, -26324.251088606023, -26503.181616153397, -26802.068779382807, -26502.747205291456, -26734.620343608214, -26726.927579678162, -26273.409595240148, -26593.902898073866, -26589.855009944586, -26711.878608257164, -26626.634676641428, -26107.335201327758, -26546.941505438415, -26144.19564144267, -26555.632671739015, -26455.20953644668, -26490.868185836465, -26525.40721963752, -26488.424427373615, -26331.0762437334, -26548.57727801088, -26541.612575523417, -26484.402359605458, -26579.5138059483], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.41723182187276, "mean_inference_ms": 0.25194086960774476, "mean_action_processing_ms": 0.05965806128433518, "mean_env_wait_ms": 1.2248340682305676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00258636474609375, "StateBufferConnector_ms": 0.0018935203552246094, "ViewRequirementAgentConnector_ms": 0.04610490798950195}}, "episode_reward_max": -25168.42411252718, "episode_reward_min": -26816.306355614426, "episode_reward_mean": -26013.591803565818, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25483.830182363334, -25353.487437612243, -25427.515309836974, -25355.789205234683, -25529.62933861321, -25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186, -25552.536900572424, -25731.969822607745, -25611.775598758017, -25431.826462254012, -25389.16068845698, -25453.72926771981, -25621.1189127248, -25637.16425553349, -25823.780154535223, -25883.61912452381, -25766.206601240516, -25402.62826850981, -26133.496214266142, -25988.205624237813, -26164.960146155958, -25995.131633214467, -25997.76105141028, -26211.303688027547, -26130.569715325095, -26166.77771551865, -26124.980088315282, -26326.641023071872, -26229.0180414901, -26021.90177146444, -26298.08524163815, -26327.769936707533, -26378.832563956214, -26816.306355614426, -26411.93973379822, -26600.342962152245, -26489.029628151697, -26457.498594314922, -26465.058899350362, -26212.3996767567, -26085.255195754733, -26629.597425272714, -26324.251088606023, -26503.181616153397, -26802.068779382807, -26502.747205291456, -26734.620343608214, -26726.927579678162, -26273.409595240148, -26593.902898073866, -26589.855009944586, -26711.878608257164, -26626.634676641428, -26107.335201327758, -26546.941505438415, -26144.19564144267, -26555.632671739015, -26455.20953644668, -26490.868185836465, -26525.40721963752, -26488.424427373615, -26331.0762437334, -26548.57727801088, -26541.612575523417, -26484.402359605458, -26579.5138059483], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.41723182187276, "mean_inference_ms": 0.25194086960774476, "mean_action_processing_ms": 0.05965806128433518, "mean_env_wait_ms": 1.2248340682305676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00258636474609375, "StateBufferConnector_ms": 0.0018935203552246094, "ViewRequirementAgentConnector_ms": 0.04610490798950195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5136720, "num_agent_steps_trained": 5136720, "num_env_steps_sampled": 5136720, "num_env_steps_trained": 5136720, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 165.06703049970218, "num_env_steps_trained_throughput_per_sec": 165.06703049970218, "timesteps_total": 5136720, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5136720, "timers": {"training_iteration_time_ms": 2174.372, "sample_time_ms": 2169.378, "load_time_ms": 0.218, "load_throughput": 1651662.043, "learn_time_ms": 4.195, "learn_throughput": 85809.159, "synch_weights_time_ms": 0.545}, "counters": {"num_env_steps_sampled": 5136720, "num_env_steps_trained": 5136720, "num_agent_steps_sampled": 5136720, "num_agent_steps_trained": 5136720}, "done": false, "episodes_total": 1313, "training_iteration": 601, "trial_id": "326f4_00000", "date": "2023-07-25_15-35-23", "timestamp": 1690288523, "time_this_iter_s": 10.907003164291382, "time_total_s": 10401.90647816658, "pid": 66278, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.125, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fcd4310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 222.27493453025818, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 30.618750000000002, "ram_util_percent": 74.9625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6e-06, "entropy_coeff": 0.125, "policy_entropy": -874.4325154622396, "policy_loss": -109976976506924.0, "vf_loss": 1292213589.3333333}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 326.0, "diff_num_grad_updates_vs_sampler_policy": 325.0}}, "num_env_steps_sampled": 5138520, "num_env_steps_trained": 5138520, "num_agent_steps_sampled": 5138520, "num_agent_steps_trained": 5138520}, "sampler_results": {"episode_reward_max": -25168.42411252718, "episode_reward_min": -26816.306355614426, "episode_reward_mean": -26067.824811093637, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186, -25552.536900572424, -25731.969822607745, -25611.775598758017, -25431.826462254012, -25389.16068845698, -25453.72926771981, -25621.1189127248, -25637.16425553349, -25823.780154535223, -25883.61912452381, -25766.206601240516, -25402.62826850981, -26133.496214266142, -25988.205624237813, -26164.960146155958, -25995.131633214467, -25997.76105141028, -26211.303688027547, -26130.569715325095, -26166.77771551865, -26124.980088315282, -26326.641023071872, -26229.0180414901, -26021.90177146444, -26298.08524163815, -26327.769936707533, -26378.832563956214, -26816.306355614426, -26411.93973379822, -26600.342962152245, -26489.029628151697, -26457.498594314922, -26465.058899350362, -26212.3996767567, -26085.255195754733, -26629.597425272714, -26324.251088606023, -26503.181616153397, -26802.068779382807, -26502.747205291456, -26734.620343608214, -26726.927579678162, -26273.409595240148, -26593.902898073866, -26589.855009944586, -26711.878608257164, -26626.634676641428, -26107.335201327758, -26546.941505438415, -26144.19564144267, -26555.632671739015, -26455.20953644668, -26490.868185836465, -26525.40721963752, -26488.424427373615, -26331.0762437334, -26548.57727801088, -26541.612575523417, -26484.402359605458, -26579.5138059483, -26402.608818884146, -26454.029353592232, -26439.585656856412, -26499.018420953144, -26778.30997615671], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418464932643426, "mean_inference_ms": 0.25226356540340816, "mean_action_processing_ms": 0.059704311645742664, "mean_env_wait_ms": 1.2003768267734598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002598285675048828, "StateBufferConnector_ms": 0.0019016265869140625, "ViewRequirementAgentConnector_ms": 0.046479225158691406}}, "episode_reward_max": -25168.42411252718, "episode_reward_min": -26816.306355614426, "episode_reward_mean": -26067.824811093637, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25396.38341598536, -25406.96386224509, -25695.93337200107, -25374.413062284395, -25497.255276150452, -25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186, -25552.536900572424, -25731.969822607745, -25611.775598758017, -25431.826462254012, -25389.16068845698, -25453.72926771981, -25621.1189127248, -25637.16425553349, -25823.780154535223, -25883.61912452381, -25766.206601240516, -25402.62826850981, -26133.496214266142, -25988.205624237813, -26164.960146155958, -25995.131633214467, -25997.76105141028, -26211.303688027547, -26130.569715325095, -26166.77771551865, -26124.980088315282, -26326.641023071872, -26229.0180414901, -26021.90177146444, -26298.08524163815, -26327.769936707533, -26378.832563956214, -26816.306355614426, -26411.93973379822, -26600.342962152245, -26489.029628151697, -26457.498594314922, -26465.058899350362, -26212.3996767567, -26085.255195754733, -26629.597425272714, -26324.251088606023, -26503.181616153397, -26802.068779382807, -26502.747205291456, -26734.620343608214, -26726.927579678162, -26273.409595240148, -26593.902898073866, -26589.855009944586, -26711.878608257164, -26626.634676641428, -26107.335201327758, -26546.941505438415, -26144.19564144267, -26555.632671739015, -26455.20953644668, -26490.868185836465, -26525.40721963752, -26488.424427373615, -26331.0762437334, -26548.57727801088, -26541.612575523417, -26484.402359605458, -26579.5138059483, -26402.608818884146, -26454.029353592232, -26439.585656856412, -26499.018420953144, -26778.30997615671], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418464932643426, "mean_inference_ms": 0.25226356540340816, "mean_action_processing_ms": 0.059704311645742664, "mean_env_wait_ms": 1.2003768267734598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002598285675048828, "StateBufferConnector_ms": 0.0019016265869140625, "ViewRequirementAgentConnector_ms": 0.046479225158691406}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5138520, "num_agent_steps_trained": 5138520, "num_env_steps_sampled": 5138520, "num_env_steps_trained": 5138520, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 166.90695145409563, "num_env_steps_trained_throughput_per_sec": 166.90695145409563, "timesteps_total": 5138520, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5138520, "timers": {"training_iteration_time_ms": 2168.901, "sample_time_ms": 2163.889, "load_time_ms": 0.215, "load_throughput": 1676603.864, "learn_time_ms": 4.21, "learn_throughput": 85508.848, "synch_weights_time_ms": 0.551}, "counters": {"num_env_steps_sampled": 5138520, "num_env_steps_trained": 5138520, "num_agent_steps_sampled": 5138520, "num_agent_steps_trained": 5138520}, "done": false, "episodes_total": 1318, "training_iteration": 602, "trial_id": "326f4_00000", "date": "2023-07-25_15-35-34", "timestamp": 1690288534, "time_this_iter_s": 10.786602020263672, "time_total_s": 10412.693080186844, "pid": 66278, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.125, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fcd4310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 233.06153655052185, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 30.026666666666664, "ram_util_percent": 75.61999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.75e-06, "entropy_coeff": 0.125, "policy_entropy": -874.3960571289062, "policy_loss": -57814759812722.664, "vf_loss": 1261100138.6666667}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 341.0, "diff_num_grad_updates_vs_sampler_policy": 340.0}}, "num_env_steps_sampled": 5140320, "num_env_steps_trained": 5140320, "num_agent_steps_sampled": 5140320, "num_agent_steps_trained": 5140320}, "sampler_results": {"episode_reward_max": -25168.42411252718, "episode_reward_min": -26816.306355614426, "episode_reward_mean": -26112.78738034671, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186, -25552.536900572424, -25731.969822607745, -25611.775598758017, -25431.826462254012, -25389.16068845698, -25453.72926771981, -25621.1189127248, -25637.16425553349, -25823.780154535223, -25883.61912452381, -25766.206601240516, -25402.62826850981, -26133.496214266142, -25988.205624237813, -26164.960146155958, -25995.131633214467, -25997.76105141028, -26211.303688027547, -26130.569715325095, -26166.77771551865, -26124.980088315282, -26326.641023071872, -26229.0180414901, -26021.90177146444, -26298.08524163815, -26327.769936707533, -26378.832563956214, -26816.306355614426, -26411.93973379822, -26600.342962152245, -26489.029628151697, -26457.498594314922, -26465.058899350362, -26212.3996767567, -26085.255195754733, -26629.597425272714, -26324.251088606023, -26503.181616153397, -26802.068779382807, -26502.747205291456, -26734.620343608214, -26726.927579678162, -26273.409595240148, -26593.902898073866, -26589.855009944586, -26711.878608257164, -26626.634676641428, -26107.335201327758, -26546.941505438415, -26144.19564144267, -26555.632671739015, -26455.20953644668, -26490.868185836465, -26525.40721963752, -26488.424427373615, -26331.0762437334, -26548.57727801088, -26541.612575523417, -26484.402359605458, -26579.5138059483, -26402.608818884146, -26454.029353592232, -26439.585656856412, -26499.018420953144, -26778.30997615671, -26461.84184399491, -26177.231713227528, -26462.93858925304, -26387.512679577572, -26377.68108792096], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.420209837158813, "mean_inference_ms": 0.2525666796938662, "mean_action_processing_ms": 0.05974751506076118, "mean_env_wait_ms": 1.1861239685306668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002603292465209961, "StateBufferConnector_ms": 0.0019059181213378906, "ViewRequirementAgentConnector_ms": 0.04650425910949707}}, "episode_reward_max": -25168.42411252718, "episode_reward_min": -26816.306355614426, "episode_reward_mean": -26112.78738034671, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25168.42411252718, -25792.838951912123, -25481.895250396537, -25331.113848950452, -25519.62223327747, -25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186, -25552.536900572424, -25731.969822607745, -25611.775598758017, -25431.826462254012, -25389.16068845698, -25453.72926771981, -25621.1189127248, -25637.16425553349, -25823.780154535223, -25883.61912452381, -25766.206601240516, -25402.62826850981, -26133.496214266142, -25988.205624237813, -26164.960146155958, -25995.131633214467, -25997.76105141028, -26211.303688027547, -26130.569715325095, -26166.77771551865, -26124.980088315282, -26326.641023071872, -26229.0180414901, -26021.90177146444, -26298.08524163815, -26327.769936707533, -26378.832563956214, -26816.306355614426, -26411.93973379822, -26600.342962152245, -26489.029628151697, -26457.498594314922, -26465.058899350362, -26212.3996767567, -26085.255195754733, -26629.597425272714, -26324.251088606023, -26503.181616153397, -26802.068779382807, -26502.747205291456, -26734.620343608214, -26726.927579678162, -26273.409595240148, -26593.902898073866, -26589.855009944586, -26711.878608257164, -26626.634676641428, -26107.335201327758, -26546.941505438415, -26144.19564144267, -26555.632671739015, -26455.20953644668, -26490.868185836465, -26525.40721963752, -26488.424427373615, -26331.0762437334, -26548.57727801088, -26541.612575523417, -26484.402359605458, -26579.5138059483, -26402.608818884146, -26454.029353592232, -26439.585656856412, -26499.018420953144, -26778.30997615671, -26461.84184399491, -26177.231713227528, -26462.93858925304, -26387.512679577572, -26377.68108792096], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.420209837158813, "mean_inference_ms": 0.2525666796938662, "mean_action_processing_ms": 0.05974751506076118, "mean_env_wait_ms": 1.1861239685306668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002603292465209961, "StateBufferConnector_ms": 0.0019059181213378906, "ViewRequirementAgentConnector_ms": 0.04650425910949707}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5140320, "num_agent_steps_trained": 5140320, "num_env_steps_sampled": 5140320, "num_env_steps_trained": 5140320, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 167.58364329761403, "num_env_steps_trained_throughput_per_sec": 167.58364329761403, "timesteps_total": 5140320, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5140320, "timers": {"training_iteration_time_ms": 2152.524, "sample_time_ms": 2147.169, "load_time_ms": 0.244, "load_throughput": 1475136.225, "learn_time_ms": 4.508, "learn_throughput": 79853.902, "synch_weights_time_ms": 0.558}, "counters": {"num_env_steps_sampled": 5140320, "num_env_steps_trained": 5140320, "num_agent_steps_sampled": 5140320, "num_agent_steps_trained": 5140320}, "done": false, "episodes_total": 1323, "training_iteration": 603, "trial_id": "326f4_00000", "date": "2023-07-25_15-35-44", "timestamp": 1690288544, "time_this_iter_s": 10.743000984191895, "time_total_s": 10423.436081171036, "pid": 66278, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.125, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fcd4310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 243.80453753471375, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 28.506666666666668, "ram_util_percent": 79.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.5000000000000004e-06, "entropy_coeff": 0.125, "policy_entropy": -874.3624064127604, "policy_loss": -37761326951082.664, "vf_loss": 1235711701.3333333}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 356.0, "diff_num_grad_updates_vs_sampler_policy": 355.0}}, "num_env_steps_sampled": 5142120, "num_env_steps_trained": 5142120, "num_agent_steps_sampled": 5142120, "num_agent_steps_trained": 5142120}, "sampler_results": {"episode_reward_max": -25331.475044872364, "episode_reward_min": -26816.306355614426, "episode_reward_mean": -26153.011641716712, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186, -25552.536900572424, -25731.969822607745, -25611.775598758017, -25431.826462254012, -25389.16068845698, -25453.72926771981, -25621.1189127248, -25637.16425553349, -25823.780154535223, -25883.61912452381, -25766.206601240516, -25402.62826850981, -26133.496214266142, -25988.205624237813, -26164.960146155958, -25995.131633214467, -25997.76105141028, -26211.303688027547, -26130.569715325095, -26166.77771551865, -26124.980088315282, -26326.641023071872, -26229.0180414901, -26021.90177146444, -26298.08524163815, -26327.769936707533, -26378.832563956214, -26816.306355614426, -26411.93973379822, -26600.342962152245, -26489.029628151697, -26457.498594314922, -26465.058899350362, -26212.3996767567, -26085.255195754733, -26629.597425272714, -26324.251088606023, -26503.181616153397, -26802.068779382807, -26502.747205291456, -26734.620343608214, -26726.927579678162, -26273.409595240148, -26593.902898073866, -26589.855009944586, -26711.878608257164, -26626.634676641428, -26107.335201327758, -26546.941505438415, -26144.19564144267, -26555.632671739015, -26455.20953644668, -26490.868185836465, -26525.40721963752, -26488.424427373615, -26331.0762437334, -26548.57727801088, -26541.612575523417, -26484.402359605458, -26579.5138059483, -26402.608818884146, -26454.029353592232, -26439.585656856412, -26499.018420953144, -26778.30997615671, -26461.84184399491, -26177.231713227528, -26462.93858925304, -26387.512679577572, -26377.68108792096, -26002.94136312933, -26321.99476283372, -26208.55963159748, -26580.439167539098, -26202.385608963985], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.422024776359045, "mean_inference_ms": 0.25286911850080324, "mean_action_processing_ms": 0.05979011212211066, "mean_env_wait_ms": 1.176425276149075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002599954605102539, "StateBufferConnector_ms": 0.0019125938415527344, "ViewRequirementAgentConnector_ms": 0.04658699035644531}}, "episode_reward_max": -25331.475044872364, "episode_reward_min": -26816.306355614426, "episode_reward_mean": -26153.011641716712, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25513.712756903933, -25525.59273104077, -25447.93819458672, -25531.606203281717, -25331.475044872364, -25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186, -25552.536900572424, -25731.969822607745, -25611.775598758017, -25431.826462254012, -25389.16068845698, -25453.72926771981, -25621.1189127248, -25637.16425553349, -25823.780154535223, -25883.61912452381, -25766.206601240516, -25402.62826850981, -26133.496214266142, -25988.205624237813, -26164.960146155958, -25995.131633214467, -25997.76105141028, -26211.303688027547, -26130.569715325095, -26166.77771551865, -26124.980088315282, -26326.641023071872, -26229.0180414901, -26021.90177146444, -26298.08524163815, -26327.769936707533, -26378.832563956214, -26816.306355614426, -26411.93973379822, -26600.342962152245, -26489.029628151697, -26457.498594314922, -26465.058899350362, -26212.3996767567, -26085.255195754733, -26629.597425272714, -26324.251088606023, -26503.181616153397, -26802.068779382807, -26502.747205291456, -26734.620343608214, -26726.927579678162, -26273.409595240148, -26593.902898073866, -26589.855009944586, -26711.878608257164, -26626.634676641428, -26107.335201327758, -26546.941505438415, -26144.19564144267, -26555.632671739015, -26455.20953644668, -26490.868185836465, -26525.40721963752, -26488.424427373615, -26331.0762437334, -26548.57727801088, -26541.612575523417, -26484.402359605458, -26579.5138059483, -26402.608818884146, -26454.029353592232, -26439.585656856412, -26499.018420953144, -26778.30997615671, -26461.84184399491, -26177.231713227528, -26462.93858925304, -26387.512679577572, -26377.68108792096, -26002.94136312933, -26321.99476283372, -26208.55963159748, -26580.439167539098, -26202.385608963985], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.422024776359045, "mean_inference_ms": 0.25286911850080324, "mean_action_processing_ms": 0.05979011212211066, "mean_env_wait_ms": 1.176425276149075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002599954605102539, "StateBufferConnector_ms": 0.0019125938415527344, "ViewRequirementAgentConnector_ms": 0.04658699035644531}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5142120, "num_agent_steps_trained": 5142120, "num_env_steps_sampled": 5142120, "num_env_steps_trained": 5142120, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 173.22054271698522, "num_env_steps_trained_throughput_per_sec": 173.22054271698522, "timesteps_total": 5142120, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5142120, "timers": {"training_iteration_time_ms": 2113.216, "sample_time_ms": 2107.859, "load_time_ms": 0.245, "load_throughput": 1471542.189, "learn_time_ms": 4.505, "learn_throughput": 79905.457, "synch_weights_time_ms": 0.563}, "counters": {"num_env_steps_sampled": 5142120, "num_env_steps_trained": 5142120, "num_agent_steps_sampled": 5142120, "num_agent_steps_trained": 5142120}, "done": false, "episodes_total": 1328, "training_iteration": 604, "trial_id": "326f4_00000", "date": "2023-07-25_15-35-55", "timestamp": 1690288555, "time_this_iter_s": 10.39379096031189, "time_total_s": 10433.829872131348, "pid": 66278, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.125, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fcd4310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 254.19832849502563, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 24.866666666666667, "ram_util_percent": 76.88000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.3500000000000004e-06, "entropy_coeff": 0.125, "policy_entropy": -874.2898763020834, "policy_loss": -21696484251422.0, "vf_loss": 1265645653.3333333}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 371.0, "diff_num_grad_updates_vs_sampler_policy": 370.0}}, "num_env_steps_sampled": 5143920, "num_env_steps_trained": 5143920, "num_agent_steps_sampled": 5143920, "num_agent_steps_trained": 5143920}, "sampler_results": {"episode_reward_max": -25389.16068845698, "episode_reward_min": -26816.306355614426, "episode_reward_mean": -26200.72635707133, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186, -25552.536900572424, -25731.969822607745, -25611.775598758017, -25431.826462254012, -25389.16068845698, -25453.72926771981, -25621.1189127248, -25637.16425553349, -25823.780154535223, -25883.61912452381, -25766.206601240516, -25402.62826850981, -26133.496214266142, -25988.205624237813, -26164.960146155958, -25995.131633214467, -25997.76105141028, -26211.303688027547, -26130.569715325095, -26166.77771551865, -26124.980088315282, -26326.641023071872, -26229.0180414901, -26021.90177146444, -26298.08524163815, -26327.769936707533, -26378.832563956214, -26816.306355614426, -26411.93973379822, -26600.342962152245, -26489.029628151697, -26457.498594314922, -26465.058899350362, -26212.3996767567, -26085.255195754733, -26629.597425272714, -26324.251088606023, -26503.181616153397, -26802.068779382807, -26502.747205291456, -26734.620343608214, -26726.927579678162, -26273.409595240148, -26593.902898073866, -26589.855009944586, -26711.878608257164, -26626.634676641428, -26107.335201327758, -26546.941505438415, -26144.19564144267, -26555.632671739015, -26455.20953644668, -26490.868185836465, -26525.40721963752, -26488.424427373615, -26331.0762437334, -26548.57727801088, -26541.612575523417, -26484.402359605458, -26579.5138059483, -26402.608818884146, -26454.029353592232, -26439.585656856412, -26499.018420953144, -26778.30997615671, -26461.84184399491, -26177.231713227528, -26462.93858925304, -26387.512679577572, -26377.68108792096, -26002.94136312933, -26321.99476283372, -26208.55963159748, -26580.439167539098, -26202.385608963985, -26334.05745260546, -26443.805324637397, -26365.245170588754, -26519.38565130188, -26459.30286701407], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.423559463951433, "mean_inference_ms": 0.25318941640068926, "mean_action_processing_ms": 0.05983461647318981, "mean_env_wait_ms": 1.1692361437467544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026023387908935547, "StateBufferConnector_ms": 0.0019183158874511719, "ViewRequirementAgentConnector_ms": 0.046625375747680664}}, "episode_reward_max": -25389.16068845698, "episode_reward_min": -26816.306355614426, "episode_reward_mean": -26200.72635707133, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25740.519376872035, -25887.91531696561, -26094.236033125497, -26187.34400376406, -26044.56646677894, -26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186, -25552.536900572424, -25731.969822607745, -25611.775598758017, -25431.826462254012, -25389.16068845698, -25453.72926771981, -25621.1189127248, -25637.16425553349, -25823.780154535223, -25883.61912452381, -25766.206601240516, -25402.62826850981, -26133.496214266142, -25988.205624237813, -26164.960146155958, -25995.131633214467, -25997.76105141028, -26211.303688027547, -26130.569715325095, -26166.77771551865, -26124.980088315282, -26326.641023071872, -26229.0180414901, -26021.90177146444, -26298.08524163815, -26327.769936707533, -26378.832563956214, -26816.306355614426, -26411.93973379822, -26600.342962152245, -26489.029628151697, -26457.498594314922, -26465.058899350362, -26212.3996767567, -26085.255195754733, -26629.597425272714, -26324.251088606023, -26503.181616153397, -26802.068779382807, -26502.747205291456, -26734.620343608214, -26726.927579678162, -26273.409595240148, -26593.902898073866, -26589.855009944586, -26711.878608257164, -26626.634676641428, -26107.335201327758, -26546.941505438415, -26144.19564144267, -26555.632671739015, -26455.20953644668, -26490.868185836465, -26525.40721963752, -26488.424427373615, -26331.0762437334, -26548.57727801088, -26541.612575523417, -26484.402359605458, -26579.5138059483, -26402.608818884146, -26454.029353592232, -26439.585656856412, -26499.018420953144, -26778.30997615671, -26461.84184399491, -26177.231713227528, -26462.93858925304, -26387.512679577572, -26377.68108792096, -26002.94136312933, -26321.99476283372, -26208.55963159748, -26580.439167539098, -26202.385608963985, -26334.05745260546, -26443.805324637397, -26365.245170588754, -26519.38565130188, -26459.30286701407], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.423559463951433, "mean_inference_ms": 0.25318941640068926, "mean_action_processing_ms": 0.05983461647318981, "mean_env_wait_ms": 1.1692361437467544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026023387908935547, "StateBufferConnector_ms": 0.0019183158874511719, "ViewRequirementAgentConnector_ms": 0.046625375747680664}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5143920, "num_agent_steps_trained": 5143920, "num_env_steps_sampled": 5143920, "num_env_steps_trained": 5143920, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 172.6854920436441, "num_env_steps_trained_throughput_per_sec": 172.6854920436441, "timesteps_total": 5143920, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5143920, "timers": {"training_iteration_time_ms": 2081.485, "sample_time_ms": 2076.623, "load_time_ms": 0.216, "load_throughput": 1665324.187, "learn_time_ms": 4.113, "learn_throughput": 87519.095, "synch_weights_time_ms": 0.499}, "counters": {"num_env_steps_sampled": 5143920, "num_env_steps_trained": 5143920, "num_agent_steps_sampled": 5143920, "num_agent_steps_trained": 5143920}, "done": false, "episodes_total": 1333, "training_iteration": 605, "trial_id": "326f4_00000", "date": "2023-07-25_15-36-05", "timestamp": 1690288565, "time_this_iter_s": 10.425657033920288, "time_total_s": 10444.255529165268, "pid": 66278, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.125, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fcd4310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 264.6239855289459, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 26.106666666666666, "ram_util_percent": 76.58666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.6000000000000001e-06, "entropy_coeff": 0.125, "policy_entropy": -874.1308186848959, "policy_loss": -5067428077200.0, "vf_loss": 1274162090.6666667}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 386.0, "diff_num_grad_updates_vs_sampler_policy": 385.0}}, "num_env_steps_sampled": 5145720, "num_env_steps_trained": 5145720, "num_agent_steps_sampled": 5145720, "num_agent_steps_trained": 5145720}, "sampler_results": {"episode_reward_max": -25389.16068845698, "episode_reward_min": -27183.2623370924, "episode_reward_mean": -26232.767878041708, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186, -25552.536900572424, -25731.969822607745, -25611.775598758017, -25431.826462254012, -25389.16068845698, -25453.72926771981, -25621.1189127248, -25637.16425553349, -25823.780154535223, -25883.61912452381, -25766.206601240516, -25402.62826850981, -26133.496214266142, -25988.205624237813, -26164.960146155958, -25995.131633214467, -25997.76105141028, -26211.303688027547, -26130.569715325095, -26166.77771551865, -26124.980088315282, -26326.641023071872, -26229.0180414901, -26021.90177146444, -26298.08524163815, -26327.769936707533, -26378.832563956214, -26816.306355614426, -26411.93973379822, -26600.342962152245, -26489.029628151697, -26457.498594314922, -26465.058899350362, -26212.3996767567, -26085.255195754733, -26629.597425272714, -26324.251088606023, -26503.181616153397, -26802.068779382807, -26502.747205291456, -26734.620343608214, -26726.927579678162, -26273.409595240148, -26593.902898073866, -26589.855009944586, -26711.878608257164, -26626.634676641428, -26107.335201327758, -26546.941505438415, -26144.19564144267, -26555.632671739015, -26455.20953644668, -26490.868185836465, -26525.40721963752, -26488.424427373615, -26331.0762437334, -26548.57727801088, -26541.612575523417, -26484.402359605458, -26579.5138059483, -26402.608818884146, -26454.029353592232, -26439.585656856412, -26499.018420953144, -26778.30997615671, -26461.84184399491, -26177.231713227528, -26462.93858925304, -26387.512679577572, -26377.68108792096, -26002.94136312933, -26321.99476283372, -26208.55963159748, -26580.439167539098, -26202.385608963985, -26334.05745260546, -26443.805324637397, -26365.245170588754, -26519.38565130188, -26459.30286701407, -26656.203313417835, -26376.92190527272, -27183.2623370924, -26418.60998357826, -26523.735755183472], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.424869398864951, "mean_inference_ms": 0.2534857635586391, "mean_action_processing_ms": 0.05987603496634392, "mean_env_wait_ms": 1.1633706646242883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002599954605102539, "StateBufferConnector_ms": 0.0019121170043945312, "ViewRequirementAgentConnector_ms": 0.04672837257385254}}, "episode_reward_max": -25389.16068845698, "episode_reward_min": -27183.2623370924, "episode_reward_mean": -26232.767878041708, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-26225.583316426077, -26154.572938864283, -26121.699076255372, -26489.865240353585, -25753.49294452921, -25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186, -25552.536900572424, -25731.969822607745, -25611.775598758017, -25431.826462254012, -25389.16068845698, -25453.72926771981, -25621.1189127248, -25637.16425553349, -25823.780154535223, -25883.61912452381, -25766.206601240516, -25402.62826850981, -26133.496214266142, -25988.205624237813, -26164.960146155958, -25995.131633214467, -25997.76105141028, -26211.303688027547, -26130.569715325095, -26166.77771551865, -26124.980088315282, -26326.641023071872, -26229.0180414901, -26021.90177146444, -26298.08524163815, -26327.769936707533, -26378.832563956214, -26816.306355614426, -26411.93973379822, -26600.342962152245, -26489.029628151697, -26457.498594314922, -26465.058899350362, -26212.3996767567, -26085.255195754733, -26629.597425272714, -26324.251088606023, -26503.181616153397, -26802.068779382807, -26502.747205291456, -26734.620343608214, -26726.927579678162, -26273.409595240148, -26593.902898073866, -26589.855009944586, -26711.878608257164, -26626.634676641428, -26107.335201327758, -26546.941505438415, -26144.19564144267, -26555.632671739015, -26455.20953644668, -26490.868185836465, -26525.40721963752, -26488.424427373615, -26331.0762437334, -26548.57727801088, -26541.612575523417, -26484.402359605458, -26579.5138059483, -26402.608818884146, -26454.029353592232, -26439.585656856412, -26499.018420953144, -26778.30997615671, -26461.84184399491, -26177.231713227528, -26462.93858925304, -26387.512679577572, -26377.68108792096, -26002.94136312933, -26321.99476283372, -26208.55963159748, -26580.439167539098, -26202.385608963985, -26334.05745260546, -26443.805324637397, -26365.245170588754, -26519.38565130188, -26459.30286701407, -26656.203313417835, -26376.92190527272, -27183.2623370924, -26418.60998357826, -26523.735755183472], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.424869398864951, "mean_inference_ms": 0.2534857635586391, "mean_action_processing_ms": 0.05987603496634392, "mean_env_wait_ms": 1.1633706646242883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002599954605102539, "StateBufferConnector_ms": 0.0019121170043945312, "ViewRequirementAgentConnector_ms": 0.04672837257385254}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5145720, "num_agent_steps_trained": 5145720, "num_env_steps_sampled": 5145720, "num_env_steps_trained": 5145720, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 172.24903490539378, "num_env_steps_trained_throughput_per_sec": 172.24903490539378, "timesteps_total": 5145720, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5145720, "timers": {"training_iteration_time_ms": 2087.347, "sample_time_ms": 2082.496, "load_time_ms": 0.217, "load_throughput": 1660379.855, "learn_time_ms": 4.097, "learn_throughput": 87866.429, "synch_weights_time_ms": 0.503}, "counters": {"num_env_steps_sampled": 5145720, "num_env_steps_trained": 5145720, "num_agent_steps_sampled": 5145720, "num_agent_steps_trained": 5145720}, "done": false, "episodes_total": 1338, "training_iteration": 606, "trial_id": "326f4_00000", "date": "2023-07-25_15-36-16", "timestamp": 1690288576, "time_this_iter_s": 10.45206904411316, "time_total_s": 10454.707598209381, "pid": 66278, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.125, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fcd4310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 275.0760545730591, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 25.78666666666667, "ram_util_percent": 77.05999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.499999999999999e-07, "entropy_coeff": 0.125, "policy_entropy": -874.0981038411459, "policy_loss": -3550296531296.0, "vf_loss": 1244024725.3333333}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 401.0, "diff_num_grad_updates_vs_sampler_policy": 400.0}}, "num_env_steps_sampled": 5147520, "num_env_steps_trained": 5147520, "num_agent_steps_sampled": 5147520, "num_agent_steps_trained": 5147520}, "sampler_results": {"episode_reward_max": -25389.16068845698, "episode_reward_min": -27183.2623370924, "episode_reward_mean": -26251.593475154772, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186, -25552.536900572424, -25731.969822607745, -25611.775598758017, -25431.826462254012, -25389.16068845698, -25453.72926771981, -25621.1189127248, -25637.16425553349, -25823.780154535223, -25883.61912452381, -25766.206601240516, -25402.62826850981, -26133.496214266142, -25988.205624237813, -26164.960146155958, -25995.131633214467, -25997.76105141028, -26211.303688027547, -26130.569715325095, -26166.77771551865, -26124.980088315282, -26326.641023071872, -26229.0180414901, -26021.90177146444, -26298.08524163815, -26327.769936707533, -26378.832563956214, -26816.306355614426, -26411.93973379822, -26600.342962152245, -26489.029628151697, -26457.498594314922, -26465.058899350362, -26212.3996767567, -26085.255195754733, -26629.597425272714, -26324.251088606023, -26503.181616153397, -26802.068779382807, -26502.747205291456, -26734.620343608214, -26726.927579678162, -26273.409595240148, -26593.902898073866, -26589.855009944586, -26711.878608257164, -26626.634676641428, -26107.335201327758, -26546.941505438415, -26144.19564144267, -26555.632671739015, -26455.20953644668, -26490.868185836465, -26525.40721963752, -26488.424427373615, -26331.0762437334, -26548.57727801088, -26541.612575523417, -26484.402359605458, -26579.5138059483, -26402.608818884146, -26454.029353592232, -26439.585656856412, -26499.018420953144, -26778.30997615671, -26461.84184399491, -26177.231713227528, -26462.93858925304, -26387.512679577572, -26377.68108792096, -26002.94136312933, -26321.99476283372, -26208.55963159748, -26580.439167539098, -26202.385608963985, -26334.05745260546, -26443.805324637397, -26365.245170588754, -26519.38565130188, -26459.30286701407, -26656.203313417835, -26376.92190527272, -27183.2623370924, -26418.60998357826, -26523.735755183472, -26619.88655993102, -26303.547152662883, -26793.717354761004, -26661.500497757523, -26249.121662622136], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4259449152501125, "mean_inference_ms": 0.25378511102001866, "mean_action_processing_ms": 0.05991791477047327, "mean_env_wait_ms": 1.1582007045970253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025861263275146484, "StateBufferConnector_ms": 0.0019047260284423828, "ViewRequirementAgentConnector_ms": 0.046563148498535156}}, "episode_reward_max": -25389.16068845698, "episode_reward_min": -27183.2623370924, "episode_reward_mean": -26251.593475154772, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25777.32540379221, -25756.335904040498, -25767.93427733958, -25583.481905810815, -25831.545820986255, -25604.659334130713, -25803.53126101666, -25863.198337172824, -25698.479511966038, -25650.42105997186, -25552.536900572424, -25731.969822607745, -25611.775598758017, -25431.826462254012, -25389.16068845698, -25453.72926771981, -25621.1189127248, -25637.16425553349, -25823.780154535223, -25883.61912452381, -25766.206601240516, -25402.62826850981, -26133.496214266142, -25988.205624237813, -26164.960146155958, -25995.131633214467, -25997.76105141028, -26211.303688027547, -26130.569715325095, -26166.77771551865, -26124.980088315282, -26326.641023071872, -26229.0180414901, -26021.90177146444, -26298.08524163815, -26327.769936707533, -26378.832563956214, -26816.306355614426, -26411.93973379822, -26600.342962152245, -26489.029628151697, -26457.498594314922, -26465.058899350362, -26212.3996767567, -26085.255195754733, -26629.597425272714, -26324.251088606023, -26503.181616153397, -26802.068779382807, -26502.747205291456, -26734.620343608214, -26726.927579678162, -26273.409595240148, -26593.902898073866, -26589.855009944586, -26711.878608257164, -26626.634676641428, -26107.335201327758, -26546.941505438415, -26144.19564144267, -26555.632671739015, -26455.20953644668, -26490.868185836465, -26525.40721963752, -26488.424427373615, -26331.0762437334, -26548.57727801088, -26541.612575523417, -26484.402359605458, -26579.5138059483, -26402.608818884146, -26454.029353592232, -26439.585656856412, -26499.018420953144, -26778.30997615671, -26461.84184399491, -26177.231713227528, -26462.93858925304, -26387.512679577572, -26377.68108792096, -26002.94136312933, -26321.99476283372, -26208.55963159748, -26580.439167539098, -26202.385608963985, -26334.05745260546, -26443.805324637397, -26365.245170588754, -26519.38565130188, -26459.30286701407, -26656.203313417835, -26376.92190527272, -27183.2623370924, -26418.60998357826, -26523.735755183472, -26619.88655993102, -26303.547152662883, -26793.717354761004, -26661.500497757523, -26249.121662622136], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4259449152501125, "mean_inference_ms": 0.25378511102001866, "mean_action_processing_ms": 0.05991791477047327, "mean_env_wait_ms": 1.1582007045970253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025861263275146484, "StateBufferConnector_ms": 0.0019047260284423828, "ViewRequirementAgentConnector_ms": 0.046563148498535156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5147520, "num_agent_steps_trained": 5147520, "num_env_steps_sampled": 5147520, "num_env_steps_trained": 5147520, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 171.92545490778326, "num_env_steps_trained_throughput_per_sec": 171.92545490778326, "timesteps_total": 5147520, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5147520, "timers": {"training_iteration_time_ms": 2091.954, "sample_time_ms": 2087.046, "load_time_ms": 0.216, "load_throughput": 1666059.186, "learn_time_ms": 4.113, "learn_throughput": 87528.734, "synch_weights_time_ms": 0.545}, "counters": {"num_env_steps_sampled": 5147520, "num_env_steps_trained": 5147520, "num_agent_steps_sampled": 5147520, "num_agent_steps_trained": 5147520}, "done": false, "episodes_total": 1343, "training_iteration": 607, "trial_id": "326f4_00000", "date": "2023-07-25_15-36-26", "timestamp": 1690288586, "time_this_iter_s": 10.471782922744751, "time_total_s": 10465.179381132126, "pid": 66278, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.125, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fcd4310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 285.54783749580383, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 24.80666666666667, "ram_util_percent": 77.18666666666668}}
