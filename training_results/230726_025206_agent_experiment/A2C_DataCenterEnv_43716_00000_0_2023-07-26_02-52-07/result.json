{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.4930725097656, "policy_loss": -97850.2421875, "vf_loss": 5023042.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}}, "num_env_steps_sampled": 220920, "num_env_steps_trained": 220920, "num_agent_steps_sampled": 220920, "num_agent_steps_trained": 220920}, "sampler_results": {"episode_reward_max": -520.0303270281479, "episode_reward_min": -805.4141382884566, "episode_reward_mean": -698.9450085926832, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566], "episode_lengths": [120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.87673057809761, "mean_inference_ms": 0.41911806756439635, "mean_action_processing_ms": 0.1007460491148719, "mean_env_wait_ms": 10.350189710918226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003608067830403646, "StateBufferConnector_ms": 0.003131230672200521, "ViewRequirementAgentConnector_ms": 0.07213751475016277}}, "episode_reward_max": -520.0303270281479, "episode_reward_min": -805.4141382884566, "episode_reward_mean": -698.9450085926832, "episode_len_mean": 120.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566], "episode_lengths": [120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.87673057809761, "mean_inference_ms": 0.41911806756439635, "mean_action_processing_ms": 0.1007460491148719, "mean_env_wait_ms": 10.350189710918226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003608067830403646, "StateBufferConnector_ms": 0.003131230672200521, "ViewRequirementAgentConnector_ms": 0.07213751475016277}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220920, "num_agent_steps_trained": 220920, "num_env_steps_sampled": 220920, "num_env_steps_trained": 220920, "num_env_steps_sampled_this_iter": 360, "num_env_steps_trained_this_iter": 360, "num_env_steps_sampled_throughput_per_sec": 31.291771302462255, "num_env_steps_trained_throughput_per_sec": 31.291771302462255, "timesteps_total": 220920, "num_steps_trained_this_iter": 360, "agent_timesteps_total": 220920, "timers": {"training_iteration_time_ms": 3834.858, "sample_time_ms": 3825.921, "load_time_ms": 0.352, "load_throughput": 341154.415, "learn_time_ms": 7.799, "learn_throughput": 15386.765, "synch_weights_time_ms": 0.744}, "counters": {"num_env_steps_sampled": 220920, "num_env_steps_trained": 220920, "num_agent_steps_sampled": 220920, "num_agent_steps_trained": 220920}, "done": false, "episodes_total": 1841, "training_iteration": 461, "trial_id": "43716_00000", "date": "2023-07-26_02-52-25", "timestamp": 1690329145, "time_this_iter_s": 11.506914138793945, "time_total_s": 5632.832390069962, "pid": 92550, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-07], [256080, 5e-07], [258480, 2.5e-07], [260880, 2.5e-07], [263280, 2.5e-07], [265680, 2.5e-07], [268080, 1e-07], [270480, 1e-07], [272880, 1e-07], [275280, 5e-08], [277680, 5e-08], [280080, 5e-08], [282480, 5e-08], [284880, 5e-08], [287280, 1e-08], [289680, 1e-08], [292080, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ff3f700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11.506914138793945, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 35.741176470588236, "ram_util_percent": 80.46470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.4924621582031, "policy_loss": -127172.7890625, "vf_loss": 7132366.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}}, "num_env_steps_sampled": 221400, "num_env_steps_trained": 221400, "num_agent_steps_sampled": 221400, "num_agent_steps_trained": 221400}, "sampler_results": {"episode_reward_max": -520.0303270281479, "episode_reward_min": -930.3524242554817, "episode_reward_mean": -739.4158594071183, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817], "episode_lengths": [120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.039681687415687, "mean_inference_ms": 0.413618423330493, "mean_action_processing_ms": 0.09974805457748959, "mean_env_wait_ms": 7.844921752902268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038623809814453125, "StateBufferConnector_ms": 0.0029666083199637277, "ViewRequirementAgentConnector_ms": 0.0695739473615374}}, "episode_reward_max": -520.0303270281479, "episode_reward_min": -930.3524242554817, "episode_reward_mean": -739.4158594071183, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817], "episode_lengths": [120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.039681687415687, "mean_inference_ms": 0.413618423330493, "mean_action_processing_ms": 0.09974805457748959, "mean_env_wait_ms": 7.844921752902268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038623809814453125, "StateBufferConnector_ms": 0.0029666083199637277, "ViewRequirementAgentConnector_ms": 0.0695739473615374}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 221400, "num_agent_steps_trained": 221400, "num_env_steps_sampled": 221400, "num_env_steps_trained": 221400, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.617339130079, "num_env_steps_trained_throughput_per_sec": 40.617339130079, "timesteps_total": 221400, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 221400, "timers": {"training_iteration_time_ms": 3331.734, "sample_time_ms": 3325.741, "load_time_ms": 0.28, "load_throughput": 429293.939, "learn_time_ms": 4.95, "learn_throughput": 24242.03, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 221400, "num_env_steps_trained": 221400, "num_agent_steps_sampled": 221400, "num_agent_steps_trained": 221400}, "done": false, "episodes_total": 1845, "training_iteration": 462, "trial_id": "43716_00000", "date": "2023-07-26_02-52-37", "timestamp": 1690329157, "time_this_iter_s": 11.820067882537842, "time_total_s": 5644.652457952499, "pid": 92550, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-07], [256080, 5e-07], [258480, 2.5e-07], [260880, 2.5e-07], [263280, 2.5e-07], [265680, 2.5e-07], [268080, 1e-07], [270480, 1e-07], [272880, 1e-07], [275280, 5e-08], [277680, 5e-08], [280080, 5e-08], [282480, 5e-08], [284880, 5e-08], [287280, 1e-08], [289680, 1e-08], [292080, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ff3f700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 23.326982021331787, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 40.370588235294115, "ram_util_percent": 79.8294117647059}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.4889221191406, "policy_loss": -55417.609375, "vf_loss": 1466433.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}}, "num_env_steps_sampled": 221880, "num_env_steps_trained": 221880, "num_agent_steps_sampled": 221880, "num_agent_steps_trained": 221880}, "sampler_results": {"episode_reward_max": -496.4737262698354, "episode_reward_min": -930.3524242554817, "episode_reward_mean": -720.1494139618579, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.138428121465505, "mean_inference_ms": 0.4098687985863506, "mean_action_processing_ms": 0.09910601862483785, "mean_env_wait_ms": 6.727592276208876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004144148393110795, "StateBufferConnector_ms": 0.002947720614346591, "ViewRequirementAgentConnector_ms": 0.06949468092484908}}, "episode_reward_max": -496.4737262698354, "episode_reward_min": -930.3524242554817, "episode_reward_mean": -720.1494139618579, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.138428121465505, "mean_inference_ms": 0.4098687985863506, "mean_action_processing_ms": 0.09910601862483785, "mean_env_wait_ms": 6.727592276208876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004144148393110795, "StateBufferConnector_ms": 0.002947720614346591, "ViewRequirementAgentConnector_ms": 0.06949468092484908}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 221880, "num_agent_steps_trained": 221880, "num_env_steps_sampled": 221880, "num_env_steps_trained": 221880, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.26535866535867, "num_env_steps_trained_throughput_per_sec": 40.26535866535867, "timesteps_total": 221880, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 221880, "timers": {"training_iteration_time_ms": 2956.628, "sample_time_ms": 2952.202, "load_time_ms": 0.243, "load_throughput": 493302.44, "learn_time_ms": 3.254, "learn_throughput": 36876.784, "synch_weights_time_ms": 0.879}, "counters": {"num_env_steps_sampled": 221880, "num_env_steps_trained": 221880, "num_agent_steps_sampled": 221880, "num_agent_steps_trained": 221880}, "done": false, "episodes_total": 1849, "training_iteration": 463, "trial_id": "43716_00000", "date": "2023-07-26_02-52-49", "timestamp": 1690329169, "time_this_iter_s": 11.925001859664917, "time_total_s": 5656.577459812164, "pid": 92550, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-07], [256080, 5e-07], [258480, 2.5e-07], [260880, 2.5e-07], [263280, 2.5e-07], [265680, 2.5e-07], [268080, 1e-07], [270480, 1e-07], [272880, 1e-07], [275280, 5e-08], [277680, 5e-08], [280080, 5e-08], [282480, 5e-08], [284880, 5e-08], [287280, 1e-08], [289680, 1e-08], [292080, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ff3f700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 35.251983880996704, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 39.635294117647064, "ram_util_percent": 79.03529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.4999084472656, "policy_loss": -87358.46875, "vf_loss": 3308267.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}}, "num_env_steps_sampled": 222360, "num_env_steps_trained": 222360, "num_agent_steps_sampled": 222360, "num_agent_steps_trained": 222360}, "sampler_results": {"episode_reward_max": -496.4737262698354, "episode_reward_min": -930.3524242554817, "episode_reward_mean": -713.9876568492144, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.137379361563816, "mean_inference_ms": 0.4079668889212211, "mean_action_processing_ms": 0.0987405734725862, "mean_env_wait_ms": 6.059386183368612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039386749267578125, "StateBufferConnector_ms": 0.0029166539510091147, "ViewRequirementAgentConnector_ms": 0.06978988647460938}}, "episode_reward_max": -496.4737262698354, "episode_reward_min": -930.3524242554817, "episode_reward_mean": -713.9876568492144, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.137379361563816, "mean_inference_ms": 0.4079668889212211, "mean_action_processing_ms": 0.0987405734725862, "mean_env_wait_ms": 6.059386183368612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039386749267578125, "StateBufferConnector_ms": 0.0029166539510091147, "ViewRequirementAgentConnector_ms": 0.06978988647460938}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 222360, "num_agent_steps_trained": 222360, "num_env_steps_sampled": 222360, "num_env_steps_trained": 222360, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.7868399218131, "num_env_steps_trained_throughput_per_sec": 41.7868399218131, "timesteps_total": 222360, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 222360, "timers": {"training_iteration_time_ms": 2942.273, "sample_time_ms": 2937.83, "load_time_ms": 0.242, "load_throughput": 494903.127, "learn_time_ms": 3.284, "learn_throughput": 36541.585, "synch_weights_time_ms": 0.865}, "counters": {"num_env_steps_sampled": 222360, "num_env_steps_trained": 222360, "num_agent_steps_sampled": 222360, "num_agent_steps_trained": 222360}, "done": false, "episodes_total": 1853, "training_iteration": 464, "trial_id": "43716_00000", "date": "2023-07-26_02-53-00", "timestamp": 1690329180, "time_this_iter_s": 11.489336013793945, "time_total_s": 5668.066795825958, "pid": 92550, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-07], [256080, 5e-07], [258480, 2.5e-07], [260880, 2.5e-07], [263280, 2.5e-07], [265680, 2.5e-07], [268080, 1e-07], [270480, 1e-07], [272880, 1e-07], [275280, 5e-08], [277680, 5e-08], [280080, 5e-08], [282480, 5e-08], [284880, 5e-08], [287280, 1e-08], [289680, 1e-08], [292080, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ff3f700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 46.74131989479065, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 35.575, "ram_util_percent": 77.63125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.5022888183594, "policy_loss": -84845.4375, "vf_loss": 3373366.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19.0, "diff_num_grad_updates_vs_sampler_policy": 18.0}}, "num_env_steps_sampled": 222840, "num_env_steps_trained": 222840, "num_agent_steps_sampled": 222840, "num_agent_steps_trained": 222840}, "sampler_results": {"episode_reward_max": -496.4737262698354, "episode_reward_min": -930.3524242554817, "episode_reward_mean": -709.9143526431701, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.11996131618888, "mean_inference_ms": 0.4061723632138452, "mean_action_processing_ms": 0.09839094612195214, "mean_env_wait_ms": 5.599499789483949, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003795874746222245, "StateBufferConnector_ms": 0.002891138980263158, "ViewRequirementAgentConnector_ms": 0.06971108286004317}}, "episode_reward_max": -496.4737262698354, "episode_reward_min": -930.3524242554817, "episode_reward_mean": -709.9143526431701, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.11996131618888, "mean_inference_ms": 0.4061723632138452, "mean_action_processing_ms": 0.09839094612195214, "mean_env_wait_ms": 5.599499789483949, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003795874746222245, "StateBufferConnector_ms": 0.002891138980263158, "ViewRequirementAgentConnector_ms": 0.06971108286004317}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 222840, "num_agent_steps_trained": 222840, "num_env_steps_sampled": 222840, "num_env_steps_trained": 222840, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.86612320955505, "num_env_steps_trained_throughput_per_sec": 41.86612320955505, "timesteps_total": 222840, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 222840, "timers": {"training_iteration_time_ms": 2901.76, "sample_time_ms": 2897.29, "load_time_ms": 0.24, "load_throughput": 500364.33, "learn_time_ms": 3.306, "learn_throughput": 36297.036, "synch_weights_time_ms": 0.871}, "counters": {"num_env_steps_sampled": 222840, "num_env_steps_trained": 222840, "num_agent_steps_sampled": 222840, "num_agent_steps_trained": 222840}, "done": false, "episodes_total": 1857, "training_iteration": 465, "trial_id": "43716_00000", "date": "2023-07-26_02-53-12", "timestamp": 1690329192, "time_this_iter_s": 11.467556953430176, "time_total_s": 5679.534352779388, "pid": 92550, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-07], [256080, 5e-07], [258480, 2.5e-07], [260880, 2.5e-07], [263280, 2.5e-07], [265680, 2.5e-07], [268080, 1e-07], [270480, 1e-07], [272880, 1e-07], [275280, 5e-08], [277680, 5e-08], [280080, 5e-08], [282480, 5e-08], [284880, 5e-08], [287280, 1e-08], [289680, 1e-08], [292080, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ff3f700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 58.208876848220825, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 37.3, "ram_util_percent": 77.70625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.4820861816406, "policy_loss": -99990.5859375, "vf_loss": 4525472.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 223320, "num_env_steps_trained": 223320, "num_agent_steps_sampled": 223320, "num_agent_steps_trained": 223320}, "sampler_results": {"episode_reward_max": -496.4737262698354, "episode_reward_min": -930.3524242554817, "episode_reward_mean": -705.9777293045189, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.102716184224054, "mean_inference_ms": 0.40473368619079364, "mean_action_processing_ms": 0.09811043301275603, "mean_env_wait_ms": 5.261113440362507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036985977836277175, "StateBufferConnector_ms": 0.002902487049932065, "ViewRequirementAgentConnector_ms": 0.06940364837646484}}, "episode_reward_max": -496.4737262698354, "episode_reward_min": -930.3524242554817, "episode_reward_mean": -705.9777293045189, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.102716184224054, "mean_inference_ms": 0.40473368619079364, "mean_action_processing_ms": 0.09811043301275603, "mean_env_wait_ms": 5.261113440362507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036985977836277175, "StateBufferConnector_ms": 0.002902487049932065, "ViewRequirementAgentConnector_ms": 0.06940364837646484}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 223320, "num_agent_steps_trained": 223320, "num_env_steps_sampled": 223320, "num_env_steps_trained": 223320, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.625107429453834, "num_env_steps_trained_throughput_per_sec": 41.625107429453834, "timesteps_total": 223320, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 223320, "timers": {"training_iteration_time_ms": 2871.68, "sample_time_ms": 2867.882, "load_time_ms": 0.216, "load_throughput": 555966.508, "learn_time_ms": 2.84, "learn_throughput": 42251.476, "synch_weights_time_ms": 0.702}, "counters": {"num_env_steps_sampled": 223320, "num_env_steps_trained": 223320, "num_agent_steps_sampled": 223320, "num_agent_steps_trained": 223320}, "done": false, "episodes_total": 1861, "training_iteration": 466, "trial_id": "43716_00000", "date": "2023-07-26_02-53-24", "timestamp": 1690329204, "time_this_iter_s": 11.533921003341675, "time_total_s": 5691.06827378273, "pid": 92550, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-07], [256080, 5e-07], [258480, 2.5e-07], [260880, 2.5e-07], [263280, 2.5e-07], [265680, 2.5e-07], [268080, 1e-07], [270480, 1e-07], [272880, 1e-07], [275280, 5e-08], [277680, 5e-08], [280080, 5e-08], [282480, 5e-08], [284880, 5e-08], [287280, 1e-08], [289680, 1e-08], [292080, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ff3f700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 69.7427978515625, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 32.71764705882353, "ram_util_percent": 76.01176470588234}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.50738525390625, "policy_loss": -112895.4375, "vf_loss": 5975180.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}}, "num_env_steps_sampled": 223800, "num_env_steps_trained": 223800, "num_agent_steps_sampled": 223800, "num_agent_steps_trained": 223800}, "sampler_results": {"episode_reward_max": -496.4737262698354, "episode_reward_min": -962.2754446853266, "episode_reward_mean": -717.0218097380648, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.103049010963836, "mean_inference_ms": 0.4035691500830171, "mean_action_processing_ms": 0.09788139897763035, "mean_env_wait_ms": 5.000592580342662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003757300200285735, "StateBufferConnector_ms": 0.0028901629977756077, "ViewRequirementAgentConnector_ms": 0.06912196124041523}}, "episode_reward_max": -496.4737262698354, "episode_reward_min": -962.2754446853266, "episode_reward_mean": -717.0218097380648, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.103049010963836, "mean_inference_ms": 0.4035691500830171, "mean_action_processing_ms": 0.09788139897763035, "mean_env_wait_ms": 5.000592580342662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003757300200285735, "StateBufferConnector_ms": 0.0028901629977756077, "ViewRequirementAgentConnector_ms": 0.06912196124041523}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 223800, "num_agent_steps_trained": 223800, "num_env_steps_sampled": 223800, "num_env_steps_trained": 223800, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.351258510375395, "num_env_steps_trained_throughput_per_sec": 40.351258510375395, "timesteps_total": 223800, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 223800, "timers": {"training_iteration_time_ms": 2917.219, "sample_time_ms": 2913.455, "load_time_ms": 0.217, "load_throughput": 551761.105, "learn_time_ms": 2.81, "learn_throughput": 42701.345, "synch_weights_time_ms": 0.696}, "counters": {"num_env_steps_sampled": 223800, "num_env_steps_trained": 223800, "num_agent_steps_sampled": 223800, "num_agent_steps_trained": 223800}, "done": false, "episodes_total": 1865, "training_iteration": 467, "trial_id": "43716_00000", "date": "2023-07-26_02-53-35", "timestamp": 1690329215, "time_this_iter_s": 11.897895097732544, "time_total_s": 5702.966168880463, "pid": 92550, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-07], [256080, 5e-07], [258480, 2.5e-07], [260880, 2.5e-07], [263280, 2.5e-07], [265680, 2.5e-07], [268080, 1e-07], [270480, 1e-07], [272880, 1e-07], [275280, 5e-08], [277680, 5e-08], [280080, 5e-08], [282480, 5e-08], [284880, 5e-08], [287280, 1e-08], [289680, 1e-08], [292080, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ff3f700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 81.64069294929504, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 37.60588235294117, "ram_util_percent": 77.19999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.4808044433594, "policy_loss": -72853.734375, "vf_loss": 2245982.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}}, "num_env_steps_sampled": 224280, "num_env_steps_trained": 224280, "num_agent_steps_sampled": 224280, "num_agent_steps_trained": 224280}, "sampler_results": {"episode_reward_max": -456.85816482747293, "episode_reward_min": -962.2754446853266, "episode_reward_mean": -718.7303465304814, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.10914704755773, "mean_inference_ms": 0.4027420457504418, "mean_action_processing_ms": 0.09771081799839407, "mean_env_wait_ms": 4.794146655289938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038054681593371977, "StateBufferConnector_ms": 0.0028733284242691533, "ViewRequirementAgentConnector_ms": 0.06896372764341292}}, "episode_reward_max": -456.85816482747293, "episode_reward_min": -962.2754446853266, "episode_reward_mean": -718.7303465304814, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.10914704755773, "mean_inference_ms": 0.4027420457504418, "mean_action_processing_ms": 0.09771081799839407, "mean_env_wait_ms": 4.794146655289938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038054681593371977, "StateBufferConnector_ms": 0.0028733284242691533, "ViewRequirementAgentConnector_ms": 0.06896372764341292}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224280, "num_agent_steps_trained": 224280, "num_env_steps_sampled": 224280, "num_env_steps_trained": 224280, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.417118630838445, "num_env_steps_trained_throughput_per_sec": 40.417118630838445, "timesteps_total": 224280, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 224280, "timers": {"training_iteration_time_ms": 2956.098, "sample_time_ms": 2952.321, "load_time_ms": 0.219, "load_throughput": 547083.13, "learn_time_ms": 2.822, "learn_throughput": 42524.204, "synch_weights_time_ms": 0.695}, "counters": {"num_env_steps_sampled": 224280, "num_env_steps_trained": 224280, "num_agent_steps_sampled": 224280, "num_agent_steps_trained": 224280}, "done": false, "episodes_total": 1869, "training_iteration": 468, "trial_id": "43716_00000", "date": "2023-07-26_02-53-47", "timestamp": 1690329227, "time_this_iter_s": 11.8786301612854, "time_total_s": 5714.844799041748, "pid": 92550, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-07], [256080, 5e-07], [258480, 2.5e-07], [260880, 2.5e-07], [263280, 2.5e-07], [265680, 2.5e-07], [268080, 1e-07], [270480, 1e-07], [272880, 1e-07], [275280, 5e-08], [277680, 5e-08], [280080, 5e-08], [282480, 5e-08], [284880, 5e-08], [287280, 1e-08], [289680, 1e-08], [292080, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ff3f700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 93.51932311058044, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 37.6235294117647, "ram_util_percent": 78.12941176470589}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.4912414550781, "policy_loss": -108495.265625, "vf_loss": 5206848.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}}, "num_env_steps_sampled": 224760, "num_env_steps_trained": 224760, "num_agent_steps_sampled": 224760, "num_agent_steps_trained": 224760}, "sampler_results": {"episode_reward_max": -456.85816482747293, "episode_reward_min": -962.2754446853266, "episode_reward_mean": -723.081350843738, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.117779619440267, "mean_inference_ms": 0.4024706568266578, "mean_action_processing_ms": 0.09764545105910777, "mean_env_wait_ms": 4.625372973302807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037969861711774555, "StateBufferConnector_ms": 0.002895082746233259, "ViewRequirementAgentConnector_ms": 0.06978171212332589}}, "episode_reward_max": -456.85816482747293, "episode_reward_min": -962.2754446853266, "episode_reward_mean": -723.081350843738, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.117779619440267, "mean_inference_ms": 0.4024706568266578, "mean_action_processing_ms": 0.09764545105910777, "mean_env_wait_ms": 4.625372973302807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037969861711774555, "StateBufferConnector_ms": 0.002895082746233259, "ViewRequirementAgentConnector_ms": 0.06978171212332589}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224760, "num_agent_steps_trained": 224760, "num_env_steps_sampled": 224760, "num_env_steps_trained": 224760, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.43285354598192, "num_env_steps_trained_throughput_per_sec": 40.43285354598192, "timesteps_total": 224760, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 224760, "timers": {"training_iteration_time_ms": 2969.74, "sample_time_ms": 2965.808, "load_time_ms": 0.228, "load_throughput": 525766.719, "learn_time_ms": 2.923, "learn_throughput": 41051.537, "synch_weights_time_ms": 0.734}, "counters": {"num_env_steps_sampled": 224760, "num_env_steps_trained": 224760, "num_agent_steps_sampled": 224760, "num_agent_steps_trained": 224760}, "done": false, "episodes_total": 1873, "training_iteration": 469, "trial_id": "43716_00000", "date": "2023-07-26_02-53-59", "timestamp": 1690329239, "time_this_iter_s": 11.87403416633606, "time_total_s": 5726.718833208084, "pid": 92550, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-07], [256080, 5e-07], [258480, 2.5e-07], [260880, 2.5e-07], [263280, 2.5e-07], [265680, 2.5e-07], [268080, 1e-07], [270480, 1e-07], [272880, 1e-07], [275280, 5e-08], [277680, 5e-08], [280080, 5e-08], [282480, 5e-08], [284880, 5e-08], [287280, 1e-08], [289680, 1e-08], [292080, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ff3f700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 105.3933572769165, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 42.57647058823529, "ram_util_percent": 78.89411764705882}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.5004577636719, "policy_loss": -146721.671875, "vf_loss": 9627455.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}}, "num_env_steps_sampled": 225240, "num_env_steps_trained": 225240, "num_agent_steps_sampled": 225240, "num_agent_steps_trained": 225240}, "sampler_results": {"episode_reward_max": -456.85816482747293, "episode_reward_min": -962.2754446853266, "episode_reward_mean": -724.9439799120206, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.12954282495422, "mean_inference_ms": 0.4021370176505955, "mean_action_processing_ms": 0.09757476834671683, "mean_env_wait_ms": 4.483582737293876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037437830215845355, "StateBufferConnector_ms": 0.0028983140603089943, "ViewRequirementAgentConnector_ms": 0.0697031999245668}}, "episode_reward_max": -456.85816482747293, "episode_reward_min": -962.2754446853266, "episode_reward_mean": -724.9439799120206, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.12954282495422, "mean_inference_ms": 0.4021370176505955, "mean_action_processing_ms": 0.09757476834671683, "mean_env_wait_ms": 4.483582737293876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037437830215845355, "StateBufferConnector_ms": 0.0028983140603089943, "ViewRequirementAgentConnector_ms": 0.0697031999245668}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 225240, "num_agent_steps_trained": 225240, "num_env_steps_sampled": 225240, "num_env_steps_trained": 225240, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.31508253157533, "num_env_steps_trained_throughput_per_sec": 40.31508253157533, "timesteps_total": 225240, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 225240, "timers": {"training_iteration_time_ms": 2979.456, "sample_time_ms": 2975.438, "load_time_ms": 0.231, "load_throughput": 520331.314, "learn_time_ms": 2.995, "learn_throughput": 40069.14, "synch_weights_time_ms": 0.746}, "counters": {"num_env_steps_sampled": 225240, "num_env_steps_trained": 225240, "num_agent_steps_sampled": 225240, "num_agent_steps_trained": 225240}, "done": false, "episodes_total": 1877, "training_iteration": 470, "trial_id": "43716_00000", "date": "2023-07-26_02-54-11", "timestamp": 1690329251, "time_this_iter_s": 11.909539699554443, "time_total_s": 5738.628372907639, "pid": 92550, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-07], [256080, 5e-07], [258480, 2.5e-07], [260880, 2.5e-07], [263280, 2.5e-07], [265680, 2.5e-07], [268080, 1e-07], [270480, 1e-07], [272880, 1e-07], [275280, 5e-08], [277680, 5e-08], [280080, 5e-08], [282480, 5e-08], [284880, 5e-08], [287280, 1e-08], [289680, 1e-08], [292080, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ff3f700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 117.30289697647095, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 41.84705882352941, "ram_util_percent": 77.94117647058823}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.4762878417969, "policy_loss": -137620.546875, "vf_loss": 7374013.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}}, "num_env_steps_sampled": 225720, "num_env_steps_trained": 225720, "num_agent_steps_sampled": 225720, "num_agent_steps_trained": 225720}, "sampler_results": {"episode_reward_max": -456.85816482747293, "episode_reward_min": -962.2754446853266, "episode_reward_mean": -728.266434655605, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.1380491057137, "mean_inference_ms": 0.40317427581175685, "mean_action_processing_ms": 0.0976217991589567, "mean_env_wait_ms": 4.3642201924041215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003774776015170785, "StateBufferConnector_ms": 0.002913142359533975, "ViewRequirementAgentConnector_ms": 0.06965870080992233}}, "episode_reward_max": -456.85816482747293, "episode_reward_min": -962.2754446853266, "episode_reward_mean": -728.266434655605, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.1380491057137, "mean_inference_ms": 0.40317427581175685, "mean_action_processing_ms": 0.0976217991589567, "mean_env_wait_ms": 4.3642201924041215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003774776015170785, "StateBufferConnector_ms": 0.002913142359533975, "ViewRequirementAgentConnector_ms": 0.06965870080992233}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 225720, "num_agent_steps_trained": 225720, "num_env_steps_sampled": 225720, "num_env_steps_trained": 225720, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.588231060435234, "num_env_steps_trained_throughput_per_sec": 40.588231060435234, "timesteps_total": 225720, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 225720, "timers": {"training_iteration_time_ms": 2969.727, "sample_time_ms": 2965.753, "load_time_ms": 0.226, "load_throughput": 531934.559, "learn_time_ms": 2.946, "learn_throughput": 40730.625, "synch_weights_time_ms": 0.76}, "counters": {"num_env_steps_sampled": 225720, "num_env_steps_trained": 225720, "num_agent_steps_sampled": 225720, "num_agent_steps_trained": 225720}, "done": false, "episodes_total": 1881, "training_iteration": 471, "trial_id": "43716_00000", "date": "2023-07-26_02-54-23", "timestamp": 1690329263, "time_this_iter_s": 11.82863974571228, "time_total_s": 5750.457012653351, "pid": 92550, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-07], [256080, 5e-07], [258480, 2.5e-07], [260880, 2.5e-07], [263280, 2.5e-07], [265680, 2.5e-07], [268080, 1e-07], [270480, 1e-07], [272880, 1e-07], [275280, 5e-08], [277680, 5e-08], [280080, 5e-08], [282480, 5e-08], [284880, 5e-08], [287280, 1e-08], [289680, 1e-08], [292080, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ff3f700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 129.13153672218323, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 46.26875, "ram_util_percent": 78.4375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.4744567871094, "policy_loss": -106705.0859375, "vf_loss": 5035721.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}}, "num_env_steps_sampled": 226200, "num_env_steps_trained": 226200, "num_agent_steps_sampled": 226200, "num_agent_steps_trained": 226200}, "sampler_results": {"episode_reward_max": -456.85816482747293, "episode_reward_min": -1048.5803677484246, "episode_reward_mean": -742.7141961012114, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.141944432618935, "mean_inference_ms": 0.4038548114835746, "mean_action_processing_ms": 0.09763593378903329, "mean_env_wait_ms": 4.260698102784025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037375916825964097, "StateBufferConnector_ms": 0.002897546646442819, "ViewRequirementAgentConnector_ms": 0.06951575583599984}}, "episode_reward_max": -456.85816482747293, "episode_reward_min": -1048.5803677484246, "episode_reward_mean": -742.7141961012114, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.141944432618935, "mean_inference_ms": 0.4038548114835746, "mean_action_processing_ms": 0.09763593378903329, "mean_env_wait_ms": 4.260698102784025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037375916825964097, "StateBufferConnector_ms": 0.002897546646442819, "ViewRequirementAgentConnector_ms": 0.06951575583599984}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 226200, "num_agent_steps_trained": 226200, "num_env_steps_sampled": 226200, "num_env_steps_trained": 226200, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.794157022722594, "num_env_steps_trained_throughput_per_sec": 41.794157022722594, "timesteps_total": 226200, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 226200, "timers": {"training_iteration_time_ms": 2950.476, "sample_time_ms": 2946.427, "load_time_ms": 0.227, "load_throughput": 528139.014, "learn_time_ms": 3.012, "learn_throughput": 39838.568, "synch_weights_time_ms": 0.766}, "counters": {"num_env_steps_sampled": 226200, "num_env_steps_trained": 226200, "num_agent_steps_sampled": 226200, "num_agent_steps_trained": 226200}, "done": false, "episodes_total": 1885, "training_iteration": 472, "trial_id": "43716_00000", "date": "2023-07-26_02-54-35", "timestamp": 1690329275, "time_this_iter_s": 11.487424850463867, "time_total_s": 5761.944437503815, "pid": 92550, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-07], [256080, 5e-07], [258480, 2.5e-07], [260880, 2.5e-07], [263280, 2.5e-07], [265680, 2.5e-07], [268080, 1e-07], [270480, 1e-07], [272880, 1e-07], [275280, 5e-08], [277680, 5e-08], [280080, 5e-08], [282480, 5e-08], [284880, 5e-08], [287280, 1e-08], [289680, 1e-08], [292080, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ff3f700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 140.6189615726471, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 35.923529411764704, "ram_util_percent": 77.90588235294116}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.4714660644531, "policy_loss": -120609.09375, "vf_loss": 6898985.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}}, "num_env_steps_sampled": 226680, "num_env_steps_trained": 226680, "num_agent_steps_sampled": 226680, "num_agent_steps_trained": 226680}, "sampler_results": {"episode_reward_max": -456.85816482747293, "episode_reward_min": -1048.5803677484246, "episode_reward_mean": -747.5935250559254, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.148811279945495, "mean_inference_ms": 0.4043516395388198, "mean_action_processing_ms": 0.0976381638739446, "mean_env_wait_ms": 4.170459530259623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037730908861347274, "StateBufferConnector_ms": 0.0028872022441789216, "ViewRequirementAgentConnector_ms": 0.06931669571820427}}, "episode_reward_max": -456.85816482747293, "episode_reward_min": -1048.5803677484246, "episode_reward_mean": -747.5935250559254, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.148811279945495, "mean_inference_ms": 0.4043516395388198, "mean_action_processing_ms": 0.0976381638739446, "mean_env_wait_ms": 4.170459530259623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037730908861347274, "StateBufferConnector_ms": 0.0028872022441789216, "ViewRequirementAgentConnector_ms": 0.06931669571820427}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 226680, "num_agent_steps_trained": 226680, "num_env_steps_sampled": 226680, "num_env_steps_trained": 226680, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.98802384790811, "num_env_steps_trained_throughput_per_sec": 39.98802384790811, "timesteps_total": 226680, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 226680, "timers": {"training_iteration_time_ms": 2939.244, "sample_time_ms": 2935.232, "load_time_ms": 0.229, "load_throughput": 524233.392, "learn_time_ms": 2.983, "learn_throughput": 40228.308, "synch_weights_time_ms": 0.758}, "counters": {"num_env_steps_sampled": 226680, "num_env_steps_trained": 226680, "num_agent_steps_sampled": 226680, "num_agent_steps_trained": 226680}, "done": false, "episodes_total": 1889, "training_iteration": 473, "trial_id": "43716_00000", "date": "2023-07-26_02-54-47", "timestamp": 1690329287, "time_this_iter_s": 12.006115674972534, "time_total_s": 5773.950553178787, "pid": 92550, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-07], [256080, 5e-07], [258480, 2.5e-07], [260880, 2.5e-07], [263280, 2.5e-07], [265680, 2.5e-07], [268080, 1e-07], [270480, 1e-07], [272880, 1e-07], [275280, 5e-08], [277680, 5e-08], [280080, 5e-08], [282480, 5e-08], [284880, 5e-08], [287280, 1e-08], [289680, 1e-08], [292080, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ff3f700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 152.62507724761963, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 43.529411764705884, "ram_util_percent": 78.2235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.47442626953125, "policy_loss": -94467.703125, "vf_loss": 3858568.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 54.0}}, "num_env_steps_sampled": 227160, "num_env_steps_trained": 227160, "num_agent_steps_sampled": 227160, "num_agent_steps_trained": 227160}, "sampler_results": {"episode_reward_max": -456.85816482747293, "episode_reward_min": -1048.5803677484246, "episode_reward_mean": -744.6899420071996, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.154647141918513, "mean_inference_ms": 0.40463629213236324, "mean_action_processing_ms": 0.09762196212359266, "mean_env_wait_ms": 4.0910704487072005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037453391335227275, "StateBufferConnector_ms": 0.0028748945756392045, "ViewRequirementAgentConnector_ms": 0.06916913119229404}}, "episode_reward_max": -456.85816482747293, "episode_reward_min": -1048.5803677484246, "episode_reward_mean": -744.6899420071996, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.154647141918513, "mean_inference_ms": 0.40463629213236324, "mean_action_processing_ms": 0.09762196212359266, "mean_env_wait_ms": 4.0910704487072005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037453391335227275, "StateBufferConnector_ms": 0.0028748945756392045, "ViewRequirementAgentConnector_ms": 0.06916913119229404}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 227160, "num_agent_steps_trained": 227160, "num_env_steps_sampled": 227160, "num_env_steps_trained": 227160, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.89019749123739, "num_env_steps_trained_throughput_per_sec": 40.89019749123739, "timesteps_total": 227160, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 227160, "timers": {"training_iteration_time_ms": 2949.511, "sample_time_ms": 2945.632, "load_time_ms": 0.229, "load_throughput": 525108.482, "learn_time_ms": 2.89, "learn_throughput": 41519.198, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 227160, "num_env_steps_trained": 227160, "num_agent_steps_sampled": 227160, "num_agent_steps_trained": 227160}, "done": false, "episodes_total": 1893, "training_iteration": 474, "trial_id": "43716_00000", "date": "2023-07-26_02-54-58", "timestamp": 1690329298, "time_this_iter_s": 11.741346836090088, "time_total_s": 5785.691900014877, "pid": 92550, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-07], [256080, 5e-07], [258480, 2.5e-07], [260880, 2.5e-07], [263280, 2.5e-07], [265680, 2.5e-07], [268080, 1e-07], [270480, 1e-07], [272880, 1e-07], [275280, 5e-08], [277680, 5e-08], [280080, 5e-08], [282480, 5e-08], [284880, 5e-08], [287280, 1e-08], [289680, 1e-08], [292080, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ff3f700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 164.36642408370972, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 42.258823529411764, "ram_util_percent": 77.95882352941176}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.47943115234375, "policy_loss": -56475.15625, "vf_loss": 1438844.375}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 58.0}}, "num_env_steps_sampled": 227640, "num_env_steps_trained": 227640, "num_agent_steps_sampled": 227640, "num_agent_steps_trained": 227640}, "sampler_results": {"episode_reward_max": -456.85816482747293, "episode_reward_min": -1048.5803677484246, "episode_reward_mean": -745.1265018874528, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.157854758690913, "mean_inference_ms": 0.4047734932106125, "mean_action_processing_ms": 0.09759194371647294, "mean_env_wait_ms": 4.020120167919218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037108437489655056, "StateBufferConnector_ms": 0.002856173757779396, "ViewRequirementAgentConnector_ms": 0.06895590636689784}}, "episode_reward_max": -456.85816482747293, "episode_reward_min": -1048.5803677484246, "episode_reward_mean": -745.1265018874528, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.157854758690913, "mean_inference_ms": 0.4047734932106125, "mean_action_processing_ms": 0.09759194371647294, "mean_env_wait_ms": 4.020120167919218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037108437489655056, "StateBufferConnector_ms": 0.002856173757779396, "ViewRequirementAgentConnector_ms": 0.06895590636689784}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 227640, "num_agent_steps_trained": 227640, "num_env_steps_sampled": 227640, "num_env_steps_trained": 227640, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.738651043172965, "num_env_steps_trained_throughput_per_sec": 41.738651043172965, "timesteps_total": 227640, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 227640, "timers": {"training_iteration_time_ms": 2936.664, "sample_time_ms": 2932.749, "load_time_ms": 0.23, "load_throughput": 520654.267, "learn_time_ms": 2.921, "learn_throughput": 41076.329, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 227640, "num_env_steps_trained": 227640, "num_agent_steps_sampled": 227640, "num_agent_steps_trained": 227640}, "done": false, "episodes_total": 1897, "training_iteration": 475, "trial_id": "43716_00000", "date": "2023-07-26_02-55-10", "timestamp": 1690329310, "time_this_iter_s": 11.502709865570068, "time_total_s": 5797.194609880447, "pid": 92550, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-07], [256080, 5e-07], [258480, 2.5e-07], [260880, 2.5e-07], [263280, 2.5e-07], [265680, 2.5e-07], [268080, 1e-07], [270480, 1e-07], [272880, 1e-07], [275280, 5e-08], [277680, 5e-08], [280080, 5e-08], [282480, 5e-08], [284880, 5e-08], [287280, 1e-08], [289680, 1e-08], [292080, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ff3f700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 175.86913394927979, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 36.86875, "ram_util_percent": 77.70625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.4710693359375, "policy_loss": -97646.0546875, "vf_loss": 4267889.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 63.0, "diff_num_grad_updates_vs_sampler_policy": 62.0}}, "num_env_steps_sampled": 228120, "num_env_steps_trained": 228120, "num_agent_steps_sampled": 228120, "num_agent_steps_trained": 228120}, "sampler_results": {"episode_reward_max": -456.85816482747293, "episode_reward_min": -1048.5803677484246, "episode_reward_mean": -749.0453192301137, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.15850731032826, "mean_inference_ms": 0.4048037216561302, "mean_action_processing_ms": 0.09755363752620132, "mean_env_wait_ms": 3.956582386680658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037246280246310765, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.06888669634622241}}, "episode_reward_max": -456.85816482747293, "episode_reward_min": -1048.5803677484246, "episode_reward_mean": -749.0453192301137, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.15850731032826, "mean_inference_ms": 0.4048037216561302, "mean_action_processing_ms": 0.09755363752620132, "mean_env_wait_ms": 3.956582386680658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037246280246310765, "StateBufferConnector_ms": 0.002845128377278646, "ViewRequirementAgentConnector_ms": 0.06888669634622241}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228120, "num_agent_steps_trained": 228120, "num_env_steps_sampled": 228120, "num_env_steps_trained": 228120, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.89142191356088, "num_env_steps_trained_throughput_per_sec": 41.89142191356088, "timesteps_total": 228120, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 228120, "timers": {"training_iteration_time_ms": 2891.439, "sample_time_ms": 2887.603, "load_time_ms": 0.223, "load_throughput": 536985.469, "learn_time_ms": 2.856, "learn_throughput": 42014.114, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 228120, "num_env_steps_trained": 228120, "num_agent_steps_sampled": 228120, "num_agent_steps_trained": 228120}, "done": false, "episodes_total": 1901, "training_iteration": 476, "trial_id": "43716_00000", "date": "2023-07-26_02-55-21", "timestamp": 1690329321, "time_this_iter_s": 11.460686683654785, "time_total_s": 5808.655296564102, "pid": 92550, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-07], [256080, 5e-07], [258480, 2.5e-07], [260880, 2.5e-07], [263280, 2.5e-07], [265680, 2.5e-07], [268080, 1e-07], [270480, 1e-07], [272880, 1e-07], [275280, 5e-08], [277680, 5e-08], [280080, 5e-08], [282480, 5e-08], [284880, 5e-08], [287280, 1e-08], [289680, 1e-08], [292080, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ff3f700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 187.32982063293457, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 35.96875, "ram_util_percent": 78.875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.50152587890625, "policy_loss": -108692.984375, "vf_loss": 5675779.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 67.0, "diff_num_grad_updates_vs_sampler_policy": 66.0}}, "num_env_steps_sampled": 228600, "num_env_steps_trained": 228600, "num_agent_steps_sampled": 228600, "num_agent_steps_trained": 228600}, "sampler_results": {"episode_reward_max": -456.85816482747293, "episode_reward_min": -1166.4859477978969, "episode_reward_mean": -761.521236774448, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.158230748632675, "mean_inference_ms": 0.40478029943268323, "mean_action_processing_ms": 0.09751524809176922, "mean_env_wait_ms": 3.899192116734243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003741036600141383, "StateBufferConnector_ms": 0.0028553293712103543, "ViewRequirementAgentConnector_ms": 0.06883215548387214}}, "episode_reward_max": -456.85816482747293, "episode_reward_min": -1166.4859477978969, "episode_reward_mean": -761.521236774448, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.158230748632675, "mean_inference_ms": 0.40478029943268323, "mean_action_processing_ms": 0.09751524809176922, "mean_env_wait_ms": 3.899192116734243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003741036600141383, "StateBufferConnector_ms": 0.0028553293712103543, "ViewRequirementAgentConnector_ms": 0.06883215548387214}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228600, "num_agent_steps_trained": 228600, "num_env_steps_sampled": 228600, "num_env_steps_trained": 228600, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.47879207625255, "num_env_steps_trained_throughput_per_sec": 41.47879207625255, "timesteps_total": 228600, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 228600, "timers": {"training_iteration_time_ms": 2883.021, "sample_time_ms": 2879.201, "load_time_ms": 0.219, "load_throughput": 546845.372, "learn_time_ms": 2.835, "learn_throughput": 42323.6, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 228600, "num_env_steps_trained": 228600, "num_agent_steps_sampled": 228600, "num_agent_steps_trained": 228600}, "done": false, "episodes_total": 1905, "training_iteration": 477, "trial_id": "43716_00000", "date": "2023-07-26_02-55-33", "timestamp": 1690329333, "time_this_iter_s": 11.574923038482666, "time_total_s": 5820.230219602585, "pid": 92550, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-07], [256080, 5e-07], [258480, 2.5e-07], [260880, 2.5e-07], [263280, 2.5e-07], [265680, 2.5e-07], [268080, 1e-07], [270480, 1e-07], [272880, 1e-07], [275280, 5e-08], [277680, 5e-08], [280080, 5e-08], [282480, 5e-08], [284880, 5e-08], [287280, 1e-08], [289680, 1e-08], [292080, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ff3f700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 198.90474367141724, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 43.582352941176474, "ram_util_percent": 78.78235294117648}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.5010070800781, "policy_loss": -74642.421875, "vf_loss": 2653696.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 71.0, "diff_num_grad_updates_vs_sampler_policy": 70.0}}, "num_env_steps_sampled": 229080, "num_env_steps_trained": 229080, "num_agent_steps_sampled": 229080, "num_agent_steps_trained": 229080}, "sampler_results": {"episode_reward_max": -456.85816482747293, "episode_reward_min": -1166.4859477978969, "episode_reward_mean": -760.0307208781143, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.157533936655096, "mean_inference_ms": 0.4047305215414734, "mean_action_processing_ms": 0.09747568461720846, "mean_env_wait_ms": 3.846960930984888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003719665634800011, "StateBufferConnector_ms": 0.002858336542693662, "ViewRequirementAgentConnector_ms": 0.06882741417683347}}, "episode_reward_max": -456.85816482747293, "episode_reward_min": -1166.4859477978969, "episode_reward_mean": -760.0307208781143, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.157533936655096, "mean_inference_ms": 0.4047305215414734, "mean_action_processing_ms": 0.09747568461720846, "mean_env_wait_ms": 3.846960930984888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003719665634800011, "StateBufferConnector_ms": 0.002858336542693662, "ViewRequirementAgentConnector_ms": 0.06882741417683347}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 229080, "num_agent_steps_trained": 229080, "num_env_steps_sampled": 229080, "num_env_steps_trained": 229080, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.38797636423467, "num_env_steps_trained_throughput_per_sec": 41.38797636423467, "timesteps_total": 229080, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 229080, "timers": {"training_iteration_time_ms": 2888.131, "sample_time_ms": 2884.323, "load_time_ms": 0.219, "load_throughput": 546964.225, "learn_time_ms": 2.822, "learn_throughput": 42527.438, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 229080, "num_env_steps_trained": 229080, "num_agent_steps_sampled": 229080, "num_agent_steps_trained": 229080}, "done": false, "episodes_total": 1909, "training_iteration": 478, "trial_id": "43716_00000", "date": "2023-07-26_02-55-45", "timestamp": 1690329345, "time_this_iter_s": 11.60016393661499, "time_total_s": 5831.8303835392, "pid": 92550, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-07], [256080, 5e-07], [258480, 2.5e-07], [260880, 2.5e-07], [263280, 2.5e-07], [265680, 2.5e-07], [268080, 1e-07], [270480, 1e-07], [272880, 1e-07], [275280, 5e-08], [277680, 5e-08], [280080, 5e-08], [282480, 5e-08], [284880, 5e-08], [287280, 1e-08], [289680, 1e-08], [292080, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ff3f700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 210.50490760803223, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 42.525000000000006, "ram_util_percent": 77.7625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.4847106933594, "policy_loss": -93070.046875, "vf_loss": 3799762.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 75.0, "diff_num_grad_updates_vs_sampler_policy": 74.0}}, "num_env_steps_sampled": 229560, "num_env_steps_trained": 229560, "num_agent_steps_sampled": 229560, "num_agent_steps_trained": 229560}, "sampler_results": {"episode_reward_max": -456.85816482747293, "episode_reward_min": -1166.4859477978969, "episode_reward_mean": -755.0909088366187, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431, -532.3478334507668, -609.0449904036087, -817.6860614321791, -710.5580951137416], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.15841279736683, "mean_inference_ms": 0.4046283397384372, "mean_action_processing_ms": 0.097431374445877, "mean_env_wait_ms": 3.7995251812096353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036853154500325522, "StateBufferConnector_ms": 0.0028537114461263022, "ViewRequirementAgentConnector_ms": 0.06868775685628255}}, "episode_reward_max": -456.85816482747293, "episode_reward_min": -1166.4859477978969, "episode_reward_mean": -755.0909088366187, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431, -532.3478334507668, -609.0449904036087, -817.6860614321791, -710.5580951137416], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.15841279736683, "mean_inference_ms": 0.4046283397384372, "mean_action_processing_ms": 0.097431374445877, "mean_env_wait_ms": 3.7995251812096353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036853154500325522, "StateBufferConnector_ms": 0.0028537114461263022, "ViewRequirementAgentConnector_ms": 0.06868775685628255}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 229560, "num_agent_steps_trained": 229560, "num_env_steps_sampled": 229560, "num_env_steps_trained": 229560, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.11787238127963, "num_env_steps_trained_throughput_per_sec": 40.11787238127963, "timesteps_total": 229560, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 229560, "timers": {"training_iteration_time_ms": 2924.671, "sample_time_ms": 2920.883, "load_time_ms": 0.221, "load_throughput": 542016.455, "learn_time_ms": 2.791, "learn_throughput": 42991.311, "synch_weights_time_ms": 0.729}, "counters": {"num_env_steps_sampled": 229560, "num_env_steps_trained": 229560, "num_agent_steps_sampled": 229560, "num_agent_steps_trained": 229560}, "done": false, "episodes_total": 1913, "training_iteration": 479, "trial_id": "43716_00000", "date": "2023-07-26_02-55-57", "timestamp": 1690329357, "time_this_iter_s": 11.967689990997314, "time_total_s": 5843.798073530197, "pid": 92550, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-07], [256080, 5e-07], [258480, 2.5e-07], [260880, 2.5e-07], [263280, 2.5e-07], [265680, 2.5e-07], [268080, 1e-07], [270480, 1e-07], [272880, 1e-07], [275280, 5e-08], [277680, 5e-08], [280080, 5e-08], [282480, 5e-08], [284880, 5e-08], [287280, 1e-08], [289680, 1e-08], [292080, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ff3f700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 222.47259759902954, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 39.858823529411765, "ram_util_percent": 78.39411764705882}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.5225524902344, "policy_loss": -169152.375, "vf_loss": 11672814.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 79.0, "diff_num_grad_updates_vs_sampler_policy": 78.0}}, "num_env_steps_sampled": 230040, "num_env_steps_trained": 230040, "num_agent_steps_sampled": 230040, "num_agent_steps_trained": 230040}, "sampler_results": {"episode_reward_max": -456.85816482747293, "episode_reward_min": -1292.289403258053, "episode_reward_mean": -757.2819539867859, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431, -532.3478334507668, -609.0449904036087, -817.6860614321791, -710.5580951137416, -564.2620618948481, -677.467561036098, -659.4371760206793, -1292.289403258053], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.15815746812243, "mean_inference_ms": 0.4045684148441402, "mean_action_processing_ms": 0.09739589471592543, "mean_env_wait_ms": 3.75604735310638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036737586878523043, "StateBufferConnector_ms": 0.0028567978098422665, "ViewRequirementAgentConnector_ms": 0.06879703908026973}}, "episode_reward_max": -456.85816482747293, "episode_reward_min": -1292.289403258053, "episode_reward_mean": -757.2819539867859, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431, -532.3478334507668, -609.0449904036087, -817.6860614321791, -710.5580951137416, -564.2620618948481, -677.467561036098, -659.4371760206793, -1292.289403258053], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.15815746812243, "mean_inference_ms": 0.4045684148441402, "mean_action_processing_ms": 0.09739589471592543, "mean_env_wait_ms": 3.75604735310638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036737586878523043, "StateBufferConnector_ms": 0.0028567978098422665, "ViewRequirementAgentConnector_ms": 0.06879703908026973}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 230040, "num_agent_steps_trained": 230040, "num_env_steps_sampled": 230040, "num_env_steps_trained": 230040, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.69123622458002, "num_env_steps_trained_throughput_per_sec": 41.69123622458002, "timesteps_total": 230040, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 230040, "timers": {"training_iteration_time_ms": 2924.34, "sample_time_ms": 2920.514, "load_time_ms": 0.226, "load_throughput": 530980.568, "learn_time_ms": 2.827, "learn_throughput": 42445.667, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 230040, "num_env_steps_trained": 230040, "num_agent_steps_sampled": 230040, "num_agent_steps_trained": 230040}, "done": false, "episodes_total": 1917, "training_iteration": 480, "trial_id": "43716_00000", "date": "2023-07-26_02-56-08", "timestamp": 1690329368, "time_this_iter_s": 11.515990018844604, "time_total_s": 5855.314063549042, "pid": 92550, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-07], [256080, 5e-07], [258480, 2.5e-07], [260880, 2.5e-07], [263280, 2.5e-07], [265680, 2.5e-07], [268080, 1e-07], [270480, 1e-07], [272880, 1e-07], [275280, 5e-08], [277680, 5e-08], [280080, 5e-08], [282480, 5e-08], [284880, 5e-08], [287280, 1e-08], [289680, 1e-08], [292080, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ff3f700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 233.98858761787415, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 41.89411764705883, "ram_util_percent": 76.41764705882352}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.49298095703125, "policy_loss": -119810.234375, "vf_loss": 7318623.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 83.0, "diff_num_grad_updates_vs_sampler_policy": 82.0}}, "num_env_steps_sampled": 230520, "num_env_steps_trained": 230520, "num_agent_steps_sampled": 230520, "num_agent_steps_trained": 230520}, "sampler_results": {"episode_reward_max": -456.85816482747293, "episode_reward_min": -1292.289403258053, "episode_reward_mean": -761.3875712845871, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431, -532.3478334507668, -609.0449904036087, -817.6860614321791, -710.5580951137416, -564.2620618948481, -677.467561036098, -659.4371760206793, -1292.289403258053, -787.0195268508753, -1044.3546504926328, -619.4193143069897, -919.1005600141378], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.158265506475423, "mean_inference_ms": 0.4046279831995237, "mean_action_processing_ms": 0.09738218405793725, "mean_env_wait_ms": 3.716270530011348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037721840732068902, "StateBufferConnector_ms": 0.0028796942837267035, "ViewRequirementAgentConnector_ms": 0.06927381078880954}}, "episode_reward_max": -456.85816482747293, "episode_reward_min": -1292.289403258053, "episode_reward_mean": -761.3875712845871, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431, -532.3478334507668, -609.0449904036087, -817.6860614321791, -710.5580951137416, -564.2620618948481, -677.467561036098, -659.4371760206793, -1292.289403258053, -787.0195268508753, -1044.3546504926328, -619.4193143069897, -919.1005600141378], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.158265506475423, "mean_inference_ms": 0.4046279831995237, "mean_action_processing_ms": 0.09738218405793725, "mean_env_wait_ms": 3.716270530011348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037721840732068902, "StateBufferConnector_ms": 0.0028796942837267035, "ViewRequirementAgentConnector_ms": 0.06927381078880954}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 230520, "num_agent_steps_trained": 230520, "num_env_steps_sampled": 230520, "num_env_steps_trained": 230520, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.54383100357256, "num_env_steps_trained_throughput_per_sec": 40.54383100357256, "timesteps_total": 230520, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 230520, "timers": {"training_iteration_time_ms": 2933.955, "sample_time_ms": 2930.099, "load_time_ms": 0.228, "load_throughput": 525821.646, "learn_time_ms": 2.841, "learn_throughput": 42245.447, "synch_weights_time_ms": 0.74}, "counters": {"num_env_steps_sampled": 230520, "num_env_steps_trained": 230520, "num_agent_steps_sampled": 230520, "num_agent_steps_trained": 230520}, "done": false, "episodes_total": 1921, "training_iteration": 481, "trial_id": "43716_00000", "date": "2023-07-26_02-56-20", "timestamp": 1690329380, "time_this_iter_s": 11.841801881790161, "time_total_s": 5867.155865430832, "pid": 92550, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-07], [256080, 5e-07], [258480, 2.5e-07], [260880, 2.5e-07], [263280, 2.5e-07], [265680, 2.5e-07], [268080, 1e-07], [270480, 1e-07], [272880, 1e-07], [275280, 5e-08], [277680, 5e-08], [280080, 5e-08], [282480, 5e-08], [284880, 5e-08], [287280, 1e-08], [289680, 1e-08], [292080, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ff3f700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 245.8303894996643, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 44.900000000000006, "ram_util_percent": 77.47058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.51416015625, "policy_loss": -137215.578125, "vf_loss": 8086692.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 87.0, "diff_num_grad_updates_vs_sampler_policy": 86.0}}, "num_env_steps_sampled": 231000, "num_env_steps_trained": 231000, "num_agent_steps_sampled": 231000, "num_agent_steps_trained": 231000}, "sampler_results": {"episode_reward_max": -456.85816482747293, "episode_reward_min": -1294.077555734341, "episode_reward_mean": -769.0425205505483, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431, -532.3478334507668, -609.0449904036087, -817.6860614321791, -710.5580951137416, -564.2620618948481, -677.467561036098, -659.4371760206793, -1292.289403258053, -787.0195268508753, -1044.3546504926328, -619.4193143069897, -919.1005600141378, -795.6615784988876, -720.9095403415635, -1294.077555734341, -900.882196702175], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.159782961339925, "mean_inference_ms": 0.40473782326404834, "mean_action_processing_ms": 0.09737998298423799, "mean_env_wait_ms": 3.679748375762405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038379910348475665, "StateBufferConnector_ms": 0.002907884532007678, "ViewRequirementAgentConnector_ms": 0.0700125749083771}}, "episode_reward_max": -456.85816482747293, "episode_reward_min": -1294.077555734341, "episode_reward_mean": -769.0425205505483, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431, -532.3478334507668, -609.0449904036087, -817.6860614321791, -710.5580951137416, -564.2620618948481, -677.467561036098, -659.4371760206793, -1292.289403258053, -787.0195268508753, -1044.3546504926328, -619.4193143069897, -919.1005600141378, -795.6615784988876, -720.9095403415635, -1294.077555734341, -900.882196702175], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.159782961339925, "mean_inference_ms": 0.40473782326404834, "mean_action_processing_ms": 0.09737998298423799, "mean_env_wait_ms": 3.679748375762405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038379910348475665, "StateBufferConnector_ms": 0.002907884532007678, "ViewRequirementAgentConnector_ms": 0.0700125749083771}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 231000, "num_agent_steps_trained": 231000, "num_env_steps_sampled": 231000, "num_env_steps_trained": 231000, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.709643097698084, "num_env_steps_trained_throughput_per_sec": 39.709643097698084, "timesteps_total": 231000, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 231000, "timers": {"training_iteration_time_ms": 2963.664, "sample_time_ms": 2959.897, "load_time_ms": 0.223, "load_throughput": 537673.838, "learn_time_ms": 2.776, "learn_throughput": 43230.962, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 231000, "num_env_steps_trained": 231000, "num_agent_steps_sampled": 231000, "num_agent_steps_trained": 231000}, "done": false, "episodes_total": 1925, "training_iteration": 482, "trial_id": "43716_00000", "date": "2023-07-26_02-56-32", "timestamp": 1690329392, "time_this_iter_s": 12.090370893478394, "time_total_s": 5879.24623632431, "pid": 92550, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-07], [256080, 5e-07], [258480, 2.5e-07], [260880, 2.5e-07], [263280, 2.5e-07], [265680, 2.5e-07], [268080, 1e-07], [270480, 1e-07], [272880, 1e-07], [275280, 5e-08], [277680, 5e-08], [280080, 5e-08], [282480, 5e-08], [284880, 5e-08], [287280, 1e-08], [289680, 1e-08], [292080, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ff3f700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 257.9207603931427, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 43.0529411764706, "ram_util_percent": 78.09411764705884}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.4879150390625, "policy_loss": -100318.59375, "vf_loss": 4531732.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 91.0, "diff_num_grad_updates_vs_sampler_policy": 90.0}}, "num_env_steps_sampled": 231480, "num_env_steps_trained": 231480, "num_agent_steps_sampled": 231480, "num_agent_steps_trained": 231480}, "sampler_results": {"episode_reward_max": -456.85816482747293, "episode_reward_min": -1294.077555734341, "episode_reward_mean": -774.92479994277, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431, -532.3478334507668, -609.0449904036087, -817.6860614321791, -710.5580951137416, -564.2620618948481, -677.467561036098, -659.4371760206793, -1292.289403258053, -787.0195268508753, -1044.3546504926328, -619.4193143069897, -919.1005600141378, -795.6615784988876, -720.9095403415635, -1294.077555734341, -900.882196702175, -953.5901614086835, -991.8935238084913, -952.7209650332702, -713.2528566439281], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.161768010797708, "mean_inference_ms": 0.4047813356868893, "mean_action_processing_ms": 0.09736947338049934, "mean_env_wait_ms": 3.6460431376887534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003807361309344952, "StateBufferConnector_ms": 0.0028979647290575637, "ViewRequirementAgentConnector_ms": 0.06994153117085551}}, "episode_reward_max": -456.85816482747293, "episode_reward_min": -1294.077555734341, "episode_reward_mean": -774.92479994277, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431, -532.3478334507668, -609.0449904036087, -817.6860614321791, -710.5580951137416, -564.2620618948481, -677.467561036098, -659.4371760206793, -1292.289403258053, -787.0195268508753, -1044.3546504926328, -619.4193143069897, -919.1005600141378, -795.6615784988876, -720.9095403415635, -1294.077555734341, -900.882196702175, -953.5901614086835, -991.8935238084913, -952.7209650332702, -713.2528566439281], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.161768010797708, "mean_inference_ms": 0.4047813356868893, "mean_action_processing_ms": 0.09736947338049934, "mean_env_wait_ms": 3.6460431376887534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003807361309344952, "StateBufferConnector_ms": 0.0028979647290575637, "ViewRequirementAgentConnector_ms": 0.06994153117085551}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 231480, "num_agent_steps_trained": 231480, "num_env_steps_sampled": 231480, "num_env_steps_trained": 231480, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.37942176242783, "num_env_steps_trained_throughput_per_sec": 40.37942176242783, "timesteps_total": 231480, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 231480, "timers": {"training_iteration_time_ms": 3014.46, "sample_time_ms": 3010.723, "load_time_ms": 0.22, "load_throughput": 544479.1, "learn_time_ms": 2.77, "learn_throughput": 43316.535, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 231480, "num_env_steps_trained": 231480, "num_agent_steps_sampled": 231480, "num_agent_steps_trained": 231480}, "done": false, "episodes_total": 1929, "training_iteration": 483, "trial_id": "43716_00000", "date": "2023-07-26_02-56-44", "timestamp": 1690329404, "time_this_iter_s": 11.889846086502075, "time_total_s": 5891.136082410812, "pid": 92550, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-07], [256080, 5e-07], [258480, 2.5e-07], [260880, 2.5e-07], [263280, 2.5e-07], [265680, 2.5e-07], [268080, 1e-07], [270480, 1e-07], [272880, 1e-07], [275280, 5e-08], [277680, 5e-08], [280080, 5e-08], [282480, 5e-08], [284880, 5e-08], [287280, 1e-08], [289680, 1e-08], [292080, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ff3f700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 269.8106064796448, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 39.78823529411765, "ram_util_percent": 78.47058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.5259704589844, "policy_loss": -110333.1953125, "vf_loss": 5707673.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 95.0, "diff_num_grad_updates_vs_sampler_policy": 94.0}}, "num_env_steps_sampled": 231960, "num_env_steps_trained": 231960, "num_agent_steps_sampled": 231960, "num_agent_steps_trained": 231960}, "sampler_results": {"episode_reward_max": -456.85816482747293, "episode_reward_min": -1294.077555734341, "episode_reward_mean": -773.3237922870406, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431, -532.3478334507668, -609.0449904036087, -817.6860614321791, -710.5580951137416, -564.2620618948481, -677.467561036098, -659.4371760206793, -1292.289403258053, -787.0195268508753, -1044.3546504926328, -619.4193143069897, -919.1005600141378, -795.6615784988876, -720.9095403415635, -1294.077555734341, -900.882196702175, -953.5901614086835, -991.8935238084913, -952.7209650332702, -713.2528566439281, -587.8408389915523, -461.8375410105642, -987.375163416636, -910.5499290580284], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.16416874307168, "mean_inference_ms": 0.40486342470262987, "mean_action_processing_ms": 0.09736677536670071, "mean_env_wait_ms": 3.6150028796811893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003833268818102385, "StateBufferConnector_ms": 0.002913224069695724, "ViewRequirementAgentConnector_ms": 0.07061807732833059}}, "episode_reward_max": -456.85816482747293, "episode_reward_min": -1294.077555734341, "episode_reward_mean": -773.3237922870406, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431, -532.3478334507668, -609.0449904036087, -817.6860614321791, -710.5580951137416, -564.2620618948481, -677.467561036098, -659.4371760206793, -1292.289403258053, -787.0195268508753, -1044.3546504926328, -619.4193143069897, -919.1005600141378, -795.6615784988876, -720.9095403415635, -1294.077555734341, -900.882196702175, -953.5901614086835, -991.8935238084913, -952.7209650332702, -713.2528566439281, -587.8408389915523, -461.8375410105642, -987.375163416636, -910.5499290580284], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.16416874307168, "mean_inference_ms": 0.40486342470262987, "mean_action_processing_ms": 0.09736677536670071, "mean_env_wait_ms": 3.6150028796811893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003833268818102385, "StateBufferConnector_ms": 0.002913224069695724, "ViewRequirementAgentConnector_ms": 0.07061807732833059}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 231960, "num_agent_steps_trained": 231960, "num_env_steps_sampled": 231960, "num_env_steps_trained": 231960, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.0680896396432, "num_env_steps_trained_throughput_per_sec": 40.0680896396432, "timesteps_total": 231960, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 231960, "timers": {"training_iteration_time_ms": 2999.006, "sample_time_ms": 2995.224, "load_time_ms": 0.222, "load_throughput": 541724.766, "learn_time_ms": 2.821, "learn_throughput": 42537.502, "synch_weights_time_ms": 0.698}, "counters": {"num_env_steps_sampled": 231960, "num_env_steps_trained": 231960, "num_agent_steps_sampled": 231960, "num_agent_steps_trained": 231960}, "done": false, "episodes_total": 1933, "training_iteration": 484, "trial_id": "43716_00000", "date": "2023-07-26_02-56-56", "timestamp": 1690329416, "time_this_iter_s": 11.982232093811035, "time_total_s": 5903.118314504623, "pid": 92550, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-07], [256080, 5e-07], [258480, 2.5e-07], [260880, 2.5e-07], [263280, 2.5e-07], [265680, 2.5e-07], [268080, 1e-07], [270480, 1e-07], [272880, 1e-07], [275280, 5e-08], [277680, 5e-08], [280080, 5e-08], [282480, 5e-08], [284880, 5e-08], [287280, 1e-08], [289680, 1e-08], [292080, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ff3f700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 281.7928385734558, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 40.752941176470586, "ram_util_percent": 78.45882352941176}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.502197265625, "policy_loss": -103076.7421875, "vf_loss": 4864595.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 99.0, "diff_num_grad_updates_vs_sampler_policy": 98.0}}, "num_env_steps_sampled": 232440, "num_env_steps_trained": 232440, "num_agent_steps_sampled": 232440, "num_agent_steps_trained": 232440}, "sampler_results": {"episode_reward_max": -456.85816482747293, "episode_reward_min": -1294.077555734341, "episode_reward_mean": -774.9819111712077, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431, -532.3478334507668, -609.0449904036087, -817.6860614321791, -710.5580951137416, -564.2620618948481, -677.467561036098, -659.4371760206793, -1292.289403258053, -787.0195268508753, -1044.3546504926328, -619.4193143069897, -919.1005600141378, -795.6615784988876, -720.9095403415635, -1294.077555734341, -900.882196702175, -953.5901614086835, -991.8935238084913, -952.7209650332702, -713.2528566439281, -587.8408389915523, -461.8375410105642, -987.375163416636, -910.5499290580284, -783.7824339713214, -637.348411633323, -1096.8035139463145, -739.5145791297532], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.169285602771463, "mean_inference_ms": 0.4049297583473429, "mean_action_processing_ms": 0.09736281028948884, "mean_env_wait_ms": 3.586000785437973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038597318861219618, "StateBufferConnector_ms": 0.0029209888342655067, "ViewRequirementAgentConnector_ms": 0.07103500944195372}}, "episode_reward_max": -456.85816482747293, "episode_reward_min": -1294.077555734341, "episode_reward_mean": -774.9819111712077, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-520.0303270281479, -771.390560461445, -805.4141382884566, -727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431, -532.3478334507668, -609.0449904036087, -817.6860614321791, -710.5580951137416, -564.2620618948481, -677.467561036098, -659.4371760206793, -1292.289403258053, -787.0195268508753, -1044.3546504926328, -619.4193143069897, -919.1005600141378, -795.6615784988876, -720.9095403415635, -1294.077555734341, -900.882196702175, -953.5901614086835, -991.8935238084913, -952.7209650332702, -713.2528566439281, -587.8408389915523, -461.8375410105642, -987.375163416636, -910.5499290580284, -783.7824339713214, -637.348411633323, -1096.8035139463145, -739.5145791297532], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.169285602771463, "mean_inference_ms": 0.4049297583473429, "mean_action_processing_ms": 0.09736281028948884, "mean_env_wait_ms": 3.586000785437973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038597318861219618, "StateBufferConnector_ms": 0.0029209888342655067, "ViewRequirementAgentConnector_ms": 0.07103500944195372}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232440, "num_agent_steps_trained": 232440, "num_env_steps_sampled": 232440, "num_env_steps_trained": 232440, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.164506574887305, "num_env_steps_trained_throughput_per_sec": 38.164506574887305, "timesteps_total": 232440, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 232440, "timers": {"training_iteration_time_ms": 3044.275, "sample_time_ms": 3040.323, "load_time_ms": 0.229, "load_throughput": 524342.619, "learn_time_ms": 2.951, "learn_throughput": 40669.738, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 232440, "num_env_steps_trained": 232440, "num_agent_steps_sampled": 232440, "num_agent_steps_trained": 232440}, "done": false, "episodes_total": 1937, "training_iteration": 485, "trial_id": "43716_00000", "date": "2023-07-26_02-57-09", "timestamp": 1690329429, "time_this_iter_s": 12.580066919326782, "time_total_s": 5915.69838142395, "pid": 92550, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-07], [256080, 5e-07], [258480, 2.5e-07], [260880, 2.5e-07], [263280, 2.5e-07], [265680, 2.5e-07], [268080, 1e-07], [270480, 1e-07], [272880, 1e-07], [275280, 5e-08], [277680, 5e-08], [280080, 5e-08], [282480, 5e-08], [284880, 5e-08], [287280, 1e-08], [289680, 1e-08], [292080, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ff3f700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 294.3729054927826, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 44.827777777777776, "ram_util_percent": 77.63333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.4609375, "policy_loss": -125125.125, "vf_loss": 7529495.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 103.0, "diff_num_grad_updates_vs_sampler_policy": 102.0}}, "num_env_steps_sampled": 232920, "num_env_steps_trained": 232920, "num_agent_steps_sampled": 232920, "num_agent_steps_trained": 232920}, "sampler_results": {"episode_reward_max": -456.85816482747293, "episode_reward_min": -1294.077555734341, "episode_reward_mean": -772.4773227291876, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431, -532.3478334507668, -609.0449904036087, -817.6860614321791, -710.5580951137416, -564.2620618948481, -677.467561036098, -659.4371760206793, -1292.289403258053, -787.0195268508753, -1044.3546504926328, -619.4193143069897, -919.1005600141378, -795.6615784988876, -720.9095403415635, -1294.077555734341, -900.882196702175, -953.5901614086835, -991.8935238084913, -952.7209650332702, -713.2528566439281, -587.8408389915523, -461.8375410105642, -987.375163416636, -910.5499290580284, -783.7824339713214, -637.348411633323, -1096.8035139463145, -739.5145791297532, -572.7351284054748, -466.3105681813804, -575.966879709711, -1006.3455164506772], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.18208893116006, "mean_inference_ms": 0.40460079585952513, "mean_action_processing_ms": 0.09726373184687637, "mean_env_wait_ms": 3.3550531211381642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038557052612304688, "StateBufferConnector_ms": 0.002918720245361328, "ViewRequirementAgentConnector_ms": 0.07111811637878418}}, "episode_reward_max": -456.85816482747293, "episode_reward_min": -1294.077555734341, "episode_reward_mean": -772.4773227291876, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-727.0895985284826, -649.9911253076058, -771.6428419802094, -930.3524242554817, -699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431, -532.3478334507668, -609.0449904036087, -817.6860614321791, -710.5580951137416, -564.2620618948481, -677.467561036098, -659.4371760206793, -1292.289403258053, -787.0195268508753, -1044.3546504926328, -619.4193143069897, -919.1005600141378, -795.6615784988876, -720.9095403415635, -1294.077555734341, -900.882196702175, -953.5901614086835, -991.8935238084913, -952.7209650332702, -713.2528566439281, -587.8408389915523, -461.8375410105642, -987.375163416636, -910.5499290580284, -783.7824339713214, -637.348411633323, -1096.8035139463145, -739.5145791297532, -572.7351284054748, -466.3105681813804, -575.966879709711, -1006.3455164506772], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.18208893116006, "mean_inference_ms": 0.40460079585952513, "mean_action_processing_ms": 0.09726373184687637, "mean_env_wait_ms": 3.3550531211381642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038557052612304688, "StateBufferConnector_ms": 0.002918720245361328, "ViewRequirementAgentConnector_ms": 0.07111811637878418}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232920, "num_agent_steps_trained": 232920, "num_env_steps_sampled": 232920, "num_env_steps_trained": 232920, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.742992794551895, "num_env_steps_trained_throughput_per_sec": 41.742992794551895, "timesteps_total": 232920, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 232920, "timers": {"training_iteration_time_ms": 2999.858, "sample_time_ms": 2995.832, "load_time_ms": 0.233, "load_throughput": 516116.161, "learn_time_ms": 3.002, "learn_throughput": 39975.258, "synch_weights_time_ms": 0.744}, "counters": {"num_env_steps_sampled": 232920, "num_env_steps_trained": 232920, "num_agent_steps_sampled": 232920, "num_agent_steps_trained": 232920}, "done": false, "episodes_total": 1941, "training_iteration": 486, "trial_id": "43716_00000", "date": "2023-07-26_02-57-20", "timestamp": 1690329440, "time_this_iter_s": 11.50196099281311, "time_total_s": 5927.200342416763, "pid": 92550, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-07], [256080, 5e-07], [258480, 2.5e-07], [260880, 2.5e-07], [263280, 2.5e-07], [265680, 2.5e-07], [268080, 1e-07], [270480, 1e-07], [272880, 1e-07], [275280, 5e-08], [277680, 5e-08], [280080, 5e-08], [282480, 5e-08], [284880, 5e-08], [287280, 1e-08], [289680, 1e-08], [292080, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ff3f700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 305.8748664855957, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 42.28235294117648, "ram_util_percent": 76.58235294117648}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.50201416015625, "policy_loss": -132378.46875, "vf_loss": 7080617.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 107.0, "diff_num_grad_updates_vs_sampler_policy": 106.0}}, "num_env_steps_sampled": 233400, "num_env_steps_trained": 233400, "num_agent_steps_sampled": 233400, "num_agent_steps_trained": 233400}, "sampler_results": {"episode_reward_max": -456.85816482747293, "episode_reward_min": -1294.077555734341, "episode_reward_mean": -773.4848300014927, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431, -532.3478334507668, -609.0449904036087, -817.6860614321791, -710.5580951137416, -564.2620618948481, -677.467561036098, -659.4371760206793, -1292.289403258053, -787.0195268508753, -1044.3546504926328, -619.4193143069897, -919.1005600141378, -795.6615784988876, -720.9095403415635, -1294.077555734341, -900.882196702175, -953.5901614086835, -991.8935238084913, -952.7209650332702, -713.2528566439281, -587.8408389915523, -461.8375410105642, -987.375163416636, -910.5499290580284, -783.7824339713214, -637.348411633323, -1096.8035139463145, -739.5145791297532, -572.7351284054748, -466.3105681813804, -575.966879709711, -1006.3455164506772, -878.2843178862477, -748.5776277387235, -604.9134751649469, -948.051296512375], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.18572801218592, "mean_inference_ms": 0.4046425646771269, "mean_action_processing_ms": 0.0972305601269873, "mean_env_wait_ms": 3.2318312671404357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931283950805664, "StateBufferConnector_ms": 0.0029752254486083984, "ViewRequirementAgentConnector_ms": 0.07236194610595703}}, "episode_reward_max": -456.85816482747293, "episode_reward_min": -1294.077555734341, "episode_reward_mean": -773.4848300014927, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-699.2116449493985, -683.1734722033545, -866.8736943080206, -496.4737262698354, -851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431, -532.3478334507668, -609.0449904036087, -817.6860614321791, -710.5580951137416, -564.2620618948481, -677.467561036098, -659.4371760206793, -1292.289403258053, -787.0195268508753, -1044.3546504926328, -619.4193143069897, -919.1005600141378, -795.6615784988876, -720.9095403415635, -1294.077555734341, -900.882196702175, -953.5901614086835, -991.8935238084913, -952.7209650332702, -713.2528566439281, -587.8408389915523, -461.8375410105642, -987.375163416636, -910.5499290580284, -783.7824339713214, -637.348411633323, -1096.8035139463145, -739.5145791297532, -572.7351284054748, -466.3105681813804, -575.966879709711, -1006.3455164506772, -878.2843178862477, -748.5776277387235, -604.9134751649469, -948.051296512375], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.18572801218592, "mean_inference_ms": 0.4046425646771269, "mean_action_processing_ms": 0.0972305601269873, "mean_env_wait_ms": 3.2318312671404357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003931283950805664, "StateBufferConnector_ms": 0.0029752254486083984, "ViewRequirementAgentConnector_ms": 0.07236194610595703}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 233400, "num_agent_steps_trained": 233400, "num_env_steps_sampled": 233400, "num_env_steps_trained": 233400, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.00175836226108, "num_env_steps_trained_throughput_per_sec": 41.00175836226108, "timesteps_total": 233400, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 233400, "timers": {"training_iteration_time_ms": 2987.167, "sample_time_ms": 2983.366, "load_time_ms": 0.223, "load_throughput": 537214.729, "learn_time_ms": 2.815, "learn_throughput": 42636.234, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 233400, "num_env_steps_trained": 233400, "num_agent_steps_sampled": 233400, "num_agent_steps_trained": 233400}, "done": false, "episodes_total": 1945, "training_iteration": 487, "trial_id": "43716_00000", "date": "2023-07-26_02-57-32", "timestamp": 1690329452, "time_this_iter_s": 11.70953917503357, "time_total_s": 5938.909881591797, "pid": 92550, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-07], [256080, 5e-07], [258480, 2.5e-07], [260880, 2.5e-07], [263280, 2.5e-07], [265680, 2.5e-07], [268080, 1e-07], [270480, 1e-07], [272880, 1e-07], [275280, 5e-08], [277680, 5e-08], [280080, 5e-08], [282480, 5e-08], [284880, 5e-08], [287280, 1e-08], [289680, 1e-08], [292080, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ff3f700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 317.5844056606293, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 39.6125, "ram_util_percent": 77.95625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.5097351074219, "policy_loss": -134175.3125, "vf_loss": 8631088.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 111.0, "diff_num_grad_updates_vs_sampler_policy": 110.0}}, "num_env_steps_sampled": 233880, "num_env_steps_trained": 233880, "num_agent_steps_sampled": 233880, "num_agent_steps_trained": 233880}, "sampler_results": {"episode_reward_max": -347.47955333313513, "episode_reward_min": -1294.077555734341, "episode_reward_mean": -772.7241110585774, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431, -532.3478334507668, -609.0449904036087, -817.6860614321791, -710.5580951137416, -564.2620618948481, -677.467561036098, -659.4371760206793, -1292.289403258053, -787.0195268508753, -1044.3546504926328, -619.4193143069897, -919.1005600141378, -795.6615784988876, -720.9095403415635, -1294.077555734341, -900.882196702175, -953.5901614086835, -991.8935238084913, -952.7209650332702, -713.2528566439281, -587.8408389915523, -461.8375410105642, -987.375163416636, -910.5499290580284, -783.7824339713214, -637.348411633323, -1096.8035139463145, -739.5145791297532, -572.7351284054748, -466.3105681813804, -575.966879709711, -1006.3455164506772, -878.2843178862477, -748.5776277387235, -604.9134751649469, -948.051296512375, -347.47955333313513, -536.4595026041254, -759.9454435591781, -1025.7761439426608], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.183068696750748, "mean_inference_ms": 0.4049096545468566, "mean_action_processing_ms": 0.09723427325635937, "mean_env_wait_ms": 3.1559160181083676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003911018371582031, "StateBufferConnector_ms": 0.0029702186584472656, "ViewRequirementAgentConnector_ms": 0.07228946685791016}}, "episode_reward_max": -347.47955333313513, "episode_reward_min": -1294.077555734341, "episode_reward_mean": -772.7241110585774, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-851.5726096335544, -595.2368200296905, -539.560029617907, -801.8018398766276, -626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431, -532.3478334507668, -609.0449904036087, -817.6860614321791, -710.5580951137416, -564.2620618948481, -677.467561036098, -659.4371760206793, -1292.289403258053, -787.0195268508753, -1044.3546504926328, -619.4193143069897, -919.1005600141378, -795.6615784988876, -720.9095403415635, -1294.077555734341, -900.882196702175, -953.5901614086835, -991.8935238084913, -952.7209650332702, -713.2528566439281, -587.8408389915523, -461.8375410105642, -987.375163416636, -910.5499290580284, -783.7824339713214, -637.348411633323, -1096.8035139463145, -739.5145791297532, -572.7351284054748, -466.3105681813804, -575.966879709711, -1006.3455164506772, -878.2843178862477, -748.5776277387235, -604.9134751649469, -948.051296512375, -347.47955333313513, -536.4595026041254, -759.9454435591781, -1025.7761439426608], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.183068696750748, "mean_inference_ms": 0.4049096545468566, "mean_action_processing_ms": 0.09723427325635937, "mean_env_wait_ms": 3.1559160181083676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003911018371582031, "StateBufferConnector_ms": 0.0029702186584472656, "ViewRequirementAgentConnector_ms": 0.07228946685791016}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 233880, "num_agent_steps_trained": 233880, "num_env_steps_sampled": 233880, "num_env_steps_trained": 233880, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.35606135894789, "num_env_steps_trained_throughput_per_sec": 41.35606135894789, "timesteps_total": 233880, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 233880, "timers": {"training_iteration_time_ms": 2903.683, "sample_time_ms": 2899.717, "load_time_ms": 0.232, "load_throughput": 517070.557, "learn_time_ms": 2.949, "learn_throughput": 40689.465, "synch_weights_time_ms": 0.738}, "counters": {"num_env_steps_sampled": 233880, "num_env_steps_trained": 233880, "num_agent_steps_sampled": 233880, "num_agent_steps_trained": 233880}, "done": false, "episodes_total": 1949, "training_iteration": 488, "trial_id": "43716_00000", "date": "2023-07-26_02-57-44", "timestamp": 1690329464, "time_this_iter_s": 11.609175205230713, "time_total_s": 5950.519056797028, "pid": 92550, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-07], [256080, 5e-07], [258480, 2.5e-07], [260880, 2.5e-07], [263280, 2.5e-07], [265680, 2.5e-07], [268080, 1e-07], [270480, 1e-07], [272880, 1e-07], [275280, 5e-08], [277680, 5e-08], [280080, 5e-08], [282480, 5e-08], [284880, 5e-08], [287280, 1e-08], [289680, 1e-08], [292080, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ff3f700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 329.19358086586, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 40.85294117647059, "ram_util_percent": 78.7764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.5386047363281, "policy_loss": -84281.796875, "vf_loss": 3114671.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 115.0, "diff_num_grad_updates_vs_sampler_policy": 114.0}}, "num_env_steps_sampled": 234360, "num_env_steps_trained": 234360, "num_agent_steps_sampled": 234360, "num_agent_steps_trained": 234360}, "sampler_results": {"episode_reward_max": -347.47955333313513, "episode_reward_min": -1294.077555734341, "episode_reward_mean": -779.046301186729, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431, -532.3478334507668, -609.0449904036087, -817.6860614321791, -710.5580951137416, -564.2620618948481, -677.467561036098, -659.4371760206793, -1292.289403258053, -787.0195268508753, -1044.3546504926328, -619.4193143069897, -919.1005600141378, -795.6615784988876, -720.9095403415635, -1294.077555734341, -900.882196702175, -953.5901614086835, -991.8935238084913, -952.7209650332702, -713.2528566439281, -587.8408389915523, -461.8375410105642, -987.375163416636, -910.5499290580284, -783.7824339713214, -637.348411633323, -1096.8035139463145, -739.5145791297532, -572.7351284054748, -466.3105681813804, -575.966879709711, -1006.3455164506772, -878.2843178862477, -748.5776277387235, -604.9134751649469, -948.051296512375, -347.47955333313513, -536.4595026041254, -759.9454435591781, -1025.7761439426608, -1090.2314324178005, -701.0812849623192, -954.031761429931, -675.0458331628741], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.187608768555616, "mean_inference_ms": 0.4051673334170474, "mean_action_processing_ms": 0.09724289178741291, "mean_env_wait_ms": 3.101814080791371, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00389862060546875, "StateBufferConnector_ms": 0.002967357635498047, "ViewRequirementAgentConnector_ms": 0.0721278190612793}}, "episode_reward_max": -347.47955333313513, "episode_reward_min": -1294.077555734341, "episode_reward_mean": -779.046301186729, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-626.1436660330887, -771.7182256118682, -761.8883294809946, -618.8076263560629, -680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431, -532.3478334507668, -609.0449904036087, -817.6860614321791, -710.5580951137416, -564.2620618948481, -677.467561036098, -659.4371760206793, -1292.289403258053, -787.0195268508753, -1044.3546504926328, -619.4193143069897, -919.1005600141378, -795.6615784988876, -720.9095403415635, -1294.077555734341, -900.882196702175, -953.5901614086835, -991.8935238084913, -952.7209650332702, -713.2528566439281, -587.8408389915523, -461.8375410105642, -987.375163416636, -910.5499290580284, -783.7824339713214, -637.348411633323, -1096.8035139463145, -739.5145791297532, -572.7351284054748, -466.3105681813804, -575.966879709711, -1006.3455164506772, -878.2843178862477, -748.5776277387235, -604.9134751649469, -948.051296512375, -347.47955333313513, -536.4595026041254, -759.9454435591781, -1025.7761439426608, -1090.2314324178005, -701.0812849623192, -954.031761429931, -675.0458331628741], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.187608768555616, "mean_inference_ms": 0.4051673334170474, "mean_action_processing_ms": 0.09724289178741291, "mean_env_wait_ms": 3.101814080791371, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00389862060546875, "StateBufferConnector_ms": 0.002967357635498047, "ViewRequirementAgentConnector_ms": 0.0721278190612793}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 234360, "num_agent_steps_trained": 234360, "num_env_steps_sampled": 234360, "num_env_steps_trained": 234360, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.60624109107729, "num_env_steps_trained_throughput_per_sec": 40.60624109107729, "timesteps_total": 234360, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 234360, "timers": {"training_iteration_time_ms": 2912.987, "sample_time_ms": 2909.017, "load_time_ms": 0.245, "load_throughput": 488894.104, "learn_time_ms": 2.949, "learn_throughput": 40687.163, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 234360, "num_env_steps_trained": 234360, "num_agent_steps_sampled": 234360, "num_agent_steps_trained": 234360}, "done": false, "episodes_total": 1953, "training_iteration": 489, "trial_id": "43716_00000", "date": "2023-07-26_02-57-56", "timestamp": 1690329476, "time_this_iter_s": 11.82374882698059, "time_total_s": 5962.342805624008, "pid": 92550, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-07], [256080, 5e-07], [258480, 2.5e-07], [260880, 2.5e-07], [263280, 2.5e-07], [265680, 2.5e-07], [268080, 1e-07], [270480, 1e-07], [272880, 1e-07], [275280, 5e-08], [277680, 5e-08], [280080, 5e-08], [282480, 5e-08], [284880, 5e-08], [287280, 1e-08], [289680, 1e-08], [292080, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ff3f700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 341.0173296928406, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 41.400000000000006, "ram_util_percent": 78.88235294117646}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.47015380859375, "policy_loss": -97170.5859375, "vf_loss": 4439206.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 119.0, "diff_num_grad_updates_vs_sampler_policy": 118.0}}, "num_env_steps_sampled": 234840, "num_env_steps_trained": 234840, "num_agent_steps_sampled": 234840, "num_agent_steps_trained": 234840}, "sampler_results": {"episode_reward_max": -347.47955333313513, "episode_reward_min": -1294.077555734341, "episode_reward_mean": -782.5817064153853, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431, -532.3478334507668, -609.0449904036087, -817.6860614321791, -710.5580951137416, -564.2620618948481, -677.467561036098, -659.4371760206793, -1292.289403258053, -787.0195268508753, -1044.3546504926328, -619.4193143069897, -919.1005600141378, -795.6615784988876, -720.9095403415635, -1294.077555734341, -900.882196702175, -953.5901614086835, -991.8935238084913, -952.7209650332702, -713.2528566439281, -587.8408389915523, -461.8375410105642, -987.375163416636, -910.5499290580284, -783.7824339713214, -637.348411633323, -1096.8035139463145, -739.5145791297532, -572.7351284054748, -466.3105681813804, -575.966879709711, -1006.3455164506772, -878.2843178862477, -748.5776277387235, -604.9134751649469, -948.051296512375, -347.47955333313513, -536.4595026041254, -759.9454435591781, -1025.7761439426608, -1090.2314324178005, -701.0812849623192, -954.031761429931, -675.0458331628741, -889.3675354400169, -594.5434178147185, -920.8272267051653, -727.3601903877632], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.19539761404181, "mean_inference_ms": 0.40553167157970194, "mean_action_processing_ms": 0.09727413678256955, "mean_env_wait_ms": 3.0612687871713966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003896474838256836, "StateBufferConnector_ms": 0.002970457077026367, "ViewRequirementAgentConnector_ms": 0.07210874557495117}}, "episode_reward_max": -347.47955333313513, "episode_reward_min": -1294.077555734341, "episode_reward_mean": -782.5817064153853, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-680.8455702622139, -540.1714167656546, -820.6268850536179, -707.471201702216, -841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431, -532.3478334507668, -609.0449904036087, -817.6860614321791, -710.5580951137416, -564.2620618948481, -677.467561036098, -659.4371760206793, -1292.289403258053, -787.0195268508753, -1044.3546504926328, -619.4193143069897, -919.1005600141378, -795.6615784988876, -720.9095403415635, -1294.077555734341, -900.882196702175, -953.5901614086835, -991.8935238084913, -952.7209650332702, -713.2528566439281, -587.8408389915523, -461.8375410105642, -987.375163416636, -910.5499290580284, -783.7824339713214, -637.348411633323, -1096.8035139463145, -739.5145791297532, -572.7351284054748, -466.3105681813804, -575.966879709711, -1006.3455164506772, -878.2843178862477, -748.5776277387235, -604.9134751649469, -948.051296512375, -347.47955333313513, -536.4595026041254, -759.9454435591781, -1025.7761439426608, -1090.2314324178005, -701.0812849623192, -954.031761429931, -675.0458331628741, -889.3675354400169, -594.5434178147185, -920.8272267051653, -727.3601903877632], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.19539761404181, "mean_inference_ms": 0.40553167157970194, "mean_action_processing_ms": 0.09727413678256955, "mean_env_wait_ms": 3.0612687871713966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003896474838256836, "StateBufferConnector_ms": 0.002970457077026367, "ViewRequirementAgentConnector_ms": 0.07210874557495117}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 234840, "num_agent_steps_trained": 234840, "num_env_steps_sampled": 234840, "num_env_steps_trained": 234840, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.84467478817185, "num_env_steps_trained_throughput_per_sec": 40.84467478817185, "timesteps_total": 234840, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 234840, "timers": {"training_iteration_time_ms": 2938.039, "sample_time_ms": 2934.053, "load_time_ms": 0.245, "load_throughput": 490275.161, "learn_time_ms": 2.952, "learn_throughput": 40655.941, "synch_weights_time_ms": 0.74}, "counters": {"num_env_steps_sampled": 234840, "num_env_steps_trained": 234840, "num_agent_steps_sampled": 234840, "num_agent_steps_trained": 234840}, "done": false, "episodes_total": 1957, "training_iteration": 490, "trial_id": "43716_00000", "date": "2023-07-26_02-58-07", "timestamp": 1690329487, "time_this_iter_s": 11.754477739334106, "time_total_s": 5974.097283363342, "pid": 92550, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-07], [256080, 5e-07], [258480, 2.5e-07], [260880, 2.5e-07], [263280, 2.5e-07], [265680, 2.5e-07], [268080, 1e-07], [270480, 1e-07], [272880, 1e-07], [275280, 5e-08], [277680, 5e-08], [280080, 5e-08], [282480, 5e-08], [284880, 5e-08], [287280, 1e-08], [289680, 1e-08], [292080, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ff3f700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 352.7718074321747, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 46.45, "ram_util_percent": 78.4375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.4765319824219, "policy_loss": -85957.359375, "vf_loss": 3531607.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 123.0, "diff_num_grad_updates_vs_sampler_policy": 122.0}}, "num_env_steps_sampled": 235320, "num_env_steps_trained": 235320, "num_agent_steps_sampled": 235320, "num_agent_steps_trained": 235320}, "sampler_results": {"episode_reward_max": -347.47955333313513, "episode_reward_min": -1294.077555734341, "episode_reward_mean": -787.7525843288968, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431, -532.3478334507668, -609.0449904036087, -817.6860614321791, -710.5580951137416, -564.2620618948481, -677.467561036098, -659.4371760206793, -1292.289403258053, -787.0195268508753, -1044.3546504926328, -619.4193143069897, -919.1005600141378, -795.6615784988876, -720.9095403415635, -1294.077555734341, -900.882196702175, -953.5901614086835, -991.8935238084913, -952.7209650332702, -713.2528566439281, -587.8408389915523, -461.8375410105642, -987.375163416636, -910.5499290580284, -783.7824339713214, -637.348411633323, -1096.8035139463145, -739.5145791297532, -572.7351284054748, -466.3105681813804, -575.966879709711, -1006.3455164506772, -878.2843178862477, -748.5776277387235, -604.9134751649469, -948.051296512375, -347.47955333313513, -536.4595026041254, -759.9454435591781, -1025.7761439426608, -1090.2314324178005, -701.0812849623192, -954.031761429931, -675.0458331628741, -889.3675354400169, -594.5434178147185, -920.8272267051653, -727.3601903877632, -748.9257915637579, -700.9010136738068, -1138.2502201852055, -678.1258397120721], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.203717591760594, "mean_inference_ms": 0.4059251200617469, "mean_action_processing_ms": 0.09731246335434647, "mean_env_wait_ms": 3.0291418451238656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003896951675415039, "StateBufferConnector_ms": 0.002960205078125, "ViewRequirementAgentConnector_ms": 0.0720210075378418}}, "episode_reward_max": -347.47955333313513, "episode_reward_min": -1294.077555734341, "episode_reward_mean": -787.7525843288968, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-841.2584581964122, -819.4389285171345, -499.1282575249418, -962.2754446853266, -843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431, -532.3478334507668, -609.0449904036087, -817.6860614321791, -710.5580951137416, -564.2620618948481, -677.467561036098, -659.4371760206793, -1292.289403258053, -787.0195268508753, -1044.3546504926328, -619.4193143069897, -919.1005600141378, -795.6615784988876, -720.9095403415635, -1294.077555734341, -900.882196702175, -953.5901614086835, -991.8935238084913, -952.7209650332702, -713.2528566439281, -587.8408389915523, -461.8375410105642, -987.375163416636, -910.5499290580284, -783.7824339713214, -637.348411633323, -1096.8035139463145, -739.5145791297532, -572.7351284054748, -466.3105681813804, -575.966879709711, -1006.3455164506772, -878.2843178862477, -748.5776277387235, -604.9134751649469, -948.051296512375, -347.47955333313513, -536.4595026041254, -759.9454435591781, -1025.7761439426608, -1090.2314324178005, -701.0812849623192, -954.031761429931, -675.0458331628741, -889.3675354400169, -594.5434178147185, -920.8272267051653, -727.3601903877632, -748.9257915637579, -700.9010136738068, -1138.2502201852055, -678.1258397120721], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.203717591760594, "mean_inference_ms": 0.4059251200617469, "mean_action_processing_ms": 0.09731246335434647, "mean_env_wait_ms": 3.0291418451238656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003896951675415039, "StateBufferConnector_ms": 0.002960205078125, "ViewRequirementAgentConnector_ms": 0.0720210075378418}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 235320, "num_agent_steps_trained": 235320, "num_env_steps_sampled": 235320, "num_env_steps_trained": 235320, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 42.190584464641184, "num_env_steps_trained_throughput_per_sec": 42.190584464641184, "timesteps_total": 235320, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 235320, "timers": {"training_iteration_time_ms": 2902.719, "sample_time_ms": 2898.86, "load_time_ms": 0.237, "load_throughput": 507170.979, "learn_time_ms": 2.858, "learn_throughput": 41989.228, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 235320, "num_env_steps_trained": 235320, "num_agent_steps_sampled": 235320, "num_agent_steps_trained": 235320}, "done": false, "episodes_total": 1961, "training_iteration": 491, "trial_id": "43716_00000", "date": "2023-07-26_02-58-19", "timestamp": 1690329499, "time_this_iter_s": 11.37964677810669, "time_total_s": 5985.476930141449, "pid": 92550, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-07], [256080, 5e-07], [258480, 2.5e-07], [260880, 2.5e-07], [263280, 2.5e-07], [265680, 2.5e-07], [268080, 1e-07], [270480, 1e-07], [272880, 1e-07], [275280, 5e-08], [277680, 5e-08], [280080, 5e-08], [282480, 5e-08], [284880, 5e-08], [287280, 1e-08], [289680, 1e-08], [292080, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ff3f700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 364.1514542102814, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 34.50588235294118, "ram_util_percent": 78.38823529411764}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.484130859375, "policy_loss": -67204.484375, "vf_loss": 2094007.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 127.0, "diff_num_grad_updates_vs_sampler_policy": 126.0}}, "num_env_steps_sampled": 235800, "num_env_steps_trained": 235800, "num_agent_steps_sampled": 235800, "num_agent_steps_trained": 235800}, "sampler_results": {"episode_reward_max": -347.47955333313513, "episode_reward_min": -1294.077555734341, "episode_reward_mean": -780.1338884901344, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431, -532.3478334507668, -609.0449904036087, -817.6860614321791, -710.5580951137416, -564.2620618948481, -677.467561036098, -659.4371760206793, -1292.289403258053, -787.0195268508753, -1044.3546504926328, -619.4193143069897, -919.1005600141378, -795.6615784988876, -720.9095403415635, -1294.077555734341, -900.882196702175, -953.5901614086835, -991.8935238084913, -952.7209650332702, -713.2528566439281, -587.8408389915523, -461.8375410105642, -987.375163416636, -910.5499290580284, -783.7824339713214, -637.348411633323, -1096.8035139463145, -739.5145791297532, -572.7351284054748, -466.3105681813804, -575.966879709711, -1006.3455164506772, -878.2843178862477, -748.5776277387235, -604.9134751649469, -948.051296512375, -347.47955333313513, -536.4595026041254, -759.9454435591781, -1025.7761439426608, -1090.2314324178005, -701.0812849623192, -954.031761429931, -675.0458331628741, -889.3675354400169, -594.5434178147185, -920.8272267051653, -727.3601903877632, -748.9257915637579, -700.9010136738068, -1138.2502201852055, -678.1258397120721, -583.154120743679, -646.0660500797044, -689.151572986174, -441.85976123800583], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.208308251207246, "mean_inference_ms": 0.4063345439202554, "mean_action_processing_ms": 0.09735546719451608, "mean_env_wait_ms": 3.002728850181727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038843154907226562, "StateBufferConnector_ms": 0.0029571056365966797, "ViewRequirementAgentConnector_ms": 0.0720367431640625}}, "episode_reward_max": -347.47955333313513, "episode_reward_min": -1294.077555734341, "episode_reward_mean": -780.1338884901344, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-843.597722361415, -861.4117917617061, -759.1842005665765, -456.85816482747293, -701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431, -532.3478334507668, -609.0449904036087, -817.6860614321791, -710.5580951137416, -564.2620618948481, -677.467561036098, -659.4371760206793, -1292.289403258053, -787.0195268508753, -1044.3546504926328, -619.4193143069897, -919.1005600141378, -795.6615784988876, -720.9095403415635, -1294.077555734341, -900.882196702175, -953.5901614086835, -991.8935238084913, -952.7209650332702, -713.2528566439281, -587.8408389915523, -461.8375410105642, -987.375163416636, -910.5499290580284, -783.7824339713214, -637.348411633323, -1096.8035139463145, -739.5145791297532, -572.7351284054748, -466.3105681813804, -575.966879709711, -1006.3455164506772, -878.2843178862477, -748.5776277387235, -604.9134751649469, -948.051296512375, -347.47955333313513, -536.4595026041254, -759.9454435591781, -1025.7761439426608, -1090.2314324178005, -701.0812849623192, -954.031761429931, -675.0458331628741, -889.3675354400169, -594.5434178147185, -920.8272267051653, -727.3601903877632, -748.9257915637579, -700.9010136738068, -1138.2502201852055, -678.1258397120721, -583.154120743679, -646.0660500797044, -689.151572986174, -441.85976123800583], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.208308251207246, "mean_inference_ms": 0.4063345439202554, "mean_action_processing_ms": 0.09735546719451608, "mean_env_wait_ms": 3.002728850181727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038843154907226562, "StateBufferConnector_ms": 0.0029571056365966797, "ViewRequirementAgentConnector_ms": 0.0720367431640625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 235800, "num_agent_steps_trained": 235800, "num_env_steps_sampled": 235800, "num_env_steps_trained": 235800, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.52235453493124, "num_env_steps_trained_throughput_per_sec": 41.52235453493124, "timesteps_total": 235800, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 235800, "timers": {"training_iteration_time_ms": 2874.949, "sample_time_ms": 2871.182, "load_time_ms": 0.219, "load_throughput": 548753.249, "learn_time_ms": 2.802, "learn_throughput": 42831.435, "synch_weights_time_ms": 0.707}, "counters": {"num_env_steps_sampled": 235800, "num_env_steps_trained": 235800, "num_agent_steps_sampled": 235800, "num_agent_steps_trained": 235800}, "done": false, "episodes_total": 1965, "training_iteration": 492, "trial_id": "43716_00000", "date": "2023-07-26_02-58-31", "timestamp": 1690329511, "time_this_iter_s": 11.562737941741943, "time_total_s": 5997.039668083191, "pid": 92550, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-07], [256080, 5e-07], [258480, 2.5e-07], [260880, 2.5e-07], [263280, 2.5e-07], [265680, 2.5e-07], [268080, 1e-07], [270480, 1e-07], [272880, 1e-07], [275280, 5e-08], [277680, 5e-08], [280080, 5e-08], [282480, 5e-08], [284880, 5e-08], [287280, 1e-08], [289680, 1e-08], [292080, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ff3f700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 375.7141921520233, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 37.0375, "ram_util_percent": 77.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.5035400390625, "policy_loss": -88178.9453125, "vf_loss": 3588951.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 131.0, "diff_num_grad_updates_vs_sampler_policy": 130.0}}, "num_env_steps_sampled": 236280, "num_env_steps_trained": 236280, "num_agent_steps_sampled": 236280, "num_agent_steps_trained": 236280}, "sampler_results": {"episode_reward_max": -347.47955333313513, "episode_reward_min": -1294.077555734341, "episode_reward_mean": -779.6988026559416, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431, -532.3478334507668, -609.0449904036087, -817.6860614321791, -710.5580951137416, -564.2620618948481, -677.467561036098, -659.4371760206793, -1292.289403258053, -787.0195268508753, -1044.3546504926328, -619.4193143069897, -919.1005600141378, -795.6615784988876, -720.9095403415635, -1294.077555734341, -900.882196702175, -953.5901614086835, -991.8935238084913, -952.7209650332702, -713.2528566439281, -587.8408389915523, -461.8375410105642, -987.375163416636, -910.5499290580284, -783.7824339713214, -637.348411633323, -1096.8035139463145, -739.5145791297532, -572.7351284054748, -466.3105681813804, -575.966879709711, -1006.3455164506772, -878.2843178862477, -748.5776277387235, -604.9134751649469, -948.051296512375, -347.47955333313513, -536.4595026041254, -759.9454435591781, -1025.7761439426608, -1090.2314324178005, -701.0812849623192, -954.031761429931, -675.0458331628741, -889.3675354400169, -594.5434178147185, -920.8272267051653, -727.3601903877632, -748.9257915637579, -700.9010136738068, -1138.2502201852055, -678.1258397120721, -583.154120743679, -646.0660500797044, -689.151572986174, -441.85976123800583, -875.9263001696252, -586.2513889089473, -756.0339717448999, -659.3316352744132], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.21081310956343, "mean_inference_ms": 0.406711706253012, "mean_action_processing_ms": 0.09739582558624328, "mean_env_wait_ms": 2.980110060378686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038928985595703125, "StateBufferConnector_ms": 0.002959012985229492, "ViewRequirementAgentConnector_ms": 0.07203054428100586}}, "episode_reward_max": -347.47955333313513, "episode_reward_min": -1294.077555734341, "episode_reward_mean": -779.6988026559416, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-701.5604164200455, -589.304317177289, -930.432649786655, -805.9091537019208, -708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431, -532.3478334507668, -609.0449904036087, -817.6860614321791, -710.5580951137416, -564.2620618948481, -677.467561036098, -659.4371760206793, -1292.289403258053, -787.0195268508753, -1044.3546504926328, -619.4193143069897, -919.1005600141378, -795.6615784988876, -720.9095403415635, -1294.077555734341, -900.882196702175, -953.5901614086835, -991.8935238084913, -952.7209650332702, -713.2528566439281, -587.8408389915523, -461.8375410105642, -987.375163416636, -910.5499290580284, -783.7824339713214, -637.348411633323, -1096.8035139463145, -739.5145791297532, -572.7351284054748, -466.3105681813804, -575.966879709711, -1006.3455164506772, -878.2843178862477, -748.5776277387235, -604.9134751649469, -948.051296512375, -347.47955333313513, -536.4595026041254, -759.9454435591781, -1025.7761439426608, -1090.2314324178005, -701.0812849623192, -954.031761429931, -675.0458331628741, -889.3675354400169, -594.5434178147185, -920.8272267051653, -727.3601903877632, -748.9257915637579, -700.9010136738068, -1138.2502201852055, -678.1258397120721, -583.154120743679, -646.0660500797044, -689.151572986174, -441.85976123800583, -875.9263001696252, -586.2513889089473, -756.0339717448999, -659.3316352744132], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.21081310956343, "mean_inference_ms": 0.406711706253012, "mean_action_processing_ms": 0.09739582558624328, "mean_env_wait_ms": 2.980110060378686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038928985595703125, "StateBufferConnector_ms": 0.002959012985229492, "ViewRequirementAgentConnector_ms": 0.07203054428100586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236280, "num_agent_steps_trained": 236280, "num_env_steps_sampled": 236280, "num_env_steps_trained": 236280, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.37804435539189, "num_env_steps_trained_throughput_per_sec": 41.37804435539189, "timesteps_total": 236280, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 236280, "timers": {"training_iteration_time_ms": 2884.186, "sample_time_ms": 2880.454, "load_time_ms": 0.217, "load_throughput": 553886.299, "learn_time_ms": 2.772, "learn_throughput": 43294.924, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 236280, "num_env_steps_trained": 236280, "num_agent_steps_sampled": 236280, "num_agent_steps_trained": 236280}, "done": false, "episodes_total": 1969, "training_iteration": 493, "trial_id": "43716_00000", "date": "2023-07-26_02-58-42", "timestamp": 1690329522, "time_this_iter_s": 11.603518962860107, "time_total_s": 6008.643187046051, "pid": 92550, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-07], [256080, 5e-07], [258480, 2.5e-07], [260880, 2.5e-07], [263280, 2.5e-07], [265680, 2.5e-07], [268080, 1e-07], [270480, 1e-07], [272880, 1e-07], [275280, 5e-08], [277680, 5e-08], [280080, 5e-08], [282480, 5e-08], [284880, 5e-08], [287280, 1e-08], [289680, 1e-08], [292080, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ff3f700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 387.3177111148834, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 43.37058823529412, "ram_util_percent": 78.03529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.47686767578125, "policy_loss": -160929.15625, "vf_loss": 11701807.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 135.0, "diff_num_grad_updates_vs_sampler_policy": 134.0}}, "num_env_steps_sampled": 236760, "num_env_steps_trained": 236760, "num_agent_steps_sampled": 236760, "num_agent_steps_trained": 236760}, "sampler_results": {"episode_reward_max": -347.47955333313513, "episode_reward_min": -1294.077555734341, "episode_reward_mean": -779.0997212665163, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431, -532.3478334507668, -609.0449904036087, -817.6860614321791, -710.5580951137416, -564.2620618948481, -677.467561036098, -659.4371760206793, -1292.289403258053, -787.0195268508753, -1044.3546504926328, -619.4193143069897, -919.1005600141378, -795.6615784988876, -720.9095403415635, -1294.077555734341, -900.882196702175, -953.5901614086835, -991.8935238084913, -952.7209650332702, -713.2528566439281, -587.8408389915523, -461.8375410105642, -987.375163416636, -910.5499290580284, -783.7824339713214, -637.348411633323, -1096.8035139463145, -739.5145791297532, -572.7351284054748, -466.3105681813804, -575.966879709711, -1006.3455164506772, -878.2843178862477, -748.5776277387235, -604.9134751649469, -948.051296512375, -347.47955333313513, -536.4595026041254, -759.9454435591781, -1025.7761439426608, -1090.2314324178005, -701.0812849623192, -954.031761429931, -675.0458331628741, -889.3675354400169, -594.5434178147185, -920.8272267051653, -727.3601903877632, -748.9257915637579, -700.9010136738068, -1138.2502201852055, -678.1258397120721, -583.154120743679, -646.0660500797044, -689.151572986174, -441.85976123800583, -875.9263001696252, -586.2513889089473, -756.0339717448999, -659.3316352744132, -690.7021647723161, -578.4839327779754, -546.7982370705962, -1151.3140635224888], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.212126826097066, "mean_inference_ms": 0.4069843556955574, "mean_action_processing_ms": 0.09741648974333666, "mean_env_wait_ms": 2.9607321909934554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038857460021972656, "StateBufferConnector_ms": 0.0029528141021728516, "ViewRequirementAgentConnector_ms": 0.07189393043518066}}, "episode_reward_max": -347.47955333313513, "episode_reward_min": -1294.077555734341, "episode_reward_mean": -779.0997212665163, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-708.5613533886794, -589.4834621686647, -773.493353497345, -893.429767983281, -485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431, -532.3478334507668, -609.0449904036087, -817.6860614321791, -710.5580951137416, -564.2620618948481, -677.467561036098, -659.4371760206793, -1292.289403258053, -787.0195268508753, -1044.3546504926328, -619.4193143069897, -919.1005600141378, -795.6615784988876, -720.9095403415635, -1294.077555734341, -900.882196702175, -953.5901614086835, -991.8935238084913, -952.7209650332702, -713.2528566439281, -587.8408389915523, -461.8375410105642, -987.375163416636, -910.5499290580284, -783.7824339713214, -637.348411633323, -1096.8035139463145, -739.5145791297532, -572.7351284054748, -466.3105681813804, -575.966879709711, -1006.3455164506772, -878.2843178862477, -748.5776277387235, -604.9134751649469, -948.051296512375, -347.47955333313513, -536.4595026041254, -759.9454435591781, -1025.7761439426608, -1090.2314324178005, -701.0812849623192, -954.031761429931, -675.0458331628741, -889.3675354400169, -594.5434178147185, -920.8272267051653, -727.3601903877632, -748.9257915637579, -700.9010136738068, -1138.2502201852055, -678.1258397120721, -583.154120743679, -646.0660500797044, -689.151572986174, -441.85976123800583, -875.9263001696252, -586.2513889089473, -756.0339717448999, -659.3316352744132, -690.7021647723161, -578.4839327779754, -546.7982370705962, -1151.3140635224888], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.212126826097066, "mean_inference_ms": 0.4069843556955574, "mean_action_processing_ms": 0.09741648974333666, "mean_env_wait_ms": 2.9607321909934554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038857460021972656, "StateBufferConnector_ms": 0.0029528141021728516, "ViewRequirementAgentConnector_ms": 0.07189393043518066}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236760, "num_agent_steps_trained": 236760, "num_env_steps_sampled": 236760, "num_env_steps_trained": 236760, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.42385753534502, "num_env_steps_trained_throughput_per_sec": 40.42385753534502, "timesteps_total": 236760, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 236760, "timers": {"training_iteration_time_ms": 2928.348, "sample_time_ms": 2924.442, "load_time_ms": 0.227, "load_throughput": 529027.202, "learn_time_ms": 2.905, "learn_throughput": 41309.287, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 236760, "num_env_steps_trained": 236760, "num_agent_steps_sampled": 236760, "num_agent_steps_trained": 236760}, "done": false, "episodes_total": 1973, "training_iteration": 494, "trial_id": "43716_00000", "date": "2023-07-26_02-58-54", "timestamp": 1690329534, "time_this_iter_s": 11.876893758773804, "time_total_s": 6020.520080804825, "pid": 92550, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-07], [256080, 5e-07], [258480, 2.5e-07], [260880, 2.5e-07], [263280, 2.5e-07], [265680, 2.5e-07], [268080, 1e-07], [270480, 1e-07], [272880, 1e-07], [275280, 5e-08], [277680, 5e-08], [280080, 5e-08], [282480, 5e-08], [284880, 5e-08], [287280, 1e-08], [289680, 1e-08], [292080, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ff3f700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 399.1946048736572, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 42.9470588235294, "ram_util_percent": 76.46470588235293}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.4972839355469, "policy_loss": -75528.9765625, "vf_loss": 2314008.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 139.0, "diff_num_grad_updates_vs_sampler_policy": 138.0}}, "num_env_steps_sampled": 237240, "num_env_steps_trained": 237240, "num_agent_steps_sampled": 237240, "num_agent_steps_trained": 237240}, "sampler_results": {"episode_reward_max": -347.47955333313513, "episode_reward_min": -1294.077555734341, "episode_reward_mean": -770.7089063203034, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431, -532.3478334507668, -609.0449904036087, -817.6860614321791, -710.5580951137416, -564.2620618948481, -677.467561036098, -659.4371760206793, -1292.289403258053, -787.0195268508753, -1044.3546504926328, -619.4193143069897, -919.1005600141378, -795.6615784988876, -720.9095403415635, -1294.077555734341, -900.882196702175, -953.5901614086835, -991.8935238084913, -952.7209650332702, -713.2528566439281, -587.8408389915523, -461.8375410105642, -987.375163416636, -910.5499290580284, -783.7824339713214, -637.348411633323, -1096.8035139463145, -739.5145791297532, -572.7351284054748, -466.3105681813804, -575.966879709711, -1006.3455164506772, -878.2843178862477, -748.5776277387235, -604.9134751649469, -948.051296512375, -347.47955333313513, -536.4595026041254, -759.9454435591781, -1025.7761439426608, -1090.2314324178005, -701.0812849623192, -954.031761429931, -675.0458331628741, -889.3675354400169, -594.5434178147185, -920.8272267051653, -727.3601903877632, -748.9257915637579, -700.9010136738068, -1138.2502201852055, -678.1258397120721, -583.154120743679, -646.0660500797044, -689.151572986174, -441.85976123800583, -875.9263001696252, -586.2513889089473, -756.0339717448999, -659.3316352744132, -690.7021647723161, -578.4839327779754, -546.7982370705962, -1151.3140635224888, -590.3176190232839, -435.0614185352309, -529.9439992700559, -570.5634055881171], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.21160244234253, "mean_inference_ms": 0.40729107711043333, "mean_action_processing_ms": 0.09744286680965807, "mean_env_wait_ms": 2.94417134123549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003885030746459961, "StateBufferConnector_ms": 0.0029447078704833984, "ViewRequirementAgentConnector_ms": 0.0718073844909668}}, "episode_reward_max": -347.47955333313513, "episode_reward_min": -1294.077555734341, "episode_reward_mean": -770.7089063203034, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-485.9842520487253, -701.1460257201759, -957.0970403983233, -898.4141554549922, -1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431, -532.3478334507668, -609.0449904036087, -817.6860614321791, -710.5580951137416, -564.2620618948481, -677.467561036098, -659.4371760206793, -1292.289403258053, -787.0195268508753, -1044.3546504926328, -619.4193143069897, -919.1005600141378, -795.6615784988876, -720.9095403415635, -1294.077555734341, -900.882196702175, -953.5901614086835, -991.8935238084913, -952.7209650332702, -713.2528566439281, -587.8408389915523, -461.8375410105642, -987.375163416636, -910.5499290580284, -783.7824339713214, -637.348411633323, -1096.8035139463145, -739.5145791297532, -572.7351284054748, -466.3105681813804, -575.966879709711, -1006.3455164506772, -878.2843178862477, -748.5776277387235, -604.9134751649469, -948.051296512375, -347.47955333313513, -536.4595026041254, -759.9454435591781, -1025.7761439426608, -1090.2314324178005, -701.0812849623192, -954.031761429931, -675.0458331628741, -889.3675354400169, -594.5434178147185, -920.8272267051653, -727.3601903877632, -748.9257915637579, -700.9010136738068, -1138.2502201852055, -678.1258397120721, -583.154120743679, -646.0660500797044, -689.151572986174, -441.85976123800583, -875.9263001696252, -586.2513889089473, -756.0339717448999, -659.3316352744132, -690.7021647723161, -578.4839327779754, -546.7982370705962, -1151.3140635224888, -590.3176190232839, -435.0614185352309, -529.9439992700559, -570.5634055881171], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.21160244234253, "mean_inference_ms": 0.40729107711043333, "mean_action_processing_ms": 0.09744286680965807, "mean_env_wait_ms": 2.94417134123549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003885030746459961, "StateBufferConnector_ms": 0.0029447078704833984, "ViewRequirementAgentConnector_ms": 0.0718073844909668}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 237240, "num_agent_steps_trained": 237240, "num_env_steps_sampled": 237240, "num_env_steps_trained": 237240, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.73778051278631, "num_env_steps_trained_throughput_per_sec": 40.73778051278631, "timesteps_total": 237240, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 237240, "timers": {"training_iteration_time_ms": 2952.834, "sample_time_ms": 2948.778, "load_time_ms": 0.23, "load_throughput": 520708.132, "learn_time_ms": 3.053, "learn_throughput": 39308.395, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 237240, "num_env_steps_trained": 237240, "num_agent_steps_sampled": 237240, "num_agent_steps_trained": 237240}, "done": false, "episodes_total": 1977, "training_iteration": 495, "trial_id": "43716_00000", "date": "2023-07-26_02-59-06", "timestamp": 1690329546, "time_this_iter_s": 11.785423040390015, "time_total_s": 6032.305503845215, "pid": 92550, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-07], [256080, 5e-07], [258480, 2.5e-07], [260880, 2.5e-07], [263280, 2.5e-07], [265680, 2.5e-07], [268080, 1e-07], [270480, 1e-07], [272880, 1e-07], [275280, 5e-08], [277680, 5e-08], [280080, 5e-08], [282480, 5e-08], [284880, 5e-08], [287280, 1e-08], [289680, 1e-08], [292080, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ff3f700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 410.98002791404724, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 40.337500000000006, "ram_util_percent": 76.26875000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.4465637207031, "policy_loss": -50449.0234375, "vf_loss": 1221552.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 143.0, "diff_num_grad_updates_vs_sampler_policy": 142.0}}, "num_env_steps_sampled": 237720, "num_env_steps_trained": 237720, "num_agent_steps_sampled": 237720, "num_agent_steps_trained": 237720}, "sampler_results": {"episode_reward_max": -347.47955333313513, "episode_reward_min": -1294.077555734341, "episode_reward_mean": -768.5127966879802, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431, -532.3478334507668, -609.0449904036087, -817.6860614321791, -710.5580951137416, -564.2620618948481, -677.467561036098, -659.4371760206793, -1292.289403258053, -787.0195268508753, -1044.3546504926328, -619.4193143069897, -919.1005600141378, -795.6615784988876, -720.9095403415635, -1294.077555734341, -900.882196702175, -953.5901614086835, -991.8935238084913, -952.7209650332702, -713.2528566439281, -587.8408389915523, -461.8375410105642, -987.375163416636, -910.5499290580284, -783.7824339713214, -637.348411633323, -1096.8035139463145, -739.5145791297532, -572.7351284054748, -466.3105681813804, -575.966879709711, -1006.3455164506772, -878.2843178862477, -748.5776277387235, -604.9134751649469, -948.051296512375, -347.47955333313513, -536.4595026041254, -759.9454435591781, -1025.7761439426608, -1090.2314324178005, -701.0812849623192, -954.031761429931, -675.0458331628741, -889.3675354400169, -594.5434178147185, -920.8272267051653, -727.3601903877632, -748.9257915637579, -700.9010136738068, -1138.2502201852055, -678.1258397120721, -583.154120743679, -646.0660500797044, -689.151572986174, -441.85976123800583, -875.9263001696252, -586.2513889089473, -756.0339717448999, -659.3316352744132, -690.7021647723161, -578.4839327779754, -546.7982370705962, -1151.3140635224888, -590.3176190232839, -435.0614185352309, -529.9439992700559, -570.5634055881171, -929.2465668392394, -714.1620712163358, -830.443084131866, -349.17878820244835], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.21098345291534, "mean_inference_ms": 0.40700773001168983, "mean_action_processing_ms": 0.09742003240288617, "mean_env_wait_ms": 2.9290188740058287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003882884979248047, "StateBufferConnector_ms": 0.002935171127319336, "ViewRequirementAgentConnector_ms": 0.07175183296203613}}, "episode_reward_max": -347.47955333313513, "episode_reward_min": -1294.077555734341, "episode_reward_mean": -768.5127966879802, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1048.5803677484246, -920.3110802090938, -903.6604013268807, -719.5586772815116, -849.9514068301557, -705.885931983147, -735.2221065574983, -928.6431157244683, -723.649444243735, -732.9088636498809, -706.2642425523879, -667.8544820977812, -984.2250599721553, -615.3423820399612, -832.494409265645, -572.4549496859718, -904.0782577445716, -884.3269616852658, -640.6359988510421, -798.3502818565715, -972.5731255487755, -957.8979770194619, -1166.4859477978969, -735.1107020247155, -955.8108242288524, -491.4043275330964, -916.9301468901049, -576.1130198060431, -532.3478334507668, -609.0449904036087, -817.6860614321791, -710.5580951137416, -564.2620618948481, -677.467561036098, -659.4371760206793, -1292.289403258053, -787.0195268508753, -1044.3546504926328, -619.4193143069897, -919.1005600141378, -795.6615784988876, -720.9095403415635, -1294.077555734341, -900.882196702175, -953.5901614086835, -991.8935238084913, -952.7209650332702, -713.2528566439281, -587.8408389915523, -461.8375410105642, -987.375163416636, -910.5499290580284, -783.7824339713214, -637.348411633323, -1096.8035139463145, -739.5145791297532, -572.7351284054748, -466.3105681813804, -575.966879709711, -1006.3455164506772, -878.2843178862477, -748.5776277387235, -604.9134751649469, -948.051296512375, -347.47955333313513, -536.4595026041254, -759.9454435591781, -1025.7761439426608, -1090.2314324178005, -701.0812849623192, -954.031761429931, -675.0458331628741, -889.3675354400169, -594.5434178147185, -920.8272267051653, -727.3601903877632, -748.9257915637579, -700.9010136738068, -1138.2502201852055, -678.1258397120721, -583.154120743679, -646.0660500797044, -689.151572986174, -441.85976123800583, -875.9263001696252, -586.2513889089473, -756.0339717448999, -659.3316352744132, -690.7021647723161, -578.4839327779754, -546.7982370705962, -1151.3140635224888, -590.3176190232839, -435.0614185352309, -529.9439992700559, -570.5634055881171, -929.2465668392394, -714.1620712163358, -830.443084131866, -349.17878820244835], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.21098345291534, "mean_inference_ms": 0.40700773001168983, "mean_action_processing_ms": 0.09742003240288617, "mean_env_wait_ms": 2.9290188740058287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003882884979248047, "StateBufferConnector_ms": 0.002935171127319336, "ViewRequirementAgentConnector_ms": 0.07175183296203613}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 237720, "num_agent_steps_trained": 237720, "num_env_steps_sampled": 237720, "num_env_steps_trained": 237720, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.933106221857315, "num_env_steps_trained_throughput_per_sec": 41.933106221857315, "timesteps_total": 237720, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 237720, "timers": {"training_iteration_time_ms": 2914.36, "sample_time_ms": 2910.397, "load_time_ms": 0.232, "load_throughput": 517868.587, "learn_time_ms": 2.961, "learn_throughput": 40525.329, "synch_weights_time_ms": 0.722}, "counters": {"num_env_steps_sampled": 237720, "num_env_steps_trained": 237720, "num_agent_steps_sampled": 237720, "num_agent_steps_trained": 237720}, "done": false, "episodes_total": 1981, "training_iteration": 496, "trial_id": "43716_00000", "date": "2023-07-26_02-59-17", "timestamp": 1690329557, "time_this_iter_s": 11.449473142623901, "time_total_s": 6043.754976987839, "pid": 92550, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-07], [256080, 5e-07], [258480, 2.5e-07], [260880, 2.5e-07], [263280, 2.5e-07], [265680, 2.5e-07], [268080, 1e-07], [270480, 1e-07], [272880, 1e-07], [275280, 5e-08], [277680, 5e-08], [280080, 5e-08], [282480, 5e-08], [284880, 5e-08], [287280, 1e-08], [289680, 1e-08], [292080, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ff3f700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 422.42950105667114, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 36.6235294117647, "ram_util_percent": 74.61176470588235}}
