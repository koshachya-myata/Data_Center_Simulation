{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.3774685329861, "policy_loss": -2489551.112847222, "vf_loss": 3195089.795138889}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 63.5, "diff_num_grad_updates_vs_sampler_policy": 62.5}}, "num_env_steps_sampled": 1907040, "num_env_steps_trained": 1907040, "num_agent_steps_sampled": 1907040, "num_agent_steps_trained": 1907040}, "sampler_results": {"episode_reward_max": -3805.276640098731, "episode_reward_min": -3939.032715660687, "episode_reward_mean": -3870.6935237654666, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715], "episode_lengths": [1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.363807657166735, "mean_inference_ms": 0.22877983390428305, "mean_action_processing_ms": 0.0561276864717464, "mean_env_wait_ms": 0.8376016638671774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005090236663818359, "StateBufferConnector_ms": 0.0015616416931152344, "ViewRequirementAgentConnector_ms": 0.04177689552307129}}, "episode_reward_max": -3805.276640098731, "episode_reward_min": -3939.032715660687, "episode_reward_mean": -3870.6935237654666, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715], "episode_lengths": [1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.363807657166735, "mean_inference_ms": 0.22877983390428305, "mean_action_processing_ms": 0.0561276864717464, "mean_env_wait_ms": 0.8376016638671774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005090236663818359, "StateBufferConnector_ms": 0.0015616416931152344, "ViewRequirementAgentConnector_ms": 0.04177689552307129}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1907040, "num_agent_steps_trained": 1907040, "num_env_steps_sampled": 1907040, "num_env_steps_trained": 1907040, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 396.764844553759, "num_env_steps_trained_throughput_per_sec": 396.764844553759, "timesteps_total": 1907040, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 1907040, "timers": {"training_iteration_time_ms": 3024.451, "sample_time_ms": 3000.881, "load_time_ms": 0.453, "load_throughput": 2647988.847, "learn_time_ms": 22.52, "learn_throughput": 53287.083, "synch_weights_time_ms": 0.56}, "counters": {"num_env_steps_sampled": 1907040, "num_env_steps_trained": 1907040, "num_agent_steps_sampled": 1907040, "num_agent_steps_trained": 1907040}, "done": false, "episodes_total": 6688, "training_iteration": 1466, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-24-03", "timestamp": 1691238243, "time_this_iter_s": 12.099842071533203, "time_total_s": 18958.91063308716, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12.099842071533203, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 23.766666666666666, "ram_util_percent": 69.28333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.6e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -321.9943322075738, "policy_loss": -2466033.449652778, "vf_loss": 3334541.8055555555}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 135.5, "diff_num_grad_updates_vs_sampler_policy": 134.5}}, "num_env_steps_sampled": 1911840, "num_env_steps_trained": 1911840, "num_agent_steps_sampled": 1911840, "num_agent_steps_trained": 1911840}, "sampler_results": {"episode_reward_max": -3805.276640098731, "episode_reward_min": -4164.611644606085, "episode_reward_mean": -3948.7682008344855, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3650970845391872, "mean_inference_ms": 0.22879836618928281, "mean_action_processing_ms": 0.05618895387043768, "mean_env_wait_ms": 0.74875142253709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004872679710388184, "StateBufferConnector_ms": 0.0016748905181884766, "ViewRequirementAgentConnector_ms": 0.04290640354156494}}, "episode_reward_max": -3805.276640098731, "episode_reward_min": -4164.611644606085, "episode_reward_mean": -3948.7682008344855, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3650970845391872, "mean_inference_ms": 0.22879836618928281, "mean_action_processing_ms": 0.05618895387043768, "mean_env_wait_ms": 0.74875142253709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004872679710388184, "StateBufferConnector_ms": 0.0016748905181884766, "ViewRequirementAgentConnector_ms": 0.04290640354156494}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1911840, "num_agent_steps_trained": 1911840, "num_env_steps_sampled": 1911840, "num_env_steps_trained": 1911840, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 461.25850302964193, "num_env_steps_trained_throughput_per_sec": 461.25850302964193, "timesteps_total": 1911840, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 1911840, "timers": {"training_iteration_time_ms": 2813.009, "sample_time_ms": 2790.566, "load_time_ms": 0.446, "load_throughput": 2687938.478, "learn_time_ms": 21.402, "learn_throughput": 56069.757, "synch_weights_time_ms": 0.559}, "counters": {"num_env_steps_sampled": 1911840, "num_env_steps_trained": 1911840, "num_agent_steps_sampled": 1911840, "num_agent_steps_trained": 1911840}, "done": false, "episodes_total": 6692, "training_iteration": 1467, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-24-14", "timestamp": 1691238254, "time_this_iter_s": 10.408200979232788, "time_total_s": 18969.31883406639, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 22.50804305076599, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 24.526666666666664, "ram_util_percent": 69.22666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.066666666666667e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.0196719699436, "policy_loss": -2780520.9774305555, "vf_loss": 3386847.097222222}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 207.5, "diff_num_grad_updates_vs_sampler_policy": 206.5}}, "num_env_steps_sampled": 1916640, "num_env_steps_trained": 1916640, "num_agent_steps_sampled": 1916640, "num_agent_steps_trained": 1916640}, "sampler_results": {"episode_reward_max": -3805.276640098731, "episode_reward_min": -4164.611644606085, "episode_reward_mean": -3983.7632237268795, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3657915145022619, "mean_inference_ms": 0.2288774845036782, "mean_action_processing_ms": 0.056264067886942104, "mean_env_wait_ms": 0.7001128672245551, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043451786041259766, "StateBufferConnector_ms": 0.0016848246256510417, "ViewRequirementAgentConnector_ms": 0.04328091939290365}}, "episode_reward_max": -3805.276640098731, "episode_reward_min": -4164.611644606085, "episode_reward_mean": -3983.7632237268795, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3657915145022619, "mean_inference_ms": 0.2288774845036782, "mean_action_processing_ms": 0.056264067886942104, "mean_env_wait_ms": 0.7001128672245551, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043451786041259766, "StateBufferConnector_ms": 0.0016848246256510417, "ViewRequirementAgentConnector_ms": 0.04328091939290365}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1916640, "num_agent_steps_trained": 1916640, "num_env_steps_sampled": 1916640, "num_env_steps_trained": 1916640, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 459.79003137418385, "num_env_steps_trained_throughput_per_sec": 459.79003137418385, "timesteps_total": 1916640, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 1916640, "timers": {"training_iteration_time_ms": 2603.808, "sample_time_ms": 2582.819, "load_time_ms": 0.427, "load_throughput": 2807119.241, "learn_time_ms": 19.976, "learn_throughput": 60072.815, "synch_weights_time_ms": 0.551}, "counters": {"num_env_steps_sampled": 1916640, "num_env_steps_trained": 1916640, "num_agent_steps_sampled": 1916640, "num_agent_steps_trained": 1916640}, "done": false, "episodes_total": 6696, "training_iteration": 1468, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-24-24", "timestamp": 1691238264, "time_this_iter_s": 10.441444873809814, "time_total_s": 18979.7602789402, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 32.949487924575806, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 23.03571428571428, "ram_util_percent": 69.24285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.533333333333334e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.1511806911892, "policy_loss": -2519738.7217881945, "vf_loss": 3302277.28125}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 279.5, "diff_num_grad_updates_vs_sampler_policy": 278.5}}, "num_env_steps_sampled": 1921440, "num_env_steps_trained": 1921440, "num_agent_steps_sampled": 1921440, "num_agent_steps_trained": 1921440}, "sampler_results": {"episode_reward_max": -3805.276640098731, "episode_reward_min": -4164.611644606085, "episode_reward_mean": -3986.2317895569595, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.366457090046858, "mean_inference_ms": 0.22902580989696736, "mean_action_processing_ms": 0.056342371880243304, "mean_env_wait_ms": 0.668253622674786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038489699363708496, "StateBufferConnector_ms": 0.0016808509826660156, "ViewRequirementAgentConnector_ms": 0.043489038944244385}}, "episode_reward_max": -3805.276640098731, "episode_reward_min": -4164.611644606085, "episode_reward_mean": -3986.2317895569595, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.366457090046858, "mean_inference_ms": 0.22902580989696736, "mean_action_processing_ms": 0.056342371880243304, "mean_env_wait_ms": 0.668253622674786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038489699363708496, "StateBufferConnector_ms": 0.0016808509826660156, "ViewRequirementAgentConnector_ms": 0.043489038944244385}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1921440, "num_agent_steps_trained": 1921440, "num_env_steps_sampled": 1921440, "num_env_steps_trained": 1921440, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 460.0963725450113, "num_env_steps_trained_throughput_per_sec": 460.0963725450113, "timesteps_total": 1921440, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 1921440, "timers": {"training_iteration_time_ms": 2610.617, "sample_time_ms": 2589.772, "load_time_ms": 0.406, "load_throughput": 2955990.368, "learn_time_ms": 19.842, "learn_throughput": 60476.597, "synch_weights_time_ms": 0.561}, "counters": {"num_env_steps_sampled": 1921440, "num_env_steps_trained": 1921440, "num_agent_steps_sampled": 1921440, "num_agent_steps_trained": 1921440}, "done": false, "episodes_total": 6700, "training_iteration": 1469, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-24-35", "timestamp": 1691238275, "time_this_iter_s": 10.434380054473877, "time_total_s": 18990.194658994675, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 43.38386797904968, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 23.746666666666666, "ram_util_percent": 69.30666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.999999999999999e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.3636305067274, "policy_loss": -2297876.9231770835, "vf_loss": 3246724.7083333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 351.5, "diff_num_grad_updates_vs_sampler_policy": 350.5}}, "num_env_steps_sampled": 1926240, "num_env_steps_trained": 1926240, "num_agent_steps_sampled": 1926240, "num_agent_steps_trained": 1926240}, "sampler_results": {"episode_reward_max": -3805.276640098731, "episode_reward_min": -4164.611644606085, "episode_reward_mean": -3980.6028298937244, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3670707462251197, "mean_inference_ms": 0.22914506290039488, "mean_action_processing_ms": 0.05641108289099128, "mean_env_wait_ms": 0.645424445059398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003535747528076172, "StateBufferConnector_ms": 0.0016641616821289062, "ViewRequirementAgentConnector_ms": 0.04342317581176758}}, "episode_reward_max": -3805.276640098731, "episode_reward_min": -4164.611644606085, "episode_reward_mean": -3980.6028298937244, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3670707462251197, "mean_inference_ms": 0.22914506290039488, "mean_action_processing_ms": 0.05641108289099128, "mean_env_wait_ms": 0.645424445059398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003535747528076172, "StateBufferConnector_ms": 0.0016641616821289062, "ViewRequirementAgentConnector_ms": 0.04342317581176758}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1926240, "num_agent_steps_trained": 1926240, "num_env_steps_sampled": 1926240, "num_env_steps_trained": 1926240, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 460.30754130863124, "num_env_steps_trained_throughput_per_sec": 460.30754130863124, "timesteps_total": 1926240, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 1926240, "timers": {"training_iteration_time_ms": 2610.173, "sample_time_ms": 2589.424, "load_time_ms": 0.409, "load_throughput": 2936502.217, "learn_time_ms": 19.745, "learn_throughput": 60774.61, "synch_weights_time_ms": 0.559}, "counters": {"num_env_steps_sampled": 1926240, "num_env_steps_trained": 1926240, "num_agent_steps_sampled": 1926240, "num_agent_steps_trained": 1926240}, "done": false, "episodes_total": 6704, "training_iteration": 1470, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-24-45", "timestamp": 1691238285, "time_this_iter_s": 10.429736137390137, "time_total_s": 19000.624395132065, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 53.81360411643982, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 24.06, "ram_util_percent": 69.24666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.533333333333335e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.0670572916667, "policy_loss": -1705717.3758680555, "vf_loss": 3232623.3819444445}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 423.5, "diff_num_grad_updates_vs_sampler_policy": 422.5}}, "num_env_steps_sampled": 1931040, "num_env_steps_trained": 1931040, "num_agent_steps_sampled": 1931040, "num_agent_steps_trained": 1931040}, "sampler_results": {"episode_reward_max": -3805.276640098731, "episode_reward_min": -4164.611644606085, "episode_reward_mean": -3987.6292760201236, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3674944770382602, "mean_inference_ms": 0.2292372125428733, "mean_action_processing_ms": 0.05646286228756737, "mean_env_wait_ms": 0.6282518277132865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003333886464436849, "StateBufferConnector_ms": 0.0016570091247558594, "ViewRequirementAgentConnector_ms": 0.04338423411051432}}, "episode_reward_max": -3805.276640098731, "episode_reward_min": -4164.611644606085, "episode_reward_mean": -3987.6292760201236, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3674944770382602, "mean_inference_ms": 0.2292372125428733, "mean_action_processing_ms": 0.05646286228756737, "mean_env_wait_ms": 0.6282518277132865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003333886464436849, "StateBufferConnector_ms": 0.0016570091247558594, "ViewRequirementAgentConnector_ms": 0.04338423411051432}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1931040, "num_agent_steps_trained": 1931040, "num_env_steps_sampled": 1931040, "num_env_steps_trained": 1931040, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 460.27813816959195, "num_env_steps_trained_throughput_per_sec": 460.27813816959195, "timesteps_total": 1931040, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 1931040, "timers": {"training_iteration_time_ms": 2607.814, "sample_time_ms": 2586.775, "load_time_ms": 0.406, "load_throughput": 2959292.568, "learn_time_ms": 20.041, "learn_throughput": 59877.0, "synch_weights_time_ms": 0.555}, "counters": {"num_env_steps_sampled": 1931040, "num_env_steps_trained": 1931040, "num_agent_steps_sampled": 1931040, "num_agent_steps_trained": 1931040}, "done": false, "episodes_total": 6708, "training_iteration": 1471, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-24-56", "timestamp": 1691238296, "time_this_iter_s": 10.430406332015991, "time_total_s": 19011.05480146408, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 64.24401044845581, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 23.000000000000004, "ram_util_percent": 69.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.066666666666668e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.57761637369794, "policy_loss": -253811.39366319444, "vf_loss": 3004114.388888889}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 495.5, "diff_num_grad_updates_vs_sampler_policy": 494.5}}, "num_env_steps_sampled": 1935840, "num_env_steps_trained": 1935840, "num_agent_steps_sampled": 1935840, "num_agent_steps_trained": 1935840}, "sampler_results": {"episode_reward_max": -3805.276640098731, "episode_reward_min": -4164.611644606085, "episode_reward_mean": -3980.0516029965625, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3678184860128002, "mean_inference_ms": 0.22931708320462604, "mean_action_processing_ms": 0.056505322470980966, "mean_env_wait_ms": 0.6147024169023829, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032186508178710938, "StateBufferConnector_ms": 0.0016731875283377512, "ViewRequirementAgentConnector_ms": 0.04354374749319894}}, "episode_reward_max": -3805.276640098731, "episode_reward_min": -4164.611644606085, "episode_reward_mean": -3980.0516029965625, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3678184860128002, "mean_inference_ms": 0.22931708320462604, "mean_action_processing_ms": 0.056505322470980966, "mean_env_wait_ms": 0.6147024169023829, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032186508178710938, "StateBufferConnector_ms": 0.0016731875283377512, "ViewRequirementAgentConnector_ms": 0.04354374749319894}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1935840, "num_agent_steps_trained": 1935840, "num_env_steps_sampled": 1935840, "num_env_steps_trained": 1935840, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 461.03393940945574, "num_env_steps_trained_throughput_per_sec": 461.03393940945574, "timesteps_total": 1935840, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 1935840, "timers": {"training_iteration_time_ms": 2606.303, "sample_time_ms": 2585.11, "load_time_ms": 0.408, "load_throughput": 2940791.586, "learn_time_ms": 20.191, "learn_throughput": 59431.994, "synch_weights_time_ms": 0.557}, "counters": {"num_env_steps_sampled": 1935840, "num_env_steps_trained": 1935840, "num_agent_steps_sampled": 1935840, "num_agent_steps_trained": 1935840}, "done": false, "episodes_total": 6712, "training_iteration": 1472, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-25-06", "timestamp": 1691238306, "time_this_iter_s": 10.413307905197144, "time_total_s": 19021.468109369278, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 74.65731835365295, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 26.053333333333335, "ram_util_percent": 69.14666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.600000000000001e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.0938313802083, "policy_loss": -1454413.4249131945, "vf_loss": 3242382.2430555555}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 567.5, "diff_num_grad_updates_vs_sampler_policy": 566.5}}, "num_env_steps_sampled": 1940640, "num_env_steps_trained": 1940640, "num_agent_steps_sampled": 1940640, "num_agent_steps_trained": 1940640}, "sampler_results": {"episode_reward_max": -3805.276640098731, "episode_reward_min": -4187.632483012279, "episode_reward_mean": -3989.966580872452, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3681293825288414, "mean_inference_ms": 0.2293806758979674, "mean_action_processing_ms": 0.05654029644595176, "mean_env_wait_ms": 0.6037675074960879, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003104656934738159, "StateBufferConnector_ms": 0.001675635576248169, "ViewRequirementAgentConnector_ms": 0.043430179357528687}}, "episode_reward_max": -3805.276640098731, "episode_reward_min": -4187.632483012279, "episode_reward_mean": -3989.966580872452, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3681293825288414, "mean_inference_ms": 0.2293806758979674, "mean_action_processing_ms": 0.05654029644595176, "mean_env_wait_ms": 0.6037675074960879, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003104656934738159, "StateBufferConnector_ms": 0.001675635576248169, "ViewRequirementAgentConnector_ms": 0.043430179357528687}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1940640, "num_agent_steps_trained": 1940640, "num_env_steps_sampled": 1940640, "num_env_steps_trained": 1940640, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 459.4699202547277, "num_env_steps_trained_throughput_per_sec": 459.4699202547277, "timesteps_total": 1940640, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 1940640, "timers": {"training_iteration_time_ms": 2604.758, "sample_time_ms": 2583.652, "load_time_ms": 0.413, "load_throughput": 2905313.323, "learn_time_ms": 20.093, "learn_throughput": 59720.981, "synch_weights_time_ms": 0.562}, "counters": {"num_env_steps_sampled": 1940640, "num_env_steps_trained": 1940640, "num_agent_steps_sampled": 1940640, "num_agent_steps_trained": 1940640}, "done": false, "episodes_total": 6716, "training_iteration": 1473, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-25-17", "timestamp": 1691238317, "time_this_iter_s": 10.448709964752197, "time_total_s": 19031.91681933403, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 85.10602831840515, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 21.386666666666663, "ram_util_percent": 69.38000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.63548956976996, "policy_loss": -1722099.0414496528, "vf_loss": 3086879.6145833335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 639.5, "diff_num_grad_updates_vs_sampler_policy": 638.5}}, "num_env_steps_sampled": 1945440, "num_env_steps_trained": 1945440, "num_agent_steps_sampled": 1945440, "num_agent_steps_trained": 1945440}, "sampler_results": {"episode_reward_max": -3805.276640098731, "episode_reward_min": -4187.632483012279, "episode_reward_mean": -3979.663524830105, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.368468278139749, "mean_inference_ms": 0.22943644795679508, "mean_action_processing_ms": 0.05656927281737448, "mean_env_wait_ms": 0.5946595070732407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030305650499131945, "StateBufferConnector_ms": 0.0016808509826660156, "ViewRequirementAgentConnector_ms": 0.0434928470187717}}, "episode_reward_max": -3805.276640098731, "episode_reward_min": -4187.632483012279, "episode_reward_mean": -3979.663524830105, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.368468278139749, "mean_inference_ms": 0.22943644795679508, "mean_action_processing_ms": 0.05656927281737448, "mean_env_wait_ms": 0.5946595070732407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030305650499131945, "StateBufferConnector_ms": 0.0016808509826660156, "ViewRequirementAgentConnector_ms": 0.0434928470187717}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1945440, "num_agent_steps_trained": 1945440, "num_env_steps_sampled": 1945440, "num_env_steps_trained": 1945440, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 459.7169686636375, "num_env_steps_trained_throughput_per_sec": 459.7169686636375, "timesteps_total": 1945440, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 1945440, "timers": {"training_iteration_time_ms": 2606.093, "sample_time_ms": 2585.2, "load_time_ms": 0.411, "load_throughput": 2916593.151, "learn_time_ms": 19.889, "learn_throughput": 60335.012, "synch_weights_time_ms": 0.555}, "counters": {"num_env_steps_sampled": 1945440, "num_env_steps_trained": 1945440, "num_agent_steps_sampled": 1945440, "num_agent_steps_trained": 1945440}, "done": false, "episodes_total": 6720, "training_iteration": 1474, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-25-27", "timestamp": 1691238327, "time_this_iter_s": 10.443094968795776, "time_total_s": 19042.359914302826, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 95.54912328720093, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 23.31428571428571, "ram_util_percent": 69.39285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.2525855170356, "policy_loss": -2481133.470920139, "vf_loss": 3249954.173611111}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 711.5, "diff_num_grad_updates_vs_sampler_policy": 710.5}}, "num_env_steps_sampled": 1950240, "num_env_steps_trained": 1950240, "num_agent_steps_sampled": 1950240, "num_agent_steps_trained": 1950240}, "sampler_results": {"episode_reward_max": -3741.633804723695, "episode_reward_min": -4187.632483012279, "episode_reward_mean": -3972.835084779518, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.368699705006249, "mean_inference_ms": 0.2294912704348114, "mean_action_processing_ms": 0.05659515203037959, "mean_env_wait_ms": 0.586928259196077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029593706130981445, "StateBufferConnector_ms": 0.0016683340072631836, "ViewRequirementAgentConnector_ms": 0.04349946975708008}}, "episode_reward_max": -3741.633804723695, "episode_reward_min": -4187.632483012279, "episode_reward_mean": -3972.835084779518, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.368699705006249, "mean_inference_ms": 0.2294912704348114, "mean_action_processing_ms": 0.05659515203037959, "mean_env_wait_ms": 0.586928259196077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029593706130981445, "StateBufferConnector_ms": 0.0016683340072631836, "ViewRequirementAgentConnector_ms": 0.04349946975708008}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1950240, "num_agent_steps_trained": 1950240, "num_env_steps_sampled": 1950240, "num_env_steps_trained": 1950240, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 462.0683330143119, "num_env_steps_trained_throughput_per_sec": 462.0683330143119, "timesteps_total": 1950240, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 1950240, "timers": {"training_iteration_time_ms": 2603.072, "sample_time_ms": 2581.894, "load_time_ms": 0.413, "load_throughput": 2908671.29, "learn_time_ms": 20.175, "learn_throughput": 59480.175, "synch_weights_time_ms": 0.553}, "counters": {"num_env_steps_sampled": 1950240, "num_env_steps_trained": 1950240, "num_agent_steps_sampled": 1950240, "num_agent_steps_trained": 1950240}, "done": false, "episodes_total": 6724, "training_iteration": 1475, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-25-37", "timestamp": 1691238337, "time_this_iter_s": 10.390063047409058, "time_total_s": 19052.749977350235, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 105.93918633460999, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 22.80666666666667, "ram_util_percent": 69.36}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.11896260579425, "policy_loss": -1744807.0594618055, "vf_loss": 3283234.034722222}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 783.5, "diff_num_grad_updates_vs_sampler_policy": 782.5}}, "num_env_steps_sampled": 1955040, "num_env_steps_trained": 1955040, "num_agent_steps_sampled": 1955040, "num_agent_steps_trained": 1955040}, "sampler_results": {"episode_reward_max": -3741.633804723695, "episode_reward_min": -4187.632483012279, "episode_reward_mean": -3976.5574206536126, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3688938595469602, "mean_inference_ms": 0.22953739072266657, "mean_action_processing_ms": 0.0566179231318682, "mean_env_wait_ms": 0.58025191809271, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028940764340487394, "StateBufferConnector_ms": 0.0016456300562078302, "ViewRequirementAgentConnector_ms": 0.04350326277992942}}, "episode_reward_max": -3741.633804723695, "episode_reward_min": -4187.632483012279, "episode_reward_mean": -3976.5574206536126, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3688938595469602, "mean_inference_ms": 0.22953739072266657, "mean_action_processing_ms": 0.0566179231318682, "mean_env_wait_ms": 0.58025191809271, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028940764340487394, "StateBufferConnector_ms": 0.0016456300562078302, "ViewRequirementAgentConnector_ms": 0.04350326277992942}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1955040, "num_agent_steps_trained": 1955040, "num_env_steps_sampled": 1955040, "num_env_steps_trained": 1955040, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 461.9315582192869, "num_env_steps_trained_throughput_per_sec": 461.9315582192869, "timesteps_total": 1955040, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 1955040, "timers": {"training_iteration_time_ms": 2601.125, "sample_time_ms": 2580.142, "load_time_ms": 0.413, "load_throughput": 2908335.144, "learn_time_ms": 19.979, "learn_throughput": 60063.496, "synch_weights_time_ms": 0.554}, "counters": {"num_env_steps_sampled": 1955040, "num_env_steps_trained": 1955040, "num_agent_steps_sampled": 1955040, "num_agent_steps_trained": 1955040}, "done": false, "episodes_total": 6728, "training_iteration": 1476, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-25-48", "timestamp": 1691238348, "time_this_iter_s": 10.393065214157104, "time_total_s": 19063.143042564392, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 116.33225154876709, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 22.753333333333337, "ram_util_percent": 69.33999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -321.880859375, "policy_loss": -1113139.09375, "vf_loss": 3261692.9930555555}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 855.5, "diff_num_grad_updates_vs_sampler_policy": 854.5}}, "num_env_steps_sampled": 1959840, "num_env_steps_trained": 1959840, "num_agent_steps_sampled": 1959840, "num_agent_steps_trained": 1959840}, "sampler_results": {"episode_reward_max": -3741.633804723695, "episode_reward_min": -4187.632483012279, "episode_reward_mean": -3971.602631211996, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3691096245393208, "mean_inference_ms": 0.22956991350057557, "mean_action_processing_ms": 0.05663577121037009, "mean_env_wait_ms": 0.5743939596972885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028446316719055176, "StateBufferConnector_ms": 0.0016515453656514485, "ViewRequirementAgentConnector_ms": 0.043539206186930336}}, "episode_reward_max": -3741.633804723695, "episode_reward_min": -4187.632483012279, "episode_reward_mean": -3971.602631211996, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3691096245393208, "mean_inference_ms": 0.22956991350057557, "mean_action_processing_ms": 0.05663577121037009, "mean_env_wait_ms": 0.5743939596972885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028446316719055176, "StateBufferConnector_ms": 0.0016515453656514485, "ViewRequirementAgentConnector_ms": 0.043539206186930336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1959840, "num_agent_steps_trained": 1959840, "num_env_steps_sampled": 1959840, "num_env_steps_trained": 1959840, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 461.3527771624928, "num_env_steps_trained_throughput_per_sec": 461.3527771624928, "timesteps_total": 1959840, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 1959840, "timers": {"training_iteration_time_ms": 2599.014, "sample_time_ms": 2577.773, "load_time_ms": 0.418, "load_throughput": 2868227.034, "learn_time_ms": 20.213, "learn_throughput": 59368.971, "synch_weights_time_ms": 0.572}, "counters": {"num_env_steps_sampled": 1959840, "num_env_steps_trained": 1959840, "num_agent_steps_sampled": 1959840, "num_agent_steps_trained": 1959840}, "done": false, "episodes_total": 6732, "training_iteration": 1477, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-25-58", "timestamp": 1691238358, "time_this_iter_s": 10.406091928482056, "time_total_s": 19073.549134492874, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 126.73834347724915, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 24.1, "ram_util_percent": 69.34666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.09508938259546, "policy_loss": -1845741.6180555555, "vf_loss": 3024768.8055555555}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 927.5, "diff_num_grad_updates_vs_sampler_policy": 926.5}}, "num_env_steps_sampled": 1964640, "num_env_steps_trained": 1964640, "num_agent_steps_sampled": 1964640, "num_agent_steps_trained": 1964640}, "sampler_results": {"episode_reward_max": -3741.633804723695, "episode_reward_min": -4187.632483012279, "episode_reward_mean": -3971.37212720239, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3693282861177472, "mean_inference_ms": 0.2296023576315793, "mean_action_processing_ms": 0.05665234521196653, "mean_env_wait_ms": 0.569282482454713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028032522935133716, "StateBufferConnector_ms": 0.0016460051903357874, "ViewRequirementAgentConnector_ms": 0.04350909819969764}}, "episode_reward_max": -3741.633804723695, "episode_reward_min": -4187.632483012279, "episode_reward_mean": -3971.37212720239, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3693282861177472, "mean_inference_ms": 0.2296023576315793, "mean_action_processing_ms": 0.05665234521196653, "mean_env_wait_ms": 0.569282482454713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028032522935133716, "StateBufferConnector_ms": 0.0016460051903357874, "ViewRequirementAgentConnector_ms": 0.04350909819969764}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1964640, "num_agent_steps_trained": 1964640, "num_env_steps_sampled": 1964640, "num_env_steps_trained": 1964640, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 458.5555540244551, "num_env_steps_trained_throughput_per_sec": 458.5555540244551, "timesteps_total": 1964640, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 1964640, "timers": {"training_iteration_time_ms": 2607.071, "sample_time_ms": 2585.855, "load_time_ms": 0.421, "load_throughput": 2851813.021, "learn_time_ms": 20.191, "learn_throughput": 59431.573, "synch_weights_time_ms": 0.566}, "counters": {"num_env_steps_sampled": 1964640, "num_env_steps_trained": 1964640, "num_agent_steps_sampled": 1964640, "num_agent_steps_trained": 1964640}, "done": false, "episodes_total": 6736, "training_iteration": 1478, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-26-09", "timestamp": 1691238369, "time_this_iter_s": 10.469940900802612, "time_total_s": 19084.019075393677, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 137.20828437805176, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 23.240000000000002, "ram_util_percent": 69.33999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.0899590386285, "policy_loss": -1477106.6692708333, "vf_loss": 3211829.190972222}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 999.5, "diff_num_grad_updates_vs_sampler_policy": 998.5}}, "num_env_steps_sampled": 1969440, "num_env_steps_trained": 1969440, "num_agent_steps_sampled": 1969440, "num_agent_steps_trained": 1969440}, "sampler_results": {"episode_reward_max": -3741.633804723695, "episode_reward_min": -4187.632483012279, "episode_reward_mean": -3971.145427533703, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.369527524495659, "mean_inference_ms": 0.22963237966171254, "mean_action_processing_ms": 0.05666727386422187, "mean_env_wait_ms": 0.564769651682172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027660812650408062, "StateBufferConnector_ms": 0.0016484941755022322, "ViewRequirementAgentConnector_ms": 0.04350883620125907}}, "episode_reward_max": -3741.633804723695, "episode_reward_min": -4187.632483012279, "episode_reward_mean": -3971.145427533703, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.369527524495659, "mean_inference_ms": 0.22963237966171254, "mean_action_processing_ms": 0.05666727386422187, "mean_env_wait_ms": 0.564769651682172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027660812650408062, "StateBufferConnector_ms": 0.0016484941755022322, "ViewRequirementAgentConnector_ms": 0.04350883620125907}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1969440, "num_agent_steps_trained": 1969440, "num_env_steps_sampled": 1969440, "num_env_steps_trained": 1969440, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 459.5951791203971, "num_env_steps_trained_throughput_per_sec": 459.5951791203971, "timesteps_total": 1969440, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 1969440, "timers": {"training_iteration_time_ms": 2613.035, "sample_time_ms": 2591.694, "load_time_ms": 0.418, "load_throughput": 2871335.958, "learn_time_ms": 20.314, "learn_throughput": 59073.664, "synch_weights_time_ms": 0.572}, "counters": {"num_env_steps_sampled": 1969440, "num_env_steps_trained": 1969440, "num_agent_steps_sampled": 1969440, "num_agent_steps_trained": 1969440}, "done": false, "episodes_total": 6740, "training_iteration": 1479, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-26-19", "timestamp": 1691238379, "time_this_iter_s": 10.44611930847168, "time_total_s": 19094.46519470215, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 147.65440368652344, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 23.419999999999998, "ram_util_percent": 69.39333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.124262491862, "policy_loss": -2481919.22265625, "vf_loss": 3478178.2291666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1071.5, "diff_num_grad_updates_vs_sampler_policy": 1070.5}}, "num_env_steps_sampled": 1974240, "num_env_steps_trained": 1974240, "num_agent_steps_sampled": 1974240, "num_agent_steps_trained": 1974240}, "sampler_results": {"episode_reward_max": -3741.633804723695, "episode_reward_min": -4236.233351170335, "episode_reward_mean": -3976.1551039091933, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.369726395953226, "mean_inference_ms": 0.22966432426929628, "mean_action_processing_ms": 0.05668138399340437, "mean_env_wait_ms": 0.5607623577788358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027338663736979165, "StateBufferConnector_ms": 0.0016589959462483723, "ViewRequirementAgentConnector_ms": 0.04353086153666178}}, "episode_reward_max": -3741.633804723695, "episode_reward_min": -4236.233351170335, "episode_reward_mean": -3976.1551039091933, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.369726395953226, "mean_inference_ms": 0.22966432426929628, "mean_action_processing_ms": 0.05668138399340437, "mean_env_wait_ms": 0.5607623577788358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027338663736979165, "StateBufferConnector_ms": 0.0016589959462483723, "ViewRequirementAgentConnector_ms": 0.04353086153666178}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1974240, "num_agent_steps_trained": 1974240, "num_env_steps_sampled": 1974240, "num_env_steps_trained": 1974240, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 458.15193133207384, "num_env_steps_trained_throughput_per_sec": 458.15193133207384, "timesteps_total": 1974240, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 1974240, "timers": {"training_iteration_time_ms": 2614.182, "sample_time_ms": 2593.021, "load_time_ms": 0.418, "load_throughput": 2873467.002, "learn_time_ms": 20.131, "learn_throughput": 59608.169, "synch_weights_time_ms": 0.575}, "counters": {"num_env_steps_sampled": 1974240, "num_env_steps_trained": 1974240, "num_agent_steps_sampled": 1974240, "num_agent_steps_trained": 1974240}, "done": false, "episodes_total": 6744, "training_iteration": 1480, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-26-30", "timestamp": 1691238390, "time_this_iter_s": 10.478826999664307, "time_total_s": 19104.944021701813, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 158.13323068618774, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 25.066666666666666, "ram_util_percent": 69.34666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -321.9973958333333, "policy_loss": -1140530.341579861, "vf_loss": 3104446.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1143.5, "diff_num_grad_updates_vs_sampler_policy": 1142.5}}, "num_env_steps_sampled": 1979040, "num_env_steps_trained": 1979040, "num_agent_steps_sampled": 1979040, "num_agent_steps_trained": 1979040}, "sampler_results": {"episode_reward_max": -3741.633804723695, "episode_reward_min": -4236.233351170335, "episode_reward_mean": -3976.7227633831117, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3699248648685185, "mean_inference_ms": 0.2296934099838806, "mean_action_processing_ms": 0.05669411238215156, "mean_env_wait_ms": 0.5571755777774523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027198344469070435, "StateBufferConnector_ms": 0.0016644597053527832, "ViewRequirementAgentConnector_ms": 0.043578073382377625}}, "episode_reward_max": -3741.633804723695, "episode_reward_min": -4236.233351170335, "episode_reward_mean": -3976.7227633831117, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3699248648685185, "mean_inference_ms": 0.2296934099838806, "mean_action_processing_ms": 0.05669411238215156, "mean_env_wait_ms": 0.5571755777774523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027198344469070435, "StateBufferConnector_ms": 0.0016644597053527832, "ViewRequirementAgentConnector_ms": 0.043578073382377625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1979040, "num_agent_steps_trained": 1979040, "num_env_steps_sampled": 1979040, "num_env_steps_trained": 1979040, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 458.29811926592663, "num_env_steps_trained_throughput_per_sec": 458.29811926592663, "timesteps_total": 1979040, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 1979040, "timers": {"training_iteration_time_ms": 2617.099, "sample_time_ms": 2595.966, "load_time_ms": 0.416, "load_throughput": 2885988.991, "learn_time_ms": 20.117, "learn_throughput": 59650.768, "synch_weights_time_ms": 0.563}, "counters": {"num_env_steps_sampled": 1979040, "num_env_steps_trained": 1979040, "num_agent_steps_sampled": 1979040, "num_agent_steps_trained": 1979040}, "done": false, "episodes_total": 6748, "training_iteration": 1481, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-26-40", "timestamp": 1691238400, "time_this_iter_s": 10.475512266159058, "time_total_s": 19115.41953396797, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 168.6087429523468, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 26.099999999999998, "ram_util_percent": 69.42857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.0715077718099, "policy_loss": -2604830.032986111, "vf_loss": 3505188.0555555555}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1215.5, "diff_num_grad_updates_vs_sampler_policy": 1214.5}}, "num_env_steps_sampled": 1983840, "num_env_steps_trained": 1983840, "num_agent_steps_sampled": 1983840, "num_agent_steps_trained": 1983840}, "sampler_results": {"episode_reward_max": -3741.633804723695, "episode_reward_min": -4236.233351170335, "episode_reward_mean": -3978.821369275305, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.370089659678712, "mean_inference_ms": 0.2297170288346835, "mean_action_processing_ms": 0.05670462231091488, "mean_env_wait_ms": 0.5539031932338522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027060508728027344, "StateBufferConnector_ms": 0.0016745399026309744, "ViewRequirementAgentConnector_ms": 0.043593434726490694}}, "episode_reward_max": -3741.633804723695, "episode_reward_min": -4236.233351170335, "episode_reward_mean": -3978.821369275305, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.370089659678712, "mean_inference_ms": 0.2297170288346835, "mean_action_processing_ms": 0.05670462231091488, "mean_env_wait_ms": 0.5539031932338522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027060508728027344, "StateBufferConnector_ms": 0.0016745399026309744, "ViewRequirementAgentConnector_ms": 0.043593434726490694}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1983840, "num_agent_steps_trained": 1983840, "num_env_steps_sampled": 1983840, "num_env_steps_trained": 1983840, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 462.89211187036136, "num_env_steps_trained_throughput_per_sec": 462.89211187036136, "timesteps_total": 1983840, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 1983840, "timers": {"training_iteration_time_ms": 2608.248, "sample_time_ms": 2587.128, "load_time_ms": 0.411, "load_throughput": 2919130.495, "learn_time_ms": 20.115, "learn_throughput": 59656.637, "synch_weights_time_ms": 0.556}, "counters": {"num_env_steps_sampled": 1983840, "num_env_steps_trained": 1983840, "num_agent_steps_sampled": 1983840, "num_agent_steps_trained": 1983840}, "done": false, "episodes_total": 6752, "training_iteration": 1482, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-26-51", "timestamp": 1691238411, "time_this_iter_s": 10.371635913848877, "time_total_s": 19125.79116988182, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 178.98037886619568, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 25.146666666666665, "ram_util_percent": 69.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.1158277723524, "policy_loss": -1660240.4535590278, "vf_loss": 3182822.7916666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1287.5, "diff_num_grad_updates_vs_sampler_policy": 1286.5}}, "num_env_steps_sampled": 1988640, "num_env_steps_trained": 1988640, "num_agent_steps_sampled": 1988640, "num_agent_steps_trained": 1988640}, "sampler_results": {"episode_reward_max": -3741.633804723695, "episode_reward_min": -4236.233351170335, "episode_reward_mean": -3975.3312113726247, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3702416978969834, "mean_inference_ms": 0.2297398634847234, "mean_action_processing_ms": 0.056714244657295736, "mean_env_wait_ms": 0.5509070722511739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026875072055392796, "StateBufferConnector_ms": 0.0016765462027655707, "ViewRequirementAgentConnector_ms": 0.04360145992702908}}, "episode_reward_max": -3741.633804723695, "episode_reward_min": -4236.233351170335, "episode_reward_mean": -3975.3312113726247, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3702416978969834, "mean_inference_ms": 0.2297398634847234, "mean_action_processing_ms": 0.056714244657295736, "mean_env_wait_ms": 0.5509070722511739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026875072055392796, "StateBufferConnector_ms": 0.0016765462027655707, "ViewRequirementAgentConnector_ms": 0.04360145992702908}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1988640, "num_agent_steps_trained": 1988640, "num_env_steps_sampled": 1988640, "num_env_steps_trained": 1988640, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 461.5336748766323, "num_env_steps_trained_throughput_per_sec": 461.5336748766323, "timesteps_total": 1988640, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 1988640, "timers": {"training_iteration_time_ms": 2598.847, "sample_time_ms": 2577.836, "load_time_ms": 0.412, "load_throughput": 2912037.028, "learn_time_ms": 20.005, "learn_throughput": 59985.327, "synch_weights_time_ms": 0.556}, "counters": {"num_env_steps_sampled": 1988640, "num_env_steps_trained": 1988640, "num_agent_steps_sampled": 1988640, "num_agent_steps_trained": 1988640}, "done": false, "episodes_total": 6756, "training_iteration": 1483, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-27-01", "timestamp": 1691238421, "time_this_iter_s": 10.402132034301758, "time_total_s": 19136.193301916122, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 189.38251090049744, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 22.74666666666667, "ram_util_percent": 69.40666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.3087972005208, "policy_loss": -702909.0894097222, "vf_loss": 3012523.090277778}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1359.5, "diff_num_grad_updates_vs_sampler_policy": 1358.5}}, "num_env_steps_sampled": 1993440, "num_env_steps_trained": 1993440, "num_agent_steps_sampled": 1993440, "num_agent_steps_trained": 1993440}, "sampler_results": {"episode_reward_max": -3741.633804723695, "episode_reward_min": -4236.233351170335, "episode_reward_mean": -3972.362733528924, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.370392149186418, "mean_inference_ms": 0.22975942813071243, "mean_action_processing_ms": 0.056722769251666014, "mean_env_wait_ms": 0.5481560842872117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002668092125340512, "StateBufferConnector_ms": 0.0016770864787854646, "ViewRequirementAgentConnector_ms": 0.04360299361379523}}, "episode_reward_max": -3741.633804723695, "episode_reward_min": -4236.233351170335, "episode_reward_mean": -3972.362733528924, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.370392149186418, "mean_inference_ms": 0.22975942813071243, "mean_action_processing_ms": 0.056722769251666014, "mean_env_wait_ms": 0.5481560842872117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002668092125340512, "StateBufferConnector_ms": 0.0016770864787854646, "ViewRequirementAgentConnector_ms": 0.04360299361379523}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1993440, "num_agent_steps_trained": 1993440, "num_env_steps_sampled": 1993440, "num_env_steps_trained": 1993440, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 460.6864662610385, "num_env_steps_trained_throughput_per_sec": 460.6864662610385, "timesteps_total": 1993440, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 1993440, "timers": {"training_iteration_time_ms": 2597.442, "sample_time_ms": 2576.632, "load_time_ms": 0.412, "load_throughput": 2911868.557, "learn_time_ms": 19.798, "learn_throughput": 60611.84, "synch_weights_time_ms": 0.563}, "counters": {"num_env_steps_sampled": 1993440, "num_env_steps_trained": 1993440, "num_agent_steps_sampled": 1993440, "num_agent_steps_trained": 1993440}, "done": false, "episodes_total": 6760, "training_iteration": 1484, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-27-11", "timestamp": 1691238431, "time_this_iter_s": 10.421261072158813, "time_total_s": 19146.61456298828, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 199.80377197265625, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 22.946666666666665, "ram_util_percent": 69.50666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.45674472384985, "policy_loss": -927940.3589409722, "vf_loss": 3046489.340277778}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1431.5, "diff_num_grad_updates_vs_sampler_policy": 1430.5}}, "num_env_steps_sampled": 1998240, "num_env_steps_trained": 1998240, "num_agent_steps_sampled": 1998240, "num_agent_steps_trained": 1998240}, "sampler_results": {"episode_reward_max": -3741.633804723695, "episode_reward_min": -4236.233351170335, "episode_reward_mean": -3970.9979096479447, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.370520018439001, "mean_inference_ms": 0.22977729742058695, "mean_action_processing_ms": 0.0567305647679491, "mean_env_wait_ms": 0.5456282489739465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002656877040863037, "StateBufferConnector_ms": 0.0016769766807556152, "ViewRequirementAgentConnector_ms": 0.04364967346191406}}, "episode_reward_max": -3741.633804723695, "episode_reward_min": -4236.233351170335, "episode_reward_mean": -3970.9979096479447, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.370520018439001, "mean_inference_ms": 0.22977729742058695, "mean_action_processing_ms": 0.0567305647679491, "mean_env_wait_ms": 0.5456282489739465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002656877040863037, "StateBufferConnector_ms": 0.0016769766807556152, "ViewRequirementAgentConnector_ms": 0.04364967346191406}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1998240, "num_agent_steps_trained": 1998240, "num_env_steps_sampled": 1998240, "num_env_steps_trained": 1998240, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 461.53291308284673, "num_env_steps_trained_throughput_per_sec": 461.53291308284673, "timesteps_total": 1998240, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 1998240, "timers": {"training_iteration_time_ms": 2603.95, "sample_time_ms": 2583.138, "load_time_ms": 0.411, "load_throughput": 2921672.259, "learn_time_ms": 19.8, "learn_throughput": 60605.418, "synch_weights_time_ms": 0.565}, "counters": {"num_env_steps_sampled": 1998240, "num_env_steps_trained": 1998240, "num_agent_steps_sampled": 1998240, "num_agent_steps_trained": 1998240}, "done": false, "episodes_total": 6764, "training_iteration": 1485, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-27-22", "timestamp": 1691238442, "time_this_iter_s": 10.402132034301758, "time_total_s": 19157.016695022583, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 210.205904006958, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 23.86, "ram_util_percent": 69.23333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.1e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.1146308051215, "policy_loss": -2108208.2630208335, "vf_loss": 3281842.8055555555}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1503.5, "diff_num_grad_updates_vs_sampler_policy": 1502.5}}, "num_env_steps_sampled": 2003040, "num_env_steps_trained": 2003040, "num_agent_steps_sampled": 2003040, "num_agent_steps_trained": 2003040}, "sampler_results": {"episode_reward_max": -3741.633804723695, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3973.1535743759123, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.370633625882831, "mean_inference_ms": 0.22979609283643326, "mean_action_processing_ms": 0.05673818674262445, "mean_env_wait_ms": 0.5432972777261357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002638215110415504, "StateBufferConnector_ms": 0.0016697815486363002, "ViewRequirementAgentConnector_ms": 0.04361584073021298}}, "episode_reward_max": -3741.633804723695, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3973.1535743759123, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.370633625882831, "mean_inference_ms": 0.22979609283643326, "mean_action_processing_ms": 0.05673818674262445, "mean_env_wait_ms": 0.5432972777261357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002638215110415504, "StateBufferConnector_ms": 0.0016697815486363002, "ViewRequirementAgentConnector_ms": 0.04361584073021298}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2003040, "num_agent_steps_trained": 2003040, "num_env_steps_sampled": 2003040, "num_env_steps_trained": 2003040, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 460.7018470834365, "num_env_steps_trained_throughput_per_sec": 460.7018470834365, "timesteps_total": 2003040, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2003040, "timers": {"training_iteration_time_ms": 2602.587, "sample_time_ms": 2581.434, "load_time_ms": 0.412, "load_throughput": 2915579.447, "learn_time_ms": 20.129, "learn_throughput": 59614.947, "synch_weights_time_ms": 0.575}, "counters": {"num_env_steps_sampled": 2003040, "num_env_steps_trained": 2003040, "num_agent_steps_sampled": 2003040, "num_agent_steps_trained": 2003040}, "done": false, "episodes_total": 6768, "training_iteration": 1486, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-27-32", "timestamp": 1691238452, "time_this_iter_s": 10.421051263809204, "time_total_s": 19167.437746286392, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 220.6269552707672, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 24.346666666666668, "ram_util_percent": 69.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.6999999999999997e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.03477478027344, "policy_loss": -3041493.300347222, "vf_loss": 3494361.3541666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1575.5, "diff_num_grad_updates_vs_sampler_policy": 1574.5}}, "num_env_steps_sampled": 2007840, "num_env_steps_trained": 2007840, "num_agent_steps_sampled": 2007840, "num_agent_steps_trained": 2007840}, "sampler_results": {"episode_reward_max": -3741.633804723695, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3972.15831324341, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3707226959330858, "mean_inference_ms": 0.22981705451484438, "mean_action_processing_ms": 0.05674592083610093, "mean_env_wait_ms": 0.5411467531313822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002625584602355957, "StateBufferConnector_ms": 0.001668117263100364, "ViewRequirementAgentConnector_ms": 0.04362220113927668}}, "episode_reward_max": -3741.633804723695, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3972.15831324341, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3707226959330858, "mean_inference_ms": 0.22981705451484438, "mean_action_processing_ms": 0.05674592083610093, "mean_env_wait_ms": 0.5411467531313822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002625584602355957, "StateBufferConnector_ms": 0.001668117263100364, "ViewRequirementAgentConnector_ms": 0.04362220113927668}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2007840, "num_agent_steps_trained": 2007840, "num_env_steps_sampled": 2007840, "num_env_steps_trained": 2007840, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 461.2410983978422, "num_env_steps_trained_throughput_per_sec": 461.2410983978422, "timesteps_total": 2007840, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2007840, "timers": {"training_iteration_time_ms": 2601.348, "sample_time_ms": 2580.348, "load_time_ms": 0.409, "load_throughput": 2936159.608, "learn_time_ms": 19.997, "learn_throughput": 60010.144, "synch_weights_time_ms": 0.558}, "counters": {"num_env_steps_sampled": 2007840, "num_env_steps_trained": 2007840, "num_agent_steps_sampled": 2007840, "num_agent_steps_trained": 2007840}, "done": false, "episodes_total": 6772, "training_iteration": 1487, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-27-43", "timestamp": 1691238463, "time_this_iter_s": 10.408643007278442, "time_total_s": 19177.84638929367, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 231.03559827804565, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 24.442857142857143, "ram_util_percent": 69.2642857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.2999999999999999e-09, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.11529710557727, "policy_loss": -1936056.674045139, "vf_loss": 3409711.472222222}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1647.5, "diff_num_grad_updates_vs_sampler_policy": 1646.5}}, "num_env_steps_sampled": 2012640, "num_env_steps_trained": 2012640, "num_agent_steps_sampled": 2012640, "num_agent_steps_trained": 2012640}, "sampler_results": {"episode_reward_max": -3741.633804723695, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3976.197928630128, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3708031034657449, "mean_inference_ms": 0.22983637740217597, "mean_action_processing_ms": 0.05675331054618312, "mean_env_wait_ms": 0.5391496188798477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002610165139903193, "StateBufferConnector_ms": 0.0016735947650411854, "ViewRequirementAgentConnector_ms": 0.043647444766500725}}, "episode_reward_max": -3741.633804723695, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3976.197928630128, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3708031034657449, "mean_inference_ms": 0.22983637740217597, "mean_action_processing_ms": 0.05675331054618312, "mean_env_wait_ms": 0.5391496188798477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002610165139903193, "StateBufferConnector_ms": 0.0016735947650411854, "ViewRequirementAgentConnector_ms": 0.043647444766500725}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2012640, "num_agent_steps_trained": 2012640, "num_env_steps_sampled": 2012640, "num_env_steps_trained": 2012640, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 460.86767517199735, "num_env_steps_trained_throughput_per_sec": 460.86767517199735, "timesteps_total": 2012640, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2012640, "timers": {"training_iteration_time_ms": 2604.519, "sample_time_ms": 2583.365, "load_time_ms": 0.41, "load_throughput": 2929835.73, "learn_time_ms": 20.139, "learn_throughput": 59585.729, "synch_weights_time_ms": 0.568}, "counters": {"num_env_steps_sampled": 2012640, "num_env_steps_trained": 2012640, "num_agent_steps_sampled": 2012640, "num_agent_steps_trained": 2012640}, "done": false, "episodes_total": 6776, "training_iteration": 1488, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-27-53", "timestamp": 1691238473, "time_this_iter_s": 10.417188167572021, "time_total_s": 19188.263577461243, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 241.45278644561768, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 23.406666666666663, "ram_util_percent": 69.33333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.040769788954, "policy_loss": -1381038.1215277778, "vf_loss": 3228018.2708333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1719.5, "diff_num_grad_updates_vs_sampler_policy": 1718.5}}, "num_env_steps_sampled": 2017440, "num_env_steps_trained": 2017440, "num_agent_steps_sampled": 2017440, "num_agent_steps_trained": 2017440}, "sampler_results": {"episode_reward_max": -3741.633804723695, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3973.3058557067234, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3708815047392973, "mean_inference_ms": 0.2298561589534888, "mean_action_processing_ms": 0.05676062442849165, "mean_env_wait_ms": 0.5372965531029222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025985141595204673, "StateBufferConnector_ms": 0.0016768773396809895, "ViewRequirementAgentConnector_ms": 0.04362141092618307}}, "episode_reward_max": -3741.633804723695, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3973.3058557067234, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3708815047392973, "mean_inference_ms": 0.2298561589534888, "mean_action_processing_ms": 0.05676062442849165, "mean_env_wait_ms": 0.5372965531029222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025985141595204673, "StateBufferConnector_ms": 0.0016768773396809895, "ViewRequirementAgentConnector_ms": 0.04362141092618307}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2017440, "num_agent_steps_trained": 2017440, "num_env_steps_sampled": 2017440, "num_env_steps_trained": 2017440, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 459.09022934650744, "num_env_steps_trained_throughput_per_sec": 459.09022934650744, "timesteps_total": 2017440, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2017440, "timers": {"training_iteration_time_ms": 2610.574, "sample_time_ms": 2589.304, "load_time_ms": 0.416, "load_throughput": 2886651.067, "learn_time_ms": 20.245, "learn_throughput": 59272.977, "synch_weights_time_ms": 0.571}, "counters": {"num_env_steps_sampled": 2017440, "num_env_steps_trained": 2017440, "num_agent_steps_sampled": 2017440, "num_agent_steps_trained": 2017440}, "done": false, "episodes_total": 6780, "training_iteration": 1489, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-28-04", "timestamp": 1691238484, "time_this_iter_s": 10.457581043243408, "time_total_s": 19198.721158504486, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 251.91036748886108, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 23.96666666666666, "ram_util_percent": 69.44}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.30224948459204, "policy_loss": -1571916.241970486, "vf_loss": 3245765.6875}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1791.5, "diff_num_grad_updates_vs_sampler_policy": 1790.5}}, "num_env_steps_sampled": 2022240, "num_env_steps_trained": 2022240, "num_agent_steps_sampled": 2022240, "num_agent_steps_trained": 2022240}, "sampler_results": {"episode_reward_max": -3741.633804723695, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3975.579462541822, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3709624337132678, "mean_inference_ms": 0.22987379471485775, "mean_action_processing_ms": 0.05676737839216326, "mean_env_wait_ms": 0.5355693722006849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002593994140625, "StateBufferConnector_ms": 0.0016813278198242188, "ViewRequirementAgentConnector_ms": 0.04361152648925781}}, "episode_reward_max": -3741.633804723695, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3975.579462541822, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3805.276640098731, -3810.9124837507334, -3939.032715660687, -3927.552255551715, -4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3709624337132678, "mean_inference_ms": 0.22987379471485775, "mean_action_processing_ms": 0.05676737839216326, "mean_env_wait_ms": 0.5355693722006849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002593994140625, "StateBufferConnector_ms": 0.0016813278198242188, "ViewRequirementAgentConnector_ms": 0.04361152648925781}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2022240, "num_agent_steps_trained": 2022240, "num_env_steps_sampled": 2022240, "num_env_steps_trained": 2022240, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 459.27758129696406, "num_env_steps_trained_throughput_per_sec": 459.27758129696406, "timesteps_total": 2022240, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2022240, "timers": {"training_iteration_time_ms": 2612.515, "sample_time_ms": 2591.33, "load_time_ms": 0.418, "load_throughput": 2874123.344, "learn_time_ms": 20.161, "learn_throughput": 59520.409, "synch_weights_time_ms": 0.569}, "counters": {"num_env_steps_sampled": 2022240, "num_env_steps_trained": 2022240, "num_agent_steps_sampled": 2022240, "num_agent_steps_trained": 2022240}, "done": false, "episodes_total": 6784, "training_iteration": 1490, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-28-14", "timestamp": 1691238494, "time_this_iter_s": 10.45334506034851, "time_total_s": 19209.174503564835, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 262.3637125492096, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 23.88666666666667, "ram_util_percent": 68.92666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.4312099880642, "policy_loss": -1334356.3138020833, "vf_loss": 3126215.736111111}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1863.5, "diff_num_grad_updates_vs_sampler_policy": 1862.5}}, "num_env_steps_sampled": 2027040, "num_env_steps_trained": 2027040, "num_agent_steps_sampled": 2027040, "num_agent_steps_trained": 2027040}, "sampler_results": {"episode_reward_max": -3741.633804723695, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3981.0373340803576, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3713238792362998, "mean_inference_ms": 0.22993267318634664, "mean_action_processing_ms": 0.056799252439976085, "mean_env_wait_ms": 0.5218139820959129, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026025772094726562, "StateBufferConnector_ms": 0.0016875267028808594, "ViewRequirementAgentConnector_ms": 0.04361891746520996}}, "episode_reward_max": -3741.633804723695, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3981.0373340803576, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4164.611644606085, -3844.755023886801, -4015.636672894412, -4082.368170226717, -3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3713238792362998, "mean_inference_ms": 0.22993267318634664, "mean_action_processing_ms": 0.056799252439976085, "mean_env_wait_ms": 0.5218139820959129, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026025772094726562, "StateBufferConnector_ms": 0.0016875267028808594, "ViewRequirementAgentConnector_ms": 0.04361891746520996}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2027040, "num_agent_steps_trained": 2027040, "num_env_steps_sampled": 2027040, "num_env_steps_trained": 2027040, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 460.22936923437686, "num_env_steps_trained_throughput_per_sec": 460.22936923437686, "timesteps_total": 2027040, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2027040, "timers": {"training_iteration_time_ms": 2612.179, "sample_time_ms": 2591.021, "load_time_ms": 0.421, "load_throughput": 2852136.227, "learn_time_ms": 20.137, "learn_throughput": 59591.937, "synch_weights_time_ms": 0.563}, "counters": {"num_env_steps_sampled": 2027040, "num_env_steps_trained": 2027040, "num_agent_steps_sampled": 2027040, "num_agent_steps_trained": 2027040}, "done": false, "episodes_total": 6788, "training_iteration": 1491, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-28-25", "timestamp": 1691238505, "time_this_iter_s": 10.431797742843628, "time_total_s": 19219.60630130768, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 272.7955102920532, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 23.34, "ram_util_percent": 68.80666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.18302069769965, "policy_loss": -1395723.630642361, "vf_loss": 3172678.5729166665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1935.5, "diff_num_grad_updates_vs_sampler_policy": 1934.5}}, "num_env_steps_sampled": 2031840, "num_env_steps_trained": 2031840, "num_agent_steps_sampled": 2031840, "num_agent_steps_trained": 2031840}, "sampler_results": {"episode_reward_max": -3741.633804723695, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3978.8817789793247, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3715833070767873, "mean_inference_ms": 0.22999131900180939, "mean_action_processing_ms": 0.05682655142387781, "mean_env_wait_ms": 0.5151733187319405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002583742141723633, "StateBufferConnector_ms": 0.001680135726928711, "ViewRequirementAgentConnector_ms": 0.04358029365539551}}, "episode_reward_max": -3741.633804723695, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3978.8817789793247, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3966.2301404528753, -4118.745823267902, -4051.7926827262568, -4078.2444315996377, -3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3715833070767873, "mean_inference_ms": 0.22999131900180939, "mean_action_processing_ms": 0.05682655142387781, "mean_env_wait_ms": 0.5151733187319405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002583742141723633, "StateBufferConnector_ms": 0.001680135726928711, "ViewRequirementAgentConnector_ms": 0.04358029365539551}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2031840, "num_agent_steps_trained": 2031840, "num_env_steps_sampled": 2031840, "num_env_steps_trained": 2031840, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 456.2683362839548, "num_env_steps_trained_throughput_per_sec": 456.2683362839548, "timesteps_total": 2031840, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2031840, "timers": {"training_iteration_time_ms": 2615.02, "sample_time_ms": 2594.011, "load_time_ms": 0.424, "load_throughput": 2830323.792, "learn_time_ms": 19.967, "learn_throughput": 60098.854, "synch_weights_time_ms": 0.58}, "counters": {"num_env_steps_sampled": 2031840, "num_env_steps_trained": 2031840, "num_agent_steps_sampled": 2031840, "num_agent_steps_trained": 2031840}, "done": false, "episodes_total": 6792, "training_iteration": 1492, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-28-35", "timestamp": 1691238515, "time_this_iter_s": 10.522256851196289, "time_total_s": 19230.128558158875, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 283.3177671432495, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 25.286666666666665, "ram_util_percent": 68.74}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.34124586317273, "policy_loss": -565862.5638020834, "vf_loss": 2987208.326388889}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2007.5, "diff_num_grad_updates_vs_sampler_policy": 2006.5}}, "num_env_steps_sampled": 2036640, "num_env_steps_trained": 2036640, "num_agent_steps_sampled": 2036640, "num_agent_steps_trained": 2036640}, "sampler_results": {"episode_reward_max": -3741.633804723695, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3975.1961654441006, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3718096929454706, "mean_inference_ms": 0.23004037631385743, "mean_action_processing_ms": 0.05684713503628178, "mean_env_wait_ms": 0.5107809486855912, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025925636291503906, "StateBufferConnector_ms": 0.0016849040985107422, "ViewRequirementAgentConnector_ms": 0.043617963790893555}}, "episode_reward_max": -3741.633804723695, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3975.1961654441006, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3878.8635735604034, -4136.363928263486, -3949.4574090285664, -4009.8650373363407, -3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3718096929454706, "mean_inference_ms": 0.23004037631385743, "mean_action_processing_ms": 0.05684713503628178, "mean_env_wait_ms": 0.5107809486855912, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025925636291503906, "StateBufferConnector_ms": 0.0016849040985107422, "ViewRequirementAgentConnector_ms": 0.043617963790893555}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2036640, "num_agent_steps_trained": 2036640, "num_env_steps_sampled": 2036640, "num_env_steps_trained": 2036640, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 462.948408811819, "num_env_steps_trained_throughput_per_sec": 462.948408811819, "timesteps_total": 2036640, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2036640, "timers": {"training_iteration_time_ms": 2607.925, "sample_time_ms": 2586.79, "load_time_ms": 0.419, "load_throughput": 2864309.583, "learn_time_ms": 20.096, "learn_throughput": 59713.612, "synch_weights_time_ms": 0.582}, "counters": {"num_env_steps_sampled": 2036640, "num_env_steps_trained": 2036640, "num_agent_steps_sampled": 2036640, "num_agent_steps_trained": 2036640}, "done": false, "episodes_total": 6796, "training_iteration": 1493, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-28-45", "timestamp": 1691238525, "time_this_iter_s": 10.37044095993042, "time_total_s": 19240.498999118805, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 293.68820810317993, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 24.071428571428573, "ram_util_percent": 69.05714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.0675964355469, "policy_loss": -2036077.8745659722, "vf_loss": 3293080.6458333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2079.5, "diff_num_grad_updates_vs_sampler_policy": 2078.5}}, "num_env_steps_sampled": 2041440, "num_env_steps_trained": 2041440, "num_agent_steps_sampled": 2041440, "num_agent_steps_trained": 2041440}, "sampler_results": {"episode_reward_max": -3741.633804723695, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3976.3227162101516, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3719818210813812, "mean_inference_ms": 0.23007272987237434, "mean_action_processing_ms": 0.056861519290324326, "mean_env_wait_ms": 0.50758006614878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002591848373413086, "StateBufferConnector_ms": 0.0016906261444091797, "ViewRequirementAgentConnector_ms": 0.043587684631347656}}, "episode_reward_max": -3741.633804723695, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3976.3227162101516, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3993.864476236392, -3915.4875560463997, -3959.687569517369, -3963.3083631629765, -4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3719818210813812, "mean_inference_ms": 0.23007272987237434, "mean_action_processing_ms": 0.056861519290324326, "mean_env_wait_ms": 0.50758006614878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002591848373413086, "StateBufferConnector_ms": 0.0016906261444091797, "ViewRequirementAgentConnector_ms": 0.043587684631347656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2041440, "num_agent_steps_trained": 2041440, "num_env_steps_sampled": 2041440, "num_env_steps_trained": 2041440, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 460.3330537326125, "num_env_steps_trained_throughput_per_sec": 460.3330537326125, "timesteps_total": 2041440, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2041440, "timers": {"training_iteration_time_ms": 2600.933, "sample_time_ms": 2579.818, "load_time_ms": 0.418, "load_throughput": 2873631.059, "learn_time_ms": 20.094, "learn_throughput": 59720.768, "synch_weights_time_ms": 0.567}, "counters": {"num_env_steps_sampled": 2041440, "num_env_steps_trained": 2041440, "num_agent_steps_sampled": 2041440, "num_agent_steps_trained": 2041440}, "done": false, "episodes_total": 6800, "training_iteration": 1494, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-28-56", "timestamp": 1691238536, "time_this_iter_s": 10.429350137710571, "time_total_s": 19250.928349256516, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 304.1175582408905, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 22.066666666666666, "ram_util_percent": 69.02666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -321.6941155327691, "policy_loss": -2845185.5164930555, "vf_loss": 3541174.048611111}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2151.5, "diff_num_grad_updates_vs_sampler_policy": 2150.5}}, "num_env_steps_sampled": 2046240, "num_env_steps_trained": 2046240, "num_agent_steps_sampled": 2046240, "num_agent_steps_trained": 2046240}, "sampler_results": {"episode_reward_max": -3741.633804723695, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3980.008082111875, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3721154915844374, "mean_inference_ms": 0.23009969784132447, "mean_action_processing_ms": 0.05687175160095817, "mean_env_wait_ms": 0.5051132476006116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025930404663085938, "StateBufferConnector_ms": 0.0016951560974121094, "ViewRequirementAgentConnector_ms": 0.04357337951660156}}, "episode_reward_max": -3741.633804723695, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3980.008082111875, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4009.4227393686792, -4034.223520388945, -4077.973496729402, -3969.4262701214434, -3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3721154915844374, "mean_inference_ms": 0.23009969784132447, "mean_action_processing_ms": 0.05687175160095817, "mean_env_wait_ms": 0.5051132476006116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025930404663085938, "StateBufferConnector_ms": 0.0016951560974121094, "ViewRequirementAgentConnector_ms": 0.04357337951660156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2046240, "num_agent_steps_trained": 2046240, "num_env_steps_sampled": 2046240, "num_env_steps_trained": 2046240, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 458.3378085372206, "num_env_steps_trained_throughput_per_sec": 458.3378085372206, "timesteps_total": 2046240, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2046240, "timers": {"training_iteration_time_ms": 2607.752, "sample_time_ms": 2586.627, "load_time_ms": 0.416, "load_throughput": 2883674.115, "learn_time_ms": 20.119, "learn_throughput": 59645.184, "synch_weights_time_ms": 0.554}, "counters": {"num_env_steps_sampled": 2046240, "num_env_steps_trained": 2046240, "num_agent_steps_sampled": 2046240, "num_agent_steps_trained": 2046240}, "done": false, "episodes_total": 6804, "training_iteration": 1495, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-29-06", "timestamp": 1691238546, "time_this_iter_s": 10.474747896194458, "time_total_s": 19261.40309715271, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 314.59230613708496, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 25.673333333333332, "ram_util_percent": 69.06}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -321.8880784776476, "policy_loss": -2893278.3424479165, "vf_loss": 3246148.284722222}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2223.5, "diff_num_grad_updates_vs_sampler_policy": 2222.5}}, "num_env_steps_sampled": 2051040, "num_env_steps_trained": 2051040, "num_agent_steps_sampled": 2051040, "num_agent_steps_trained": 2051040}, "sampler_results": {"episode_reward_max": -3741.633804723695, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3978.9235766885395, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3722555616154315, "mean_inference_ms": 0.23012232835060994, "mean_action_processing_ms": 0.056880228912943656, "mean_env_wait_ms": 0.5030941969031099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025942325592041016, "StateBufferConnector_ms": 0.0016970634460449219, "ViewRequirementAgentConnector_ms": 0.04359030723571777}}, "episode_reward_max": -3741.633804723695, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3978.9235766885395, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3982.473636955685, -3963.5580753565123, -3940.9835563786355, -3851.32699072994, -4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3722555616154315, "mean_inference_ms": 0.23012232835060994, "mean_action_processing_ms": 0.056880228912943656, "mean_env_wait_ms": 0.5030941969031099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025942325592041016, "StateBufferConnector_ms": 0.0016970634460449219, "ViewRequirementAgentConnector_ms": 0.04359030723571777}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2051040, "num_agent_steps_trained": 2051040, "num_env_steps_sampled": 2051040, "num_env_steps_trained": 2051040, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 459.88360108592207, "num_env_steps_trained_throughput_per_sec": 459.88360108592207, "timesteps_total": 2051040, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2051040, "timers": {"training_iteration_time_ms": 2616.818, "sample_time_ms": 2595.695, "load_time_ms": 0.414, "load_throughput": 2895452.338, "learn_time_ms": 20.12, "learn_throughput": 59642.003, "synch_weights_time_ms": 0.551}, "counters": {"num_env_steps_sampled": 2051040, "num_env_steps_trained": 2051040, "num_agent_steps_sampled": 2051040, "num_agent_steps_trained": 2051040}, "done": false, "episodes_total": 6808, "training_iteration": 1496, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-29-17", "timestamp": 1691238557, "time_this_iter_s": 10.43947982788086, "time_total_s": 19271.84257698059, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 325.0317859649658, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 28.946666666666665, "ram_util_percent": 68.98666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.000000000000002e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.15672980414496, "policy_loss": -1770197.8315972222, "vf_loss": 3188822.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2295.5, "diff_num_grad_updates_vs_sampler_policy": 2294.5}}, "num_env_steps_sampled": 2055840, "num_env_steps_trained": 2055840, "num_agent_steps_sampled": 2055840, "num_agent_steps_trained": 2055840}, "sampler_results": {"episode_reward_max": -3741.633804723695, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3983.8130567451076, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3723832660949153, "mean_inference_ms": 0.23013808694344406, "mean_action_processing_ms": 0.056886661052435124, "mean_env_wait_ms": 0.5014068589321229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002587556838989258, "StateBufferConnector_ms": 0.0016963481903076172, "ViewRequirementAgentConnector_ms": 0.04357743263244629}}, "episode_reward_max": -3741.633804723695, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3983.8130567451076, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4055.8632696402656, -3953.789406200857, -4187.632483012279, -4040.2005451613477, -3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3723832660949153, "mean_inference_ms": 0.23013808694344406, "mean_action_processing_ms": 0.056886661052435124, "mean_env_wait_ms": 0.5014068589321229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002587556838989258, "StateBufferConnector_ms": 0.0016963481903076172, "ViewRequirementAgentConnector_ms": 0.04357743263244629}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2055840, "num_agent_steps_trained": 2055840, "num_env_steps_sampled": 2055840, "num_env_steps_trained": 2055840, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 464.2331121019387, "num_env_steps_trained_throughput_per_sec": 464.2331121019387, "timesteps_total": 2055840, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2055840, "timers": {"training_iteration_time_ms": 2598.637, "sample_time_ms": 2577.422, "load_time_ms": 0.417, "load_throughput": 2880538.431, "learn_time_ms": 20.209, "learn_throughput": 59380.948, "synch_weights_time_ms": 0.553}, "counters": {"num_env_steps_sampled": 2055840, "num_env_steps_trained": 2055840, "num_agent_steps_sampled": 2055840, "num_agent_steps_trained": 2055840}, "done": false, "episodes_total": 6812, "training_iteration": 1497, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-29-27", "timestamp": 1691238567, "time_this_iter_s": 10.341755151748657, "time_total_s": 19282.18433213234, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 335.3735411167145, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 34.566666666666656, "ram_util_percent": 68.79333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.666666666666667e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.0728776719835, "policy_loss": -885297.1623263889, "vf_loss": 3166713.2569444445}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2367.5, "diff_num_grad_updates_vs_sampler_policy": 2366.5}}, "num_env_steps_sampled": 2060640, "num_env_steps_trained": 2060640, "num_agent_steps_sampled": 2060640, "num_agent_steps_trained": 2060640}, "sampler_results": {"episode_reward_max": -3741.633804723695, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3980.6105045486856, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3724888286030994, "mean_inference_ms": 0.23015140891125177, "mean_action_processing_ms": 0.056891820444204884, "mean_env_wait_ms": 0.49994314849221483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025823116302490234, "StateBufferConnector_ms": 0.0016901493072509766, "ViewRequirementAgentConnector_ms": 0.04357194900512695}}, "episode_reward_max": -3741.633804723695, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3980.6105045486856, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3830.927979917069, -3914.4455297174986, -3980.556384866725, -3863.0264114640418, -3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3724888286030994, "mean_inference_ms": 0.23015140891125177, "mean_action_processing_ms": 0.056891820444204884, "mean_env_wait_ms": 0.49994314849221483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025823116302490234, "StateBufferConnector_ms": 0.0016901493072509766, "ViewRequirementAgentConnector_ms": 0.04357194900512695}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2060640, "num_agent_steps_trained": 2060640, "num_env_steps_sampled": 2060640, "num_env_steps_trained": 2060640, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 462.57739307205736, "num_env_steps_trained_throughput_per_sec": 462.57739307205736, "timesteps_total": 2060640, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2060640, "timers": {"training_iteration_time_ms": 2592.752, "sample_time_ms": 2571.577, "load_time_ms": 0.417, "load_throughput": 2876587.301, "learn_time_ms": 20.17, "learn_throughput": 59493.955, "synch_weights_time_ms": 0.55}, "counters": {"num_env_steps_sampled": 2060640, "num_env_steps_trained": 2060640, "num_agent_steps_sampled": 2060640, "num_agent_steps_trained": 2060640}, "done": false, "episodes_total": 6816, "training_iteration": 1498, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-29-38", "timestamp": 1691238578, "time_this_iter_s": 10.378731966018677, "time_total_s": 19292.563064098358, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 345.75227308273315, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 36.407142857142865, "ram_util_percent": 68.92142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.333333333333335e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.186755710178, "policy_loss": -1986236.5581597222, "vf_loss": 3213114.3958333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2439.5, "diff_num_grad_updates_vs_sampler_policy": 2438.5}}, "num_env_steps_sampled": 2065440, "num_env_steps_trained": 2065440, "num_agent_steps_sampled": 2065440, "num_agent_steps_trained": 2065440}, "sampler_results": {"episode_reward_max": -3741.633804723695, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3985.4959788780416, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3725543097645332, "mean_inference_ms": 0.23016020741801654, "mean_action_processing_ms": 0.056896006093218966, "mean_env_wait_ms": 0.4986711820522639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002578258514404297, "StateBufferConnector_ms": 0.0016880035400390625, "ViewRequirementAgentConnector_ms": 0.043544769287109375}}, "episode_reward_max": -3741.633804723695, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3985.4959788780416, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3741.633804723695, -3995.122859083649, -3945.2884313984946, -3963.4714020910565, -4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3725543097645332, "mean_inference_ms": 0.23016020741801654, "mean_action_processing_ms": 0.056896006093218966, "mean_env_wait_ms": 0.4986711820522639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002578258514404297, "StateBufferConnector_ms": 0.0016880035400390625, "ViewRequirementAgentConnector_ms": 0.043544769287109375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2065440, "num_agent_steps_trained": 2065440, "num_env_steps_sampled": 2065440, "num_env_steps_trained": 2065440, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 464.2755062517405, "num_env_steps_trained_throughput_per_sec": 464.2755062517405, "timesteps_total": 2065440, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2065440, "timers": {"training_iteration_time_ms": 2586.714, "sample_time_ms": 2565.697, "load_time_ms": 0.414, "load_throughput": 2896118.764, "learn_time_ms": 20.012, "learn_throughput": 59964.244, "synch_weights_time_ms": 0.554}, "counters": {"num_env_steps_sampled": 2065440, "num_env_steps_trained": 2065440, "num_agent_steps_sampled": 2065440, "num_agent_steps_trained": 2065440}, "done": false, "episodes_total": 6820, "training_iteration": 1499, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-29-48", "timestamp": 1691238588, "time_this_iter_s": 10.340755939483643, "time_total_s": 19302.90382003784, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 356.0930290222168, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 33.49333333333333, "ram_util_percent": 68.96000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.0212758382161, "policy_loss": -1837931.2395833333, "vf_loss": 3331925.1041666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2511.5, "diff_num_grad_updates_vs_sampler_policy": 2510.5}}, "num_env_steps_sampled": 2070240, "num_env_steps_trained": 2070240, "num_agent_steps_sampled": 2070240, "num_agent_steps_trained": 2070240}, "sampler_results": {"episode_reward_max": -3811.1814284063425, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3992.7280555466486, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3726307947101912, "mean_inference_ms": 0.23016339812444633, "mean_action_processing_ms": 0.05689882551154781, "mean_env_wait_ms": 0.4975637954118221, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002580881118774414, "StateBufferConnector_ms": 0.0016951560974121094, "ViewRequirementAgentConnector_ms": 0.043581247329711914}}, "episode_reward_max": -3811.1814284063425, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3992.7280555466486, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4040.2913118271986, -4059.7809113037365, -3937.458763329509, -4017.5921311177526, -3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3726307947101912, "mean_inference_ms": 0.23016339812444633, "mean_action_processing_ms": 0.05689882551154781, "mean_env_wait_ms": 0.4975637954118221, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002580881118774414, "StateBufferConnector_ms": 0.0016951560974121094, "ViewRequirementAgentConnector_ms": 0.043581247329711914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2070240, "num_agent_steps_trained": 2070240, "num_env_steps_sampled": 2070240, "num_env_steps_trained": 2070240, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 462.1248646575345, "num_env_steps_trained_throughput_per_sec": 462.1248646575345, "timesteps_total": 2070240, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2070240, "timers": {"training_iteration_time_ms": 2586.565, "sample_time_ms": 2565.641, "load_time_ms": 0.412, "load_throughput": 2909511.995, "learn_time_ms": 19.919, "learn_throughput": 60243.297, "synch_weights_time_ms": 0.556}, "counters": {"num_env_steps_sampled": 2070240, "num_env_steps_trained": 2070240, "num_agent_steps_sampled": 2070240, "num_agent_steps_trained": 2070240}, "done": false, "episodes_total": 6824, "training_iteration": 1500, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-29-58", "timestamp": 1691238598, "time_this_iter_s": 10.388849973678589, "time_total_s": 19313.29267001152, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 366.4818789958954, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 32.38666666666667, "ram_util_percent": 69.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.5639868842231, "policy_loss": -2619747.91796875, "vf_loss": 3299663.3333333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2583.5, "diff_num_grad_updates_vs_sampler_policy": 2582.5}}, "num_env_steps_sampled": 2075040, "num_env_steps_trained": 2075040, "num_agent_steps_sampled": 2075040, "num_agent_steps_trained": 2075040}, "sampler_results": {"episode_reward_max": -3811.1814284063425, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3992.3921602116206, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3727044864487266, "mean_inference_ms": 0.2301697709534733, "mean_action_processing_ms": 0.05690174885509108, "mean_env_wait_ms": 0.49659962373550187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002588987350463867, "StateBufferConnector_ms": 0.001711130142211914, "ViewRequirementAgentConnector_ms": 0.04365420341491699}}, "episode_reward_max": -3811.1814284063425, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3992.3921602116206, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3853.0250521300704, -3818.769000621748, -3969.759449787727, -4026.846286877378, -3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3727044864487266, "mean_inference_ms": 0.2301697709534733, "mean_action_processing_ms": 0.05690174885509108, "mean_env_wait_ms": 0.49659962373550187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002588987350463867, "StateBufferConnector_ms": 0.001711130142211914, "ViewRequirementAgentConnector_ms": 0.04365420341491699}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2075040, "num_agent_steps_trained": 2075040, "num_env_steps_sampled": 2075040, "num_env_steps_trained": 2075040, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 459.8933183859954, "num_env_steps_trained_throughput_per_sec": 459.8933183859954, "timesteps_total": 2075040, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2075040, "timers": {"training_iteration_time_ms": 2599.796, "sample_time_ms": 2578.828, "load_time_ms": 0.416, "load_throughput": 2886154.481, "learn_time_ms": 19.967, "learn_throughput": 60098.71, "synch_weights_time_ms": 0.548}, "counters": {"num_env_steps_sampled": 2075040, "num_env_steps_trained": 2075040, "num_agent_steps_sampled": 2075040, "num_agent_steps_trained": 2075040}, "done": false, "episodes_total": 6828, "training_iteration": 1501, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-30-09", "timestamp": 1691238609, "time_this_iter_s": 10.439288139343262, "time_total_s": 19323.731958150864, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 376.92116713523865, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 44.864285714285714, "ram_util_percent": 69.11428571428573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.12259758843317, "policy_loss": -514108.4079861111, "vf_loss": 3033147.309027778}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2655.5, "diff_num_grad_updates_vs_sampler_policy": 2654.5}}, "num_env_steps_sampled": 2079840, "num_env_steps_trained": 2079840, "num_agent_steps_sampled": 2079840, "num_agent_steps_trained": 2079840}, "sampler_results": {"episode_reward_max": -3811.1814284063425, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3996.041791970597, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3727511680175177, "mean_inference_ms": 0.2301790084116906, "mean_action_processing_ms": 0.05690540750933862, "mean_env_wait_ms": 0.49574648981031016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025882720947265625, "StateBufferConnector_ms": 0.0017130374908447266, "ViewRequirementAgentConnector_ms": 0.04362845420837402}}, "episode_reward_max": -3811.1814284063425, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3996.041791970597, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3910.5462155044283, -3939.2379964951842, -4164.961956190055, -3859.67814815877, -4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3727511680175177, "mean_inference_ms": 0.2301790084116906, "mean_action_processing_ms": 0.05690540750933862, "mean_env_wait_ms": 0.49574648981031016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025882720947265625, "StateBufferConnector_ms": 0.0017130374908447266, "ViewRequirementAgentConnector_ms": 0.04362845420837402}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2079840, "num_agent_steps_trained": 2079840, "num_env_steps_sampled": 2079840, "num_env_steps_trained": 2079840, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 464.647032256577, "num_env_steps_trained_throughput_per_sec": 464.647032256577, "timesteps_total": 2079840, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2079840, "timers": {"training_iteration_time_ms": 2595.86, "sample_time_ms": 2574.735, "load_time_ms": 0.423, "load_throughput": 2837984.099, "learn_time_ms": 20.111, "learn_throughput": 59670.145, "synch_weights_time_ms": 0.554}, "counters": {"num_env_steps_sampled": 2079840, "num_env_steps_trained": 2079840, "num_agent_steps_sampled": 2079840, "num_agent_steps_trained": 2079840}, "done": false, "episodes_total": 6832, "training_iteration": 1502, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-30-19", "timestamp": 1691238619, "time_this_iter_s": 10.332556009292603, "time_total_s": 19334.064514160156, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 387.25372314453125, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 43.39333333333333, "ram_util_percent": 69.09333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -321.984619140625, "policy_loss": -1006317.7408854166, "vf_loss": 3044308.173611111}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2727.5, "diff_num_grad_updates_vs_sampler_policy": 2726.5}}, "num_env_steps_sampled": 2084640, "num_env_steps_trained": 2084640, "num_agent_steps_sampled": 2084640, "num_agent_steps_trained": 2084640}, "sampler_results": {"episode_reward_max": -3811.1814284063425, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3994.558055915464, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3727773762638515, "mean_inference_ms": 0.2301858580231851, "mean_action_processing_ms": 0.056908281242984554, "mean_env_wait_ms": 0.4949607086024915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025887489318847656, "StateBufferConnector_ms": 0.0017168521881103516, "ViewRequirementAgentConnector_ms": 0.04367661476135254}}, "episode_reward_max": -3811.1814284063425, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3994.558055915464, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4095.054641572006, -3926.3817766633056, -3908.5101280258514, -3942.846781101921, -4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3727773762638515, "mean_inference_ms": 0.2301858580231851, "mean_action_processing_ms": 0.056908281242984554, "mean_env_wait_ms": 0.4949607086024915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025887489318847656, "StateBufferConnector_ms": 0.0017168521881103516, "ViewRequirementAgentConnector_ms": 0.04367661476135254}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2084640, "num_agent_steps_trained": 2084640, "num_env_steps_sampled": 2084640, "num_env_steps_trained": 2084640, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 461.6895780911848, "num_env_steps_trained_throughput_per_sec": 461.6895780911848, "timesteps_total": 2084640, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2084640, "timers": {"training_iteration_time_ms": 2590.786, "sample_time_ms": 2569.7, "load_time_ms": 0.422, "load_throughput": 2841508.948, "learn_time_ms": 20.072, "learn_throughput": 59783.546, "synch_weights_time_ms": 0.555}, "counters": {"num_env_steps_sampled": 2084640, "num_env_steps_trained": 2084640, "num_agent_steps_sampled": 2084640, "num_agent_steps_trained": 2084640}, "done": false, "episodes_total": 6836, "training_iteration": 1503, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-30-30", "timestamp": 1691238630, "time_this_iter_s": 10.398730039596558, "time_total_s": 19344.463244199753, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 397.6524531841278, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 36.193333333333335, "ram_util_percent": 69.05333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -321.80275472005206, "policy_loss": -2983353.640625, "vf_loss": 3479570.4375}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2799.5, "diff_num_grad_updates_vs_sampler_policy": 2798.5}}, "num_env_steps_sampled": 2089440, "num_env_steps_trained": 2089440, "num_agent_steps_sampled": 2089440, "num_agent_steps_trained": 2089440}, "sampler_results": {"episode_reward_max": -3811.1814284063425, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3996.770170040539, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3727994266368102, "mean_inference_ms": 0.2301928844767426, "mean_action_processing_ms": 0.056911186842344016, "mean_env_wait_ms": 0.4942139531093976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025916099548339844, "StateBufferConnector_ms": 0.001714944839477539, "ViewRequirementAgentConnector_ms": 0.04366636276245117}}, "episode_reward_max": -3811.1814284063425, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3996.770170040539, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4236.233351170335, -3836.35654744714, -3926.103068500227, -4186.46932554649, -3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3727994266368102, "mean_inference_ms": 0.2301928844767426, "mean_action_processing_ms": 0.056911186842344016, "mean_env_wait_ms": 0.4942139531093976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025916099548339844, "StateBufferConnector_ms": 0.001714944839477539, "ViewRequirementAgentConnector_ms": 0.04366636276245117}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2089440, "num_agent_steps_trained": 2089440, "num_env_steps_sampled": 2089440, "num_env_steps_trained": 2089440, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 465.0407542948741, "num_env_steps_trained_throughput_per_sec": 465.0407542948741, "timesteps_total": 2089440, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2089440, "timers": {"training_iteration_time_ms": 2584.578, "sample_time_ms": 2563.378, "load_time_ms": 0.419, "load_throughput": 2863820.654, "learn_time_ms": 20.191, "learn_throughput": 59431.432, "synch_weights_time_ms": 0.552}, "counters": {"num_env_steps_sampled": 2089440, "num_env_steps_trained": 2089440, "num_agent_steps_sampled": 2089440, "num_agent_steps_trained": 2089440}, "done": false, "episodes_total": 6840, "training_iteration": 1504, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-30-40", "timestamp": 1691238640, "time_this_iter_s": 10.323823928833008, "time_total_s": 19354.787068128586, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 407.9762771129608, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 33.121428571428574, "ram_util_percent": 68.94999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.207019382053, "policy_loss": -2373243.198893229, "vf_loss": 3125401.8020833335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2871.5, "diff_num_grad_updates_vs_sampler_policy": 2870.5}}, "num_env_steps_sampled": 2094240, "num_env_steps_trained": 2094240, "num_agent_steps_sampled": 2094240, "num_agent_steps_trained": 2094240}, "sampler_results": {"episode_reward_max": -3811.1814284063425, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3994.7221766386706, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3728058430373318, "mean_inference_ms": 0.2301950019337824, "mean_action_processing_ms": 0.05691324216266955, "mean_env_wait_ms": 0.4935222628810034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002591848373413086, "StateBufferConnector_ms": 0.0017158985137939453, "ViewRequirementAgentConnector_ms": 0.043619632720947266}}, "episode_reward_max": -3811.1814284063425, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3994.7221766386706, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3960.818717281438, -3979.1867971418105, -4095.0870514859275, -3905.858056058427, -3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3728058430373318, "mean_inference_ms": 0.2301950019337824, "mean_action_processing_ms": 0.05691324216266955, "mean_env_wait_ms": 0.4935222628810034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002591848373413086, "StateBufferConnector_ms": 0.0017158985137939453, "ViewRequirementAgentConnector_ms": 0.043619632720947266}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2094240, "num_agent_steps_trained": 2094240, "num_env_steps_sampled": 2094240, "num_env_steps_trained": 2094240, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 459.68790332257026, "num_env_steps_trained_throughput_per_sec": 459.68790332257026, "timesteps_total": 2094240, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2094240, "timers": {"training_iteration_time_ms": 2596.181, "sample_time_ms": 2574.732, "load_time_ms": 0.416, "load_throughput": 2884169.847, "learn_time_ms": 20.421, "learn_throughput": 58763.986, "synch_weights_time_ms": 0.574}, "counters": {"num_env_steps_sampled": 2094240, "num_env_steps_trained": 2094240, "num_agent_steps_sampled": 2094240, "num_agent_steps_trained": 2094240}, "done": false, "episodes_total": 6844, "training_iteration": 1505, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-30-50", "timestamp": 1691238650, "time_this_iter_s": 10.444108963012695, "time_total_s": 19365.2311770916, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 418.4203860759735, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 22.966666666666672, "ram_util_percent": 69.08}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.07499016655817, "policy_loss": -1707600.3984375, "vf_loss": 3297642.2916666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2943.5, "diff_num_grad_updates_vs_sampler_policy": 2942.5}}, "num_env_steps_sampled": 2099040, "num_env_steps_trained": 2099040, "num_agent_steps_sampled": 2099040, "num_agent_steps_trained": 2099040}, "sampler_results": {"episode_reward_max": -3811.1814284063425, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3993.6383060151115, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3727956545237123, "mean_inference_ms": 0.23019657721429232, "mean_action_processing_ms": 0.05691514643910007, "mean_env_wait_ms": 0.49287299582411037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002584695816040039, "StateBufferConnector_ms": 0.0017151832580566406, "ViewRequirementAgentConnector_ms": 0.04360604286193848}}, "episode_reward_max": -3811.1814284063425, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3993.6383060151115, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3961.114857887357, -3998.5939647240434, -3878.2107173401505, -4211.676714250083, -3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3727956545237123, "mean_inference_ms": 0.23019657721429232, "mean_action_processing_ms": 0.05691514643910007, "mean_env_wait_ms": 0.49287299582411037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002584695816040039, "StateBufferConnector_ms": 0.0017151832580566406, "ViewRequirementAgentConnector_ms": 0.04360604286193848}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2099040, "num_agent_steps_trained": 2099040, "num_env_steps_sampled": 2099040, "num_env_steps_trained": 2099040, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 461.1246891684574, "num_env_steps_trained_throughput_per_sec": 461.1246891684574, "timesteps_total": 2099040, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2099040, "timers": {"training_iteration_time_ms": 2601.483, "sample_time_ms": 2580.194, "load_time_ms": 0.417, "load_throughput": 2880043.946, "learn_time_ms": 20.253, "learn_throughput": 59249.672, "synch_weights_time_ms": 0.58}, "counters": {"num_env_steps_sampled": 2099040, "num_env_steps_trained": 2099040, "num_agent_steps_sampled": 2099040, "num_agent_steps_trained": 2099040}, "done": false, "episodes_total": 6848, "training_iteration": 1506, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-31-01", "timestamp": 1691238661, "time_this_iter_s": 10.411428213119507, "time_total_s": 19375.642605304718, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 428.831814289093, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 24.65333333333333, "ram_util_percent": 69.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.13551839192706, "policy_loss": -3048518.1848958335, "vf_loss": 3180947.3958333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3015.5, "diff_num_grad_updates_vs_sampler_policy": 3014.5}}, "num_env_steps_sampled": 2103840, "num_env_steps_trained": 2103840, "num_agent_steps_sampled": 2103840, "num_agent_steps_trained": 2103840}, "sampler_results": {"episode_reward_max": -3811.1814284063425, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3989.976022396464, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.372788801684231, "mean_inference_ms": 0.23019948498603499, "mean_action_processing_ms": 0.056917613017172, "mean_env_wait_ms": 0.49229244017467805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025818347930908203, "StateBufferConnector_ms": 0.001706838607788086, "ViewRequirementAgentConnector_ms": 0.04363584518432617}}, "episode_reward_max": -3811.1814284063425, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3989.976022396464, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3841.7380753754073, -3942.775191431736, -3885.6308823542026, -3993.849958946887, -3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.372788801684231, "mean_inference_ms": 0.23019948498603499, "mean_action_processing_ms": 0.056917613017172, "mean_env_wait_ms": 0.49229244017467805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025818347930908203, "StateBufferConnector_ms": 0.001706838607788086, "ViewRequirementAgentConnector_ms": 0.04363584518432617}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2103840, "num_agent_steps_trained": 2103840, "num_env_steps_sampled": 2103840, "num_env_steps_trained": 2103840, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 460.84591160517687, "num_env_steps_trained_throughput_per_sec": 460.84591160517687, "timesteps_total": 2103840, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2103840, "timers": {"training_iteration_time_ms": 2601.565, "sample_time_ms": 2580.487, "load_time_ms": 0.419, "load_throughput": 2864961.749, "learn_time_ms": 20.056, "learn_throughput": 59832.512, "synch_weights_time_ms": 0.565}, "counters": {"num_env_steps_sampled": 2103840, "num_env_steps_trained": 2103840, "num_agent_steps_sampled": 2103840, "num_agent_steps_trained": 2103840}, "done": false, "episodes_total": 6852, "training_iteration": 1507, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-31-11", "timestamp": 1691238671, "time_this_iter_s": 10.417779922485352, "time_total_s": 19386.060385227203, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 439.24959421157837, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 23.313333333333333, "ram_util_percent": 68.92}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.02373758951825, "policy_loss": -2648707.5859375, "vf_loss": 3358085.909722222}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3087.5, "diff_num_grad_updates_vs_sampler_policy": 3086.5}}, "num_env_steps_sampled": 2108640, "num_env_steps_trained": 2108640, "num_agent_steps_sampled": 2108640, "num_agent_steps_trained": 2108640}, "sampler_results": {"episode_reward_max": -3811.1814284063425, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3996.8935942053254, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.372780155590517, "mean_inference_ms": 0.23020214775975012, "mean_action_processing_ms": 0.056920065831583246, "mean_env_wait_ms": 0.4917763095942563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025773048400878906, "StateBufferConnector_ms": 0.0017080307006835938, "ViewRequirementAgentConnector_ms": 0.043643951416015625}}, "episode_reward_max": -3811.1814284063425, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3996.8935942053254, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3978.2670133084025, -3928.2491472914703, -3919.1348138954377, -3850.06955487394, -4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.372780155590517, "mean_inference_ms": 0.23020214775975012, "mean_action_processing_ms": 0.056920065831583246, "mean_env_wait_ms": 0.4917763095942563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025773048400878906, "StateBufferConnector_ms": 0.0017080307006835938, "ViewRequirementAgentConnector_ms": 0.043643951416015625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2108640, "num_agent_steps_trained": 2108640, "num_env_steps_sampled": 2108640, "num_env_steps_trained": 2108640, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 457.83290937647575, "num_env_steps_trained_throughput_per_sec": 457.83290937647575, "timesteps_total": 2108640, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2108640, "timers": {"training_iteration_time_ms": 2608.672, "sample_time_ms": 2587.476, "load_time_ms": 0.42, "load_throughput": 2854562.613, "learn_time_ms": 20.172, "learn_throughput": 59488.119, "synch_weights_time_ms": 0.566}, "counters": {"num_env_steps_sampled": 2108640, "num_env_steps_trained": 2108640, "num_agent_steps_sampled": 2108640, "num_agent_steps_trained": 2108640}, "done": false, "episodes_total": 6856, "training_iteration": 1508, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-31-22", "timestamp": 1691238682, "time_this_iter_s": 10.486309051513672, "time_total_s": 19396.546694278717, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 449.73590326309204, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 23.719999999999995, "ram_util_percent": 68.80666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.2881334092882, "policy_loss": -2344248.607313368, "vf_loss": 3425351.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3159.5, "diff_num_grad_updates_vs_sampler_policy": 3158.5}}, "num_env_steps_sampled": 2113440, "num_env_steps_trained": 2113440, "num_agent_steps_sampled": 2113440, "num_agent_steps_trained": 2113440}, "sampler_results": {"episode_reward_max": -3811.1814284063425, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -4000.170516474073, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3727594699963046, "mean_inference_ms": 0.2302074767342448, "mean_action_processing_ms": 0.05692289004908356, "mean_env_wait_ms": 0.49130482908823325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025773048400878906, "StateBufferConnector_ms": 0.0017049312591552734, "ViewRequirementAgentConnector_ms": 0.04370284080505371}}, "episode_reward_max": -3811.1814284063425, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -4000.170516474073, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4043.6969231872085, -3977.408487058361, -3903.0116730076907, -3856.1479403840426, -3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3727594699963046, "mean_inference_ms": 0.2302074767342448, "mean_action_processing_ms": 0.05692289004908356, "mean_env_wait_ms": 0.49130482908823325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025773048400878906, "StateBufferConnector_ms": 0.0017049312591552734, "ViewRequirementAgentConnector_ms": 0.04370284080505371}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2113440, "num_agent_steps_trained": 2113440, "num_env_steps_sampled": 2113440, "num_env_steps_trained": 2113440, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 460.75743322937797, "num_env_steps_trained_throughput_per_sec": 460.75743322937797, "timesteps_total": 2113440, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2113440, "timers": {"training_iteration_time_ms": 2611.08, "sample_time_ms": 2589.876, "load_time_ms": 0.421, "load_throughput": 2850359.497, "learn_time_ms": 20.176, "learn_throughput": 59476.028, "synch_weights_time_ms": 0.569}, "counters": {"num_env_steps_sampled": 2113440, "num_env_steps_trained": 2113440, "num_agent_steps_sampled": 2113440, "num_agent_steps_trained": 2113440}, "done": false, "episodes_total": 6860, "training_iteration": 1509, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-31-32", "timestamp": 1691238692, "time_this_iter_s": 10.419826745986938, "time_total_s": 19406.966521024704, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 460.155730009079, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 27.628571428571426, "ram_util_percent": 68.74285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.1988711886936, "policy_loss": -445065.37543402775, "vf_loss": 2994568.7291666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3231.5, "diff_num_grad_updates_vs_sampler_policy": 3230.5}}, "num_env_steps_sampled": 2118240, "num_env_steps_trained": 2118240, "num_agent_steps_sampled": 2118240, "num_agent_steps_trained": 2118240}, "sampler_results": {"episode_reward_max": -3811.1814284063425, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3999.7278375252768, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3727470955646242, "mean_inference_ms": 0.2302122480518209, "mean_action_processing_ms": 0.056925556890186656, "mean_env_wait_ms": 0.4908634442379072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002566814422607422, "StateBufferConnector_ms": 0.0017042160034179688, "ViewRequirementAgentConnector_ms": 0.0436396598815918}}, "episode_reward_max": -3811.1814284063425, "episode_reward_min": -4290.31371570862, "episode_reward_mean": -3999.7278375252768, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3919.084352664769, -4290.31371570862, -3840.8736611888844, -4014.7957461788583, -3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3727470955646242, "mean_inference_ms": 0.2302122480518209, "mean_action_processing_ms": 0.056925556890186656, "mean_env_wait_ms": 0.4908634442379072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002566814422607422, "StateBufferConnector_ms": 0.0017042160034179688, "ViewRequirementAgentConnector_ms": 0.0436396598815918}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2118240, "num_agent_steps_trained": 2118240, "num_env_steps_sampled": 2118240, "num_env_steps_trained": 2118240, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 461.4093559120103, "num_env_steps_trained_throughput_per_sec": 461.4093559120103, "timesteps_total": 2118240, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2118240, "timers": {"training_iteration_time_ms": 2602.974, "sample_time_ms": 2581.898, "load_time_ms": 0.423, "load_throughput": 2837504.115, "learn_time_ms": 20.055, "learn_throughput": 59836.354, "synch_weights_time_ms": 0.561}, "counters": {"num_env_steps_sampled": 2118240, "num_env_steps_trained": 2118240, "num_agent_steps_sampled": 2118240, "num_agent_steps_trained": 2118240}, "done": false, "episodes_total": 6864, "training_iteration": 1510, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-31-43", "timestamp": 1691238703, "time_this_iter_s": 10.405014038085938, "time_total_s": 19417.37153506279, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 470.5607440471649, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 24.38, "ram_util_percent": 68.80000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.2915852864583, "policy_loss": -1189676.3311631945, "vf_loss": 3108715.076388889}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3303.5, "diff_num_grad_updates_vs_sampler_policy": 3302.5}}, "num_env_steps_sampled": 2123040, "num_env_steps_trained": 2123040, "num_agent_steps_sampled": 2123040, "num_agent_steps_trained": 2123040}, "sampler_results": {"episode_reward_max": -3811.1814284063425, "episode_reward_min": -4227.831890184065, "episode_reward_mean": -3994.945323589541, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.372737022990069, "mean_inference_ms": 0.230214555587031, "mean_action_processing_ms": 0.05692770455924613, "mean_env_wait_ms": 0.4904486305477498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025680065155029297, "StateBufferConnector_ms": 0.0017132759094238281, "ViewRequirementAgentConnector_ms": 0.043700456619262695}}, "episode_reward_max": -3811.1814284063425, "episode_reward_min": -4227.831890184065, "episode_reward_mean": -3994.945323589541, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3816.61089768592, -3887.88861848602, -3925.2190171508337, -4175.3127845206145, -4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.372737022990069, "mean_inference_ms": 0.230214555587031, "mean_action_processing_ms": 0.05692770455924613, "mean_env_wait_ms": 0.4904486305477498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025680065155029297, "StateBufferConnector_ms": 0.0017132759094238281, "ViewRequirementAgentConnector_ms": 0.043700456619262695}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2123040, "num_agent_steps_trained": 2123040, "num_env_steps_sampled": 2123040, "num_env_steps_trained": 2123040, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 461.5826571475048, "num_env_steps_trained_throughput_per_sec": 461.5826571475048, "timesteps_total": 2123040, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2123040, "timers": {"training_iteration_time_ms": 2604.33, "sample_time_ms": 2583.423, "load_time_ms": 0.423, "load_throughput": 2833989.189, "learn_time_ms": 19.89, "learn_throughput": 60333.204, "synch_weights_time_ms": 0.557}, "counters": {"num_env_steps_sampled": 2123040, "num_env_steps_trained": 2123040, "num_agent_steps_sampled": 2123040, "num_agent_steps_trained": 2123040}, "done": false, "episodes_total": 6868, "training_iteration": 1511, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-31-53", "timestamp": 1691238713, "time_this_iter_s": 10.401262998580933, "time_total_s": 19427.77279806137, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 480.96200704574585, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 26.793333333333337, "ram_util_percent": 68.94666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.2e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -321.85377332899304, "policy_loss": -1100001.7799479167, "vf_loss": 3217353.5555555555}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3375.5, "diff_num_grad_updates_vs_sampler_policy": 3374.5}}, "num_env_steps_sampled": 2127840, "num_env_steps_trained": 2127840, "num_agent_steps_sampled": 2127840, "num_agent_steps_trained": 2127840}, "sampler_results": {"episode_reward_max": -3811.1814284063425, "episode_reward_min": -4227.831890184065, "episode_reward_mean": -3994.641324715243, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3727389635023826, "mean_inference_ms": 0.2302145390396532, "mean_action_processing_ms": 0.05692930315040783, "mean_env_wait_ms": 0.4900540216020856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002574920654296875, "StateBufferConnector_ms": 0.0017180442810058594, "ViewRequirementAgentConnector_ms": 0.04370403289794922}}, "episode_reward_max": -3811.1814284063425, "episode_reward_min": -4227.831890184065, "episode_reward_mean": -3994.641324715243, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4028.872587960596, -4227.772813504845, -3858.139189392885, -4145.493277693318, -3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3727389635023826, "mean_inference_ms": 0.2302145390396532, "mean_action_processing_ms": 0.05692930315040783, "mean_env_wait_ms": 0.4900540216020856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002574920654296875, "StateBufferConnector_ms": 0.0017180442810058594, "ViewRequirementAgentConnector_ms": 0.04370403289794922}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2127840, "num_agent_steps_trained": 2127840, "num_env_steps_sampled": 2127840, "num_env_steps_trained": 2127840, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 460.9685444375887, "num_env_steps_trained_throughput_per_sec": 460.9685444375887, "timesteps_total": 2127840, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2127840, "timers": {"training_iteration_time_ms": 2600.177, "sample_time_ms": 2579.394, "load_time_ms": 0.419, "load_throughput": 2863169.008, "learn_time_ms": 19.776, "learn_throughput": 60679.799, "synch_weights_time_ms": 0.551}, "counters": {"num_env_steps_sampled": 2127840, "num_env_steps_trained": 2127840, "num_agent_steps_sampled": 2127840, "num_agent_steps_trained": 2127840}, "done": false, "episodes_total": 6872, "training_iteration": 1512, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-32-03", "timestamp": 1691238723, "time_this_iter_s": 10.414921045303345, "time_total_s": 19438.187719106674, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 491.3769280910492, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 34.086666666666666, "ram_util_percent": 68.91333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.133333333333334e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.34920925564234, "policy_loss": -1399260.1684027778, "vf_loss": 3217219.9305555555}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3447.5, "diff_num_grad_updates_vs_sampler_policy": 3446.5}}, "num_env_steps_sampled": 2132640, "num_env_steps_trained": 2132640, "num_agent_steps_sampled": 2132640, "num_agent_steps_trained": 2132640}, "sampler_results": {"episode_reward_max": -3811.1814284063425, "episode_reward_min": -4227.831890184065, "episode_reward_mean": -3993.0568667802336, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3727394692949315, "mean_inference_ms": 0.23021366951687924, "mean_action_processing_ms": 0.05693042952944614, "mean_env_wait_ms": 0.4896802777805901, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025806427001953125, "StateBufferConnector_ms": 0.0017168521881103516, "ViewRequirementAgentConnector_ms": 0.04370546340942383}}, "episode_reward_max": -3811.1814284063425, "episode_reward_min": -4227.831890184065, "episode_reward_mean": -3993.0568667802336, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3859.822842381103, -3811.1814284063425, -3961.8646066289193, -3994.2838364573695, -3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3727394692949315, "mean_inference_ms": 0.23021366951687924, "mean_action_processing_ms": 0.05693042952944614, "mean_env_wait_ms": 0.4896802777805901, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025806427001953125, "StateBufferConnector_ms": 0.0017168521881103516, "ViewRequirementAgentConnector_ms": 0.04370546340942383}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2132640, "num_agent_steps_trained": 2132640, "num_env_steps_sampled": 2132640, "num_env_steps_trained": 2132640, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 462.6785230935716, "num_env_steps_trained_throughput_per_sec": 462.6785230935716, "timesteps_total": 2132640, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2132640, "timers": {"training_iteration_time_ms": 2601.309, "sample_time_ms": 2580.608, "load_time_ms": 0.418, "load_throughput": 2873467.002, "learn_time_ms": 19.694, "learn_throughput": 60933.756, "synch_weights_time_ms": 0.553}, "counters": {"num_env_steps_sampled": 2132640, "num_env_steps_trained": 2132640, "num_agent_steps_sampled": 2132640, "num_agent_steps_trained": 2132640}, "done": false, "episodes_total": 6876, "training_iteration": 1513, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-32-14", "timestamp": 1691238734, "time_this_iter_s": 10.376402854919434, "time_total_s": 19448.564121961594, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 501.7533309459686, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 35.07142857142857, "ram_util_percent": 68.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.0666666666666673e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.3323262532552, "policy_loss": -1116867.6627604167, "vf_loss": 3395140.4791666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3519.5, "diff_num_grad_updates_vs_sampler_policy": 3518.5}}, "num_env_steps_sampled": 2137440, "num_env_steps_trained": 2137440, "num_agent_steps_sampled": 2137440, "num_agent_steps_trained": 2137440}, "sampler_results": {"episode_reward_max": -3815.2386478269286, "episode_reward_min": -4227.831890184065, "episode_reward_mean": -3995.7255426197967, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3727402616083126, "mean_inference_ms": 0.2302104585598476, "mean_action_processing_ms": 0.05693098347593693, "mean_env_wait_ms": 0.4893173799182831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025801658630371094, "StateBufferConnector_ms": 0.0017168521881103516, "ViewRequirementAgentConnector_ms": 0.043723106384277344}}, "episode_reward_max": -3815.2386478269286, "episode_reward_min": -4227.831890184065, "episode_reward_mean": -3995.7255426197967, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3967.3595252964465, -4218.054488946926, -3906.300789738077, -4028.8693023553274, -4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3727402616083126, "mean_inference_ms": 0.2302104585598476, "mean_action_processing_ms": 0.05693098347593693, "mean_env_wait_ms": 0.4893173799182831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025801658630371094, "StateBufferConnector_ms": 0.0017168521881103516, "ViewRequirementAgentConnector_ms": 0.043723106384277344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2137440, "num_agent_steps_trained": 2137440, "num_env_steps_sampled": 2137440, "num_env_steps_trained": 2137440, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 460.90409655739126, "num_env_steps_trained_throughput_per_sec": 460.90409655739126, "timesteps_total": 2137440, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2137440, "timers": {"training_iteration_time_ms": 2597.493, "sample_time_ms": 2576.783, "load_time_ms": 0.422, "load_throughput": 2845042.564, "learn_time_ms": 19.69, "learn_throughput": 60944.75, "synch_weights_time_ms": 0.56}, "counters": {"num_env_steps_sampled": 2137440, "num_env_steps_trained": 2137440, "num_agent_steps_sampled": 2137440, "num_agent_steps_trained": 2137440}, "done": false, "episodes_total": 6880, "training_iteration": 1514, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-32-24", "timestamp": 1691238744, "time_this_iter_s": 10.416453123092651, "time_total_s": 19458.980575084686, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 512.1697840690613, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 48.64666666666667, "ram_util_percent": 69.17333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.2055901421441, "policy_loss": -1214154.0286458333, "vf_loss": 3390101.5625}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3591.5, "diff_num_grad_updates_vs_sampler_policy": 3590.5}}, "num_env_steps_sampled": 2142240, "num_env_steps_trained": 2142240, "num_agent_steps_sampled": 2142240, "num_agent_steps_trained": 2142240}, "sampler_results": {"episode_reward_max": -3815.2386478269286, "episode_reward_min": -4227.831890184065, "episode_reward_mean": -3995.5232742909975, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3727313597862707, "mean_inference_ms": 0.2302079476624948, "mean_action_processing_ms": 0.05693148617065523, "mean_env_wait_ms": 0.48896963306687624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002574920654296875, "StateBufferConnector_ms": 0.001718759536743164, "ViewRequirementAgentConnector_ms": 0.04373645782470703}}, "episode_reward_max": -3815.2386478269286, "episode_reward_min": -4227.831890184065, "episode_reward_mean": -3995.5232742909975, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4000.0635303722547, -4034.4857633045867, -4104.772835506389, -3889.2391197321585, -4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3727313597862707, "mean_inference_ms": 0.2302079476624948, "mean_action_processing_ms": 0.05693148617065523, "mean_env_wait_ms": 0.48896963306687624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002574920654296875, "StateBufferConnector_ms": 0.001718759536743164, "ViewRequirementAgentConnector_ms": 0.04373645782470703}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2142240, "num_agent_steps_trained": 2142240, "num_env_steps_sampled": 2142240, "num_env_steps_trained": 2142240, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 461.5150857102328, "num_env_steps_trained_throughput_per_sec": 461.5150857102328, "timesteps_total": 2142240, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2142240, "timers": {"training_iteration_time_ms": 2600.792, "sample_time_ms": 2579.981, "load_time_ms": 0.425, "load_throughput": 2825398.451, "learn_time_ms": 19.782, "learn_throughput": 60659.98, "synch_weights_time_ms": 0.566}, "counters": {"num_env_steps_sampled": 2142240, "num_env_steps_trained": 2142240, "num_agent_steps_sampled": 2142240, "num_agent_steps_trained": 2142240}, "done": false, "episodes_total": 6884, "training_iteration": 1515, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-32-35", "timestamp": 1691238755, "time_this_iter_s": 10.402594089508057, "time_total_s": 19469.383169174194, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 522.5723781585693, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 39.00000000000001, "ram_util_percent": 69.76}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.31592135959204, "policy_loss": -646598.0125868055, "vf_loss": 3035204.923611111}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3663.5, "diff_num_grad_updates_vs_sampler_policy": 3662.5}}, "num_env_steps_sampled": 2147040, "num_env_steps_trained": 2147040, "num_agent_steps_sampled": 2147040, "num_agent_steps_trained": 2147040}, "sampler_results": {"episode_reward_max": -3815.2386478269286, "episode_reward_min": -4227.831890184065, "episode_reward_mean": -3991.685346290449, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3727217916588053, "mean_inference_ms": 0.23021751781836194, "mean_action_processing_ms": 0.05693210789036592, "mean_env_wait_ms": 0.48862096995785026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002572298049926758, "StateBufferConnector_ms": 0.0017147064208984375, "ViewRequirementAgentConnector_ms": 0.043749094009399414}}, "episode_reward_max": -3815.2386478269286, "episode_reward_min": -4227.831890184065, "episode_reward_mean": -3991.685346290449, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4064.5103352551905, -4098.41894922661, -3815.2386478269286, -3913.648069202032, -4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3727217916588053, "mean_inference_ms": 0.23021751781836194, "mean_action_processing_ms": 0.05693210789036592, "mean_env_wait_ms": 0.48862096995785026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002572298049926758, "StateBufferConnector_ms": 0.0017147064208984375, "ViewRequirementAgentConnector_ms": 0.043749094009399414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2147040, "num_agent_steps_trained": 2147040, "num_env_steps_sampled": 2147040, "num_env_steps_trained": 2147040, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 461.9721867521766, "num_env_steps_trained_throughput_per_sec": 461.9721867521766, "timesteps_total": 2147040, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2147040, "timers": {"training_iteration_time_ms": 2600.892, "sample_time_ms": 2579.805, "load_time_ms": 0.425, "load_throughput": 2826509.126, "learn_time_ms": 20.047, "learn_throughput": 59860.122, "synch_weights_time_ms": 0.577}, "counters": {"num_env_steps_sampled": 2147040, "num_env_steps_trained": 2147040, "num_agent_steps_sampled": 2147040, "num_agent_steps_trained": 2147040}, "done": false, "episodes_total": 6888, "training_iteration": 1516, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-32-45", "timestamp": 1691238765, "time_this_iter_s": 10.392568826675415, "time_total_s": 19479.77573800087, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 532.9649469852448, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 31.828571428571426, "ram_util_percent": 67.68571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.2352600097656, "policy_loss": -2317596.763888889, "vf_loss": 3226031.388888889}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3735.5, "diff_num_grad_updates_vs_sampler_policy": 3734.5}}, "num_env_steps_sampled": 2151840, "num_env_steps_trained": 2151840, "num_agent_steps_sampled": 2151840, "num_agent_steps_trained": 2151840}, "sampler_results": {"episode_reward_max": -3817.734941124621, "episode_reward_min": -4227.831890184065, "episode_reward_mean": -3992.748551470497, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3727028006564916, "mean_inference_ms": 0.23022501108408175, "mean_action_processing_ms": 0.056932378055721725, "mean_env_wait_ms": 0.48825538851385003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002576112747192383, "StateBufferConnector_ms": 0.0017206668853759766, "ViewRequirementAgentConnector_ms": 0.04374432563781738}}, "episode_reward_max": -3817.734941124621, "episode_reward_min": -4227.831890184065, "episode_reward_mean": -3992.748551470497, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4014.0185424302467, -3961.8451697316937, -4052.853071237695, -3817.734941124621, -4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3727028006564916, "mean_inference_ms": 0.23022501108408175, "mean_action_processing_ms": 0.056932378055721725, "mean_env_wait_ms": 0.48825538851385003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002576112747192383, "StateBufferConnector_ms": 0.0017206668853759766, "ViewRequirementAgentConnector_ms": 0.04374432563781738}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2151840, "num_agent_steps_trained": 2151840, "num_env_steps_sampled": 2151840, "num_env_steps_trained": 2151840, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 464.87101914115095, "num_env_steps_trained_throughput_per_sec": 464.87101914115095, "timesteps_total": 2151840, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2151840, "timers": {"training_iteration_time_ms": 2590.746, "sample_time_ms": 2569.791, "load_time_ms": 0.422, "load_throughput": 2846651.66, "learn_time_ms": 19.923, "learn_throughput": 60232.267, "synch_weights_time_ms": 0.572}, "counters": {"num_env_steps_sampled": 2151840, "num_env_steps_trained": 2151840, "num_agent_steps_sampled": 2151840, "num_agent_steps_trained": 2151840}, "done": false, "episodes_total": 6892, "training_iteration": 1517, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-32-55", "timestamp": 1691238775, "time_this_iter_s": 10.327494859695435, "time_total_s": 19490.103232860565, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 543.2924418449402, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 31.740000000000002, "ram_util_percent": 67.88000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.2701144748264, "policy_loss": -1294280.3667534722, "vf_loss": 3286408.972222222}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3807.5, "diff_num_grad_updates_vs_sampler_policy": 3806.5}}, "num_env_steps_sampled": 2156640, "num_env_steps_trained": 2156640, "num_agent_steps_sampled": 2156640, "num_agent_steps_trained": 2156640}, "sampler_results": {"episode_reward_max": -3818.644746091456, "episode_reward_min": -4227.831890184065, "episode_reward_mean": -3997.176591905545, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3726831879921872, "mean_inference_ms": 0.23023216358353304, "mean_action_processing_ms": 0.056932612401234234, "mean_env_wait_ms": 0.4879083453101789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002573251724243164, "StateBufferConnector_ms": 0.0017254352569580078, "ViewRequirementAgentConnector_ms": 0.043794870376586914}}, "episode_reward_max": -3818.644746091456, "episode_reward_min": -4227.831890184065, "episode_reward_mean": -3997.176591905545, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4091.2155704150905, -3875.0048482100638, -4075.654297748476, -4045.3303084202157, -4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3726831879921872, "mean_inference_ms": 0.23023216358353304, "mean_action_processing_ms": 0.056932612401234234, "mean_env_wait_ms": 0.4879083453101789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002573251724243164, "StateBufferConnector_ms": 0.0017254352569580078, "ViewRequirementAgentConnector_ms": 0.043794870376586914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2156640, "num_agent_steps_trained": 2156640, "num_env_steps_sampled": 2156640, "num_env_steps_trained": 2156640, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 465.011699285404, "num_env_steps_trained_throughput_per_sec": 465.011699285404, "timesteps_total": 2156640, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2156640, "timers": {"training_iteration_time_ms": 2582.249, "sample_time_ms": 2561.508, "load_time_ms": 0.421, "load_throughput": 2848262.577, "learn_time_ms": 19.723, "learn_throughput": 60843.081, "synch_weights_time_ms": 0.559}, "counters": {"num_env_steps_sampled": 2156640, "num_env_steps_trained": 2156640, "num_agent_steps_sampled": 2156640, "num_agent_steps_trained": 2156640}, "done": false, "episodes_total": 6896, "training_iteration": 1518, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-33-06", "timestamp": 1691238786, "time_this_iter_s": 10.324405908584595, "time_total_s": 19500.42763876915, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 553.6168477535248, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 36.06666666666667, "ram_util_percent": 69.23333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -321.8485463460286, "policy_loss": -2131082.992621528, "vf_loss": 3270708.784722222}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3879.5, "diff_num_grad_updates_vs_sampler_policy": 3878.5}}, "num_env_steps_sampled": 2161440, "num_env_steps_trained": 2161440, "num_agent_steps_sampled": 2161440, "num_agent_steps_trained": 2161440}, "sampler_results": {"episode_reward_max": -3818.644746091456, "episode_reward_min": -4227.831890184065, "episode_reward_mean": -3996.4974321269633, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3726584221649916, "mean_inference_ms": 0.23023681257002088, "mean_action_processing_ms": 0.056932260214080356, "mean_env_wait_ms": 0.4875639926743217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002568960189819336, "StateBufferConnector_ms": 0.001718759536743164, "ViewRequirementAgentConnector_ms": 0.04380059242248535}}, "episode_reward_max": -3818.644746091456, "episode_reward_min": -4227.831890184065, "episode_reward_mean": -3996.4974321269633, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4030.3149012231224, -4001.93955994057, -3975.62365687813, -4193.0064370936725, -3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3726584221649916, "mean_inference_ms": 0.23023681257002088, "mean_action_processing_ms": 0.056932260214080356, "mean_env_wait_ms": 0.4875639926743217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002568960189819336, "StateBufferConnector_ms": 0.001718759536743164, "ViewRequirementAgentConnector_ms": 0.04380059242248535}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2161440, "num_agent_steps_trained": 2161440, "num_env_steps_sampled": 2161440, "num_env_steps_trained": 2161440, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 466.24394371101585, "num_env_steps_trained_throughput_per_sec": 466.24394371101585, "timesteps_total": 2161440, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2161440, "timers": {"training_iteration_time_ms": 2577.022, "sample_time_ms": 2556.291, "load_time_ms": 0.419, "load_throughput": 2860565.388, "learn_time_ms": 19.71, "learn_throughput": 60881.572, "synch_weights_time_ms": 0.563}, "counters": {"num_env_steps_sampled": 2161440, "num_env_steps_trained": 2161440, "num_agent_steps_sampled": 2161440, "num_agent_steps_trained": 2161440}, "done": false, "episodes_total": 6900, "training_iteration": 1519, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-33-16", "timestamp": 1691238796, "time_this_iter_s": 10.29716181755066, "time_total_s": 19510.7248005867, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 563.9140095710754, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 36.92857142857143, "ram_util_percent": 67.98571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.52339341905383, "policy_loss": -1039205.0251736111, "vf_loss": 3150864.111111111}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3951.5, "diff_num_grad_updates_vs_sampler_policy": 3950.5}}, "num_env_steps_sampled": 2166240, "num_env_steps_trained": 2166240, "num_agent_steps_sampled": 2166240, "num_agent_steps_trained": 2166240}, "sampler_results": {"episode_reward_max": -3818.644746091456, "episode_reward_min": -4227.831890184065, "episode_reward_mean": -3993.313588505339, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3726250838547622, "mean_inference_ms": 0.23023892465960966, "mean_action_processing_ms": 0.056931432887614236, "mean_env_wait_ms": 0.4872163962182978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025696754455566406, "StateBufferConnector_ms": 0.001722097396850586, "ViewRequirementAgentConnector_ms": 0.04382634162902832}}, "episode_reward_max": -3818.644746091456, "episode_reward_min": -4227.831890184065, "episode_reward_mean": -3993.313588505339, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3856.6600947408733, -4185.9058266366965, -3944.0320388894193, -3995.9975240079148, -4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3726250838547622, "mean_inference_ms": 0.23023892465960966, "mean_action_processing_ms": 0.056931432887614236, "mean_env_wait_ms": 0.4872163962182978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025696754455566406, "StateBufferConnector_ms": 0.001722097396850586, "ViewRequirementAgentConnector_ms": 0.04382634162902832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2166240, "num_agent_steps_trained": 2166240, "num_env_steps_sampled": 2166240, "num_env_steps_trained": 2166240, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 465.05170054312157, "num_env_steps_trained_throughput_per_sec": 465.05170054312157, "timesteps_total": 2166240, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2166240, "timers": {"training_iteration_time_ms": 2576.107, "sample_time_ms": 2555.069, "load_time_ms": 0.423, "load_throughput": 2834627.619, "learn_time_ms": 19.999, "learn_throughput": 60002.847, "synch_weights_time_ms": 0.578}, "counters": {"num_env_steps_sampled": 2166240, "num_env_steps_trained": 2166240, "num_agent_steps_sampled": 2166240, "num_agent_steps_trained": 2166240}, "done": false, "episodes_total": 6904, "training_iteration": 1520, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-33-26", "timestamp": 1691238806, "time_this_iter_s": 10.323453903198242, "time_total_s": 19521.0482544899, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 574.2374634742737, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 39.053333333333335, "ram_util_percent": 68.22666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -321.7722676595052, "policy_loss": -1430074.2899305555, "vf_loss": 3293614.138888889}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4023.5, "diff_num_grad_updates_vs_sampler_policy": 4022.5}}, "num_env_steps_sampled": 2171040, "num_env_steps_trained": 2171040, "num_agent_steps_sampled": 2171040, "num_agent_steps_trained": 2171040}, "sampler_results": {"episode_reward_max": -3818.644746091456, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3998.0494490112287, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.372581857095761, "mean_inference_ms": 0.23024186433636487, "mean_action_processing_ms": 0.05693080269550904, "mean_env_wait_ms": 0.48688311756704394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025703907012939453, "StateBufferConnector_ms": 0.0017240047454833984, "ViewRequirementAgentConnector_ms": 0.04382896423339844}}, "episode_reward_max": -3818.644746091456, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3998.0494490112287, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4011.0766114588428, -4178.454044287439, -4085.8738839422977, -3951.8857253890264, -3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.372581857095761, "mean_inference_ms": 0.23024186433636487, "mean_action_processing_ms": 0.05693080269550904, "mean_env_wait_ms": 0.48688311756704394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025703907012939453, "StateBufferConnector_ms": 0.0017240047454833984, "ViewRequirementAgentConnector_ms": 0.04382896423339844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2171040, "num_agent_steps_trained": 2171040, "num_env_steps_sampled": 2171040, "num_env_steps_trained": 2171040, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 462.0582054473667, "num_env_steps_trained_throughput_per_sec": 462.0582054473667, "timesteps_total": 2171040, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2171040, "timers": {"training_iteration_time_ms": 2583.908, "sample_time_ms": 2562.918, "load_time_ms": 0.424, "load_throughput": 2829210.118, "learn_time_ms": 19.962, "learn_throughput": 60114.932, "synch_weights_time_ms": 0.567}, "counters": {"num_env_steps_sampled": 2171040, "num_env_steps_trained": 2171040, "num_agent_steps_sampled": 2171040, "num_agent_steps_trained": 2171040}, "done": false, "episodes_total": 6908, "training_iteration": 1521, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-33-37", "timestamp": 1691238817, "time_this_iter_s": 10.390407800674438, "time_total_s": 19531.438662290573, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 584.6278712749481, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 35.919999999999995, "ram_util_percent": 69.21333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.35284932454425, "policy_loss": -981255.6193576389, "vf_loss": 3071149.0625}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4095.5, "diff_num_grad_updates_vs_sampler_policy": 4094.5}}, "num_env_steps_sampled": 2175840, "num_env_steps_trained": 2175840, "num_agent_steps_sampled": 2175840, "num_agent_steps_trained": 2175840}, "sampler_results": {"episode_reward_max": -3818.644746091456, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3992.3179357487843, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.372551212744055, "mean_inference_ms": 0.23024805628016723, "mean_action_processing_ms": 0.05693061759020066, "mean_env_wait_ms": 0.48656385642360817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002571582794189453, "StateBufferConnector_ms": 0.001722574234008789, "ViewRequirementAgentConnector_ms": 0.043811798095703125}}, "episode_reward_max": -3818.644746091456, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3992.3179357487843, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3924.1412879909317, -3974.6802437251317, -4050.060633807993, -3968.3483188486084, -3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.372551212744055, "mean_inference_ms": 0.23024805628016723, "mean_action_processing_ms": 0.05693061759020066, "mean_env_wait_ms": 0.48656385642360817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002571582794189453, "StateBufferConnector_ms": 0.001722574234008789, "ViewRequirementAgentConnector_ms": 0.043811798095703125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2175840, "num_agent_steps_trained": 2175840, "num_env_steps_sampled": 2175840, "num_env_steps_trained": 2175840, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 462.0573040624, "num_env_steps_trained_throughput_per_sec": 462.0573040624, "timesteps_total": 2175840, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2175840, "timers": {"training_iteration_time_ms": 2595.568, "sample_time_ms": 2574.557, "load_time_ms": 0.434, "load_throughput": 2766235.12, "learn_time_ms": 19.969, "learn_throughput": 60093.615, "synch_weights_time_ms": 0.571}, "counters": {"num_env_steps_sampled": 2175840, "num_env_steps_trained": 2175840, "num_agent_steps_sampled": 2175840, "num_agent_steps_trained": 2175840}, "done": false, "episodes_total": 6912, "training_iteration": 1522, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-33-47", "timestamp": 1691238827, "time_this_iter_s": 10.390274047851562, "time_total_s": 19541.828936338425, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 595.0181453227997, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 35.82142857142857, "ram_util_percent": 69.59285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.0412326388889, "policy_loss": -1623157.19921875, "vf_loss": 3402008.215277778}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4167.5, "diff_num_grad_updates_vs_sampler_policy": 4166.5}}, "num_env_steps_sampled": 2180640, "num_env_steps_trained": 2180640, "num_agent_steps_sampled": 2180640, "num_agent_steps_trained": 2180640}, "sampler_results": {"episode_reward_max": -3818.644746091456, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3994.33190379093, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.372519509348433, "mean_inference_ms": 0.2302549830249372, "mean_action_processing_ms": 0.05693062293391726, "mean_env_wait_ms": 0.4862562352448039, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025801658630371094, "StateBufferConnector_ms": 0.0017247200012207031, "ViewRequirementAgentConnector_ms": 0.04389548301696777}}, "episode_reward_max": -3818.644746091456, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3994.33190379093, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3891.068766806766, -4154.4072082644025, -4075.66032542855, -3956.367438401157, -4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.372519509348433, "mean_inference_ms": 0.2302549830249372, "mean_action_processing_ms": 0.05693062293391726, "mean_env_wait_ms": 0.4862562352448039, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025801658630371094, "StateBufferConnector_ms": 0.0017247200012207031, "ViewRequirementAgentConnector_ms": 0.04389548301696777}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2180640, "num_agent_steps_trained": 2180640, "num_env_steps_sampled": 2180640, "num_env_steps_trained": 2180640, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 464.27342918625345, "num_env_steps_trained_throughput_per_sec": 464.27342918625345, "timesteps_total": 2180640, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2180640, "timers": {"training_iteration_time_ms": 2589.869, "sample_time_ms": 2568.826, "load_time_ms": 0.432, "load_throughput": 2776458.959, "learn_time_ms": 20.017, "learn_throughput": 59950.317, "synch_weights_time_ms": 0.558}, "counters": {"num_env_steps_sampled": 2180640, "num_env_steps_trained": 2180640, "num_agent_steps_sampled": 2180640, "num_agent_steps_trained": 2180640}, "done": false, "episodes_total": 6916, "training_iteration": 1523, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-33-58", "timestamp": 1691238838, "time_this_iter_s": 10.340939998626709, "time_total_s": 19552.16987633705, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 605.3590853214264, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 40.273333333333326, "ram_util_percent": 69.84666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.33089023166235, "policy_loss": -993652.0603298611, "vf_loss": 3133539.5555555555}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4239.5, "diff_num_grad_updates_vs_sampler_policy": 4238.5}}, "num_env_steps_sampled": 2185440, "num_env_steps_trained": 2185440, "num_agent_steps_sampled": 2185440, "num_agent_steps_trained": 2185440}, "sampler_results": {"episode_reward_max": -3818.644746091456, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3992.104571169369, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3724917678483624, "mean_inference_ms": 0.2302632783061889, "mean_action_processing_ms": 0.05693089983504037, "mean_env_wait_ms": 0.485962478177451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025784969329833984, "StateBufferConnector_ms": 0.0017275810241699219, "ViewRequirementAgentConnector_ms": 0.04388260841369629}}, "episode_reward_max": -3818.644746091456, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3992.104571169369, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4136.060769559751, -3974.860845341209, -4208.290936549874, -4049.5116127067263, -4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3724917678483624, "mean_inference_ms": 0.2302632783061889, "mean_action_processing_ms": 0.05693089983504037, "mean_env_wait_ms": 0.485962478177451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025784969329833984, "StateBufferConnector_ms": 0.0017275810241699219, "ViewRequirementAgentConnector_ms": 0.04388260841369629}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2185440, "num_agent_steps_trained": 2185440, "num_env_steps_sampled": 2185440, "num_env_steps_trained": 2185440, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 464.3370236523902, "num_env_steps_trained_throughput_per_sec": 464.3370236523902, "timesteps_total": 2185440, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2185440, "timers": {"training_iteration_time_ms": 2587.861, "sample_time_ms": 2566.959, "load_time_ms": 0.428, "load_throughput": 2806180.196, "learn_time_ms": 19.892, "learn_throughput": 60326.985, "synch_weights_time_ms": 0.545}, "counters": {"num_env_steps_sampled": 2185440, "num_env_steps_trained": 2185440, "num_agent_steps_sampled": 2185440, "num_agent_steps_trained": 2185440}, "done": false, "episodes_total": 6920, "training_iteration": 1524, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-34-08", "timestamp": 1691238848, "time_this_iter_s": 10.339501857757568, "time_total_s": 19562.50937819481, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 615.698587179184, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 32.76, "ram_util_percent": 68.08666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.2240854899089, "policy_loss": -2617513.4140625, "vf_loss": 3362633.7083333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4311.5, "diff_num_grad_updates_vs_sampler_policy": 4310.5}}, "num_env_steps_sampled": 2190240, "num_env_steps_trained": 2190240, "num_agent_steps_sampled": 2190240, "num_agent_steps_trained": 2190240}, "sampler_results": {"episode_reward_max": -3818.644746091456, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3987.6320006931933, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3724737735121773, "mean_inference_ms": 0.23027323428994356, "mean_action_processing_ms": 0.056931587203110486, "mean_env_wait_ms": 0.48568395138880205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002579212188720703, "StateBufferConnector_ms": 0.0017247200012207031, "ViewRequirementAgentConnector_ms": 0.043854713439941406}}, "episode_reward_max": -3818.644746091456, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3987.6320006931933, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4127.878684739905, -3988.0850290510593, -3920.5885003553585, -3984.981369928998, -4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3724737735121773, "mean_inference_ms": 0.23027323428994356, "mean_action_processing_ms": 0.056931587203110486, "mean_env_wait_ms": 0.48568395138880205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002579212188720703, "StateBufferConnector_ms": 0.0017247200012207031, "ViewRequirementAgentConnector_ms": 0.043854713439941406}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2190240, "num_agent_steps_trained": 2190240, "num_env_steps_sampled": 2190240, "num_env_steps_trained": 2190240, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 457.8527961854915, "num_env_steps_trained_throughput_per_sec": 457.8527961854915, "timesteps_total": 2190240, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2190240, "timers": {"training_iteration_time_ms": 2598.507, "sample_time_ms": 2577.588, "load_time_ms": 0.423, "load_throughput": 2834946.942, "learn_time_ms": 19.906, "learn_throughput": 60282.188, "synch_weights_time_ms": 0.552}, "counters": {"num_env_steps_sampled": 2190240, "num_env_steps_trained": 2190240, "num_agent_steps_sampled": 2190240, "num_agent_steps_trained": 2190240}, "done": false, "episodes_total": 6924, "training_iteration": 1525, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-34-18", "timestamp": 1691238858, "time_this_iter_s": 10.485792398452759, "time_total_s": 19572.99517059326, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 626.1843795776367, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 22.473333333333336, "ram_util_percent": 68.15333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-10, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.0211452907986, "policy_loss": -1683425.3619791667, "vf_loss": 3386337.409722222}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4383.5, "diff_num_grad_updates_vs_sampler_policy": 4382.5}}, "num_env_steps_sampled": 2195040, "num_env_steps_trained": 2195040, "num_agent_steps_sampled": 2195040, "num_agent_steps_trained": 2195040}, "sampler_results": {"episode_reward_max": -3818.644746091456, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3986.224833038761, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3725254906135678, "mean_inference_ms": 0.2303146956185865, "mean_action_processing_ms": 0.05693749248359253, "mean_env_wait_ms": 0.4854635519639015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025823116302490234, "StateBufferConnector_ms": 0.0017278194427490234, "ViewRequirementAgentConnector_ms": 0.04392528533935547}}, "episode_reward_max": -3818.644746091456, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3986.224833038761, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4193.929500326487, -3974.724261733287, -4023.7521399412108, -3840.957063313605, -3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3725254906135678, "mean_inference_ms": 0.2303146956185865, "mean_action_processing_ms": 0.05693749248359253, "mean_env_wait_ms": 0.4854635519639015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025823116302490234, "StateBufferConnector_ms": 0.0017278194427490234, "ViewRequirementAgentConnector_ms": 0.04392528533935547}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2195040, "num_agent_steps_trained": 2195040, "num_env_steps_sampled": 2195040, "num_env_steps_trained": 2195040, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 412.9525594538785, "num_env_steps_trained_throughput_per_sec": 412.9525594538785, "timesteps_total": 2195040, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2195040, "timers": {"training_iteration_time_ms": 2728.749, "sample_time_ms": 2705.12, "load_time_ms": 0.42, "load_throughput": 2853915.174, "learn_time_ms": 22.526, "learn_throughput": 53272.503, "synch_weights_time_ms": 0.638}, "counters": {"num_env_steps_sampled": 2195040, "num_env_steps_trained": 2195040, "num_agent_steps_sampled": 2195040, "num_agent_steps_trained": 2195040}, "done": false, "episodes_total": 6928, "training_iteration": 1526, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-34-30", "timestamp": 1691238870, "time_this_iter_s": 11.625830173492432, "time_total_s": 19584.621000766754, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 637.8102097511292, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 43.881249999999994, "ram_util_percent": 68.725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.999999999999999e-11, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.1620788574219, "policy_loss": -2585939.956597222, "vf_loss": 3416528.986111111}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4455.5, "diff_num_grad_updates_vs_sampler_policy": 4454.5}}, "num_env_steps_sampled": 2199840, "num_env_steps_trained": 2199840, "num_agent_steps_sampled": 2199840, "num_agent_steps_trained": 2199840}, "sampler_results": {"episode_reward_max": -3818.644746091456, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3989.689955530965, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3726014637565291, "mean_inference_ms": 0.2303634375487684, "mean_action_processing_ms": 0.05694450715490748, "mean_env_wait_ms": 0.48528796057661944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002589702606201172, "StateBufferConnector_ms": 0.0017256736755371094, "ViewRequirementAgentConnector_ms": 0.04399371147155762}}, "episode_reward_max": -3818.644746091456, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3989.689955530965, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3825.535808055757, -4038.5149648490046, -3993.9778618556666, -3868.022076074768, -4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3726014637565291, "mean_inference_ms": 0.2303634375487684, "mean_action_processing_ms": 0.05694450715490748, "mean_env_wait_ms": 0.48528796057661944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002589702606201172, "StateBufferConnector_ms": 0.0017256736755371094, "ViewRequirementAgentConnector_ms": 0.04399371147155762}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2199840, "num_agent_steps_trained": 2199840, "num_env_steps_sampled": 2199840, "num_env_steps_trained": 2199840, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 444.39029372305134, "num_env_steps_trained_throughput_per_sec": 444.39029372305134, "timesteps_total": 2199840, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2199840, "timers": {"training_iteration_time_ms": 2767.261, "sample_time_ms": 2743.353, "load_time_ms": 0.422, "load_throughput": 2841508.948, "learn_time_ms": 22.787, "learn_throughput": 52660.727, "synch_weights_time_ms": 0.653}, "counters": {"num_env_steps_sampled": 2199840, "num_env_steps_trained": 2199840, "num_agent_steps_sampled": 2199840, "num_agent_steps_trained": 2199840}, "done": false, "episodes_total": 6932, "training_iteration": 1527, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-34-41", "timestamp": 1691238881, "time_this_iter_s": 10.80385708808899, "time_total_s": 19595.424857854843, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 648.6140668392181, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 36.519999999999996, "ram_util_percent": 69.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.666666666666666e-11, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.31546359592016, "policy_loss": -982115.7499457465, "vf_loss": 3104310.9930555555}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4527.5, "diff_num_grad_updates_vs_sampler_policy": 4526.5}}, "num_env_steps_sampled": 2204640, "num_env_steps_trained": 2204640, "num_agent_steps_sampled": 2204640, "num_agent_steps_trained": 2204640}, "sampler_results": {"episode_reward_max": -3818.644746091456, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3992.1110719612484, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3727031787874113, "mean_inference_ms": 0.23042614358826072, "mean_action_processing_ms": 0.05695413606322658, "mean_env_wait_ms": 0.48514460041303636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002594470977783203, "StateBufferConnector_ms": 0.0017256736755371094, "ViewRequirementAgentConnector_ms": 0.0440220832824707}}, "episode_reward_max": -3818.644746091456, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3992.1110719612484, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4154.192500800524, -3867.3024397880313, -3901.8402810785883, -4170.669518203415, -3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3727031787874113, "mean_inference_ms": 0.23042614358826072, "mean_action_processing_ms": 0.05695413606322658, "mean_env_wait_ms": 0.48514460041303636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002594470977783203, "StateBufferConnector_ms": 0.0017256736755371094, "ViewRequirementAgentConnector_ms": 0.0440220832824707}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2204640, "num_agent_steps_trained": 2204640, "num_env_steps_sampled": 2204640, "num_env_steps_trained": 2204640, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 439.40978625570233, "num_env_steps_trained_throughput_per_sec": 439.40978625570233, "timesteps_total": 2204640, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2204640, "timers": {"training_iteration_time_ms": 2816.651, "sample_time_ms": 2791.832, "load_time_ms": 0.428, "load_throughput": 2804460.244, "learn_time_ms": 23.676, "learn_throughput": 50683.34, "synch_weights_time_ms": 0.668}, "counters": {"num_env_steps_sampled": 2204640, "num_env_steps_trained": 2204640, "num_agent_steps_sampled": 2204640, "num_agent_steps_trained": 2204640}, "done": false, "episodes_total": 6936, "training_iteration": 1528, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-34-52", "timestamp": 1691238892, "time_this_iter_s": 10.925925731658936, "time_total_s": 19606.350783586502, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 659.5399925708771, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 33.40625, "ram_util_percent": 69.78125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.333333333333335e-11, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.40277608235675, "policy_loss": -554704.5316840278, "vf_loss": 2960588.2604166665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4599.5, "diff_num_grad_updates_vs_sampler_policy": 4598.5}}, "num_env_steps_sampled": 2209440, "num_env_steps_trained": 2209440, "num_agent_steps_sampled": 2209440, "num_agent_steps_trained": 2209440}, "sampler_results": {"episode_reward_max": -3795.6746934360763, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3990.7478510971823, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3728319118200722, "mean_inference_ms": 0.2305042479304439, "mean_action_processing_ms": 0.05696645675051757, "mean_env_wait_ms": 0.485060917187554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026044845581054688, "StateBufferConnector_ms": 0.001729726791381836, "ViewRequirementAgentConnector_ms": 0.04418349266052246}}, "episode_reward_max": -3795.6746934360763, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3990.7478510971823, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3992.9938093879186, -4123.305863941374, -3961.1832632957257, -3902.8800158522754, -3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3728319118200722, "mean_inference_ms": 0.2305042479304439, "mean_action_processing_ms": 0.05696645675051757, "mean_env_wait_ms": 0.485060917187554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026044845581054688, "StateBufferConnector_ms": 0.001729726791381836, "ViewRequirementAgentConnector_ms": 0.04418349266052246}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2209440, "num_agent_steps_trained": 2209440, "num_env_steps_sampled": 2209440, "num_env_steps_trained": 2209440, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 434.28754895524713, "num_env_steps_trained_throughput_per_sec": 434.28754895524713, "timesteps_total": 2209440, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2209440, "timers": {"training_iteration_time_ms": 2732.981, "sample_time_ms": 2710.16, "load_time_ms": 0.44, "load_throughput": 2724311.123, "learn_time_ms": 21.739, "learn_throughput": 55200.195, "synch_weights_time_ms": 0.601}, "counters": {"num_env_steps_sampled": 2209440, "num_env_steps_trained": 2209440, "num_agent_steps_sampled": 2209440, "num_agent_steps_trained": 2209440}, "done": false, "episodes_total": 6940, "training_iteration": 1529, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-35-03", "timestamp": 1691238903, "time_this_iter_s": 11.05483603477478, "time_total_s": 19617.405619621277, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 670.5948286056519, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 36.25333333333333, "ram_util_percent": 69.77333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.4052513970269, "policy_loss": -808606.7955729166, "vf_loss": 3051350.7083333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4671.5, "diff_num_grad_updates_vs_sampler_policy": 4670.5}}, "num_env_steps_sampled": 2214240, "num_env_steps_trained": 2214240, "num_agent_steps_sampled": 2214240, "num_agent_steps_trained": 2214240}, "sampler_results": {"episode_reward_max": -3795.6746934360763, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3988.3406329446466, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3729641638899066, "mean_inference_ms": 0.23058346406777283, "mean_action_processing_ms": 0.056978949121565314, "mean_env_wait_ms": 0.48498493969927936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026094913482666016, "StateBufferConnector_ms": 0.0017235279083251953, "ViewRequirementAgentConnector_ms": 0.0442509651184082}}, "episode_reward_max": -3795.6746934360763, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3988.3406329446466, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3870.448501337994, -4003.731114394262, -3901.911793097935, -4056.4721507816207, -3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3729641638899066, "mean_inference_ms": 0.23058346406777283, "mean_action_processing_ms": 0.056978949121565314, "mean_env_wait_ms": 0.48498493969927936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026094913482666016, "StateBufferConnector_ms": 0.0017235279083251953, "ViewRequirementAgentConnector_ms": 0.0442509651184082}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2214240, "num_agent_steps_trained": 2214240, "num_env_steps_sampled": 2214240, "num_env_steps_trained": 2214240, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 455.3806739711871, "num_env_steps_trained_throughput_per_sec": 455.3806739711871, "timesteps_total": 2214240, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2214240, "timers": {"training_iteration_time_ms": 2722.685, "sample_time_ms": 2700.444, "load_time_ms": 0.438, "load_throughput": 2738988.246, "learn_time_ms": 21.188, "learn_throughput": 56636.987, "synch_weights_time_ms": 0.577}, "counters": {"num_env_steps_sampled": 2214240, "num_env_steps_trained": 2214240, "num_agent_steps_sampled": 2214240, "num_agent_steps_trained": 2214240}, "done": false, "episodes_total": 6944, "training_iteration": 1530, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-35-14", "timestamp": 1691238914, "time_this_iter_s": 10.542916297912598, "time_total_s": 19627.94853591919, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 681.1377449035645, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 26.093333333333337, "ram_util_percent": 69.74}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.23754035101996, "policy_loss": -2237462.445746528, "vf_loss": 3507539.1180555555}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4743.5, "diff_num_grad_updates_vs_sampler_policy": 4742.5}}, "num_env_steps_sampled": 2219040, "num_env_steps_trained": 2219040, "num_agent_steps_sampled": 2219040, "num_agent_steps_trained": 2219040}, "sampler_results": {"episode_reward_max": -3795.6746934360763, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3990.407197050408, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3731068061803773, "mean_inference_ms": 0.23066692415453807, "mean_action_processing_ms": 0.05699209056342399, "mean_env_wait_ms": 0.48492610772137207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026133060455322266, "StateBufferConnector_ms": 0.0017211437225341797, "ViewRequirementAgentConnector_ms": 0.0442805290222168}}, "episode_reward_max": -3795.6746934360763, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3990.407197050408, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3987.32490973415, -3884.954024506025, -3824.295345525687, -3986.793612571025, -4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3731068061803773, "mean_inference_ms": 0.23066692415453807, "mean_action_processing_ms": 0.05699209056342399, "mean_env_wait_ms": 0.48492610772137207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026133060455322266, "StateBufferConnector_ms": 0.0017211437225341797, "ViewRequirementAgentConnector_ms": 0.0442805290222168}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2219040, "num_agent_steps_trained": 2219040, "num_env_steps_sampled": 2219040, "num_env_steps_trained": 2219040, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 450.25510862462573, "num_env_steps_trained_throughput_per_sec": 450.25510862462573, "timesteps_total": 2219040, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2219040, "timers": {"training_iteration_time_ms": 2657.852, "sample_time_ms": 2636.554, "load_time_ms": 0.424, "load_throughput": 2830642.146, "learn_time_ms": 20.269, "learn_throughput": 59204.997, "synch_weights_time_ms": 0.569}, "counters": {"num_env_steps_sampled": 2219040, "num_env_steps_trained": 2219040, "num_agent_steps_sampled": 2219040, "num_agent_steps_trained": 2219040}, "done": false, "episodes_total": 6948, "training_iteration": 1531, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-35-24", "timestamp": 1691238924, "time_this_iter_s": 10.662844896316528, "time_total_s": 19638.611380815506, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 691.800589799881, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 28.94375, "ram_util_percent": 69.49375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.7594180636936, "policy_loss": -1282188.5403645833, "vf_loss": 3139093.28125}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4815.5, "diff_num_grad_updates_vs_sampler_policy": 4814.5}}, "num_env_steps_sampled": 2223840, "num_env_steps_trained": 2223840, "num_agent_steps_sampled": 2223840, "num_agent_steps_trained": 2223840}, "sampler_results": {"episode_reward_max": -3795.6746934360763, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3993.3553227397297, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.373255912155861, "mean_inference_ms": 0.23075087206284622, "mean_action_processing_ms": 0.05700518128144352, "mean_env_wait_ms": 0.48487188570130535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026128292083740234, "StateBufferConnector_ms": 0.0017180442810058594, "ViewRequirementAgentConnector_ms": 0.044245243072509766}}, "episode_reward_max": -3795.6746934360763, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3993.3553227397297, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4227.831890184065, -3955.0050909766296, -4080.9936212843554, -4091.9206865491788, -4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.373255912155861, "mean_inference_ms": 0.23075087206284622, "mean_action_processing_ms": 0.05700518128144352, "mean_env_wait_ms": 0.48487188570130535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026128292083740234, "StateBufferConnector_ms": 0.0017180442810058594, "ViewRequirementAgentConnector_ms": 0.044245243072509766}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2223840, "num_agent_steps_trained": 2223840, "num_env_steps_sampled": 2223840, "num_env_steps_trained": 2223840, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 456.5635816652954, "num_env_steps_trained_throughput_per_sec": 456.5635816652954, "timesteps_total": 2223840, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2223840, "timers": {"training_iteration_time_ms": 2640.953, "sample_time_ms": 2619.156, "load_time_ms": 0.435, "load_throughput": 2756237.227, "learn_time_ms": 20.731, "learn_throughput": 57883.34, "synch_weights_time_ms": 0.592}, "counters": {"num_env_steps_sampled": 2223840, "num_env_steps_trained": 2223840, "num_agent_steps_sampled": 2223840, "num_agent_steps_trained": 2223840}, "done": false, "episodes_total": 6952, "training_iteration": 1532, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-35-35", "timestamp": 1691238935, "time_this_iter_s": 10.515666246414185, "time_total_s": 19649.12704706192, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 702.3162560462952, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 27.178571428571427, "ram_util_percent": 69.34285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.26375155978735, "policy_loss": -3240096.412326389, "vf_loss": 3224712.3055555555}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4887.5, "diff_num_grad_updates_vs_sampler_policy": 4886.5}}, "num_env_steps_sampled": 2228640, "num_env_steps_trained": 2228640, "num_agent_steps_sampled": 2228640, "num_agent_steps_trained": 2228640}, "sampler_results": {"episode_reward_max": -3795.6746934360763, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3986.5144804907018, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.373415173499605, "mean_inference_ms": 0.23083480602050294, "mean_action_processing_ms": 0.057018211781403504, "mean_env_wait_ms": 0.48481967033403334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026242733001708984, "StateBufferConnector_ms": 0.0017154216766357422, "ViewRequirementAgentConnector_ms": 0.04430699348449707}}, "episode_reward_max": -3795.6746934360763, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3986.5144804907018, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4000.4594490712366, -3991.981344427485, -3818.644746091456, -4192.3272166538345, -3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.373415173499605, "mean_inference_ms": 0.23083480602050294, "mean_action_processing_ms": 0.057018211781403504, "mean_env_wait_ms": 0.48481967033403334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026242733001708984, "StateBufferConnector_ms": 0.0017154216766357422, "ViewRequirementAgentConnector_ms": 0.04430699348449707}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2228640, "num_agent_steps_trained": 2228640, "num_env_steps_sampled": 2228640, "num_env_steps_trained": 2228640, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 451.6811694829856, "num_env_steps_trained_throughput_per_sec": 451.6811694829856, "timesteps_total": 2228640, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2228640, "timers": {"training_iteration_time_ms": 2642.596, "sample_time_ms": 2620.176, "load_time_ms": 0.435, "load_throughput": 2756388.171, "learn_time_ms": 21.334, "learn_throughput": 56248.231, "synch_weights_time_ms": 0.61}, "counters": {"num_env_steps_sampled": 2228640, "num_env_steps_trained": 2228640, "num_agent_steps_sampled": 2228640, "num_agent_steps_trained": 2228640}, "done": false, "episodes_total": 6956, "training_iteration": 1533, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-35-45", "timestamp": 1691238945, "time_this_iter_s": 10.629163026809692, "time_total_s": 19659.75621008873, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 712.9454190731049, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 25.39333333333333, "ram_util_percent": 69.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.833333333333334e-11, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.1101769341363, "policy_loss": -2484367.6219618055, "vf_loss": 3220876.2569444445}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4959.5, "diff_num_grad_updates_vs_sampler_policy": 4958.5}}, "num_env_steps_sampled": 2233440, "num_env_steps_trained": 2233440, "num_agent_steps_sampled": 2233440, "num_agent_steps_trained": 2233440}, "sampler_results": {"episode_reward_max": -3795.6746934360763, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3985.625793294426, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3735827084111454, "mean_inference_ms": 0.23092011024928438, "mean_action_processing_ms": 0.05703140922707995, "mean_env_wait_ms": 0.4847799697953842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026314258575439453, "StateBufferConnector_ms": 0.0017240047454833984, "ViewRequirementAgentConnector_ms": 0.04439806938171387}}, "episode_reward_max": -3795.6746934360763, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3985.625793294426, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3867.279224240154, -3883.8622202506444, -4119.215742455408, -3865.6399418115247, -3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3735827084111454, "mean_inference_ms": 0.23092011024928438, "mean_action_processing_ms": 0.05703140922707995, "mean_env_wait_ms": 0.4847799697953842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026314258575439453, "StateBufferConnector_ms": 0.0017240047454833984, "ViewRequirementAgentConnector_ms": 0.04439806938171387}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2233440, "num_agent_steps_trained": 2233440, "num_env_steps_sampled": 2233440, "num_env_steps_trained": 2233440, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 452.5546064378438, "num_env_steps_trained_throughput_per_sec": 452.5546064378438, "timesteps_total": 2233440, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2233440, "timers": {"training_iteration_time_ms": 2649.219, "sample_time_ms": 2626.978, "load_time_ms": 0.438, "load_throughput": 2741076.571, "learn_time_ms": 21.166, "learn_throughput": 56695.171, "synch_weights_time_ms": 0.596}, "counters": {"num_env_steps_sampled": 2233440, "num_env_steps_trained": 2233440, "num_agent_steps_sampled": 2233440, "num_agent_steps_trained": 2233440}, "done": false, "episodes_total": 6960, "training_iteration": 1534, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-35-56", "timestamp": 1691238956, "time_this_iter_s": 10.608649969100952, "time_total_s": 19670.36486005783, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 723.5540690422058, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 31.06875, "ram_util_percent": 69.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.166666666666666e-11, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.2066243489583, "policy_loss": -2450554.049045139, "vf_loss": 3170279.5069444445}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5031.5, "diff_num_grad_updates_vs_sampler_policy": 5030.5}}, "num_env_steps_sampled": 2238240, "num_env_steps_trained": 2238240, "num_agent_steps_sampled": 2238240, "num_agent_steps_trained": 2238240}, "sampler_results": {"episode_reward_max": -3795.6746934360763, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3985.023728689537, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3737501513129866, "mean_inference_ms": 0.2310112830919088, "mean_action_processing_ms": 0.05704549673105792, "mean_env_wait_ms": 0.4847622436917017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026426315307617188, "StateBufferConnector_ms": 0.001729726791381836, "ViewRequirementAgentConnector_ms": 0.044506072998046875}}, "episode_reward_max": -3795.6746934360763, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3985.023728689537, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3885.104250706225, -3922.6775327909736, -3885.28463033197, -3893.7496683384693, -3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3737501513129866, "mean_inference_ms": 0.2310112830919088, "mean_action_processing_ms": 0.05704549673105792, "mean_env_wait_ms": 0.4847622436917017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026426315307617188, "StateBufferConnector_ms": 0.001729726791381836, "ViewRequirementAgentConnector_ms": 0.044506072998046875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2238240, "num_agent_steps_trained": 2238240, "num_env_steps_sampled": 2238240, "num_env_steps_trained": 2238240, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 450.8299852674427, "num_env_steps_trained_throughput_per_sec": 450.8299852674427, "timesteps_total": 2238240, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2238240, "timers": {"training_iteration_time_ms": 2660.266, "sample_time_ms": 2638.928, "load_time_ms": 0.423, "load_throughput": 2836065.138, "learn_time_ms": 20.293, "learn_throughput": 59132.24, "synch_weights_time_ms": 0.583}, "counters": {"num_env_steps_sampled": 2238240, "num_env_steps_trained": 2238240, "num_agent_steps_sampled": 2238240, "num_agent_steps_trained": 2238240}, "done": false, "episodes_total": 6964, "training_iteration": 1535, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-36-07", "timestamp": 1691238967, "time_this_iter_s": 10.64926266670227, "time_total_s": 19681.014122724533, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 734.2033317089081, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 27.339999999999996, "ram_util_percent": 69.46}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.5e-11, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.3706749810113, "policy_loss": -1993630.0807291667, "vf_loss": 3309309.548611111}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5103.5, "diff_num_grad_updates_vs_sampler_policy": 5102.5}}, "num_env_steps_sampled": 2243040, "num_env_steps_trained": 2243040, "num_agent_steps_sampled": 2243040, "num_agent_steps_trained": 2243040}, "sampler_results": {"episode_reward_max": -3795.6746934360763, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3988.6678200390243, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.373921874040447, "mean_inference_ms": 0.23110410639412918, "mean_action_processing_ms": 0.05705981429354146, "mean_env_wait_ms": 0.4847614447010455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002646207809448242, "StateBufferConnector_ms": 0.0017294883728027344, "ViewRequirementAgentConnector_ms": 0.0444636344909668}}, "episode_reward_max": -3795.6746934360763, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3988.6678200390243, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3944.387464754216, -3911.3714548634744, -3969.5347891865067, -3949.3377216094227, -3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.373921874040447, "mean_inference_ms": 0.23110410639412918, "mean_action_processing_ms": 0.05705981429354146, "mean_env_wait_ms": 0.4847614447010455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002646207809448242, "StateBufferConnector_ms": 0.0017294883728027344, "ViewRequirementAgentConnector_ms": 0.0444636344909668}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2243040, "num_agent_steps_trained": 2243040, "num_env_steps_sampled": 2243040, "num_env_steps_trained": 2243040, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 452.8700102054375, "num_env_steps_trained_throughput_per_sec": 452.8700102054375, "timesteps_total": 2243040, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2243040, "timers": {"training_iteration_time_ms": 2659.045, "sample_time_ms": 2637.729, "load_time_ms": 0.423, "load_throughput": 2835585.803, "learn_time_ms": 20.258, "learn_throughput": 59234.68, "synch_weights_time_ms": 0.595}, "counters": {"num_env_steps_sampled": 2243040, "num_env_steps_trained": 2243040, "num_agent_steps_sampled": 2243040, "num_agent_steps_trained": 2243040}, "done": false, "episodes_total": 6968, "training_iteration": 1536, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-36-17", "timestamp": 1691238977, "time_this_iter_s": 10.601206064224243, "time_total_s": 19691.615328788757, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 744.8045377731323, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 28.180000000000003, "ram_util_percent": 69.47333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.8333333333333332e-11, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.082761976454, "policy_loss": -1582723.3932291667, "vf_loss": 3446005.125}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5175.5, "diff_num_grad_updates_vs_sampler_policy": 5174.5}}, "num_env_steps_sampled": 2247840, "num_env_steps_trained": 2247840, "num_agent_steps_sampled": 2247840, "num_agent_steps_trained": 2247840}, "sampler_results": {"episode_reward_max": -3795.6746934360763, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3989.8262709542123, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3741011228300641, "mean_inference_ms": 0.23119870514248123, "mean_action_processing_ms": 0.05707446094212654, "mean_env_wait_ms": 0.4847739473335308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026459693908691406, "StateBufferConnector_ms": 0.0017321109771728516, "ViewRequirementAgentConnector_ms": 0.04451775550842285}}, "episode_reward_max": -3795.6746934360763, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3989.8262709542123, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3940.150579920399, -4192.13121798893, -3997.7947725545055, -3971.7555045868385, -3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3741011228300641, "mean_inference_ms": 0.23119870514248123, "mean_action_processing_ms": 0.05707446094212654, "mean_env_wait_ms": 0.4847739473335308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026459693908691406, "StateBufferConnector_ms": 0.0017321109771728516, "ViewRequirementAgentConnector_ms": 0.04451775550842285}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2247840, "num_agent_steps_trained": 2247840, "num_env_steps_sampled": 2247840, "num_env_steps_trained": 2247840, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 451.56265798680346, "num_env_steps_trained_throughput_per_sec": 451.56265798680346, "timesteps_total": 2247840, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2247840, "timers": {"training_iteration_time_ms": 2656.509, "sample_time_ms": 2635.155, "load_time_ms": 0.424, "load_throughput": 2827938.42, "learn_time_ms": 20.3, "learn_throughput": 59113.419, "synch_weights_time_ms": 0.592}, "counters": {"num_env_steps_sampled": 2247840, "num_env_steps_trained": 2247840, "num_agent_steps_sampled": 2247840, "num_agent_steps_trained": 2247840}, "done": false, "episodes_total": 6972, "training_iteration": 1537, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-36-28", "timestamp": 1691238988, "time_this_iter_s": 10.632506847381592, "time_total_s": 19702.24783563614, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 755.4370446205139, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 28.293333333333333, "ram_util_percent": 69.53999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000004e-11, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.0783284505208, "policy_loss": -3745762.297309028, "vf_loss": 3392981.097222222}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5247.5, "diff_num_grad_updates_vs_sampler_policy": 5246.5}}, "num_env_steps_sampled": 2252640, "num_env_steps_trained": 2252640, "num_agent_steps_sampled": 2252640, "num_agent_steps_trained": 2252640}, "sampler_results": {"episode_reward_max": -3795.6746934360763, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3989.732341506726, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.374284122590651, "mean_inference_ms": 0.2312960452392039, "mean_action_processing_ms": 0.057089647955321725, "mean_env_wait_ms": 0.48480833990586975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002648591995239258, "StateBufferConnector_ms": 0.0017299652099609375, "ViewRequirementAgentConnector_ms": 0.044550180435180664}}, "episode_reward_max": -3795.6746934360763, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3989.732341506726, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3954.2772856050133, -3902.762181663389, -3895.437169546143, -4141.543661015405, -4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.374284122590651, "mean_inference_ms": 0.2312960452392039, "mean_action_processing_ms": 0.057089647955321725, "mean_env_wait_ms": 0.48480833990586975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002648591995239258, "StateBufferConnector_ms": 0.0017299652099609375, "ViewRequirementAgentConnector_ms": 0.044550180435180664}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2252640, "num_agent_steps_trained": 2252640, "num_env_steps_sampled": 2252640, "num_env_steps_trained": 2252640, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 451.39305307941237, "num_env_steps_trained_throughput_per_sec": 451.39305307941237, "timesteps_total": 2252640, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2252640, "timers": {"training_iteration_time_ms": 2660.408, "sample_time_ms": 2638.626, "load_time_ms": 0.427, "load_throughput": 2810567.791, "learn_time_ms": 20.717, "learn_throughput": 57922.842, "synch_weights_time_ms": 0.599}, "counters": {"num_env_steps_sampled": 2252640, "num_env_steps_trained": 2252640, "num_agent_steps_sampled": 2252640, "num_agent_steps_trained": 2252640}, "done": false, "episodes_total": 6976, "training_iteration": 1538, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-36-39", "timestamp": 1691238999, "time_this_iter_s": 10.636000871658325, "time_total_s": 19712.883836507797, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 766.0730454921722, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 29.373333333333335, "ram_util_percent": 69.52666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000004e-11, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.1042192247179, "policy_loss": -1078353.9639756945, "vf_loss": 3302748.1875}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5319.5, "diff_num_grad_updates_vs_sampler_policy": 5318.5}}, "num_env_steps_sampled": 2257440, "num_env_steps_trained": 2257440, "num_agent_steps_sampled": 2257440, "num_agent_steps_trained": 2257440}, "sampler_results": {"episode_reward_max": -3795.6746934360763, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3992.2434220008267, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.374472427119194, "mean_inference_ms": 0.23139714489249258, "mean_action_processing_ms": 0.05710547481015826, "mean_env_wait_ms": 0.4848560528750213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026535987854003906, "StateBufferConnector_ms": 0.0017256736755371094, "ViewRequirementAgentConnector_ms": 0.044582366943359375}}, "episode_reward_max": -3795.6746934360763, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3992.2434220008267, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4025.163872145372, -3871.5092756985155, -4092.3454881700277, -4111.3386374429565, -3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.374472427119194, "mean_inference_ms": 0.23139714489249258, "mean_action_processing_ms": 0.05710547481015826, "mean_env_wait_ms": 0.4848560528750213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026535987854003906, "StateBufferConnector_ms": 0.0017256736755371094, "ViewRequirementAgentConnector_ms": 0.044582366943359375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2257440, "num_agent_steps_trained": 2257440, "num_env_steps_sampled": 2257440, "num_env_steps_trained": 2257440, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 450.95143560791445, "num_env_steps_trained_throughput_per_sec": 450.95143560791445, "timesteps_total": 2257440, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2257440, "timers": {"training_iteration_time_ms": 2660.892, "sample_time_ms": 2638.929, "load_time_ms": 0.434, "load_throughput": 2767299.758, "learn_time_ms": 20.894, "learn_throughput": 57431.699, "synch_weights_time_ms": 0.597}, "counters": {"num_env_steps_sampled": 2257440, "num_env_steps_trained": 2257440, "num_agent_steps_sampled": 2257440, "num_agent_steps_trained": 2257440}, "done": false, "episodes_total": 6980, "training_iteration": 1539, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-36-49", "timestamp": 1691239009, "time_this_iter_s": 10.646470308303833, "time_total_s": 19723.5303068161, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 776.7195158004761, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 30.026666666666664, "ram_util_percent": 69.70666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000004e-11, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.14856974283856, "policy_loss": -2859464.435763889, "vf_loss": 3580766.951388889}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5391.5, "diff_num_grad_updates_vs_sampler_policy": 5390.5}}, "num_env_steps_sampled": 2262240, "num_env_steps_trained": 2262240, "num_agent_steps_sampled": 2262240, "num_agent_steps_trained": 2262240}, "sampler_results": {"episode_reward_max": -3795.6746934360763, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3995.2491052521136, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3746689086284192, "mean_inference_ms": 0.2314998216965541, "mean_action_processing_ms": 0.057121567606713414, "mean_env_wait_ms": 0.4849218612932437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002653837203979492, "StateBufferConnector_ms": 0.0017180442810058594, "ViewRequirementAgentConnector_ms": 0.04460453987121582}}, "episode_reward_max": -3795.6746934360763, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3995.2491052521136, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3971.4948739002407, -3902.3255029804272, -3909.3892866321958, -3861.5587853476527, -3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3746689086284192, "mean_inference_ms": 0.2314998216965541, "mean_action_processing_ms": 0.057121567606713414, "mean_env_wait_ms": 0.4849218612932437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002653837203979492, "StateBufferConnector_ms": 0.0017180442810058594, "ViewRequirementAgentConnector_ms": 0.04460453987121582}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2262240, "num_agent_steps_trained": 2262240, "num_env_steps_sampled": 2262240, "num_env_steps_trained": 2262240, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 449.4879896173728, "num_env_steps_trained_throughput_per_sec": 449.4879896173728, "timesteps_total": 2262240, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2262240, "timers": {"training_iteration_time_ms": 2666.543, "sample_time_ms": 2644.458, "load_time_ms": 0.445, "load_throughput": 2697590.739, "learn_time_ms": 21.007, "learn_throughput": 57124.558, "synch_weights_time_ms": 0.596}, "counters": {"num_env_steps_sampled": 2262240, "num_env_steps_trained": 2262240, "num_agent_steps_sampled": 2262240, "num_agent_steps_trained": 2262240}, "done": false, "episodes_total": 6984, "training_iteration": 1540, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-37-00", "timestamp": 1691239020, "time_this_iter_s": 10.681158304214478, "time_total_s": 19734.211465120316, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 787.4006741046906, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 33.026666666666664, "ram_util_percent": 69.69333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000004e-11, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.038586086697, "policy_loss": -1829868.525173611, "vf_loss": 3270306.451388889}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5463.5, "diff_num_grad_updates_vs_sampler_policy": 5462.5}}, "num_env_steps_sampled": 2267040, "num_env_steps_trained": 2267040, "num_agent_steps_sampled": 2267040, "num_agent_steps_trained": 2267040}, "sampler_results": {"episode_reward_max": -3795.6746934360763, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -4000.002519459244, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3748791320995712, "mean_inference_ms": 0.23159605941243708, "mean_action_processing_ms": 0.05713839562573717, "mean_env_wait_ms": 0.48501443066917505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002658367156982422, "StateBufferConnector_ms": 0.0017189979553222656, "ViewRequirementAgentConnector_ms": 0.04464292526245117}}, "episode_reward_max": -3795.6746934360763, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -4000.002519459244, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3866.4120341333855, -4092.570445330363, -4075.651052227958, -3963.5029878239175, -4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3748791320995712, "mean_inference_ms": 0.23159605941243708, "mean_action_processing_ms": 0.05713839562573717, "mean_env_wait_ms": 0.48501443066917505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002658367156982422, "StateBufferConnector_ms": 0.0017189979553222656, "ViewRequirementAgentConnector_ms": 0.04464292526245117}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2267040, "num_agent_steps_trained": 2267040, "num_env_steps_sampled": 2267040, "num_env_steps_trained": 2267040, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 447.55849075822647, "num_env_steps_trained_throughput_per_sec": 447.55849075822647, "timesteps_total": 2267040, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2267040, "timers": {"training_iteration_time_ms": 2670.259, "sample_time_ms": 2648.663, "load_time_ms": 0.44, "load_throughput": 2724311.123, "learn_time_ms": 20.546, "learn_throughput": 58406.661, "synch_weights_time_ms": 0.573}, "counters": {"num_env_steps_sampled": 2267040, "num_env_steps_trained": 2267040, "num_agent_steps_sampled": 2267040, "num_agent_steps_trained": 2267040}, "done": false, "episodes_total": 6988, "training_iteration": 1541, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-37-11", "timestamp": 1691239031, "time_this_iter_s": 10.726998090744019, "time_total_s": 19744.93846321106, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 798.1276721954346, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 28.793333333333337, "ram_util_percent": 69.70666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.2000000000000005e-11, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.52037726508246, "policy_loss": -731055.5607638889, "vf_loss": 3025260.465277778}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5535.5, "diff_num_grad_updates_vs_sampler_policy": 5534.5}}, "num_env_steps_sampled": 2271840, "num_env_steps_trained": 2271840, "num_agent_steps_sampled": 2271840, "num_agent_steps_trained": 2271840}, "sampler_results": {"episode_reward_max": -3795.6746934360763, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3997.55333916237, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.375102457608881, "mean_inference_ms": 0.23169646132922023, "mean_action_processing_ms": 0.05715583603830336, "mean_env_wait_ms": 0.48512164422604653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002658367156982422, "StateBufferConnector_ms": 0.0017223358154296875, "ViewRequirementAgentConnector_ms": 0.04465794563293457}}, "episode_reward_max": -3795.6746934360763, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3997.55333916237, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4149.753341282015, -4154.846385840994, -3907.1980644979485, -4077.4579764080954, -4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.375102457608881, "mean_inference_ms": 0.23169646132922023, "mean_action_processing_ms": 0.05715583603830336, "mean_env_wait_ms": 0.48512164422604653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002658367156982422, "StateBufferConnector_ms": 0.0017223358154296875, "ViewRequirementAgentConnector_ms": 0.04465794563293457}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2271840, "num_agent_steps_trained": 2271840, "num_env_steps_sampled": 2271840, "num_env_steps_trained": 2271840, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 451.65690086691194, "num_env_steps_trained_throughput_per_sec": 451.65690086691194, "timesteps_total": 2271840, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2271840, "timers": {"training_iteration_time_ms": 2673.342, "sample_time_ms": 2651.375, "load_time_ms": 0.434, "load_throughput": 2763652.976, "learn_time_ms": 20.891, "learn_throughput": 57442.121, "synch_weights_time_ms": 0.605}, "counters": {"num_env_steps_sampled": 2271840, "num_env_steps_trained": 2271840, "num_agent_steps_sampled": 2271840, "num_agent_steps_trained": 2271840}, "done": false, "episodes_total": 6992, "training_iteration": 1542, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-37-21", "timestamp": 1691239041, "time_this_iter_s": 10.629753828048706, "time_total_s": 19755.56821703911, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 808.7574260234833, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 32.18666666666666, "ram_util_percent": 69.52666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.8000000000000002e-11, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.0635409884983, "policy_loss": -2142381.0792100695, "vf_loss": 3381731.777777778}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5607.5, "diff_num_grad_updates_vs_sampler_policy": 5606.5}}, "num_env_steps_sampled": 2276640, "num_env_steps_trained": 2276640, "num_agent_steps_sampled": 2276640, "num_agent_steps_trained": 2276640}, "sampler_results": {"episode_reward_max": -3795.6746934360763, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3997.8436269680255, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3753313181599793, "mean_inference_ms": 0.23180279646848626, "mean_action_processing_ms": 0.05717425452796974, "mean_env_wait_ms": 0.48526026772375486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026607513427734375, "StateBufferConnector_ms": 0.0017189979553222656, "ViewRequirementAgentConnector_ms": 0.044612884521484375}}, "episode_reward_max": -3795.6746934360763, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3997.8436269680255, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4004.1500746760753, -3972.055903218523, -3988.435531340625, -4054.647537700471, -3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3753313181599793, "mean_inference_ms": 0.23180279646848626, "mean_action_processing_ms": 0.05717425452796974, "mean_env_wait_ms": 0.48526026772375486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026607513427734375, "StateBufferConnector_ms": 0.0017189979553222656, "ViewRequirementAgentConnector_ms": 0.044612884521484375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2276640, "num_agent_steps_trained": 2276640, "num_env_steps_sampled": 2276640, "num_env_steps_trained": 2276640, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 447.1596154970782, "num_env_steps_trained_throughput_per_sec": 447.1596154970782, "timesteps_total": 2276640, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2276640, "timers": {"training_iteration_time_ms": 2670.825, "sample_time_ms": 2649.117, "load_time_ms": 0.426, "load_throughput": 2815914.065, "learn_time_ms": 20.64, "learn_throughput": 58139.088, "synch_weights_time_ms": 0.603}, "counters": {"num_env_steps_sampled": 2276640, "num_env_steps_trained": 2276640, "num_agent_steps_sampled": 2276640, "num_agent_steps_trained": 2276640}, "done": false, "episodes_total": 6996, "training_iteration": 1543, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-37-32", "timestamp": 1691239052, "time_this_iter_s": 10.736643075942993, "time_total_s": 19766.30486011505, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 819.4940690994263, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 28.4625, "ram_util_percent": 69.49375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.4e-11, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.074712117513, "policy_loss": -2619977.6258680555, "vf_loss": 3321746.8055555555}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5679.5, "diff_num_grad_updates_vs_sampler_policy": 5678.5}}, "num_env_steps_sampled": 2281440, "num_env_steps_trained": 2281440, "num_agent_steps_sampled": 2281440, "num_agent_steps_trained": 2281440}, "sampler_results": {"episode_reward_max": -3795.6746934360763, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3997.8031245751226, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3755732660788067, "mean_inference_ms": 0.23191217110363138, "mean_action_processing_ms": 0.05719314282231771, "mean_env_wait_ms": 0.48541342398345405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002657175064086914, "StateBufferConnector_ms": 0.001718759536743164, "ViewRequirementAgentConnector_ms": 0.04462099075317383}}, "episode_reward_max": -3795.6746934360763, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3997.8031245751226, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3912.208452509626, -4083.9875211451154, -3954.080493817349, -3932.2237255009118, -4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3755732660788067, "mean_inference_ms": 0.23191217110363138, "mean_action_processing_ms": 0.05719314282231771, "mean_env_wait_ms": 0.48541342398345405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002657175064086914, "StateBufferConnector_ms": 0.001718759536743164, "ViewRequirementAgentConnector_ms": 0.04462099075317383}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2281440, "num_agent_steps_trained": 2281440, "num_env_steps_sampled": 2281440, "num_env_steps_trained": 2281440, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 453.45074016562484, "num_env_steps_trained_throughput_per_sec": 453.45074016562484, "timesteps_total": 2281440, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2281440, "timers": {"training_iteration_time_ms": 2664.018, "sample_time_ms": 2642.53, "load_time_ms": 0.428, "load_throughput": 2803679.144, "learn_time_ms": 20.448, "learn_throughput": 58684.234, "synch_weights_time_ms": 0.574}, "counters": {"num_env_steps_sampled": 2281440, "num_env_steps_trained": 2281440, "num_agent_steps_sampled": 2281440, "num_agent_steps_trained": 2281440}, "done": false, "episodes_total": 7000, "training_iteration": 1544, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-37-43", "timestamp": 1691239063, "time_this_iter_s": 10.587760210037231, "time_total_s": 19776.89262032509, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 830.0818293094635, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 26.986666666666668, "ram_util_percent": 69.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.30904473198785, "policy_loss": -913690.4717881945, "vf_loss": 3051987.034722222}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5751.5, "diff_num_grad_updates_vs_sampler_policy": 5750.5}}, "num_env_steps_sampled": 2286240, "num_env_steps_trained": 2286240, "num_agent_steps_sampled": 2286240, "num_agent_steps_trained": 2286240}, "sampler_results": {"episode_reward_max": -3795.6746934360763, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3996.1059430628234, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.375823718875766, "mean_inference_ms": 0.23202534723187512, "mean_action_processing_ms": 0.05721260499702012, "mean_env_wait_ms": 0.4855849882748929, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002660036087036133, "StateBufferConnector_ms": 0.0017116069793701172, "ViewRequirementAgentConnector_ms": 0.04463362693786621}}, "episode_reward_max": -3795.6746934360763, "episode_reward_min": -4329.601481295444, "episode_reward_mean": -3996.1059430628234, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4083.343215022378, -4329.601481295444, -4016.365491896138, -4026.871346650079, -4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.375823718875766, "mean_inference_ms": 0.23202534723187512, "mean_action_processing_ms": 0.05721260499702012, "mean_env_wait_ms": 0.4855849882748929, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002660036087036133, "StateBufferConnector_ms": 0.0017116069793701172, "ViewRequirementAgentConnector_ms": 0.04463362693786621}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2286240, "num_agent_steps_trained": 2286240, "num_env_steps_sampled": 2286240, "num_env_steps_trained": 2286240, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 451.3318010703423, "num_env_steps_trained_throughput_per_sec": 451.3318010703423, "timesteps_total": 2286240, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2286240, "timers": {"training_iteration_time_ms": 2659.689, "sample_time_ms": 2637.912, "load_time_ms": 0.431, "load_throughput": 2785370.67, "learn_time_ms": 20.722, "learn_throughput": 57910.313, "synch_weights_time_ms": 0.586}, "counters": {"num_env_steps_sampled": 2286240, "num_env_steps_trained": 2286240, "num_agent_steps_sampled": 2286240, "num_agent_steps_trained": 2286240}, "done": false, "episodes_total": 7004, "training_iteration": 1545, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-37-53", "timestamp": 1691239073, "time_this_iter_s": 10.637484788894653, "time_total_s": 19787.530105113983, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 840.7193140983582, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 28.54666666666667, "ram_util_percent": 69.52666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.15313212076825, "policy_loss": -986140.1193576389, "vf_loss": 3007252.6979166665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5823.5, "diff_num_grad_updates_vs_sampler_policy": 5822.5}}, "num_env_steps_sampled": 2291040, "num_env_steps_trained": 2291040, "num_agent_steps_sampled": 2291040, "num_agent_steps_trained": 2291040}, "sampler_results": {"episode_reward_max": -3795.6746934360763, "episode_reward_min": -4243.051822601634, "episode_reward_mean": -3991.164577295415, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.376078596450804, "mean_inference_ms": 0.2321404272063581, "mean_action_processing_ms": 0.05723242489262852, "mean_env_wait_ms": 0.4857675628733537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002660036087036133, "StateBufferConnector_ms": 0.0017120838165283203, "ViewRequirementAgentConnector_ms": 0.04470467567443848}}, "episode_reward_max": -3795.6746934360763, "episode_reward_min": -4243.051822601634, "episode_reward_mean": -3991.164577295415, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4057.4899270342853, -3841.5790476547772, -3895.0813991655828, -3859.9885649784183, -4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.376078596450804, "mean_inference_ms": 0.2321404272063581, "mean_action_processing_ms": 0.05723242489262852, "mean_env_wait_ms": 0.4857675628733537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002660036087036133, "StateBufferConnector_ms": 0.0017120838165283203, "ViewRequirementAgentConnector_ms": 0.04470467567443848}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2291040, "num_agent_steps_trained": 2291040, "num_env_steps_sampled": 2291040, "num_env_steps_trained": 2291040, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 452.5371505730526, "num_env_steps_trained_throughput_per_sec": 452.5371505730526, "timesteps_total": 2291040, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2291040, "timers": {"training_iteration_time_ms": 2659.432, "sample_time_ms": 2637.994, "load_time_ms": 0.424, "load_throughput": 2831279.068, "learn_time_ms": 20.412, "learn_throughput": 58789.039, "synch_weights_time_ms": 0.565}, "counters": {"num_env_steps_sampled": 2291040, "num_env_steps_trained": 2291040, "num_agent_steps_sampled": 2291040, "num_agent_steps_trained": 2291040}, "done": false, "episodes_total": 7008, "training_iteration": 1546, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-38-04", "timestamp": 1691239084, "time_this_iter_s": 10.609058856964111, "time_total_s": 19798.139163970947, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 851.3283729553223, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 26.24, "ram_util_percent": 69.51333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -321.96178351508246, "policy_loss": -943005.0286458334, "vf_loss": 3145542.722222222}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5895.5, "diff_num_grad_updates_vs_sampler_policy": 5894.5}}, "num_env_steps_sampled": 2295840, "num_env_steps_trained": 2295840, "num_agent_steps_sampled": 2295840, "num_agent_steps_trained": 2295840}, "sampler_results": {"episode_reward_max": -3795.6746934360763, "episode_reward_min": -4253.911927103893, "episode_reward_mean": -3995.8542187632115, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.376330452013814, "mean_inference_ms": 0.23225737533851107, "mean_action_processing_ms": 0.057252698892220566, "mean_env_wait_ms": 0.4859682669730499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026633739471435547, "StateBufferConnector_ms": 0.0017118453979492188, "ViewRequirementAgentConnector_ms": 0.04477691650390625}}, "episode_reward_max": -3795.6746934360763, "episode_reward_min": -4253.911927103893, "episode_reward_mean": -3995.8542187632115, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4078.6597806514333, -4033.7216245229542, -3874.1282406389246, -4132.117642773871, -3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.376330452013814, "mean_inference_ms": 0.23225737533851107, "mean_action_processing_ms": 0.057252698892220566, "mean_env_wait_ms": 0.4859682669730499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026633739471435547, "StateBufferConnector_ms": 0.0017118453979492188, "ViewRequirementAgentConnector_ms": 0.04477691650390625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2295840, "num_agent_steps_trained": 2295840, "num_env_steps_sampled": 2295840, "num_env_steps_trained": 2295840, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 452.43503633710594, "num_env_steps_trained_throughput_per_sec": 452.43503633710594, "timesteps_total": 2295840, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2295840, "timers": {"training_iteration_time_ms": 2653.098, "sample_time_ms": 2631.677, "load_time_ms": 0.423, "load_throughput": 2836224.952, "learn_time_ms": 20.4, "learn_throughput": 58822.568, "synch_weights_time_ms": 0.562}, "counters": {"num_env_steps_sampled": 2295840, "num_env_steps_trained": 2295840, "num_agent_steps_sampled": 2295840, "num_agent_steps_trained": 2295840}, "done": false, "episodes_total": 7012, "training_iteration": 1547, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-38-15", "timestamp": 1691239095, "time_this_iter_s": 10.611406087875366, "time_total_s": 19808.750570058823, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 861.9397790431976, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 28.473333333333336, "ram_util_percent": 69.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.2618357340495, "policy_loss": -1709221.6649305555, "vf_loss": 3183504.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5967.5, "diff_num_grad_updates_vs_sampler_policy": 5966.5}}, "num_env_steps_sampled": 2300640, "num_env_steps_trained": 2300640, "num_agent_steps_sampled": 2300640, "num_agent_steps_trained": 2300640}, "sampler_results": {"episode_reward_max": -3795.6746934360763, "episode_reward_min": -4253.911927103893, "episode_reward_mean": -3992.961445275052, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3765871493025292, "mean_inference_ms": 0.23237444790516348, "mean_action_processing_ms": 0.0572730213143056, "mean_env_wait_ms": 0.48617854696537505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026633739471435547, "StateBufferConnector_ms": 0.0017170906066894531, "ViewRequirementAgentConnector_ms": 0.04472017288208008}}, "episode_reward_max": -3795.6746934360763, "episode_reward_min": -4253.911927103893, "episode_reward_mean": -3992.961445275052, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3909.8588602821656, -4128.376188610584, -3921.4126663085526, -3895.1227615434263, -3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3765871493025292, "mean_inference_ms": 0.23237444790516348, "mean_action_processing_ms": 0.0572730213143056, "mean_env_wait_ms": 0.48617854696537505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026633739471435547, "StateBufferConnector_ms": 0.0017170906066894531, "ViewRequirementAgentConnector_ms": 0.04472017288208008}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2300640, "num_agent_steps_trained": 2300640, "num_env_steps_sampled": 2300640, "num_env_steps_trained": 2300640, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 456.5086197533329, "num_env_steps_trained_throughput_per_sec": 456.5086197533329, "timesteps_total": 2300640, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2300640, "timers": {"training_iteration_time_ms": 2636.72, "sample_time_ms": 2615.571, "load_time_ms": 0.418, "load_throughput": 2868553.972, "learn_time_ms": 20.109, "learn_throughput": 59674.319, "synch_weights_time_ms": 0.584}, "counters": {"num_env_steps_sampled": 2300640, "num_env_steps_trained": 2300640, "num_agent_steps_sampled": 2300640, "num_agent_steps_trained": 2300640}, "done": false, "episodes_total": 7016, "training_iteration": 1548, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-38-25", "timestamp": 1691239105, "time_this_iter_s": 10.51675009727478, "time_total_s": 19819.267320156097, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 872.4565291404724, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 27.033333333333328, "ram_util_percent": 69.59333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.666666666666666e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.05540974934894, "policy_loss": -1687299.9739583333, "vf_loss": 3454285.263888889}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6039.5, "diff_num_grad_updates_vs_sampler_policy": 6038.5}}, "num_env_steps_sampled": 2305440, "num_env_steps_trained": 2305440, "num_agent_steps_sampled": 2305440, "num_agent_steps_trained": 2305440}, "sampler_results": {"episode_reward_max": -3795.6746934360763, "episode_reward_min": -4253.911927103893, "episode_reward_mean": -3994.380269833794, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3768546714199243, "mean_inference_ms": 0.23249450657132387, "mean_action_processing_ms": 0.057293662010329136, "mean_env_wait_ms": 0.4863963787167981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002665281295776367, "StateBufferConnector_ms": 0.0017082691192626953, "ViewRequirementAgentConnector_ms": 0.04476213455200195}}, "episode_reward_max": -3795.6746934360763, "episode_reward_min": -4253.911927103893, "episode_reward_mean": -3994.380269833794, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3841.7543729208373, -4049.7977020357716, -3956.179229965365, -4073.7358116181117, -4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3768546714199243, "mean_inference_ms": 0.23249450657132387, "mean_action_processing_ms": 0.057293662010329136, "mean_env_wait_ms": 0.4863963787167981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002665281295776367, "StateBufferConnector_ms": 0.0017082691192626953, "ViewRequirementAgentConnector_ms": 0.04476213455200195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2305440, "num_agent_steps_trained": 2305440, "num_env_steps_sampled": 2305440, "num_env_steps_trained": 2305440, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 452.8005455739555, "num_env_steps_trained_throughput_per_sec": 452.8005455739555, "timesteps_total": 2305440, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2305440, "timers": {"training_iteration_time_ms": 2641.509, "sample_time_ms": 2619.534, "load_time_ms": 0.439, "load_throughput": 2730962.995, "learn_time_ms": 20.889, "learn_throughput": 57446.186, "synch_weights_time_ms": 0.608}, "counters": {"num_env_steps_sampled": 2305440, "num_env_steps_trained": 2305440, "num_agent_steps_sampled": 2305440, "num_agent_steps_trained": 2305440}, "done": false, "episodes_total": 7020, "training_iteration": 1549, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-38-36", "timestamp": 1691239116, "time_this_iter_s": 10.602800846099854, "time_total_s": 19829.870121002197, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 883.0593299865723, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 48.53333333333333, "ram_util_percent": 69.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.333333333333334e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.02457004123266, "policy_loss": -2960134.269965278, "vf_loss": 3510257.076388889}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6111.5, "diff_num_grad_updates_vs_sampler_policy": 6110.5}}, "num_env_steps_sampled": 2310240, "num_env_steps_trained": 2310240, "num_agent_steps_sampled": 2310240, "num_agent_steps_trained": 2310240}, "sampler_results": {"episode_reward_max": -3795.6746934360763, "episode_reward_min": -4253.911927103893, "episode_reward_mean": -3995.26819537149, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3771209544594831, "mean_inference_ms": 0.2326150471897248, "mean_action_processing_ms": 0.05731432789046258, "mean_env_wait_ms": 0.48660922620617314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026617050170898438, "StateBufferConnector_ms": 0.0017099380493164062, "ViewRequirementAgentConnector_ms": 0.04475116729736328}}, "episode_reward_max": -3795.6746934360763, "episode_reward_min": -4253.911927103893, "episode_reward_mean": -3995.26819537149, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4021.6334463035137, -3838.9678175005392, -3893.744833380047, -4126.470721448044, -3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3771209544594831, "mean_inference_ms": 0.2326150471897248, "mean_action_processing_ms": 0.05731432789046258, "mean_env_wait_ms": 0.48660922620617314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026617050170898438, "StateBufferConnector_ms": 0.0017099380493164062, "ViewRequirementAgentConnector_ms": 0.04475116729736328}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2310240, "num_agent_steps_trained": 2310240, "num_env_steps_sampled": 2310240, "num_env_steps_trained": 2310240, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 456.0778516527818, "num_env_steps_trained_throughput_per_sec": 456.0778516527818, "timesteps_total": 2310240, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2310240, "timers": {"training_iteration_time_ms": 2643.412, "sample_time_ms": 2621.238, "load_time_ms": 0.442, "load_throughput": 2713588.958, "learn_time_ms": 21.077, "learn_throughput": 56932.84, "synch_weights_time_ms": 0.615}, "counters": {"num_env_steps_sampled": 2310240, "num_env_steps_trained": 2310240, "num_agent_steps_sampled": 2310240, "num_agent_steps_trained": 2310240}, "done": false, "episodes_total": 7024, "training_iteration": 1550, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-38-46", "timestamp": 1691239126, "time_this_iter_s": 10.527046918869019, "time_total_s": 19840.397167921066, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 893.5863769054413, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 52.47857142857141, "ram_util_percent": 69.92857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.09456041124133, "policy_loss": -1989395.0653211805, "vf_loss": 3198153.111111111}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6183.5, "diff_num_grad_updates_vs_sampler_policy": 6182.5}}, "num_env_steps_sampled": 2315040, "num_env_steps_trained": 2315040, "num_agent_steps_sampled": 2315040, "num_agent_steps_trained": 2315040}, "sampler_results": {"episode_reward_max": -3795.6746934360763, "episode_reward_min": -4253.911927103893, "episode_reward_mean": -3998.529776357963, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.377323073896057, "mean_inference_ms": 0.23270194035076394, "mean_action_processing_ms": 0.05732919842132407, "mean_env_wait_ms": 0.48678101795135986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026547908782958984, "StateBufferConnector_ms": 0.0017056465148925781, "ViewRequirementAgentConnector_ms": 0.04464149475097656}}, "episode_reward_max": -3795.6746934360763, "episode_reward_min": -4253.911927103893, "episode_reward_mean": -3998.529776357963, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3879.331642972728, -4228.628553957469, -4156.858044776546, -4115.056972828176, -3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.377323073896057, "mean_inference_ms": 0.23270194035076394, "mean_action_processing_ms": 0.05732919842132407, "mean_env_wait_ms": 0.48678101795135986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026547908782958984, "StateBufferConnector_ms": 0.0017056465148925781, "ViewRequirementAgentConnector_ms": 0.04464149475097656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2315040, "num_agent_steps_trained": 2315040, "num_env_steps_sampled": 2315040, "num_env_steps_trained": 2315040, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 451.08597880592674, "num_env_steps_trained_throughput_per_sec": 451.08597880592674, "timesteps_total": 2315040, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2315040, "timers": {"training_iteration_time_ms": 2640.409, "sample_time_ms": 2619.07, "load_time_ms": 0.421, "load_throughput": 2852944.564, "learn_time_ms": 20.32, "learn_throughput": 59053.703, "synch_weights_time_ms": 0.561}, "counters": {"num_env_steps_sampled": 2315040, "num_env_steps_trained": 2315040, "num_agent_steps_sampled": 2315040, "num_agent_steps_trained": 2315040}, "done": false, "episodes_total": 7028, "training_iteration": 1551, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-38-57", "timestamp": 1691239137, "time_this_iter_s": 10.643066883087158, "time_total_s": 19851.040234804153, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 904.2294437885284, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 29.25625, "ram_util_percent": 69.29375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.666666666666667e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.17569817437067, "policy_loss": -3427362.3272569445, "vf_loss": 3553715.7291666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6255.5, "diff_num_grad_updates_vs_sampler_policy": 6254.5}}, "num_env_steps_sampled": 2319840, "num_env_steps_trained": 2319840, "num_agent_steps_sampled": 2319840, "num_agent_steps_trained": 2319840}, "sampler_results": {"episode_reward_max": -3795.6746934360763, "episode_reward_min": -4253.911927103893, "episode_reward_mean": -3994.1831132336574, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3775062777363807, "mean_inference_ms": 0.23278403993283303, "mean_action_processing_ms": 0.057343141945095905, "mean_env_wait_ms": 0.4869435257929108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026569366455078125, "StateBufferConnector_ms": 0.0017085075378417969, "ViewRequirementAgentConnector_ms": 0.044629573822021484}}, "episode_reward_max": -3795.6746934360763, "episode_reward_min": -4253.911927103893, "episode_reward_mean": -3994.1831132336574, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3858.535010681726, -4041.7310481344825, -4189.434804473208, -3878.4614905740405, -4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3775062777363807, "mean_inference_ms": 0.23278403993283303, "mean_action_processing_ms": 0.057343141945095905, "mean_env_wait_ms": 0.4869435257929108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026569366455078125, "StateBufferConnector_ms": 0.0017085075378417969, "ViewRequirementAgentConnector_ms": 0.044629573822021484}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2319840, "num_agent_steps_trained": 2319840, "num_env_steps_sampled": 2319840, "num_env_steps_trained": 2319840, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 451.0007331994175, "num_env_steps_trained_throughput_per_sec": 451.0007331994175, "timesteps_total": 2319840, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2319840, "timers": {"training_iteration_time_ms": 2654.109, "sample_time_ms": 2632.649, "load_time_ms": 0.422, "load_throughput": 2841829.823, "learn_time_ms": 20.442, "learn_throughput": 58702.645, "synch_weights_time_ms": 0.559}, "counters": {"num_env_steps_sampled": 2319840, "num_env_steps_trained": 2319840, "num_agent_steps_sampled": 2319840, "num_agent_steps_trained": 2319840}, "done": false, "episodes_total": 7032, "training_iteration": 1552, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-39-08", "timestamp": 1691239148, "time_this_iter_s": 10.645205020904541, "time_total_s": 19861.685439825058, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 914.874648809433, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 29.2, "ram_util_percent": 69.46}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -321.8662821451823, "policy_loss": -2388053.9149305555, "vf_loss": 3328120.1944444445}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6327.5, "diff_num_grad_updates_vs_sampler_policy": 6326.5}}, "num_env_steps_sampled": 2324640, "num_env_steps_trained": 2324640, "num_agent_steps_sampled": 2324640, "num_agent_steps_trained": 2324640}, "sampler_results": {"episode_reward_max": -3795.6746934360763, "episode_reward_min": -4253.911927103893, "episode_reward_mean": -3993.284776228935, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3776684886390018, "mean_inference_ms": 0.2328544671904483, "mean_action_processing_ms": 0.057354875628147235, "mean_env_wait_ms": 0.487094883002191, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026712417602539062, "StateBufferConnector_ms": 0.0017137527465820312, "ViewRequirementAgentConnector_ms": 0.04485511779785156}}, "episode_reward_max": -3795.6746934360763, "episode_reward_min": -4253.911927103893, "episode_reward_mean": -3993.284776228935, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4147.729899902109, -4033.479646214124, -3980.798413911634, -3795.6746934360763, -3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3776684886390018, "mean_inference_ms": 0.2328544671904483, "mean_action_processing_ms": 0.057354875628147235, "mean_env_wait_ms": 0.487094883002191, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026712417602539062, "StateBufferConnector_ms": 0.0017137527465820312, "ViewRequirementAgentConnector_ms": 0.04485511779785156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2324640, "num_agent_steps_trained": 2324640, "num_env_steps_sampled": 2324640, "num_env_steps_trained": 2324640, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 450.26806869033607, "num_env_steps_trained_throughput_per_sec": 450.26806869033607, "timesteps_total": 2324640, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2324640, "timers": {"training_iteration_time_ms": 2660.442, "sample_time_ms": 2639.212, "load_time_ms": 0.421, "load_throughput": 2847940.248, "learn_time_ms": 20.219, "learn_throughput": 59349.929, "synch_weights_time_ms": 0.553}, "counters": {"num_env_steps_sampled": 2324640, "num_env_steps_trained": 2324640, "num_agent_steps_sampled": 2324640, "num_agent_steps_trained": 2324640}, "done": false, "episodes_total": 7036, "training_iteration": 1553, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-39-18", "timestamp": 1691239158, "time_this_iter_s": 10.662546873092651, "time_total_s": 19872.34798669815, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 925.5371956825256, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 30.633333333333333, "ram_util_percent": 69.48666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.3416493733724, "policy_loss": -1513547.3871527778, "vf_loss": 3055337.3680555555}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6399.5, "diff_num_grad_updates_vs_sampler_policy": 6398.5}}, "num_env_steps_sampled": 2329440, "num_env_steps_trained": 2329440, "num_agent_steps_sampled": 2329440, "num_agent_steps_trained": 2329440}, "sampler_results": {"episode_reward_max": -3806.065255088926, "episode_reward_min": -4253.911927103893, "episode_reward_mean": -3988.292321861659, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3778017240700167, "mean_inference_ms": 0.23290852300940387, "mean_action_processing_ms": 0.05736357563758067, "mean_env_wait_ms": 0.48721819122910304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026564598083496094, "StateBufferConnector_ms": 0.0017154216766357422, "ViewRequirementAgentConnector_ms": 0.04469490051269531}}, "episode_reward_max": -3806.065255088926, "episode_reward_min": -4253.911927103893, "episode_reward_mean": -3988.292321861659, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3985.3729784916395, -3979.808273102678, -3905.201961359772, -3869.257924269636, -3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3778017240700167, "mean_inference_ms": 0.23290852300940387, "mean_action_processing_ms": 0.05736357563758067, "mean_env_wait_ms": 0.48721819122910304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026564598083496094, "StateBufferConnector_ms": 0.0017154216766357422, "ViewRequirementAgentConnector_ms": 0.04469490051269531}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2329440, "num_agent_steps_trained": 2329440, "num_env_steps_sampled": 2329440, "num_env_steps_trained": 2329440, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 457.42180636845626, "num_env_steps_trained_throughput_per_sec": 457.42180636845626, "timesteps_total": 2329440, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2329440, "timers": {"training_iteration_time_ms": 2651.74, "sample_time_ms": 2630.556, "load_time_ms": 0.425, "load_throughput": 2822704.728, "learn_time_ms": 20.163, "learn_throughput": 59515.552, "synch_weights_time_ms": 0.559}, "counters": {"num_env_steps_sampled": 2329440, "num_env_steps_trained": 2329440, "num_agent_steps_sampled": 2329440, "num_agent_steps_trained": 2329440}, "done": false, "episodes_total": 7040, "training_iteration": 1554, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-39-29", "timestamp": 1691239169, "time_this_iter_s": 10.495887994766235, "time_total_s": 19882.843874692917, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 936.0330836772919, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 25.56, "ram_util_percent": 69.24}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.63189697265625, "policy_loss": -523518.18402777775, "vf_loss": 3011517.0208333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6471.5, "diff_num_grad_updates_vs_sampler_policy": 6470.5}}, "num_env_steps_sampled": 2334240, "num_env_steps_trained": 2334240, "num_agent_steps_sampled": 2334240, "num_agent_steps_trained": 2334240}, "sampler_results": {"episode_reward_max": -3806.065255088926, "episode_reward_min": -4253.911927103893, "episode_reward_mean": -3990.964804645754, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.377935012456632, "mean_inference_ms": 0.23296726245176835, "mean_action_processing_ms": 0.057372973413031915, "mean_env_wait_ms": 0.48734422957598506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026552677154541016, "StateBufferConnector_ms": 0.00173187255859375, "ViewRequirementAgentConnector_ms": 0.044766902923583984}}, "episode_reward_max": -3806.065255088926, "episode_reward_min": -4253.911927103893, "episode_reward_mean": -3990.964804645754, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3993.693485482526, -3933.7649796702053, -3937.1529179700124, -4174.608587065212, -4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.377935012456632, "mean_inference_ms": 0.23296726245176835, "mean_action_processing_ms": 0.057372973413031915, "mean_env_wait_ms": 0.48734422957598506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026552677154541016, "StateBufferConnector_ms": 0.00173187255859375, "ViewRequirementAgentConnector_ms": 0.044766902923583984}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2334240, "num_agent_steps_trained": 2334240, "num_env_steps_sampled": 2334240, "num_env_steps_trained": 2334240, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 448.7240301837045, "num_env_steps_trained_throughput_per_sec": 448.7240301837045, "timesteps_total": 2334240, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2334240, "timers": {"training_iteration_time_ms": 2654.013, "sample_time_ms": 2632.686, "load_time_ms": 0.425, "load_throughput": 2823338.083, "learn_time_ms": 20.306, "learn_throughput": 59097.247, "synch_weights_time_ms": 0.559}, "counters": {"num_env_steps_sampled": 2334240, "num_env_steps_trained": 2334240, "num_agent_steps_sampled": 2334240, "num_agent_steps_trained": 2334240}, "done": false, "episodes_total": 7044, "training_iteration": 1555, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-39-40", "timestamp": 1691239180, "time_this_iter_s": 10.699172019958496, "time_total_s": 19893.543046712875, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 946.7322556972504, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 28.766666666666666, "ram_util_percent": 69.34666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.07417466905383, "policy_loss": -1611277.3111979167, "vf_loss": 3173719.777777778}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6543.5, "diff_num_grad_updates_vs_sampler_policy": 6542.5}}, "num_env_steps_sampled": 2339040, "num_env_steps_trained": 2339040, "num_agent_steps_sampled": 2339040, "num_agent_steps_trained": 2339040}, "sampler_results": {"episode_reward_max": -3806.065255088926, "episode_reward_min": -4253.911927103893, "episode_reward_mean": -3989.2406041534623, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3780613087941445, "mean_inference_ms": 0.23302218224380664, "mean_action_processing_ms": 0.05738172372279788, "mean_env_wait_ms": 0.48746641031545906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026509761810302734, "StateBufferConnector_ms": 0.001733541488647461, "ViewRequirementAgentConnector_ms": 0.044806480407714844}}, "episode_reward_max": -3806.065255088926, "episode_reward_min": -4253.911927103893, "episode_reward_mean": -3989.2406041534623, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4066.620202584944, -3918.49214478662, -4036.48345589404, -3956.5846580034827, -3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3780613087941445, "mean_inference_ms": 0.23302218224380664, "mean_action_processing_ms": 0.05738172372279788, "mean_env_wait_ms": 0.48746641031545906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026509761810302734, "StateBufferConnector_ms": 0.001733541488647461, "ViewRequirementAgentConnector_ms": 0.044806480407714844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2339040, "num_agent_steps_trained": 2339040, "num_env_steps_sampled": 2339040, "num_env_steps_trained": 2339040, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 452.8421606809613, "num_env_steps_trained_throughput_per_sec": 452.8421606809613, "timesteps_total": 2339040, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2339040, "timers": {"training_iteration_time_ms": 2657.616, "sample_time_ms": 2636.001, "load_time_ms": 0.426, "load_throughput": 2819226.349, "learn_time_ms": 20.595, "learn_throughput": 58267.912, "synch_weights_time_ms": 0.558}, "counters": {"num_env_steps_sampled": 2339040, "num_env_steps_trained": 2339040, "num_agent_steps_sampled": 2339040, "num_agent_steps_trained": 2339040}, "done": false, "episodes_total": 7048, "training_iteration": 1556, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-39-50", "timestamp": 1691239190, "time_this_iter_s": 10.601802825927734, "time_total_s": 19904.144849538803, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 957.3340585231781, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 27.166666666666664, "ram_util_percent": 69.29333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.199999999999999e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.1623704698351, "policy_loss": -1911063.9136284722, "vf_loss": 3227949.715277778}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 6614.5}}, "num_env_steps_sampled": 2343840, "num_env_steps_trained": 2343840, "num_agent_steps_sampled": 2343840, "num_agent_steps_trained": 2343840}, "sampler_results": {"episode_reward_max": -3806.065255088926, "episode_reward_min": -4253.911927103893, "episode_reward_mean": -3989.839076886115, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.378191151699142, "mean_inference_ms": 0.23307887555192244, "mean_action_processing_ms": 0.0573907997379043, "mean_env_wait_ms": 0.4875899421130623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026540756225585938, "StateBufferConnector_ms": 0.001749277114868164, "ViewRequirementAgentConnector_ms": 0.04487752914428711}}, "episode_reward_max": -3806.065255088926, "episode_reward_min": -4253.911927103893, "episode_reward_mean": -3989.839076886115, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3967.1051287440014, -3817.973290257903, -3937.230926507777, -3949.3577185817885, -4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.378191151699142, "mean_inference_ms": 0.23307887555192244, "mean_action_processing_ms": 0.0573907997379043, "mean_env_wait_ms": 0.4875899421130623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026540756225585938, "StateBufferConnector_ms": 0.001749277114868164, "ViewRequirementAgentConnector_ms": 0.04487752914428711}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2343840, "num_agent_steps_trained": 2343840, "num_env_steps_sampled": 2343840, "num_env_steps_trained": 2343840, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 451.28401924973105, "num_env_steps_trained_throughput_per_sec": 451.28401924973105, "timesteps_total": 2343840, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2343840, "timers": {"training_iteration_time_ms": 2658.941, "sample_time_ms": 2637.237, "load_time_ms": 0.426, "load_throughput": 2817648.099, "learn_time_ms": 20.651, "learn_throughput": 58107.407, "synch_weights_time_ms": 0.588}, "counters": {"num_env_steps_sampled": 2343840, "num_env_steps_trained": 2343840, "num_agent_steps_sampled": 2343840, "num_agent_steps_trained": 2343840}, "done": false, "episodes_total": 7052, "training_iteration": 1557, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-40-01", "timestamp": 1691239201, "time_this_iter_s": 10.638491153717041, "time_total_s": 19914.78334069252, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 967.9725496768951, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 28.740000000000006, "ram_util_percent": 69.33999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.133333333333333e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.40814887152777, "policy_loss": -820619.7808159722, "vf_loss": 3084460.486111111}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6687.5, "diff_num_grad_updates_vs_sampler_policy": 6686.5}}, "num_env_steps_sampled": 2348640, "num_env_steps_trained": 2348640, "num_agent_steps_sampled": 2348640, "num_agent_steps_trained": 2348640}, "sampler_results": {"episode_reward_max": -3806.065255088926, "episode_reward_min": -4269.572909381862, "episode_reward_mean": -3993.3852101048624, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3783104119437968, "mean_inference_ms": 0.2331363179703792, "mean_action_processing_ms": 0.05740005596338208, "mean_env_wait_ms": 0.4877146196415208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026595592498779297, "StateBufferConnector_ms": 0.0017588138580322266, "ViewRequirementAgentConnector_ms": 0.04487729072570801}}, "episode_reward_max": -3806.065255088926, "episode_reward_min": -4269.572909381862, "episode_reward_mean": -3993.3852101048624, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4157.813104921655, -3861.963499668353, -3923.317927894804, -3971.449504131591, -3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3783104119437968, "mean_inference_ms": 0.2331363179703792, "mean_action_processing_ms": 0.05740005596338208, "mean_env_wait_ms": 0.4877146196415208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026595592498779297, "StateBufferConnector_ms": 0.0017588138580322266, "ViewRequirementAgentConnector_ms": 0.04487729072570801}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2348640, "num_agent_steps_trained": 2348640, "num_env_steps_sampled": 2348640, "num_env_steps_trained": 2348640, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 452.155360903142, "num_env_steps_trained_throughput_per_sec": 452.155360903142, "timesteps_total": 2348640, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2348640, "timers": {"training_iteration_time_ms": 2656.042, "sample_time_ms": 2634.457, "load_time_ms": 0.429, "load_throughput": 2796047.331, "learn_time_ms": 20.526, "learn_throughput": 58463.106, "synch_weights_time_ms": 0.591}, "counters": {"num_env_steps_sampled": 2348640, "num_env_steps_trained": 2348640, "num_agent_steps_sampled": 2348640, "num_agent_steps_trained": 2348640}, "done": false, "episodes_total": 7056, "training_iteration": 1558, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-40-11", "timestamp": 1691239211, "time_this_iter_s": 10.618009805679321, "time_total_s": 19925.4013504982, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 978.5905594825745, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 27.319999999999997, "ram_util_percent": 69.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.0666666666666665e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.55128987630206, "policy_loss": -97068.28125, "vf_loss": 3039625.3541666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6759.5, "diff_num_grad_updates_vs_sampler_policy": 6758.5}}, "num_env_steps_sampled": 2353440, "num_env_steps_trained": 2353440, "num_agent_steps_sampled": 2353440, "num_agent_steps_trained": 2353440}, "sampler_results": {"episode_reward_max": -3753.273999969725, "episode_reward_min": -4269.572909381862, "episode_reward_mean": -3988.488169508226, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3784254446198747, "mean_inference_ms": 0.23319225528387066, "mean_action_processing_ms": 0.057409125297840674, "mean_env_wait_ms": 0.48783515631893876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002659320831298828, "StateBufferConnector_ms": 0.0017516613006591797, "ViewRequirementAgentConnector_ms": 0.044774770736694336}}, "episode_reward_max": -3753.273999969725, "episode_reward_min": -4269.572909381862, "episode_reward_mean": -3988.488169508226, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3864.9193285135184, -4026.2989072694695, -3869.630917696951, -3914.9415147889317, -3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3784254446198747, "mean_inference_ms": 0.23319225528387066, "mean_action_processing_ms": 0.057409125297840674, "mean_env_wait_ms": 0.48783515631893876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002659320831298828, "StateBufferConnector_ms": 0.0017516613006591797, "ViewRequirementAgentConnector_ms": 0.044774770736694336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2353440, "num_agent_steps_trained": 2353440, "num_env_steps_sampled": 2353440, "num_env_steps_trained": 2353440, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 453.7202103739689, "num_env_steps_trained_throughput_per_sec": 453.7202103739689, "timesteps_total": 2353440, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2353440, "timers": {"training_iteration_time_ms": 2654.854, "sample_time_ms": 2633.056, "load_time_ms": 0.433, "load_throughput": 2773551.992, "learn_time_ms": 20.738, "learn_throughput": 57865.04, "synch_weights_time_ms": 0.589}, "counters": {"num_env_steps_sampled": 2353440, "num_env_steps_trained": 2353440, "num_agent_steps_sampled": 2353440, "num_agent_steps_trained": 2353440}, "done": false, "episodes_total": 7060, "training_iteration": 1559, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-40-22", "timestamp": 1691239222, "time_this_iter_s": 10.581440925598145, "time_total_s": 19935.982791423798, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 989.1720004081726, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 25.66, "ram_util_percent": 69.38666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.05770704481336, "policy_loss": -1063526.052734375, "vf_loss": 3081922.4166666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6831.5, "diff_num_grad_updates_vs_sampler_policy": 6830.5}}, "num_env_steps_sampled": 2358240, "num_env_steps_trained": 2358240, "num_agent_steps_sampled": 2358240, "num_agent_steps_trained": 2358240}, "sampler_results": {"episode_reward_max": -3753.273999969725, "episode_reward_min": -4269.572909381862, "episode_reward_mean": -3994.2221574705723, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3785439670101838, "mean_inference_ms": 0.2332427762854065, "mean_action_processing_ms": 0.05741736920358328, "mean_env_wait_ms": 0.4879468055776418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002655506134033203, "StateBufferConnector_ms": 0.0017459392547607422, "ViewRequirementAgentConnector_ms": 0.04473257064819336}}, "episode_reward_max": -3753.273999969725, "episode_reward_min": -4269.572909381862, "episode_reward_mean": -3994.2221574705723, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3838.4754766902224, -3955.495327371911, -4105.626911438178, -4051.6275016160503, -3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3785439670101838, "mean_inference_ms": 0.2332427762854065, "mean_action_processing_ms": 0.05741736920358328, "mean_env_wait_ms": 0.4879468055776418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002655506134033203, "StateBufferConnector_ms": 0.0017459392547607422, "ViewRequirementAgentConnector_ms": 0.04473257064819336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2358240, "num_agent_steps_trained": 2358240, "num_env_steps_sampled": 2358240, "num_env_steps_trained": 2358240, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 452.456399122337, "num_env_steps_trained_throughput_per_sec": 452.456399122337, "timesteps_total": 2358240, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2358240, "timers": {"training_iteration_time_ms": 2653.013, "sample_time_ms": 2631.029, "load_time_ms": 0.445, "load_throughput": 2697735.327, "learn_time_ms": 20.914, "learn_throughput": 57376.835, "synch_weights_time_ms": 0.585}, "counters": {"num_env_steps_sampled": 2358240, "num_env_steps_trained": 2358240, "num_agent_steps_sampled": 2358240, "num_agent_steps_trained": 2358240}, "done": false, "episodes_total": 7064, "training_iteration": 1560, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-40-33", "timestamp": 1691239233, "time_this_iter_s": 10.61103105545044, "time_total_s": 19946.593822479248, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 999.783031463623, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 28.986666666666668, "ram_util_percent": 69.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -321.69829644097223, "policy_loss": -1394541.1397569445, "vf_loss": 3195949.5208333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6903.5, "diff_num_grad_updates_vs_sampler_policy": 6902.5}}, "num_env_steps_sampled": 2363040, "num_env_steps_trained": 2363040, "num_agent_steps_sampled": 2363040, "num_agent_steps_trained": 2363040}, "sampler_results": {"episode_reward_max": -3753.273999969725, "episode_reward_min": -4269.572909381862, "episode_reward_mean": -3993.5654704025283, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3786623227946897, "mean_inference_ms": 0.2332956803763885, "mean_action_processing_ms": 0.05742606249521744, "mean_env_wait_ms": 0.4880621268882169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026574134826660156, "StateBufferConnector_ms": 0.0017435550689697266, "ViewRequirementAgentConnector_ms": 0.04475593566894531}}, "episode_reward_max": -3753.273999969725, "episode_reward_min": -4269.572909381862, "episode_reward_mean": -3993.5654704025283, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3853.670751698826, -3896.434839215364, -4008.0936474241676, -4132.277283594052, -4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3786623227946897, "mean_inference_ms": 0.2332956803763885, "mean_action_processing_ms": 0.05742606249521744, "mean_env_wait_ms": 0.4880621268882169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026574134826660156, "StateBufferConnector_ms": 0.0017435550689697266, "ViewRequirementAgentConnector_ms": 0.04475593566894531}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2363040, "num_agent_steps_trained": 2363040, "num_env_steps_sampled": 2363040, "num_env_steps_trained": 2363040, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 446.52811692070793, "num_env_steps_trained_throughput_per_sec": 446.52811692070793, "timesteps_total": 2363040, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2363040, "timers": {"training_iteration_time_ms": 2663.441, "sample_time_ms": 2641.517, "load_time_ms": 0.44, "load_throughput": 2724753.573, "learn_time_ms": 20.848, "learn_throughput": 57559.708, "synch_weights_time_ms": 0.597}, "counters": {"num_env_steps_sampled": 2363040, "num_env_steps_trained": 2363040, "num_agent_steps_sampled": 2363040, "num_agent_steps_trained": 2363040}, "done": false, "episodes_total": 7068, "training_iteration": 1561, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-40-43", "timestamp": 1691239243, "time_this_iter_s": 10.751982927322388, "time_total_s": 19957.34580540657, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1010.5350143909454, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 31.259999999999998, "ram_util_percent": 69.70666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.0768568250868, "policy_loss": -1130680.689236111, "vf_loss": 3010256.326388889}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 6974.5}}, "num_env_steps_sampled": 2367840, "num_env_steps_trained": 2367840, "num_agent_steps_sampled": 2367840, "num_agent_steps_trained": 2367840}, "sampler_results": {"episode_reward_max": -3753.273999969725, "episode_reward_min": -4269.572909381862, "episode_reward_mean": -3993.8043225684205, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3787735544841737, "mean_inference_ms": 0.23334576554065492, "mean_action_processing_ms": 0.05743427849277152, "mean_env_wait_ms": 0.48817151739907244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002650022506713867, "StateBufferConnector_ms": 0.0017328262329101562, "ViewRequirementAgentConnector_ms": 0.04466867446899414}}, "episode_reward_max": -3753.273999969725, "episode_reward_min": -4269.572909381862, "episode_reward_mean": -3993.8043225684205, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4008.5118668656028, -3987.9364085385664, -4057.7125926904573, -4038.278262207424, -3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3787735544841737, "mean_inference_ms": 0.23334576554065492, "mean_action_processing_ms": 0.05743427849277152, "mean_env_wait_ms": 0.48817151739907244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002650022506713867, "StateBufferConnector_ms": 0.0017328262329101562, "ViewRequirementAgentConnector_ms": 0.04466867446899414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2367840, "num_agent_steps_trained": 2367840, "num_env_steps_sampled": 2367840, "num_env_steps_trained": 2367840, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 456.19956196577687, "num_env_steps_trained_throughput_per_sec": 456.19956196577687, "timesteps_total": 2367840, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2367840, "timers": {"training_iteration_time_ms": 2657.974, "sample_time_ms": 2636.386, "load_time_ms": 0.431, "load_throughput": 2785370.67, "learn_time_ms": 20.53, "learn_throughput": 58451.971, "synch_weights_time_ms": 0.589}, "counters": {"num_env_steps_sampled": 2367840, "num_env_steps_trained": 2367840, "num_agent_steps_sampled": 2367840, "num_agent_steps_trained": 2367840}, "done": false, "episodes_total": 7072, "training_iteration": 1562, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-40-54", "timestamp": 1691239254, "time_this_iter_s": 10.52405309677124, "time_total_s": 19967.86985850334, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1021.0590674877167, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 22.84666666666667, "ram_util_percent": 69.76}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.97957017686633, "policy_loss": -971374.6080729166, "vf_loss": 2998370.576388889}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7047.5, "diff_num_grad_updates_vs_sampler_policy": 7046.5}}, "num_env_steps_sampled": 2372640, "num_env_steps_trained": 2372640, "num_agent_steps_sampled": 2372640, "num_agent_steps_trained": 2372640}, "sampler_results": {"episode_reward_max": -3753.273999969725, "episode_reward_min": -4269.572909381862, "episode_reward_mean": -3988.690877781819, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3788858587700366, "mean_inference_ms": 0.23339635761634792, "mean_action_processing_ms": 0.05744246023761924, "mean_env_wait_ms": 0.4882701271204864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026781558990478516, "StateBufferConnector_ms": 0.0017476081848144531, "ViewRequirementAgentConnector_ms": 0.04497575759887695}}, "episode_reward_max": -3753.273999969725, "episode_reward_min": -4269.572909381862, "episode_reward_mean": -3988.690877781819, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3945.633358176248, -4215.482810111044, -3908.0970230507655, -4075.9151559019674, -4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3788858587700366, "mean_inference_ms": 0.23339635761634792, "mean_action_processing_ms": 0.05744246023761924, "mean_env_wait_ms": 0.4882701271204864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026781558990478516, "StateBufferConnector_ms": 0.0017476081848144531, "ViewRequirementAgentConnector_ms": 0.04497575759887695}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2372640, "num_agent_steps_trained": 2372640, "num_env_steps_sampled": 2372640, "num_env_steps_trained": 2372640, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 452.6693644565634, "num_env_steps_trained_throughput_per_sec": 452.6693644565634, "timesteps_total": 2372640, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2372640, "timers": {"training_iteration_time_ms": 2650.078, "sample_time_ms": 2628.639, "load_time_ms": 0.436, "load_throughput": 2750814.232, "learn_time_ms": 20.373, "learn_throughput": 58901.112, "synch_weights_time_ms": 0.592}, "counters": {"num_env_steps_sampled": 2372640, "num_env_steps_trained": 2372640, "num_agent_steps_sampled": 2372640, "num_agent_steps_trained": 2372640}, "done": false, "episodes_total": 7076, "training_iteration": 1563, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-41-05", "timestamp": 1691239265, "time_this_iter_s": 10.605841875076294, "time_total_s": 19978.475700378418, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1031.664909362793, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 29.44, "ram_util_percent": 69.79333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.2828555636936, "policy_loss": -1722513.954155816, "vf_loss": 3085640.215277778}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7119.5, "diff_num_grad_updates_vs_sampler_policy": 7118.5}}, "num_env_steps_sampled": 2377440, "num_env_steps_trained": 2377440, "num_agent_steps_sampled": 2377440, "num_agent_steps_trained": 2377440}, "sampler_results": {"episode_reward_max": -3753.273999969725, "episode_reward_min": -4269.572909381862, "episode_reward_mean": -3984.6207163175022, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3789929107063241, "mean_inference_ms": 0.23344431221284495, "mean_action_processing_ms": 0.057450163762230756, "mean_env_wait_ms": 0.48836991370471494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002680540084838867, "StateBufferConnector_ms": 0.0017511844635009766, "ViewRequirementAgentConnector_ms": 0.04500913619995117}}, "episode_reward_max": -3753.273999969725, "episode_reward_min": -4269.572909381862, "episode_reward_mean": -3984.6207163175022, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4227.637408329059, -3962.5581120410134, -3967.678255613795, -4243.051822601634, -4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3789929107063241, "mean_inference_ms": 0.23344431221284495, "mean_action_processing_ms": 0.057450163762230756, "mean_env_wait_ms": 0.48836991370471494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002680540084838867, "StateBufferConnector_ms": 0.0017511844635009766, "ViewRequirementAgentConnector_ms": 0.04500913619995117}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2377440, "num_agent_steps_trained": 2377440, "num_env_steps_sampled": 2377440, "num_env_steps_trained": 2377440, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 451.166403554641, "num_env_steps_trained_throughput_per_sec": 451.166403554641, "timesteps_total": 2377440, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2377440, "timers": {"training_iteration_time_ms": 2650.88, "sample_time_ms": 2629.436, "load_time_ms": 0.436, "load_throughput": 2754276.458, "learn_time_ms": 20.389, "learn_throughput": 58854.208, "synch_weights_time_ms": 0.581}, "counters": {"num_env_steps_sampled": 2377440, "num_env_steps_trained": 2377440, "num_agent_steps_sampled": 2377440, "num_agent_steps_trained": 2377440}, "done": false, "episodes_total": 7080, "training_iteration": 1564, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-41-15", "timestamp": 1691239275, "time_this_iter_s": 10.641211986541748, "time_total_s": 19989.11691236496, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1042.3061213493347, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 27.939999999999998, "ram_util_percent": 69.68}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -321.96170383029516, "policy_loss": -2112476.2766927085, "vf_loss": 3324703.5625}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7191.5, "diff_num_grad_updates_vs_sampler_policy": 7190.5}}, "num_env_steps_sampled": 2382240, "num_env_steps_trained": 2382240, "num_agent_steps_sampled": 2382240, "num_agent_steps_trained": 2382240}, "sampler_results": {"episode_reward_max": -3753.273999969725, "episode_reward_min": -4323.681448455668, "episode_reward_mean": -3985.0816534171895, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3790961302523965, "mean_inference_ms": 0.23349251937847262, "mean_action_processing_ms": 0.05745791767802087, "mean_env_wait_ms": 0.4884648689705237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027015209197998047, "StateBufferConnector_ms": 0.0017626285552978516, "ViewRequirementAgentConnector_ms": 0.04527425765991211}}, "episode_reward_max": -3753.273999969725, "episode_reward_min": -4323.681448455668, "episode_reward_mean": -3985.0816534171895, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4004.0421033912758, -4191.148154879409, -3913.538209678998, -4011.3814016239457, -3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3790961302523965, "mean_inference_ms": 0.23349251937847262, "mean_action_processing_ms": 0.05745791767802087, "mean_env_wait_ms": 0.4884648689705237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027015209197998047, "StateBufferConnector_ms": 0.0017626285552978516, "ViewRequirementAgentConnector_ms": 0.04527425765991211}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2382240, "num_agent_steps_trained": 2382240, "num_env_steps_sampled": 2382240, "num_env_steps_trained": 2382240, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 449.9144873129476, "num_env_steps_trained_throughput_per_sec": 449.9144873129476, "timesteps_total": 2382240, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2382240, "timers": {"training_iteration_time_ms": 2653.192, "sample_time_ms": 2631.593, "load_time_ms": 0.433, "load_throughput": 2771413.909, "learn_time_ms": 20.55, "learn_throughput": 58394.735, "synch_weights_time_ms": 0.578}, "counters": {"num_env_steps_sampled": 2382240, "num_env_steps_trained": 2382240, "num_agent_steps_sampled": 2382240, "num_agent_steps_trained": 2382240}, "done": false, "episodes_total": 7084, "training_iteration": 1565, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-41-26", "timestamp": 1691239286, "time_this_iter_s": 10.67103099822998, "time_total_s": 19999.78794336319, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1052.9771523475647, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 27.84666666666667, "ram_util_percent": 69.39333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.45316738552515, "policy_loss": -650888.0386284722, "vf_loss": 3012686.795138889}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7263.5, "diff_num_grad_updates_vs_sampler_policy": 7262.5}}, "num_env_steps_sampled": 2387040, "num_env_steps_trained": 2387040, "num_agent_steps_sampled": 2387040, "num_agent_steps_trained": 2387040}, "sampler_results": {"episode_reward_max": -3753.273999969725, "episode_reward_min": -4323.681448455668, "episode_reward_mean": -3982.719453054191, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3791907622440396, "mean_inference_ms": 0.2335391060276223, "mean_action_processing_ms": 0.057465346733469966, "mean_env_wait_ms": 0.48855350958969185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027091503143310547, "StateBufferConnector_ms": 0.0017848014831542969, "ViewRequirementAgentConnector_ms": 0.04530191421508789}}, "episode_reward_max": -3753.273999969725, "episode_reward_min": -4323.681448455668, "episode_reward_mean": -3982.719453054191, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3900.961749883438, -4068.3740744343563, -3938.0814418731825, -3845.801223637317, -3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3791907622440396, "mean_inference_ms": 0.2335391060276223, "mean_action_processing_ms": 0.057465346733469966, "mean_env_wait_ms": 0.48855350958969185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027091503143310547, "StateBufferConnector_ms": 0.0017848014831542969, "ViewRequirementAgentConnector_ms": 0.04530191421508789}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2387040, "num_agent_steps_trained": 2387040, "num_env_steps_sampled": 2387040, "num_env_steps_trained": 2387040, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 451.2866190165264, "num_env_steps_trained_throughput_per_sec": 451.2866190165264, "timesteps_total": 2387040, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2387040, "timers": {"training_iteration_time_ms": 2666.899, "sample_time_ms": 2644.615, "load_time_ms": 0.429, "load_throughput": 2796824.183, "learn_time_ms": 21.211, "learn_throughput": 56575.489, "synch_weights_time_ms": 0.606}, "counters": {"num_env_steps_sampled": 2387040, "num_env_steps_trained": 2387040, "num_agent_steps_sampled": 2387040, "num_agent_steps_trained": 2387040}, "done": false, "episodes_total": 7088, "training_iteration": 1566, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-41-37", "timestamp": 1691239297, "time_this_iter_s": 10.638412237167358, "time_total_s": 20010.426355600357, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1063.615564584732, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 26.43125, "ram_util_percent": 69.43125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.3181627061632, "policy_loss": -961274.2243923611, "vf_loss": 3029481.1944444445}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7335.5, "diff_num_grad_updates_vs_sampler_policy": 7334.5}}, "num_env_steps_sampled": 2391840, "num_env_steps_trained": 2391840, "num_agent_steps_sampled": 2391840, "num_agent_steps_trained": 2391840}, "sampler_results": {"episode_reward_max": -3753.273999969725, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -3986.3514498802124, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3792856269075906, "mean_inference_ms": 0.23358463148262826, "mean_action_processing_ms": 0.05747254899100349, "mean_env_wait_ms": 0.48864301054247233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002713918685913086, "StateBufferConnector_ms": 0.0017886161804199219, "ViewRequirementAgentConnector_ms": 0.04535984992980957}}, "episode_reward_max": -3753.273999969725, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -3986.3514498802124, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3978.462718476035, -4079.2894729949103, -4161.58792410282, -4098.944433020796, -3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3792856269075906, "mean_inference_ms": 0.23358463148262826, "mean_action_processing_ms": 0.05747254899100349, "mean_env_wait_ms": 0.48864301054247233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002713918685913086, "StateBufferConnector_ms": 0.0017886161804199219, "ViewRequirementAgentConnector_ms": 0.04535984992980957}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2391840, "num_agent_steps_trained": 2391840, "num_env_steps_sampled": 2391840, "num_env_steps_trained": 2391840, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 449.03739032795943, "num_env_steps_trained_throughput_per_sec": 449.03739032795943, "timesteps_total": 2391840, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2391840, "timers": {"training_iteration_time_ms": 2665.728, "sample_time_ms": 2643.359, "load_time_ms": 0.427, "load_throughput": 2808372.28, "learn_time_ms": 21.308, "learn_throughput": 56317.714, "synch_weights_time_ms": 0.596}, "counters": {"num_env_steps_sampled": 2391840, "num_env_steps_trained": 2391840, "num_agent_steps_sampled": 2391840, "num_agent_steps_trained": 2391840}, "done": false, "episodes_total": 7092, "training_iteration": 1567, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-41-47", "timestamp": 1691239307, "time_this_iter_s": 10.691709995269775, "time_total_s": 20021.118065595627, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1074.3072745800018, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 29.006666666666664, "ram_util_percent": 69.51333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.6299828423394, "policy_loss": -678326.6315104166, "vf_loss": 2967729.576388889}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7407.5, "diff_num_grad_updates_vs_sampler_policy": 7406.5}}, "num_env_steps_sampled": 2396640, "num_env_steps_trained": 2396640, "num_agent_steps_sampled": 2396640, "num_agent_steps_trained": 2396640}, "sampler_results": {"episode_reward_max": -3753.273999969725, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -3977.4938464064194, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3793806928870977, "mean_inference_ms": 0.23362567400514425, "mean_action_processing_ms": 0.057479011672086786, "mean_env_wait_ms": 0.4887168859436326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027091503143310547, "StateBufferConnector_ms": 0.001783609390258789, "ViewRequirementAgentConnector_ms": 0.04535722732543945}}, "episode_reward_max": -3753.273999969725, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -3977.4938464064194, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3874.13693235629, -3922.048475443253, -4202.556812241874, -4016.4965876039305, -3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3793806928870977, "mean_inference_ms": 0.23362567400514425, "mean_action_processing_ms": 0.057479011672086786, "mean_env_wait_ms": 0.4887168859436326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027091503143310547, "StateBufferConnector_ms": 0.001783609390258789, "ViewRequirementAgentConnector_ms": 0.04535722732543945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2396640, "num_agent_steps_trained": 2396640, "num_env_steps_sampled": 2396640, "num_env_steps_trained": 2396640, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 453.51456081654817, "num_env_steps_trained_throughput_per_sec": 453.51456081654817, "timesteps_total": 2396640, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2396640, "timers": {"training_iteration_time_ms": 2657.429, "sample_time_ms": 2634.964, "load_time_ms": 0.428, "load_throughput": 2803210.693, "learn_time_ms": 21.408, "learn_throughput": 56054.723, "synch_weights_time_ms": 0.59}, "counters": {"num_env_steps_sampled": 2396640, "num_env_steps_trained": 2396640, "num_agent_steps_sampled": 2396640, "num_agent_steps_trained": 2396640}, "done": false, "episodes_total": 7096, "training_iteration": 1568, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-41-58", "timestamp": 1691239318, "time_this_iter_s": 10.586183071136475, "time_total_s": 20031.704248666763, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1084.8934576511383, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 27.85333333333333, "ram_util_percent": 69.54}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.34876844618054, "policy_loss": -878567.4952256945, "vf_loss": 2964985.472222222}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7479.5, "diff_num_grad_updates_vs_sampler_policy": 7478.5}}, "num_env_steps_sampled": 2401440, "num_env_steps_trained": 2401440, "num_agent_steps_sampled": 2401440, "num_agent_steps_trained": 2401440}, "sampler_results": {"episode_reward_max": -3753.273999969725, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -3976.403690729083, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3794775377011834, "mean_inference_ms": 0.2336672454204031, "mean_action_processing_ms": 0.05748555761741457, "mean_env_wait_ms": 0.4887864222987389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002722501754760742, "StateBufferConnector_ms": 0.00179290771484375, "ViewRequirementAgentConnector_ms": 0.04541277885437012}}, "episode_reward_max": -3753.273999969725, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -3976.403690729083, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3865.811301468883, -3988.0598929132016, -4001.6901655560746, -3857.220681804869, -3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3794775377011834, "mean_inference_ms": 0.2336672454204031, "mean_action_processing_ms": 0.05748555761741457, "mean_env_wait_ms": 0.4887864222987389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002722501754760742, "StateBufferConnector_ms": 0.00179290771484375, "ViewRequirementAgentConnector_ms": 0.04541277885437012}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2401440, "num_agent_steps_trained": 2401440, "num_env_steps_sampled": 2401440, "num_env_steps_trained": 2401440, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 452.30034779167295, "num_env_steps_trained_throughput_per_sec": 452.30034779167295, "timesteps_total": 2401440, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2401440, "timers": {"training_iteration_time_ms": 2649.342, "sample_time_ms": 2627.746, "load_time_ms": 0.433, "load_throughput": 2770651.106, "learn_time_ms": 20.545, "learn_throughput": 58407.881, "synch_weights_time_ms": 0.579}, "counters": {"num_env_steps_sampled": 2401440, "num_env_steps_trained": 2401440, "num_agent_steps_sampled": 2401440, "num_agent_steps_trained": 2401440}, "done": false, "episodes_total": 7100, "training_iteration": 1569, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-42-09", "timestamp": 1691239329, "time_this_iter_s": 10.61494517326355, "time_total_s": 20042.319193840027, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1095.5084028244019, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 33.43333333333333, "ram_util_percent": 69.65333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -321.9713372124566, "policy_loss": -1673039.0590277778, "vf_loss": 3358505.638888889}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7551.5, "diff_num_grad_updates_vs_sampler_policy": 7550.5}}, "num_env_steps_sampled": 2406240, "num_env_steps_trained": 2406240, "num_agent_steps_sampled": 2406240, "num_agent_steps_trained": 2406240}, "sampler_results": {"episode_reward_max": -3753.273999969725, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -3980.6282732721284, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3795726259446786, "mean_inference_ms": 0.23370731174290654, "mean_action_processing_ms": 0.05749188689663722, "mean_env_wait_ms": 0.488852199553826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027313232421875, "StateBufferConnector_ms": 0.0018012523651123047, "ViewRequirementAgentConnector_ms": 0.04549288749694824}}, "episode_reward_max": -3753.273999969725, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -3980.6282732721284, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3926.542396103452, -4028.675066710389, -4162.696708251824, -3844.1307870575793, -3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3795726259446786, "mean_inference_ms": 0.23370731174290654, "mean_action_processing_ms": 0.05749188689663722, "mean_env_wait_ms": 0.488852199553826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027313232421875, "StateBufferConnector_ms": 0.0018012523651123047, "ViewRequirementAgentConnector_ms": 0.04549288749694824}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2406240, "num_agent_steps_trained": 2406240, "num_env_steps_sampled": 2406240, "num_env_steps_trained": 2406240, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 452.5030565207529, "num_env_steps_trained_throughput_per_sec": 452.5030565207529, "timesteps_total": 2406240, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2406240, "timers": {"training_iteration_time_ms": 2651.355, "sample_time_ms": 2629.521, "load_time_ms": 0.437, "load_throughput": 2748110.729, "learn_time_ms": 20.746, "learn_throughput": 57843.227, "synch_weights_time_ms": 0.612}, "counters": {"num_env_steps_sampled": 2406240, "num_env_steps_trained": 2406240, "num_agent_steps_sampled": 2406240, "num_agent_steps_trained": 2406240}, "done": false, "episodes_total": 7104, "training_iteration": 1570, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-42-19", "timestamp": 1691239339, "time_this_iter_s": 10.609893321990967, "time_total_s": 20052.929087162018, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1106.1182961463928, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 26.459999999999997, "ram_util_percent": 69.46000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -321.9670104980469, "policy_loss": -2940283.5850694445, "vf_loss": 3328117.2881944445}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7623.5, "diff_num_grad_updates_vs_sampler_policy": 7622.5}}, "num_env_steps_sampled": 2411040, "num_env_steps_trained": 2411040, "num_agent_steps_sampled": 2411040, "num_agent_steps_trained": 2411040}, "sampler_results": {"episode_reward_max": -3753.273999969725, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -3983.182667510168, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3796662048735708, "mean_inference_ms": 0.2337487063626586, "mean_action_processing_ms": 0.057498437999593026, "mean_env_wait_ms": 0.48892459013697914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027403831481933594, "StateBufferConnector_ms": 0.0018055438995361328, "ViewRequirementAgentConnector_ms": 0.04559659957885742}}, "episode_reward_max": -3753.273999969725, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -3983.182667510168, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3912.9810258075977, -4253.911927103893, -3999.8946075465356, -3956.3155251546314, -3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3796662048735708, "mean_inference_ms": 0.2337487063626586, "mean_action_processing_ms": 0.057498437999593026, "mean_env_wait_ms": 0.48892459013697914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027403831481933594, "StateBufferConnector_ms": 0.0018055438995361328, "ViewRequirementAgentConnector_ms": 0.04559659957885742}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2411040, "num_agent_steps_trained": 2411040, "num_env_steps_sampled": 2411040, "num_env_steps_trained": 2411040, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 446.3618663895465, "num_env_steps_trained_throughput_per_sec": 446.3618663895465, "timesteps_total": 2411040, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2411040, "timers": {"training_iteration_time_ms": 2662.653, "sample_time_ms": 2640.785, "load_time_ms": 0.427, "load_throughput": 2808842.458, "learn_time_ms": 20.801, "learn_throughput": 57689.81, "synch_weights_time_ms": 0.602}, "counters": {"num_env_steps_sampled": 2411040, "num_env_steps_trained": 2411040, "num_agent_steps_sampled": 2411040, "num_agent_steps_trained": 2411040}, "done": false, "episodes_total": 7108, "training_iteration": 1571, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-42-30", "timestamp": 1691239350, "time_this_iter_s": 10.7558274269104, "time_total_s": 20063.68491458893, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1116.8741235733032, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 29.959999999999997, "ram_util_percent": 69.48666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.508544921875, "policy_loss": -2251104.2039930555, "vf_loss": 3392348.4375}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7695.5, "diff_num_grad_updates_vs_sampler_policy": 7694.5}}, "num_env_steps_sampled": 2415840, "num_env_steps_trained": 2415840, "num_agent_steps_sampled": 2415840, "num_agent_steps_trained": 2415840}, "sampler_results": {"episode_reward_max": -3753.273999969725, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -3985.228781594978, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3797600865289974, "mean_inference_ms": 0.23378782314053517, "mean_action_processing_ms": 0.057504520069808704, "mean_env_wait_ms": 0.4889947046869683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027360916137695312, "StateBufferConnector_ms": 0.0018086433410644531, "ViewRequirementAgentConnector_ms": 0.045540571212768555}}, "episode_reward_max": -3753.273999969725, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -3985.228781594978, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3888.1702609106032, -3902.642503516392, -4088.1663310841623, -3950.370844260146, -3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3797600865289974, "mean_inference_ms": 0.23378782314053517, "mean_action_processing_ms": 0.057504520069808704, "mean_env_wait_ms": 0.4889947046869683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027360916137695312, "StateBufferConnector_ms": 0.0018086433410644531, "ViewRequirementAgentConnector_ms": 0.045540571212768555}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2415840, "num_agent_steps_trained": 2415840, "num_env_steps_sampled": 2415840, "num_env_steps_trained": 2415840, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 452.5154750302778, "num_env_steps_trained_throughput_per_sec": 452.5154750302778, "timesteps_total": 2415840, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2415840, "timers": {"training_iteration_time_ms": 2665.548, "sample_time_ms": 2643.722, "load_time_ms": 0.424, "load_throughput": 2827144.189, "learn_time_ms": 20.76, "learn_throughput": 57802.705, "synch_weights_time_ms": 0.603}, "counters": {"num_env_steps_sampled": 2415840, "num_env_steps_trained": 2415840, "num_agent_steps_sampled": 2415840, "num_agent_steps_trained": 2415840}, "done": false, "episodes_total": 7112, "training_iteration": 1572, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-42-41", "timestamp": 1691239361, "time_this_iter_s": 10.609715938568115, "time_total_s": 20074.294630527496, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1127.4838395118713, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 28.77333333333333, "ram_util_percent": 69.58000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -321.9368421766493, "policy_loss": -1635741.1046006945, "vf_loss": 3194103.923611111}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7767.5, "diff_num_grad_updates_vs_sampler_policy": 7766.5}}, "num_env_steps_sampled": 2420640, "num_env_steps_trained": 2420640, "num_agent_steps_sampled": 2420640, "num_agent_steps_trained": 2420640}, "sampler_results": {"episode_reward_max": -3753.273999969725, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -3990.5071211345285, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.379858183655161, "mean_inference_ms": 0.23382987110642448, "mean_action_processing_ms": 0.05751104500910678, "mean_env_wait_ms": 0.4890740516427348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027437210083007812, "StateBufferConnector_ms": 0.0018150806427001953, "ViewRequirementAgentConnector_ms": 0.045812129974365234}}, "episode_reward_max": -3753.273999969725, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -3990.5071211345285, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3927.625933519365, -3806.065255088926, -4073.4808517764786, -4189.480892234059, -3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.379858183655161, "mean_inference_ms": 0.23382987110642448, "mean_action_processing_ms": 0.05751104500910678, "mean_env_wait_ms": 0.4890740516427348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027437210083007812, "StateBufferConnector_ms": 0.0018150806427001953, "ViewRequirementAgentConnector_ms": 0.045812129974365234}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2420640, "num_agent_steps_trained": 2420640, "num_env_steps_sampled": 2420640, "num_env_steps_trained": 2420640, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 445.8660982067433, "num_env_steps_trained_throughput_per_sec": 445.8660982067433, "timesteps_total": 2420640, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2420640, "timers": {"training_iteration_time_ms": 2676.773, "sample_time_ms": 2654.618, "load_time_ms": 0.435, "load_throughput": 2758503.124, "learn_time_ms": 21.046, "learn_throughput": 57016.618, "synch_weights_time_ms": 0.634}, "counters": {"num_env_steps_sampled": 2420640, "num_env_steps_trained": 2420640, "num_agent_steps_sampled": 2420640, "num_agent_steps_trained": 2420640}, "done": false, "episodes_total": 7116, "training_iteration": 1573, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-42-51", "timestamp": 1691239371, "time_this_iter_s": 10.76800799369812, "time_total_s": 20085.062638521194, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1138.2518475055695, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 40.486666666666665, "ram_util_percent": 69.61333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -321.93260871039496, "policy_loss": -1850678.958767361, "vf_loss": 3184539.5416666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7839.5, "diff_num_grad_updates_vs_sampler_policy": 7838.5}}, "num_env_steps_sampled": 2425440, "num_env_steps_trained": 2425440, "num_agent_steps_sampled": 2425440, "num_agent_steps_trained": 2425440}, "sampler_results": {"episode_reward_max": -3753.273999969725, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -3988.2943780204023, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3799493558426443, "mean_inference_ms": 0.23387061075584342, "mean_action_processing_ms": 0.0575174536173566, "mean_env_wait_ms": 0.4891558407457896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027451515197753906, "StateBufferConnector_ms": 0.001821279525756836, "ViewRequirementAgentConnector_ms": 0.04587388038635254}}, "episode_reward_max": -3753.273999969725, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -3988.2943780204023, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3820.187529539605, -4159.935911599221, -3823.274331799397, -4206.8618973715265, -4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3799493558426443, "mean_inference_ms": 0.23387061075584342, "mean_action_processing_ms": 0.0575174536173566, "mean_env_wait_ms": 0.4891558407457896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027451515197753906, "StateBufferConnector_ms": 0.001821279525756836, "ViewRequirementAgentConnector_ms": 0.04587388038635254}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2425440, "num_agent_steps_trained": 2425440, "num_env_steps_sampled": 2425440, "num_env_steps_trained": 2425440, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 454.25780660094944, "num_env_steps_trained_throughput_per_sec": 454.25780660094944, "timesteps_total": 2425440, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2425440, "timers": {"training_iteration_time_ms": 2663.625, "sample_time_ms": 2641.616, "load_time_ms": 0.441, "load_throughput": 2723131.959, "learn_time_ms": 20.9, "learn_throughput": 57415.845, "synch_weights_time_ms": 0.629}, "counters": {"num_env_steps_sampled": 2425440, "num_env_steps_trained": 2425440, "num_agent_steps_sampled": 2425440, "num_agent_steps_trained": 2425440}, "done": false, "episodes_total": 7120, "training_iteration": 1574, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-43-02", "timestamp": 1691239382, "time_this_iter_s": 10.569122076034546, "time_total_s": 20095.63176059723, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1148.820969581604, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 31.013333333333332, "ram_util_percent": 69.38666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.03984917534723, "policy_loss": -2282857.910590278, "vf_loss": 3430815.3055555555}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7911.5, "diff_num_grad_updates_vs_sampler_policy": 7910.5}}, "num_env_steps_sampled": 2430240, "num_env_steps_trained": 2430240, "num_agent_steps_sampled": 2430240, "num_agent_steps_trained": 2430240}, "sampler_results": {"episode_reward_max": -3753.273999969725, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -3987.7536469998345, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3800429657615307, "mean_inference_ms": 0.2339126212477406, "mean_action_processing_ms": 0.05752406489513234, "mean_env_wait_ms": 0.48924716385219597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002744913101196289, "StateBufferConnector_ms": 0.0018191337585449219, "ViewRequirementAgentConnector_ms": 0.04589438438415527}}, "episode_reward_max": -3753.273999969725, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -3987.7536469998345, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4189.376352973547, -3861.946447150432, -4217.505453709988, -3938.1466634455273, -4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3800429657615307, "mean_inference_ms": 0.2339126212477406, "mean_action_processing_ms": 0.05752406489513234, "mean_env_wait_ms": 0.48924716385219597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002744913101196289, "StateBufferConnector_ms": 0.0018191337585449219, "ViewRequirementAgentConnector_ms": 0.04589438438415527}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2430240, "num_agent_steps_trained": 2430240, "num_env_steps_sampled": 2430240, "num_env_steps_trained": 2430240, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 447.2665658550351, "num_env_steps_trained_throughput_per_sec": 447.2665658550351, "timesteps_total": 2430240, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2430240, "timers": {"training_iteration_time_ms": 2664.546, "sample_time_ms": 2642.787, "load_time_ms": 0.443, "load_throughput": 2710374.152, "learn_time_ms": 20.689, "learn_throughput": 58001.941, "synch_weights_time_ms": 0.588}, "counters": {"num_env_steps_sampled": 2430240, "num_env_steps_trained": 2430240, "num_agent_steps_sampled": 2430240, "num_agent_steps_trained": 2430240}, "done": false, "episodes_total": 7124, "training_iteration": 1575, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-43-13", "timestamp": 1691239393, "time_this_iter_s": 10.734122037887573, "time_total_s": 20106.365882635117, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1159.5550916194916, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 33.33125, "ram_util_percent": 69.50625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.768559773763, "policy_loss": -887305.4908854166, "vf_loss": 3107320.0833333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7983.5, "diff_num_grad_updates_vs_sampler_policy": 7982.5}}, "num_env_steps_sampled": 2435040, "num_env_steps_trained": 2435040, "num_agent_steps_sampled": 2435040, "num_agent_steps_trained": 2435040}, "sampler_results": {"episode_reward_max": -3753.273999969725, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -3983.66528104382, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.380132719159251, "mean_inference_ms": 0.23395340180047391, "mean_action_processing_ms": 0.05753045167543748, "mean_env_wait_ms": 0.489335083234199, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027418136596679688, "StateBufferConnector_ms": 0.001814126968383789, "ViewRequirementAgentConnector_ms": 0.04584074020385742}}, "episode_reward_max": -3753.273999969725, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -3983.66528104382, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4006.1861819716833, -3908.1449049841617, -3814.5427798836663, -4216.335035264869, -3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.380132719159251, "mean_inference_ms": 0.23395340180047391, "mean_action_processing_ms": 0.05753045167543748, "mean_env_wait_ms": 0.489335083234199, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027418136596679688, "StateBufferConnector_ms": 0.001814126968383789, "ViewRequirementAgentConnector_ms": 0.04584074020385742}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2435040, "num_agent_steps_trained": 2435040, "num_env_steps_sampled": 2435040, "num_env_steps_trained": 2435040, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 453.2087465793787, "num_env_steps_trained_throughput_per_sec": 453.2087465793787, "timesteps_total": 2435040, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2435040, "timers": {"training_iteration_time_ms": 2657.257, "sample_time_ms": 2635.894, "load_time_ms": 0.43, "load_throughput": 2788611.447, "learn_time_ms": 20.304, "learn_throughput": 59100.647, "synch_weights_time_ms": 0.59}, "counters": {"num_env_steps_sampled": 2435040, "num_env_steps_trained": 2435040, "num_agent_steps_sampled": 2435040, "num_agent_steps_trained": 2435040}, "done": false, "episodes_total": 7128, "training_iteration": 1576, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-43-23", "timestamp": 1691239403, "time_this_iter_s": 10.593387842178345, "time_total_s": 20116.959270477295, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1170.14847946167, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 26.39333333333333, "ram_util_percent": 69.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.12445237901477, "policy_loss": -2037691.3741319445, "vf_loss": 3481005.0416666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8055.5, "diff_num_grad_updates_vs_sampler_policy": 8054.5}}, "num_env_steps_sampled": 2439840, "num_env_steps_trained": 2439840, "num_agent_steps_sampled": 2439840, "num_agent_steps_trained": 2439840}, "sampler_results": {"episode_reward_max": -3753.273999969725, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -3987.3635183329957, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.380222950027494, "mean_inference_ms": 0.23399837466507847, "mean_action_processing_ms": 0.057536802605773596, "mean_env_wait_ms": 0.48942326218656407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027360916137695312, "StateBufferConnector_ms": 0.0018138885498046875, "ViewRequirementAgentConnector_ms": 0.045841217041015625}}, "episode_reward_max": -3753.273999969725, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -3987.3635183329957, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3856.1977018404577, -3987.1253675890443, -3977.144128976338, -4057.8614549853473, -3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.380222950027494, "mean_inference_ms": 0.23399837466507847, "mean_action_processing_ms": 0.057536802605773596, "mean_env_wait_ms": 0.48942326218656407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027360916137695312, "StateBufferConnector_ms": 0.0018138885498046875, "ViewRequirementAgentConnector_ms": 0.045841217041015625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2439840, "num_agent_steps_trained": 2439840, "num_env_steps_sampled": 2439840, "num_env_steps_trained": 2439840, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 445.6261330230137, "num_env_steps_trained_throughput_per_sec": 445.6261330230137, "timesteps_total": 2439840, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2439840, "timers": {"training_iteration_time_ms": 2674.459, "sample_time_ms": 2653.387, "load_time_ms": 0.426, "load_throughput": 2817490.372, "learn_time_ms": 20.032, "learn_throughput": 59903.867, "synch_weights_time_ms": 0.576}, "counters": {"num_env_steps_sampled": 2439840, "num_env_steps_trained": 2439840, "num_agent_steps_sampled": 2439840, "num_agent_steps_trained": 2439840}, "done": false, "episodes_total": 7132, "training_iteration": 1577, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-43-34", "timestamp": 1691239414, "time_this_iter_s": 10.773485898971558, "time_total_s": 20127.732756376266, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1180.9219653606415, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 30.073333333333338, "ram_util_percent": 69.36666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.1430884467231, "policy_loss": -2663740.3216145835, "vf_loss": 3313778.5208333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8127.5, "diff_num_grad_updates_vs_sampler_policy": 8126.5}}, "num_env_steps_sampled": 2444640, "num_env_steps_trained": 2444640, "num_agent_steps_sampled": 2444640, "num_agent_steps_trained": 2444640}, "sampler_results": {"episode_reward_max": -3753.273999969725, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -3987.8004458644177, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.38031243529158, "mean_inference_ms": 0.2340400716055372, "mean_action_processing_ms": 0.05754262899058077, "mean_env_wait_ms": 0.4895016437195626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002721071243286133, "StateBufferConnector_ms": 0.0018129348754882812, "ViewRequirementAgentConnector_ms": 0.04551506042480469}}, "episode_reward_max": -3753.273999969725, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -3987.8004458644177, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3937.0909546900466, -3823.736441558682, -3841.3404321965095, -3856.2693882909844, -4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.38031243529158, "mean_inference_ms": 0.2340400716055372, "mean_action_processing_ms": 0.05754262899058077, "mean_env_wait_ms": 0.4895016437195626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002721071243286133, "StateBufferConnector_ms": 0.0018129348754882812, "ViewRequirementAgentConnector_ms": 0.04551506042480469}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2444640, "num_agent_steps_trained": 2444640, "num_env_steps_sampled": 2444640, "num_env_steps_trained": 2444640, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 455.29389024967776, "num_env_steps_trained_throughput_per_sec": 455.29389024967776, "timesteps_total": 2444640, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2444640, "timers": {"training_iteration_time_ms": 2660.121, "sample_time_ms": 2638.246, "load_time_ms": 0.436, "load_throughput": 2755030.27, "learn_time_ms": 20.805, "learn_throughput": 57677.183, "synch_weights_time_ms": 0.595}, "counters": {"num_env_steps_sampled": 2444640, "num_env_steps_trained": 2444640, "num_agent_steps_sampled": 2444640, "num_agent_steps_trained": 2444640}, "done": false, "episodes_total": 7136, "training_iteration": 1578, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-43-45", "timestamp": 1691239425, "time_this_iter_s": 10.54529619216919, "time_total_s": 20138.278052568436, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1191.4672615528107, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 27.10666666666667, "ram_util_percent": 69.48666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.1173570421007, "policy_loss": -369074.99110243056, "vf_loss": 3019149.9930555555}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8199.5, "diff_num_grad_updates_vs_sampler_policy": 8198.5}}, "num_env_steps_sampled": 2449440, "num_env_steps_trained": 2449440, "num_agent_steps_sampled": 2449440, "num_agent_steps_trained": 2449440}, "sampler_results": {"episode_reward_max": -3753.273999969725, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -3995.2001463491797, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.380402460877792, "mean_inference_ms": 0.23408322862660447, "mean_action_processing_ms": 0.05754861978378413, "mean_env_wait_ms": 0.48958811297729776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002729177474975586, "StateBufferConnector_ms": 0.0018126964569091797, "ViewRequirementAgentConnector_ms": 0.04555034637451172}}, "episode_reward_max": -3753.273999969725, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -3995.2001463491797, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4035.630977756324, -4033.017474947769, -4114.737696862438, -3823.5032660667825, -3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.380402460877792, "mean_inference_ms": 0.23408322862660447, "mean_action_processing_ms": 0.05754861978378413, "mean_env_wait_ms": 0.48958811297729776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002729177474975586, "StateBufferConnector_ms": 0.0018126964569091797, "ViewRequirementAgentConnector_ms": 0.04555034637451172}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2449440, "num_agent_steps_trained": 2449440, "num_env_steps_sampled": 2449440, "num_env_steps_trained": 2449440, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 450.34822217259773, "num_env_steps_trained_throughput_per_sec": 450.34822217259773, "timesteps_total": 2449440, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2449440, "timers": {"training_iteration_time_ms": 2659.552, "sample_time_ms": 2637.149, "load_time_ms": 0.444, "load_throughput": 2701355.088, "learn_time_ms": 21.268, "learn_throughput": 56423.59, "synch_weights_time_ms": 0.652}, "counters": {"num_env_steps_sampled": 2449440, "num_env_steps_trained": 2449440, "num_agent_steps_sampled": 2449440, "num_agent_steps_trained": 2449440}, "done": false, "episodes_total": 7140, "training_iteration": 1579, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-43-55", "timestamp": 1691239435, "time_this_iter_s": 10.661074161529541, "time_total_s": 20148.939126729965, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1202.1283357143402, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 28.246666666666666, "ram_util_percent": 69.47333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -321.803478664822, "policy_loss": -2590063.9440104165, "vf_loss": 3240279.486111111}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8271.5, "diff_num_grad_updates_vs_sampler_policy": 8270.5}}, "num_env_steps_sampled": 2454240, "num_env_steps_trained": 2454240, "num_agent_steps_sampled": 2454240, "num_agent_steps_trained": 2454240}, "sampler_results": {"episode_reward_max": -3753.273999969725, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -3993.414182078794, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.380491453123564, "mean_inference_ms": 0.23412281765878085, "mean_action_processing_ms": 0.05755401726963047, "mean_env_wait_ms": 0.4896691179741064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027282238006591797, "StateBufferConnector_ms": 0.0017948150634765625, "ViewRequirementAgentConnector_ms": 0.045488834381103516}}, "episode_reward_max": -3753.273999969725, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -3993.414182078794, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3976.6137284284555, -4052.6187819157317, -3918.33782016207, -3919.2295904525427, -4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.380491453123564, "mean_inference_ms": 0.23412281765878085, "mean_action_processing_ms": 0.05755401726963047, "mean_env_wait_ms": 0.4896691179741064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027282238006591797, "StateBufferConnector_ms": 0.0017948150634765625, "ViewRequirementAgentConnector_ms": 0.045488834381103516}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2454240, "num_agent_steps_trained": 2454240, "num_env_steps_sampled": 2454240, "num_env_steps_trained": 2454240, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 451.8410731363378, "num_env_steps_trained_throughput_per_sec": 451.8410731363378, "timesteps_total": 2454240, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2454240, "timers": {"training_iteration_time_ms": 2657.132, "sample_time_ms": 2634.899, "load_time_ms": 0.441, "load_throughput": 2720188.51, "learn_time_ms": 21.106, "learn_throughput": 56856.885, "synch_weights_time_ms": 0.646}, "counters": {"num_env_steps_sampled": 2454240, "num_env_steps_trained": 2454240, "num_agent_steps_sampled": 2454240, "num_agent_steps_trained": 2454240}, "done": false, "episodes_total": 7144, "training_iteration": 1580, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-44-06", "timestamp": 1691239446, "time_this_iter_s": 10.625452995300293, "time_total_s": 20159.564579725266, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1212.7537887096405, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 29.473333333333336, "ram_util_percent": 69.44666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.1043395996094, "policy_loss": -1875768.2469618055, "vf_loss": 3416471.1319444445}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8343.5, "diff_num_grad_updates_vs_sampler_policy": 8342.5}}, "num_env_steps_sampled": 2459040, "num_env_steps_trained": 2459040, "num_agent_steps_sampled": 2459040, "num_agent_steps_trained": 2459040}, "sampler_results": {"episode_reward_max": -3753.273999969725, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -3997.2000837899523, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.380581974587992, "mean_inference_ms": 0.23416413174187517, "mean_action_processing_ms": 0.057559712320065425, "mean_env_wait_ms": 0.48974841862703966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027344226837158203, "StateBufferConnector_ms": 0.0017974376678466797, "ViewRequirementAgentConnector_ms": 0.045461177825927734}}, "episode_reward_max": -3753.273999969725, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -3997.2000837899523, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4159.121030597869, -3945.0010825865493, -3971.835187257314, -3962.070434092578, -3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.380581974587992, "mean_inference_ms": 0.23416413174187517, "mean_action_processing_ms": 0.057559712320065425, "mean_env_wait_ms": 0.48974841862703966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027344226837158203, "StateBufferConnector_ms": 0.0017974376678466797, "ViewRequirementAgentConnector_ms": 0.045461177825927734}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2459040, "num_agent_steps_trained": 2459040, "num_env_steps_sampled": 2459040, "num_env_steps_trained": 2459040, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 449.79597643728926, "num_env_steps_trained_throughput_per_sec": 449.79597643728926, "timesteps_total": 2459040, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2459040, "timers": {"training_iteration_time_ms": 2662.194, "sample_time_ms": 2641.16, "load_time_ms": 0.424, "load_throughput": 2826985.397, "learn_time_ms": 19.985, "learn_throughput": 60046.227, "synch_weights_time_ms": 0.587}, "counters": {"num_env_steps_sampled": 2459040, "num_env_steps_trained": 2459040, "num_agent_steps_sampled": 2459040, "num_agent_steps_trained": 2459040}, "done": false, "episodes_total": 7148, "training_iteration": 1581, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-44-17", "timestamp": 1691239457, "time_this_iter_s": 10.673663854598999, "time_total_s": 20170.238243579865, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1223.4274525642395, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 28.833333333333332, "ram_util_percent": 69.55333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -321.91693115234375, "policy_loss": -2125118.8151041665, "vf_loss": 3324740.7708333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8415.5, "diff_num_grad_updates_vs_sampler_policy": 8414.5}}, "num_env_steps_sampled": 2463840, "num_env_steps_trained": 2463840, "num_agent_steps_sampled": 2463840, "num_agent_steps_trained": 2463840}, "sampler_results": {"episode_reward_max": -3753.273999969725, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -3998.70658063375, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.380666235445176, "mean_inference_ms": 0.23420312309951996, "mean_action_processing_ms": 0.057565051446472636, "mean_env_wait_ms": 0.48982860125824734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027344226837158203, "StateBufferConnector_ms": 0.0017848014831542969, "ViewRequirementAgentConnector_ms": 0.045443058013916016}}, "episode_reward_max": -3753.273999969725, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -3998.70658063375, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3935.2819951588253, -4269.572909381862, -3955.883898484763, -3865.541582940788, -3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.380666235445176, "mean_inference_ms": 0.23420312309951996, "mean_action_processing_ms": 0.057565051446472636, "mean_env_wait_ms": 0.48982860125824734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027344226837158203, "StateBufferConnector_ms": 0.0017848014831542969, "ViewRequirementAgentConnector_ms": 0.045443058013916016}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2463840, "num_agent_steps_trained": 2463840, "num_env_steps_sampled": 2463840, "num_env_steps_trained": 2463840, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 453.9062946864198, "num_env_steps_trained_throughput_per_sec": 453.9062946864198, "timesteps_total": 2463840, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2463840, "timers": {"training_iteration_time_ms": 2653.394, "sample_time_ms": 2632.509, "load_time_ms": 0.426, "load_throughput": 2815599.015, "learn_time_ms": 19.847, "learn_throughput": 60463.665, "synch_weights_time_ms": 0.575}, "counters": {"num_env_steps_sampled": 2463840, "num_env_steps_trained": 2463840, "num_agent_steps_sampled": 2463840, "num_agent_steps_trained": 2463840}, "done": false, "episodes_total": 7152, "training_iteration": 1582, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-44-27", "timestamp": 1691239467, "time_this_iter_s": 10.57705020904541, "time_total_s": 20180.81529378891, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1234.004502773285, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 26.306666666666665, "ram_util_percent": 69.57333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.0291510687934, "policy_loss": -953087.1163194445, "vf_loss": 3118718.4444444445}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8487.5, "diff_num_grad_updates_vs_sampler_policy": 8486.5}}, "num_env_steps_sampled": 2468640, "num_env_steps_trained": 2468640, "num_agent_steps_sampled": 2468640, "num_agent_steps_trained": 2468640}, "sampler_results": {"episode_reward_max": -3753.273999969725, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -3996.2185122632322, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3807516881410309, "mean_inference_ms": 0.2342435329518148, "mean_action_processing_ms": 0.05757060876338472, "mean_env_wait_ms": 0.4899117623435346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027294158935546875, "StateBufferConnector_ms": 0.0017790794372558594, "ViewRequirementAgentConnector_ms": 0.045452117919921875}}, "episode_reward_max": -3753.273999969725, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -3996.2185122632322, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3925.5296617768113, -3753.273999969725, -3887.5293313425996, -3858.506983863688, -4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3807516881410309, "mean_inference_ms": 0.2342435329518148, "mean_action_processing_ms": 0.05757060876338472, "mean_env_wait_ms": 0.4899117623435346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027294158935546875, "StateBufferConnector_ms": 0.0017790794372558594, "ViewRequirementAgentConnector_ms": 0.045452117919921875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2468640, "num_agent_steps_trained": 2468640, "num_env_steps_sampled": 2468640, "num_env_steps_trained": 2468640, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 446.64839976234254, "num_env_steps_trained_throughput_per_sec": 446.64839976234254, "timesteps_total": 2468640, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2468640, "timers": {"training_iteration_time_ms": 2664.121, "sample_time_ms": 2643.381, "load_time_ms": 0.424, "load_throughput": 2832713.192, "learn_time_ms": 19.727, "learn_throughput": 60828.963, "synch_weights_time_ms": 0.553}, "counters": {"num_env_steps_sampled": 2468640, "num_env_steps_trained": 2468640, "num_agent_steps_sampled": 2468640, "num_agent_steps_trained": 2468640}, "done": false, "episodes_total": 7156, "training_iteration": 1583, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-44-38", "timestamp": 1691239478, "time_this_iter_s": 10.748816967010498, "time_total_s": 20191.56411075592, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1244.7533197402954, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 31.48666666666667, "ram_util_percent": 69.70666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.38821750217016, "policy_loss": -1007412.0269097222, "vf_loss": 3305370.347222222}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8559.5, "diff_num_grad_updates_vs_sampler_policy": 8558.5}}, "num_env_steps_sampled": 2473440, "num_env_steps_trained": 2473440, "num_agent_steps_sampled": 2473440, "num_agent_steps_trained": 2473440}, "sampler_results": {"episode_reward_max": -3789.597534288838, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -4007.154587834883, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.380834907551805, "mean_inference_ms": 0.23428238250196579, "mean_action_processing_ms": 0.05757591477610553, "mean_env_wait_ms": 0.4899962010619048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027289390563964844, "StateBufferConnector_ms": 0.0017838478088378906, "ViewRequirementAgentConnector_ms": 0.045484066009521484}}, "episode_reward_max": -3789.597534288838, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -4007.154587834883, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4224.964865217003, -4102.894341193706, -4023.248016667468, -3898.0822414252093, -3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.380834907551805, "mean_inference_ms": 0.23428238250196579, "mean_action_processing_ms": 0.05757591477610553, "mean_env_wait_ms": 0.4899962010619048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027289390563964844, "StateBufferConnector_ms": 0.0017838478088378906, "ViewRequirementAgentConnector_ms": 0.045484066009521484}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2473440, "num_agent_steps_trained": 2473440, "num_env_steps_sampled": 2473440, "num_env_steps_trained": 2473440, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 453.9404162960897, "num_env_steps_trained_throughput_per_sec": 453.9404162960897, "timesteps_total": 2473440, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2473440, "timers": {"training_iteration_time_ms": 2665.235, "sample_time_ms": 2644.289, "load_time_ms": 0.432, "load_throughput": 2776458.959, "learn_time_ms": 19.906, "learn_throughput": 60283.776, "synch_weights_time_ms": 0.571}, "counters": {"num_env_steps_sampled": 2473440, "num_env_steps_trained": 2473440, "num_agent_steps_sampled": 2473440, "num_agent_steps_trained": 2473440}, "done": false, "episodes_total": 7160, "training_iteration": 1584, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-44-49", "timestamp": 1691239489, "time_this_iter_s": 10.576566934585571, "time_total_s": 20202.140677690506, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1255.329886674881, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 27.633333333333333, "ram_util_percent": 70.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.2097473144531, "policy_loss": -1154678.982638889, "vf_loss": 3255314.673611111}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8631.5, "diff_num_grad_updates_vs_sampler_policy": 8630.5}}, "num_env_steps_sampled": 2478240, "num_env_steps_trained": 2478240, "num_agent_steps_sampled": 2478240, "num_agent_steps_trained": 2478240}, "sampler_results": {"episode_reward_max": -3789.597534288838, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -4003.9663771353516, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3809163024452897, "mean_inference_ms": 0.23432313866314644, "mean_action_processing_ms": 0.057581520358336746, "mean_env_wait_ms": 0.4900806069624197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027344226837158203, "StateBufferConnector_ms": 0.0017881393432617188, "ViewRequirementAgentConnector_ms": 0.0455021858215332}}, "episode_reward_max": -3789.597534288838, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -4003.9663771353516, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3929.3846979655095, -4007.321067987111, -3980.536018890543, -3968.3147254688024, -4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3809163024452897, "mean_inference_ms": 0.23432313866314644, "mean_action_processing_ms": 0.057581520358336746, "mean_env_wait_ms": 0.4900806069624197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027344226837158203, "StateBufferConnector_ms": 0.0017881393432617188, "ViewRequirementAgentConnector_ms": 0.0455021858215332}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2478240, "num_agent_steps_trained": 2478240, "num_env_steps_sampled": 2478240, "num_env_steps_trained": 2478240, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 450.2208138684581, "num_env_steps_trained_throughput_per_sec": 450.2208138684581, "timesteps_total": 2478240, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2478240, "timers": {"training_iteration_time_ms": 2659.157, "sample_time_ms": 2637.897, "load_time_ms": 0.427, "load_throughput": 2810253.936, "learn_time_ms": 20.204, "learn_throughput": 59395.173, "synch_weights_time_ms": 0.592}, "counters": {"num_env_steps_sampled": 2478240, "num_env_steps_trained": 2478240, "num_agent_steps_sampled": 2478240, "num_agent_steps_trained": 2478240}, "done": false, "episodes_total": 7164, "training_iteration": 1585, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-44-59", "timestamp": 1691239499, "time_this_iter_s": 10.663628101348877, "time_total_s": 20212.804305791855, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1265.9935147762299, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 29.15333333333333, "ram_util_percent": 69.93333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.07230970594617, "policy_loss": -3008545.6336805555, "vf_loss": 3196116.8125}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8703.5, "diff_num_grad_updates_vs_sampler_policy": 8702.5}}, "num_env_steps_sampled": 2483040, "num_env_steps_trained": 2483040, "num_agent_steps_sampled": 2483040, "num_agent_steps_trained": 2483040}, "sampler_results": {"episode_reward_max": -3789.597534288838, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -4006.718355631153, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3809951242308356, "mean_inference_ms": 0.23436016006408514, "mean_action_processing_ms": 0.057586504361659185, "mean_env_wait_ms": 0.4901547755761916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027320384979248047, "StateBufferConnector_ms": 0.0017895698547363281, "ViewRequirementAgentConnector_ms": 0.04551839828491211}}, "episode_reward_max": -3789.597534288838, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -4006.718355631153, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4104.6913296801495, -3860.6304386908864, -4084.1017755168846, -3864.938194633813, -3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3809951242308356, "mean_inference_ms": 0.23436016006408514, "mean_action_processing_ms": 0.057586504361659185, "mean_env_wait_ms": 0.4901547755761916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027320384979248047, "StateBufferConnector_ms": 0.0017895698547363281, "ViewRequirementAgentConnector_ms": 0.04551839828491211}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2483040, "num_agent_steps_trained": 2483040, "num_env_steps_sampled": 2483040, "num_env_steps_trained": 2483040, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 453.73037452760127, "num_env_steps_trained_throughput_per_sec": 453.73037452760127, "timesteps_total": 2483040, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2483040, "timers": {"training_iteration_time_ms": 2648.912, "sample_time_ms": 2627.516, "load_time_ms": 0.427, "load_throughput": 2808999.219, "learn_time_ms": 20.339, "learn_throughput": 59000.123, "synch_weights_time_ms": 0.592}, "counters": {"num_env_steps_sampled": 2483040, "num_env_steps_trained": 2483040, "num_agent_steps_sampled": 2483040, "num_agent_steps_trained": 2483040}, "done": false, "episodes_total": 7168, "training_iteration": 1586, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-45-10", "timestamp": 1691239510, "time_this_iter_s": 10.581245183944702, "time_total_s": 20223.3855509758, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1276.5747599601746, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 28.059999999999995, "ram_util_percent": 70.04666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -321.81178114149304, "policy_loss": -2874127.062065972, "vf_loss": 3623854.1458333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8775.5, "diff_num_grad_updates_vs_sampler_policy": 8774.5}}, "num_env_steps_sampled": 2487840, "num_env_steps_trained": 2487840, "num_agent_steps_sampled": 2487840, "num_agent_steps_trained": 2487840}, "sampler_results": {"episode_reward_max": -3789.597534288838, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -4007.1416380773508, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3810751417357456, "mean_inference_ms": 0.23439934410415625, "mean_action_processing_ms": 0.057591810886427425, "mean_env_wait_ms": 0.4902353624629045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027358531951904297, "StateBufferConnector_ms": 0.001798391342163086, "ViewRequirementAgentConnector_ms": 0.04559946060180664}}, "episode_reward_max": -3789.597534288838, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -4007.1416380773508, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3944.391105514169, -3985.8162786437933, -3834.6141815328638, -3816.273085951067, -3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3810751417357456, "mean_inference_ms": 0.23439934410415625, "mean_action_processing_ms": 0.057591810886427425, "mean_env_wait_ms": 0.4902353624629045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027358531951904297, "StateBufferConnector_ms": 0.001798391342163086, "ViewRequirementAgentConnector_ms": 0.04559946060180664}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2487840, "num_agent_steps_trained": 2487840, "num_env_steps_sampled": 2487840, "num_env_steps_trained": 2487840, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 448.6250089245198, "num_env_steps_trained_throughput_per_sec": 448.6250089245198, "timesteps_total": 2487840, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2487840, "timers": {"training_iteration_time_ms": 2663.502, "sample_time_ms": 2641.935, "load_time_ms": 0.432, "load_throughput": 2779372.025, "learn_time_ms": 20.491, "learn_throughput": 58562.489, "synch_weights_time_ms": 0.607}, "counters": {"num_env_steps_sampled": 2487840, "num_env_steps_trained": 2487840, "num_agent_steps_sampled": 2487840, "num_agent_steps_trained": 2487840}, "done": false, "episodes_total": 7172, "training_iteration": 1587, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-45-21", "timestamp": 1691239521, "time_this_iter_s": 10.701483011245728, "time_total_s": 20234.087033987045, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1287.2762429714203, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 27.9875, "ram_util_percent": 69.86250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.29942830403644, "policy_loss": -1694462.40625, "vf_loss": 3379208.6041666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8847.5, "diff_num_grad_updates_vs_sampler_policy": 8846.5}}, "num_env_steps_sampled": 2492640, "num_env_steps_trained": 2492640, "num_agent_steps_sampled": 2492640, "num_agent_steps_trained": 2492640}, "sampler_results": {"episode_reward_max": -3789.597534288838, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -4011.845177865438, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3811556121895188, "mean_inference_ms": 0.23443603495820944, "mean_action_processing_ms": 0.057596807481548884, "mean_env_wait_ms": 0.4903158852275948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002705097198486328, "StateBufferConnector_ms": 0.0017821788787841797, "ViewRequirementAgentConnector_ms": 0.0452427864074707}}, "episode_reward_max": -3789.597534288838, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -4011.845177865438, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3937.3001522016166, -4069.8352297613887, -3863.8419640847087, -3867.1348547605935, -3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3811556121895188, "mean_inference_ms": 0.23443603495820944, "mean_action_processing_ms": 0.057596807481548884, "mean_env_wait_ms": 0.4903158852275948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002705097198486328, "StateBufferConnector_ms": 0.0017821788787841797, "ViewRequirementAgentConnector_ms": 0.0452427864074707}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2492640, "num_agent_steps_trained": 2492640, "num_env_steps_sampled": 2492640, "num_env_steps_trained": 2492640, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 452.53613337303796, "num_env_steps_trained_throughput_per_sec": 452.53613337303796, "timesteps_total": 2492640, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2492640, "timers": {"training_iteration_time_ms": 2662.947, "sample_time_ms": 2641.49, "load_time_ms": 0.433, "load_throughput": 2771719.148, "learn_time_ms": 20.382, "learn_throughput": 58874.242, "synch_weights_time_ms": 0.605}, "counters": {"num_env_steps_sampled": 2492640, "num_env_steps_trained": 2492640, "num_agent_steps_sampled": 2492640, "num_agent_steps_trained": 2492640}, "done": false, "episodes_total": 7176, "training_iteration": 1588, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-45-31", "timestamp": 1691239531, "time_this_iter_s": 10.609138250350952, "time_total_s": 20244.696172237396, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1297.8853812217712, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 27.839999999999996, "ram_util_percent": 69.72666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.1770273844401, "policy_loss": -1131572.6788194445, "vf_loss": 3097645.076388889}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8919.5, "diff_num_grad_updates_vs_sampler_policy": 8918.5}}, "num_env_steps_sampled": 2497440, "num_env_steps_trained": 2497440, "num_agent_steps_sampled": 2497440, "num_agent_steps_trained": 2497440}, "sampler_results": {"episode_reward_max": -3779.8537676316732, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -4014.543747293227, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3812332807005936, "mean_inference_ms": 0.2344734817071358, "mean_action_processing_ms": 0.05760192177281178, "mean_env_wait_ms": 0.4903929656910118, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026979446411132812, "StateBufferConnector_ms": 0.0017840862274169922, "ViewRequirementAgentConnector_ms": 0.04520869255065918}}, "episode_reward_max": -3779.8537676316732, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -4014.543747293227, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3856.0371464939976, -4188.495481051558, -4323.681448455668, -4078.805232552978, -4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3812332807005936, "mean_inference_ms": 0.2344734817071358, "mean_action_processing_ms": 0.05760192177281178, "mean_env_wait_ms": 0.4903929656910118, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026979446411132812, "StateBufferConnector_ms": 0.0017840862274169922, "ViewRequirementAgentConnector_ms": 0.04520869255065918}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2497440, "num_agent_steps_trained": 2497440, "num_env_steps_sampled": 2497440, "num_env_steps_trained": 2497440, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 452.21559744120657, "num_env_steps_trained_throughput_per_sec": 452.21559744120657, "timesteps_total": 2497440, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2497440, "timers": {"training_iteration_time_ms": 2660.527, "sample_time_ms": 2639.284, "load_time_ms": 0.43, "load_throughput": 2790312.008, "learn_time_ms": 20.19, "learn_throughput": 59436.415, "synch_weights_time_ms": 0.586}, "counters": {"num_env_steps_sampled": 2497440, "num_env_steps_trained": 2497440, "num_agent_steps_sampled": 2497440, "num_agent_steps_trained": 2497440}, "done": false, "episodes_total": 7180, "training_iteration": 1589, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-45-42", "timestamp": 1691239542, "time_this_iter_s": 10.616636991500854, "time_total_s": 20255.312809228897, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1308.502018213272, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 29.486666666666668, "ram_util_percent": 69.78666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.1100379096137, "policy_loss": -3462387.287326389, "vf_loss": 3634110.4930555555}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8991.5, "diff_num_grad_updates_vs_sampler_policy": 8990.5}}, "num_env_steps_sampled": 2502240, "num_env_steps_trained": 2502240, "num_agent_steps_sampled": 2502240, "num_agent_steps_trained": 2502240}, "sampler_results": {"episode_reward_max": -3779.8537676316732, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -4013.1346538305074, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3813110502512875, "mean_inference_ms": 0.23450912973337193, "mean_action_processing_ms": 0.05760676273213144, "mean_env_wait_ms": 0.49046228222043275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002687215805053711, "StateBufferConnector_ms": 0.0017764568328857422, "ViewRequirementAgentConnector_ms": 0.044943809509277344}}, "episode_reward_max": -3779.8537676316732, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -4013.1346538305074, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4067.613694825724, -4074.087782356552, -3914.5680463369285, -3827.6203097546736, -4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3813110502512875, "mean_inference_ms": 0.23450912973337193, "mean_action_processing_ms": 0.05760676273213144, "mean_env_wait_ms": 0.49046228222043275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002687215805053711, "StateBufferConnector_ms": 0.0017764568328857422, "ViewRequirementAgentConnector_ms": 0.044943809509277344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2502240, "num_agent_steps_trained": 2502240, "num_env_steps_sampled": 2502240, "num_env_steps_trained": 2502240, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 453.5312850423783, "num_env_steps_trained_throughput_per_sec": 453.5312850423783, "timesteps_total": 2502240, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2502240, "timers": {"training_iteration_time_ms": 2653.838, "sample_time_ms": 2632.39, "load_time_ms": 0.434, "load_throughput": 2761984.745, "learn_time_ms": 20.388, "learn_throughput": 58859.026, "synch_weights_time_ms": 0.587}, "counters": {"num_env_steps_sampled": 2502240, "num_env_steps_trained": 2502240, "num_agent_steps_sampled": 2502240, "num_agent_steps_trained": 2502240}, "done": false, "episodes_total": 7184, "training_iteration": 1590, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-45-52", "timestamp": 1691239552, "time_this_iter_s": 10.58581805229187, "time_total_s": 20265.89862728119, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1319.087836265564, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 39.686666666666675, "ram_util_percent": 69.90000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.3563876681858, "policy_loss": -1061451.1453993055, "vf_loss": 3257027.9305555555}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9063.5, "diff_num_grad_updates_vs_sampler_policy": 9062.5}}, "num_env_steps_sampled": 2507040, "num_env_steps_trained": 2507040, "num_agent_steps_sampled": 2507040, "num_agent_steps_trained": 2507040}, "sampler_results": {"episode_reward_max": -3779.8537676316732, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -4015.7553926400233, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3813881241462682, "mean_inference_ms": 0.2345450332071988, "mean_action_processing_ms": 0.057611703561077705, "mean_env_wait_ms": 0.4905318654177824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026700496673583984, "StateBufferConnector_ms": 0.001756429672241211, "ViewRequirementAgentConnector_ms": 0.044891357421875}}, "episode_reward_max": -3779.8537676316732, "episode_reward_min": -4400.9584397888875, "episode_reward_mean": -4015.7553926400233, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4400.9584397888875, -3858.7151418668795, -3986.710250848036, -3870.0343399265703, -3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3813881241462682, "mean_inference_ms": 0.2345450332071988, "mean_action_processing_ms": 0.057611703561077705, "mean_env_wait_ms": 0.4905318654177824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026700496673583984, "StateBufferConnector_ms": 0.001756429672241211, "ViewRequirementAgentConnector_ms": 0.044891357421875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2507040, "num_agent_steps_trained": 2507040, "num_env_steps_sampled": 2507040, "num_env_steps_trained": 2507040, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 449.47221450937303, "num_env_steps_trained_throughput_per_sec": 449.47221450937303, "timesteps_total": 2507040, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2507040, "timers": {"training_iteration_time_ms": 2662.832, "sample_time_ms": 2640.839, "load_time_ms": 0.439, "load_throughput": 2735564.324, "learn_time_ms": 20.916, "learn_throughput": 57372.714, "synch_weights_time_ms": 0.6}, "counters": {"num_env_steps_sampled": 2507040, "num_env_steps_trained": 2507040, "num_agent_steps_sampled": 2507040, "num_agent_steps_trained": 2507040}, "done": false, "episodes_total": 7188, "training_iteration": 1591, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-46-03", "timestamp": 1691239563, "time_this_iter_s": 10.681465148925781, "time_total_s": 20276.580092430115, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1329.7693014144897, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 29.02, "ram_util_percent": 69.83999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.23047892252606, "policy_loss": -2626805.6041666665, "vf_loss": 3124267.5069444445}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9135.5, "diff_num_grad_updates_vs_sampler_policy": 9134.5}}, "num_env_steps_sampled": 2511840, "num_env_steps_trained": 2511840, "num_agent_steps_sampled": 2511840, "num_agent_steps_trained": 2511840}, "sampler_results": {"episode_reward_max": -3779.8537676316732, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -4013.097569995739, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3814636542770597, "mean_inference_ms": 0.23458090936519, "mean_action_processing_ms": 0.057616641381710944, "mean_env_wait_ms": 0.4905989886924752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026862621307373047, "StateBufferConnector_ms": 0.0017473697662353516, "ViewRequirementAgentConnector_ms": 0.044879913330078125}}, "episode_reward_max": -3779.8537676316732, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -4013.097569995739, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3789.597534288838, -3937.541250458573, -3896.5262679265534, -3808.8591485413026, -3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3814636542770597, "mean_inference_ms": 0.23458090936519, "mean_action_processing_ms": 0.057616641381710944, "mean_env_wait_ms": 0.4905989886924752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026862621307373047, "StateBufferConnector_ms": 0.0017473697662353516, "ViewRequirementAgentConnector_ms": 0.044879913330078125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2511840, "num_agent_steps_trained": 2511840, "num_env_steps_sampled": 2511840, "num_env_steps_trained": 2511840, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 449.13839729144416, "num_env_steps_trained_throughput_per_sec": 449.13839729144416, "timesteps_total": 2511840, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2511840, "timers": {"training_iteration_time_ms": 2661.455, "sample_time_ms": 2639.348, "load_time_ms": 0.436, "load_throughput": 2753673.706, "learn_time_ms": 21.032, "learn_throughput": 57055.463, "synch_weights_time_ms": 0.6}, "counters": {"num_env_steps_sampled": 2511840, "num_env_steps_trained": 2511840, "num_agent_steps_sampled": 2511840, "num_agent_steps_trained": 2511840}, "done": false, "episodes_total": 7192, "training_iteration": 1592, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-46-14", "timestamp": 1691239574, "time_this_iter_s": 10.689318895339966, "time_total_s": 20287.269411325455, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1340.4586203098297, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 29.386666666666667, "ram_util_percent": 69.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.1457299126519, "policy_loss": -2962461.5225694445, "vf_loss": 3511487.861111111}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9207.5, "diff_num_grad_updates_vs_sampler_policy": 9206.5}}, "num_env_steps_sampled": 2516640, "num_env_steps_trained": 2516640, "num_agent_steps_sampled": 2516640, "num_agent_steps_trained": 2516640}, "sampler_results": {"episode_reward_max": -3779.8537676316732, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -4022.6292196577892, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.381536480795387, "mean_inference_ms": 0.2346169952899579, "mean_action_processing_ms": 0.057621605075244824, "mean_env_wait_ms": 0.49067047771778816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026869773864746094, "StateBufferConnector_ms": 0.0017392635345458984, "ViewRequirementAgentConnector_ms": 0.04483914375305176}}, "episode_reward_max": -3779.8537676316732, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -4022.6292196577892, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3832.596361720348, -4071.3904858997116, -4193.850372625249, -3808.3860196664364, -3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.381536480795387, "mean_inference_ms": 0.2346169952899579, "mean_action_processing_ms": 0.057621605075244824, "mean_env_wait_ms": 0.49067047771778816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026869773864746094, "StateBufferConnector_ms": 0.0017392635345458984, "ViewRequirementAgentConnector_ms": 0.04483914375305176}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2516640, "num_agent_steps_trained": 2516640, "num_env_steps_sampled": 2516640, "num_env_steps_trained": 2516640, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 450.91864049659273, "num_env_steps_trained_throughput_per_sec": 450.91864049659273, "timesteps_total": 2516640, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2516640, "timers": {"training_iteration_time_ms": 2665.521, "sample_time_ms": 2644.052, "load_time_ms": 0.426, "load_throughput": 2819700.168, "learn_time_ms": 20.404, "learn_throughput": 58811.571, "synch_weights_time_ms": 0.6}, "counters": {"num_env_steps_sampled": 2516640, "num_env_steps_trained": 2516640, "num_agent_steps_sampled": 2516640, "num_agent_steps_trained": 2516640}, "done": false, "episodes_total": 7196, "training_iteration": 1593, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-46-25", "timestamp": 1691239585, "time_this_iter_s": 10.647207975387573, "time_total_s": 20297.916619300842, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1351.1058282852173, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 27.900000000000002, "ram_util_percent": 69.82666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -321.87593926323785, "policy_loss": -980079.1028645834, "vf_loss": 3486166.638888889}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9279.5, "diff_num_grad_updates_vs_sampler_policy": 9278.5}}, "num_env_steps_sampled": 2521440, "num_env_steps_trained": 2521440, "num_agent_steps_sampled": 2521440, "num_agent_steps_trained": 2521440}, "sampler_results": {"episode_reward_max": -3779.8537676316732, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -4027.2241504494614, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3816061647786035, "mean_inference_ms": 0.23465315570696654, "mean_action_processing_ms": 0.05762662982458113, "mean_env_wait_ms": 0.4907508105254751, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026798248291015625, "StateBufferConnector_ms": 0.0017344951629638672, "ViewRequirementAgentConnector_ms": 0.04483342170715332}}, "episode_reward_max": -3779.8537676316732, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -4027.2241504494614, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3929.117222539248, -4041.6715393446834, -4041.7001819594784, -4122.751352204065, -3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3816061647786035, "mean_inference_ms": 0.23465315570696654, "mean_action_processing_ms": 0.05762662982458113, "mean_env_wait_ms": 0.4907508105254751, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026798248291015625, "StateBufferConnector_ms": 0.0017344951629638672, "ViewRequirementAgentConnector_ms": 0.04483342170715332}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2521440, "num_agent_steps_trained": 2521440, "num_env_steps_sampled": 2521440, "num_env_steps_trained": 2521440, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 446.82298552451454, "num_env_steps_trained_throughput_per_sec": 446.82298552451454, "timesteps_total": 2521440, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2521440, "timers": {"training_iteration_time_ms": 2671.92, "sample_time_ms": 2650.64, "load_time_ms": 0.428, "load_throughput": 2804303.989, "learn_time_ms": 20.219, "learn_throughput": 59350.839, "synch_weights_time_ms": 0.595}, "counters": {"num_env_steps_sampled": 2521440, "num_env_steps_trained": 2521440, "num_agent_steps_sampled": 2521440, "num_agent_steps_trained": 2521440}, "done": false, "episodes_total": 7200, "training_iteration": 1594, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-46-35", "timestamp": 1691239595, "time_this_iter_s": 10.744722843170166, "time_total_s": 20308.661342144012, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1361.8505511283875, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 30.886666666666663, "ram_util_percent": 69.86666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -321.91904703776044, "policy_loss": -1985761.8511284722, "vf_loss": 3386069.6180555555}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9351.5, "diff_num_grad_updates_vs_sampler_policy": 9350.5}}, "num_env_steps_sampled": 2526240, "num_env_steps_trained": 2526240, "num_agent_steps_sampled": 2526240, "num_agent_steps_trained": 2526240}, "sampler_results": {"episode_reward_max": -3779.8537676316732, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -4028.1882342878484, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3816751036657593, "mean_inference_ms": 0.23469050086751886, "mean_action_processing_ms": 0.057631896163238244, "mean_env_wait_ms": 0.4908314215674139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002669095993041992, "StateBufferConnector_ms": 0.0017275810241699219, "ViewRequirementAgentConnector_ms": 0.04477524757385254}}, "episode_reward_max": -3779.8537676316732, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -4028.1882342878484, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3913.529240016582, -4095.972341353713, -4194.913825086721, -4013.0689754702144, -4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3816751036657593, "mean_inference_ms": 0.23469050086751886, "mean_action_processing_ms": 0.057631896163238244, "mean_env_wait_ms": 0.4908314215674139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002669095993041992, "StateBufferConnector_ms": 0.0017275810241699219, "ViewRequirementAgentConnector_ms": 0.04477524757385254}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2526240, "num_agent_steps_trained": 2526240, "num_env_steps_sampled": 2526240, "num_env_steps_trained": 2526240, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 450.21144060908847, "num_env_steps_trained_throughput_per_sec": 450.21144060908847, "timesteps_total": 2526240, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2526240, "timers": {"training_iteration_time_ms": 2670.774, "sample_time_ms": 2649.626, "load_time_ms": 0.432, "load_throughput": 2779986.081, "learn_time_ms": 20.093, "learn_throughput": 59721.902, "synch_weights_time_ms": 0.584}, "counters": {"num_env_steps_sampled": 2526240, "num_env_steps_trained": 2526240, "num_agent_steps_sampled": 2526240, "num_agent_steps_trained": 2526240}, "done": false, "episodes_total": 7204, "training_iteration": 1595, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-46-46", "timestamp": 1691239606, "time_this_iter_s": 10.66388201713562, "time_total_s": 20319.325224161148, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1372.514433145523, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 29.026666666666667, "ram_util_percent": 70.13333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -321.88438415527344, "policy_loss": -2177465.0381944445, "vf_loss": 3575927.159722222}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9423.5, "diff_num_grad_updates_vs_sampler_policy": 9422.5}}, "num_env_steps_sampled": 2531040, "num_env_steps_trained": 2531040, "num_agent_steps_sampled": 2531040, "num_agent_steps_trained": 2531040}, "sampler_results": {"episode_reward_max": -3779.8537676316732, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -4028.486161792636, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.381742430796557, "mean_inference_ms": 0.2347251900555495, "mean_action_processing_ms": 0.0576367075579517, "mean_env_wait_ms": 0.49090242713078824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002660512924194336, "StateBufferConnector_ms": 0.0017290115356445312, "ViewRequirementAgentConnector_ms": 0.04464268684387207}}, "episode_reward_max": -3779.8537676316732, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -4028.486161792636, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4000.2093703993805, -3904.60637616547, -4242.451311804386, -4180.447435724426, -4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.381742430796557, "mean_inference_ms": 0.2347251900555495, "mean_action_processing_ms": 0.0576367075579517, "mean_env_wait_ms": 0.49090242713078824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002660512924194336, "StateBufferConnector_ms": 0.0017290115356445312, "ViewRequirementAgentConnector_ms": 0.04464268684387207}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2531040, "num_agent_steps_trained": 2531040, "num_env_steps_sampled": 2531040, "num_env_steps_trained": 2531040, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 452.96385184679207, "num_env_steps_trained_throughput_per_sec": 452.96385184679207, "timesteps_total": 2531040, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2531040, "timers": {"training_iteration_time_ms": 2657.721, "sample_time_ms": 2636.719, "load_time_ms": 0.429, "load_throughput": 2800091.683, "learn_time_ms": 19.954, "learn_throughput": 60138.851, "synch_weights_time_ms": 0.582}, "counters": {"num_env_steps_sampled": 2531040, "num_env_steps_trained": 2531040, "num_agent_steps_sampled": 2531040, "num_agent_steps_trained": 2531040}, "done": false, "episodes_total": 7208, "training_iteration": 1596, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-46-57", "timestamp": 1691239617, "time_this_iter_s": 10.598943948745728, "time_total_s": 20329.924168109894, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1383.1133770942688, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 28.333333333333332, "ram_util_percent": 70.11333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.11993408203125, "policy_loss": -1640459.9973958333, "vf_loss": 3089838.0069444445}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9495.5, "diff_num_grad_updates_vs_sampler_policy": 9494.5}}, "num_env_steps_sampled": 2535840, "num_env_steps_trained": 2535840, "num_agent_steps_sampled": 2535840, "num_agent_steps_trained": 2535840}, "sampler_results": {"episode_reward_max": -3779.8537676316732, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -4026.733960730764, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.38180820947502, "mean_inference_ms": 0.23476097894357217, "mean_action_processing_ms": 0.057641753287026185, "mean_env_wait_ms": 0.49097403440713777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002658843994140625, "StateBufferConnector_ms": 0.0017240047454833984, "ViewRequirementAgentConnector_ms": 0.044638872146606445}}, "episode_reward_max": -3779.8537676316732, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -4026.733960730764, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4139.11688896978, -4257.055379212142, -4010.2369010411044, -3950.7747245033543, -3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.38180820947502, "mean_inference_ms": 0.23476097894357217, "mean_action_processing_ms": 0.057641753287026185, "mean_env_wait_ms": 0.49097403440713777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002658843994140625, "StateBufferConnector_ms": 0.0017240047454833984, "ViewRequirementAgentConnector_ms": 0.044638872146606445}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2535840, "num_agent_steps_trained": 2535840, "num_env_steps_sampled": 2535840, "num_env_steps_trained": 2535840, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 450.43446082196454, "num_env_steps_trained_throughput_per_sec": 450.43446082196454, "timesteps_total": 2535840, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2535840, "timers": {"training_iteration_time_ms": 2661.094, "sample_time_ms": 2639.518, "load_time_ms": 0.43, "load_throughput": 2790157.326, "learn_time_ms": 20.496, "learn_throughput": 58547.57, "synch_weights_time_ms": 0.611}, "counters": {"num_env_steps_sampled": 2535840, "num_env_steps_trained": 2535840, "num_agent_steps_sampled": 2535840, "num_agent_steps_trained": 2535840}, "done": false, "episodes_total": 7212, "training_iteration": 1597, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-47-07", "timestamp": 1691239627, "time_this_iter_s": 10.658551931381226, "time_total_s": 20340.582720041275, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1393.77192902565, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 27.480000000000004, "ram_util_percent": 70.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.03268093532984, "policy_loss": -1844350.7300347222, "vf_loss": 3325398.486111111}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9567.5, "diff_num_grad_updates_vs_sampler_policy": 9566.5}}, "num_env_steps_sampled": 2540640, "num_env_steps_trained": 2540640, "num_agent_steps_sampled": 2540640, "num_agent_steps_trained": 2540640}, "sampler_results": {"episode_reward_max": -3779.8537676316732, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -4022.4327049857943, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3818690240885447, "mean_inference_ms": 0.23479392727068624, "mean_action_processing_ms": 0.057646362059892875, "mean_env_wait_ms": 0.49104140869788965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002653837203979492, "StateBufferConnector_ms": 0.0017199516296386719, "ViewRequirementAgentConnector_ms": 0.044454336166381836}}, "episode_reward_max": -3779.8537676316732, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -4022.4327049857943, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3877.234152573492, -4045.005612943535, -3847.964670540511, -4005.174185148657, -3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3818690240885447, "mean_inference_ms": 0.23479392727068624, "mean_action_processing_ms": 0.057646362059892875, "mean_env_wait_ms": 0.49104140869788965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002653837203979492, "StateBufferConnector_ms": 0.0017199516296386719, "ViewRequirementAgentConnector_ms": 0.044454336166381836}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2540640, "num_agent_steps_trained": 2540640, "num_env_steps_sampled": 2540640, "num_env_steps_trained": 2540640, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 451.47003378312394, "num_env_steps_trained_throughput_per_sec": 451.47003378312394, "timesteps_total": 2540640, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2540640, "timers": {"training_iteration_time_ms": 2657.265, "sample_time_ms": 2635.604, "load_time_ms": 0.432, "load_throughput": 2780907.674, "learn_time_ms": 20.575, "learn_throughput": 58322.873, "synch_weights_time_ms": 0.615}, "counters": {"num_env_steps_sampled": 2540640, "num_env_steps_trained": 2540640, "num_agent_steps_sampled": 2540640, "num_agent_steps_trained": 2540640}, "done": false, "episodes_total": 7216, "training_iteration": 1598, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-47-18", "timestamp": 1691239638, "time_this_iter_s": 10.634206056594849, "time_total_s": 20351.21692609787, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1404.4061350822449, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 27.80625, "ram_util_percent": 69.98124999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.0990804036458, "policy_loss": -3320667.216579861, "vf_loss": 3474429.5416666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9639.5, "diff_num_grad_updates_vs_sampler_policy": 9638.5}}, "num_env_steps_sampled": 2545440, "num_env_steps_trained": 2545440, "num_agent_steps_sampled": 2545440, "num_agent_steps_trained": 2545440}, "sampler_results": {"episode_reward_max": -3779.8537676316732, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -4024.616179025911, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3819300787893978, "mean_inference_ms": 0.23482754764791416, "mean_action_processing_ms": 0.05765105583765687, "mean_env_wait_ms": 0.4911165800769581, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026543140411376953, "StateBufferConnector_ms": 0.0017142295837402344, "ViewRequirementAgentConnector_ms": 0.044381141662597656}}, "episode_reward_max": -3779.8537676316732, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -4024.616179025911, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3911.062580012327, -4053.010007570673, -3891.716792939307, -4100.397187730715, -3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3819300787893978, "mean_inference_ms": 0.23482754764791416, "mean_action_processing_ms": 0.05765105583765687, "mean_env_wait_ms": 0.4911165800769581, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026543140411376953, "StateBufferConnector_ms": 0.0017142295837402344, "ViewRequirementAgentConnector_ms": 0.044381141662597656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2545440, "num_agent_steps_trained": 2545440, "num_env_steps_sampled": 2545440, "num_env_steps_trained": 2545440, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 447.33022788364735, "num_env_steps_trained_throughput_per_sec": 447.33022788364735, "timesteps_total": 2545440, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2545440, "timers": {"training_iteration_time_ms": 2670.182, "sample_time_ms": 2648.94, "load_time_ms": 0.431, "load_throughput": 2781676.136, "learn_time_ms": 20.184, "learn_throughput": 59453.687, "synch_weights_time_ms": 0.588}, "counters": {"num_env_steps_sampled": 2545440, "num_env_steps_trained": 2545440, "num_agent_steps_sampled": 2545440, "num_agent_steps_trained": 2545440}, "done": false, "episodes_total": 7220, "training_iteration": 1599, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-47-29", "timestamp": 1691239649, "time_this_iter_s": 10.732439756393433, "time_total_s": 20361.949365854263, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1415.1385748386383, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 30.893333333333334, "ram_util_percent": 69.69333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.25264316134985, "policy_loss": -1584387.5208333333, "vf_loss": 3218048.673611111}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9711.5, "diff_num_grad_updates_vs_sampler_policy": 9710.5}}, "num_env_steps_sampled": 2550240, "num_env_steps_trained": 2550240, "num_agent_steps_sampled": 2550240, "num_agent_steps_trained": 2550240}, "sampler_results": {"episode_reward_max": -3779.8537676316732, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -4023.737976930255, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.381986027980102, "mean_inference_ms": 0.23486031052074233, "mean_action_processing_ms": 0.05765554042126668, "mean_env_wait_ms": 0.4911853858309978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026564598083496094, "StateBufferConnector_ms": 0.0017216205596923828, "ViewRequirementAgentConnector_ms": 0.044382572174072266}}, "episode_reward_max": -3779.8537676316732, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -4023.737976930255, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3967.1033305219457, -3961.2370382244135, -3964.4198141476027, -3905.378138784046, -4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.381986027980102, "mean_inference_ms": 0.23486031052074233, "mean_action_processing_ms": 0.05765554042126668, "mean_env_wait_ms": 0.4911853858309978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026564598083496094, "StateBufferConnector_ms": 0.0017216205596923828, "ViewRequirementAgentConnector_ms": 0.044382572174072266}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2550240, "num_agent_steps_trained": 2550240, "num_env_steps_sampled": 2550240, "num_env_steps_trained": 2550240, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 453.16218835146606, "num_env_steps_trained_throughput_per_sec": 453.16218835146606, "timesteps_total": 2550240, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2550240, "timers": {"training_iteration_time_ms": 2660.535, "sample_time_ms": 2639.717, "load_time_ms": 0.423, "load_throughput": 2840065.907, "learn_time_ms": 19.782, "learn_throughput": 60659.761, "synch_weights_time_ms": 0.576}, "counters": {"num_env_steps_sampled": 2550240, "num_env_steps_trained": 2550240, "num_agent_steps_sampled": 2550240, "num_agent_steps_trained": 2550240}, "done": false, "episodes_total": 7224, "training_iteration": 1600, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-47-39", "timestamp": 1691239659, "time_this_iter_s": 10.59436297416687, "time_total_s": 20372.54372882843, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1425.7329378128052, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 28.080000000000002, "ram_util_percent": 69.76666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.2384948730469, "policy_loss": -1370093.1861979167, "vf_loss": 3063602.9479166665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9783.5, "diff_num_grad_updates_vs_sampler_policy": 9782.5}}, "num_env_steps_sampled": 2555040, "num_env_steps_trained": 2555040, "num_agent_steps_sampled": 2555040, "num_agent_steps_trained": 2555040}, "sampler_results": {"episode_reward_max": -3779.8537676316732, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -4023.716302501004, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3820417216236462, "mean_inference_ms": 0.23489278495670796, "mean_action_processing_ms": 0.057660044302652536, "mean_env_wait_ms": 0.4912522855694321, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026595592498779297, "StateBufferConnector_ms": 0.0017199516296386719, "ViewRequirementAgentConnector_ms": 0.04448699951171875}}, "episode_reward_max": -3779.8537676316732, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -4023.716302501004, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4155.24982721327, -3931.6803116136343, -4064.447366648855, -4163.655125546093, -3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3820417216236462, "mean_inference_ms": 0.23489278495670796, "mean_action_processing_ms": 0.057660044302652536, "mean_env_wait_ms": 0.4912522855694321, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026595592498779297, "StateBufferConnector_ms": 0.0017199516296386719, "ViewRequirementAgentConnector_ms": 0.04448699951171875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2555040, "num_agent_steps_trained": 2555040, "num_env_steps_sampled": 2555040, "num_env_steps_trained": 2555040, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 453.36156639444243, "num_env_steps_trained_throughput_per_sec": 453.36156639444243, "timesteps_total": 2555040, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2555040, "timers": {"training_iteration_time_ms": 2654.092, "sample_time_ms": 2632.937, "load_time_ms": 0.434, "load_throughput": 2766995.492, "learn_time_ms": 20.102, "learn_throughput": 59694.278, "synch_weights_time_ms": 0.582}, "counters": {"num_env_steps_sampled": 2555040, "num_env_steps_trained": 2555040, "num_agent_steps_sampled": 2555040, "num_agent_steps_trained": 2555040}, "done": false, "episodes_total": 7228, "training_iteration": 1601, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-47-50", "timestamp": 1691239670, "time_this_iter_s": 10.58973217010498, "time_total_s": 20383.133460998535, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1436.3226699829102, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 26.366666666666667, "ram_util_percent": 69.68666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.370361328125, "policy_loss": -896991.9144965278, "vf_loss": 3282331.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9855.5, "diff_num_grad_updates_vs_sampler_policy": 9854.5}}, "num_env_steps_sampled": 2559840, "num_env_steps_trained": 2559840, "num_agent_steps_sampled": 2559840, "num_agent_steps_trained": 2559840}, "sampler_results": {"episode_reward_max": -3779.8537676316732, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -4019.322004012873, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3820962584112433, "mean_inference_ms": 0.23491960599838613, "mean_action_processing_ms": 0.05766436932502313, "mean_env_wait_ms": 0.49131813365389876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002666950225830078, "StateBufferConnector_ms": 0.001718282699584961, "ViewRequirementAgentConnector_ms": 0.04451608657836914}}, "episode_reward_max": -3779.8537676316732, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -4019.322004012873, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3911.731518920261, -3936.4210840710225, -4036.6199021844177, -4037.248901357784, -4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3820962584112433, "mean_inference_ms": 0.23491960599838613, "mean_action_processing_ms": 0.05766436932502313, "mean_env_wait_ms": 0.49131813365389876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002666950225830078, "StateBufferConnector_ms": 0.001718282699584961, "ViewRequirementAgentConnector_ms": 0.04451608657836914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2559840, "num_agent_steps_trained": 2559840, "num_env_steps_sampled": 2559840, "num_env_steps_trained": 2559840, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 448.19685037371744, "num_env_steps_trained_throughput_per_sec": 448.19685037371744, "timesteps_total": 2559840, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2559840, "timers": {"training_iteration_time_ms": 2654.847, "sample_time_ms": 2633.705, "load_time_ms": 0.438, "load_throughput": 2736754.282, "learn_time_ms": 20.078, "learn_throughput": 59768.07, "synch_weights_time_ms": 0.588}, "counters": {"num_env_steps_sampled": 2559840, "num_env_steps_trained": 2559840, "num_agent_steps_sampled": 2559840, "num_agent_steps_trained": 2559840}, "done": false, "episodes_total": 7232, "training_iteration": 1602, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-48-01", "timestamp": 1691239681, "time_this_iter_s": 10.711973905563354, "time_total_s": 20393.8454349041, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1447.0346438884735, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 29.226666666666667, "ram_util_percent": 69.67999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.16836886935766, "policy_loss": -844399.7061631945, "vf_loss": 3063430.2083333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9927.5, "diff_num_grad_updates_vs_sampler_policy": 9926.5}}, "num_env_steps_sampled": 2564640, "num_env_steps_trained": 2564640, "num_agent_steps_sampled": 2564640, "num_agent_steps_trained": 2564640}, "sampler_results": {"episode_reward_max": -3779.8537676316732, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -4016.8089069132966, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3821478415793984, "mean_inference_ms": 0.23494846956184223, "mean_action_processing_ms": 0.05766905182392372, "mean_env_wait_ms": 0.49138636716786394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026619434356689453, "StateBufferConnector_ms": 0.001714468002319336, "ViewRequirementAgentConnector_ms": 0.04453921318054199}}, "episode_reward_max": -3779.8537676316732, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -4016.8089069132966, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4204.5978347068, -4107.597141990711, -4022.3142733274058, -3863.8980151875003, -3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3821478415793984, "mean_inference_ms": 0.23494846956184223, "mean_action_processing_ms": 0.05766905182392372, "mean_env_wait_ms": 0.49138636716786394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026619434356689453, "StateBufferConnector_ms": 0.001714468002319336, "ViewRequirementAgentConnector_ms": 0.04453921318054199}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2564640, "num_agent_steps_trained": 2564640, "num_env_steps_sampled": 2564640, "num_env_steps_trained": 2564640, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 453.5835089357329, "num_env_steps_trained_throughput_per_sec": 453.5835089357329, "timesteps_total": 2564640, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2564640, "timers": {"training_iteration_time_ms": 2654.94, "sample_time_ms": 2633.97, "load_time_ms": 0.432, "load_throughput": 2776612.126, "learn_time_ms": 19.906, "learn_throughput": 60283.993, "synch_weights_time_ms": 0.594}, "counters": {"num_env_steps_sampled": 2564640, "num_env_steps_trained": 2564640, "num_agent_steps_sampled": 2564640, "num_agent_steps_trained": 2564640}, "done": false, "episodes_total": 7236, "training_iteration": 1603, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-48-11", "timestamp": 1691239691, "time_this_iter_s": 10.584570169448853, "time_total_s": 20404.430005073547, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1457.6192140579224, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 26.706666666666667, "ram_util_percent": 69.68666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.59126451280383, "policy_loss": -411068.1853298611, "vf_loss": 3049330.222222222}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9999.5, "diff_num_grad_updates_vs_sampler_policy": 9998.5}}, "num_env_steps_sampled": 2569440, "num_env_steps_trained": 2569440, "num_agent_steps_sampled": 2569440, "num_agent_steps_trained": 2569440}, "sampler_results": {"episode_reward_max": -3779.8537676316732, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -4015.125603439305, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3822016276951274, "mean_inference_ms": 0.2349762943616559, "mean_action_processing_ms": 0.057673628885015545, "mean_env_wait_ms": 0.4914513805134357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026526451110839844, "StateBufferConnector_ms": 0.0017070770263671875, "ViewRequirementAgentConnector_ms": 0.0444948673248291}}, "episode_reward_max": -3779.8537676316732, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -4015.125603439305, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3887.441319296044, -3996.1359392896525, -3926.3718940446397, -4018.343835964425, -3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3822016276951274, "mean_inference_ms": 0.2349762943616559, "mean_action_processing_ms": 0.057673628885015545, "mean_env_wait_ms": 0.4914513805134357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026526451110839844, "StateBufferConnector_ms": 0.0017070770263671875, "ViewRequirementAgentConnector_ms": 0.0444948673248291}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2569440, "num_agent_steps_trained": 2569440, "num_env_steps_sampled": 2569440, "num_env_steps_trained": 2569440, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 450.2689649462372, "num_env_steps_trained_throughput_per_sec": 450.2689649462372, "timesteps_total": 2569440, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2569440, "timers": {"training_iteration_time_ms": 2657.125, "sample_time_ms": 2636.212, "load_time_ms": 0.431, "load_throughput": 2782598.85, "learn_time_ms": 19.866, "learn_throughput": 60405.758, "synch_weights_time_ms": 0.58}, "counters": {"num_env_steps_sampled": 2569440, "num_env_steps_trained": 2569440, "num_agent_steps_sampled": 2569440, "num_agent_steps_trained": 2569440}, "done": false, "episodes_total": 7240, "training_iteration": 1604, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-48-22", "timestamp": 1691239702, "time_this_iter_s": 10.662567853927612, "time_total_s": 20415.092572927475, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1468.28178191185, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 29.119999999999997, "ram_util_percent": 69.71333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.29278055826825, "policy_loss": -1513710.9913194445, "vf_loss": 3417554.6875}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10071.5, "diff_num_grad_updates_vs_sampler_policy": 10070.5}}, "num_env_steps_sampled": 2574240, "num_env_steps_trained": 2574240, "num_agent_steps_sampled": 2574240, "num_agent_steps_trained": 2574240}, "sampler_results": {"episode_reward_max": -3779.8537676316732, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -4015.8912107515066, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3822533862066229, "mean_inference_ms": 0.23500532238020347, "mean_action_processing_ms": 0.05767849516400499, "mean_env_wait_ms": 0.4915118148781979, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026552677154541016, "StateBufferConnector_ms": 0.0017108917236328125, "ViewRequirementAgentConnector_ms": 0.044480323791503906}}, "episode_reward_max": -3779.8537676316732, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -4015.8912107515066, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3921.2605165981463, -4225.985999335454, -3969.665639495675, -4128.477936645387, -3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3822533862066229, "mean_inference_ms": 0.23500532238020347, "mean_action_processing_ms": 0.05767849516400499, "mean_env_wait_ms": 0.4915118148781979, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026552677154541016, "StateBufferConnector_ms": 0.0017108917236328125, "ViewRequirementAgentConnector_ms": 0.044480323791503906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2574240, "num_agent_steps_trained": 2574240, "num_env_steps_sampled": 2574240, "num_env_steps_trained": 2574240, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 453.7856309062525, "num_env_steps_trained_throughput_per_sec": 453.7856309062525, "timesteps_total": 2574240, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2574240, "timers": {"training_iteration_time_ms": 2652.947, "sample_time_ms": 2631.741, "load_time_ms": 0.432, "load_throughput": 2775999.559, "learn_time_ms": 20.165, "learn_throughput": 59508.445, "synch_weights_time_ms": 0.571}, "counters": {"num_env_steps_sampled": 2574240, "num_env_steps_trained": 2574240, "num_agent_steps_sampled": 2574240, "num_agent_steps_trained": 2574240}, "done": false, "episodes_total": 7244, "training_iteration": 1605, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-48-32", "timestamp": 1691239712, "time_this_iter_s": 10.579814910888672, "time_total_s": 20425.672387838364, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1478.8615968227386, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 32.67333333333333, "ram_util_percent": 69.74}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.1832546657986, "policy_loss": -1789371.3980034722, "vf_loss": 3041945.684027778}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10143.5, "diff_num_grad_updates_vs_sampler_policy": 10142.5}}, "num_env_steps_sampled": 2579040, "num_env_steps_trained": 2579040, "num_agent_steps_sampled": 2579040, "num_agent_steps_trained": 2579040}, "sampler_results": {"episode_reward_max": -3779.8537676316732, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -4010.13779674685, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.382303155510857, "mean_inference_ms": 0.2350315826217014, "mean_action_processing_ms": 0.05768287002794328, "mean_env_wait_ms": 0.491567150451371, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026519298553466797, "StateBufferConnector_ms": 0.0017077922821044922, "ViewRequirementAgentConnector_ms": 0.044475555419921875}}, "episode_reward_max": -3779.8537676316732, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -4010.13779674685, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3889.6997623443226, -4076.300859590717, -4181.607123771896, -4041.069673207045, -3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.382303155510857, "mean_inference_ms": 0.2350315826217014, "mean_action_processing_ms": 0.05768287002794328, "mean_env_wait_ms": 0.491567150451371, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026519298553466797, "StateBufferConnector_ms": 0.0017077922821044922, "ViewRequirementAgentConnector_ms": 0.044475555419921875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2579040, "num_agent_steps_trained": 2579040, "num_env_steps_sampled": 2579040, "num_env_steps_trained": 2579040, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 455.371208232024, "num_env_steps_trained_throughput_per_sec": 455.371208232024, "timesteps_total": 2579040, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2579040, "timers": {"training_iteration_time_ms": 2636.765, "sample_time_ms": 2615.561, "load_time_ms": 0.433, "load_throughput": 2772482.538, "learn_time_ms": 20.173, "learn_throughput": 59484.111, "synch_weights_time_ms": 0.559}, "counters": {"num_env_steps_sampled": 2579040, "num_env_steps_trained": 2579040, "num_agent_steps_sampled": 2579040, "num_agent_steps_trained": 2579040}, "done": false, "episodes_total": 7248, "training_iteration": 1606, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-48-43", "timestamp": 1691239723, "time_this_iter_s": 10.542982816696167, "time_total_s": 20436.21537065506, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1489.4045796394348, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 30.459999999999997, "ram_util_percent": 70.06000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.29266187879773, "policy_loss": -1599067.584201389, "vf_loss": 3529933.784722222}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10215.5, "diff_num_grad_updates_vs_sampler_policy": 10214.5}}, "num_env_steps_sampled": 2583840, "num_env_steps_trained": 2583840, "num_agent_steps_sampled": 2583840, "num_agent_steps_trained": 2583840}, "sampler_results": {"episode_reward_max": -3779.8537676316732, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -4008.878717620522, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3823537316233814, "mean_inference_ms": 0.23505862276688227, "mean_action_processing_ms": 0.057687371563190835, "mean_env_wait_ms": 0.49162050655465606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026488304138183594, "StateBufferConnector_ms": 0.0017108917236328125, "ViewRequirementAgentConnector_ms": 0.04441666603088379}}, "episode_reward_max": -3779.8537676316732, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -4008.878717620522, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3980.310122414446, -4047.3277601650643, -3834.738796857874, -3915.0968694770713, -4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3823537316233814, "mean_inference_ms": 0.23505862276688227, "mean_action_processing_ms": 0.057687371563190835, "mean_env_wait_ms": 0.49162050655465606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026488304138183594, "StateBufferConnector_ms": 0.0017108917236328125, "ViewRequirementAgentConnector_ms": 0.04441666603088379}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2583840, "num_agent_steps_trained": 2583840, "num_env_steps_sampled": 2583840, "num_env_steps_trained": 2583840, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 453.05671284541825, "num_env_steps_trained_throughput_per_sec": 453.05671284541825, "timesteps_total": 2583840, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2583840, "timers": {"training_iteration_time_ms": 2642.114, "sample_time_ms": 2620.882, "load_time_ms": 0.435, "load_throughput": 2761378.614, "learn_time_ms": 20.187, "learn_throughput": 59444.418, "synch_weights_time_ms": 0.572}, "counters": {"num_env_steps_sampled": 2583840, "num_env_steps_trained": 2583840, "num_agent_steps_sampled": 2583840, "num_agent_steps_trained": 2583840}, "done": false, "episodes_total": 7252, "training_iteration": 1607, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-48-54", "timestamp": 1691239734, "time_this_iter_s": 10.596745014190674, "time_total_s": 20446.81211566925, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1500.0013246536255, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 33.08, "ram_util_percent": 70.08000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -321.8746592203776, "policy_loss": -1606220.306423611, "vf_loss": 3163333.263888889}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10287.5, "diff_num_grad_updates_vs_sampler_policy": 10286.5}}, "num_env_steps_sampled": 2588640, "num_env_steps_trained": 2588640, "num_agent_steps_sampled": 2588640, "num_agent_steps_trained": 2588640}, "sampler_results": {"episode_reward_max": -3779.8537676316732, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -4007.139046980449, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3824047624021443, "mean_inference_ms": 0.23508254657878674, "mean_action_processing_ms": 0.05769137497317, "mean_env_wait_ms": 0.4916662308752406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002644062042236328, "StateBufferConnector_ms": 0.0017094612121582031, "ViewRequirementAgentConnector_ms": 0.044408321380615234}}, "episode_reward_max": -3779.8537676316732, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -4007.139046980449, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4001.5625444647803, -4199.608601590914, -4235.222643741405, -4082.0537443209, -3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3824047624021443, "mean_inference_ms": 0.23508254657878674, "mean_action_processing_ms": 0.05769137497317, "mean_env_wait_ms": 0.4916662308752406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002644062042236328, "StateBufferConnector_ms": 0.0017094612121582031, "ViewRequirementAgentConnector_ms": 0.044408321380615234}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2588640, "num_agent_steps_trained": 2588640, "num_env_steps_sampled": 2588640, "num_env_steps_trained": 2588640, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 451.78264966381084, "num_env_steps_trained_throughput_per_sec": 451.78264966381084, "timesteps_total": 2588640, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2588640, "timers": {"training_iteration_time_ms": 2647.683, "sample_time_ms": 2626.456, "load_time_ms": 0.434, "load_throughput": 2766083.095, "learn_time_ms": 20.172, "learn_throughput": 59489.806, "synch_weights_time_ms": 0.583}, "counters": {"num_env_steps_sampled": 2588640, "num_env_steps_trained": 2588640, "num_agent_steps_sampled": 2588640, "num_agent_steps_trained": 2588640}, "done": false, "episodes_total": 7256, "training_iteration": 1608, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-49-04", "timestamp": 1691239744, "time_this_iter_s": 10.626842021942139, "time_total_s": 20457.438957691193, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1510.6281666755676, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 28.713333333333328, "ram_util_percent": 70.14666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.17391798231336, "policy_loss": -898361.7105034722, "vf_loss": 3182373.138888889}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10359.5, "diff_num_grad_updates_vs_sampler_policy": 10358.5}}, "num_env_steps_sampled": 2593440, "num_env_steps_trained": 2593440, "num_agent_steps_sampled": 2593440, "num_agent_steps_trained": 2593440}, "sampler_results": {"episode_reward_max": -3779.8537676316732, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -3998.6601933534025, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.382454059630067, "mean_inference_ms": 0.2351075760815863, "mean_action_processing_ms": 0.05769560892916324, "mean_env_wait_ms": 0.49171091248486093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002634286880493164, "StateBufferConnector_ms": 0.0017056465148925781, "ViewRequirementAgentConnector_ms": 0.044318199157714844}}, "episode_reward_max": -3779.8537676316732, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -3998.6601933534025, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3951.803373544243, -4020.982239154511, -3939.530456915117, -4018.052324936314, -4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.382454059630067, "mean_inference_ms": 0.2351075760815863, "mean_action_processing_ms": 0.05769560892916324, "mean_env_wait_ms": 0.49171091248486093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002634286880493164, "StateBufferConnector_ms": 0.0017056465148925781, "ViewRequirementAgentConnector_ms": 0.044318199157714844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2593440, "num_agent_steps_trained": 2593440, "num_env_steps_sampled": 2593440, "num_env_steps_trained": 2593440, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 454.0520996222461, "num_env_steps_trained_throughput_per_sec": 454.0520996222461, "timesteps_total": 2593440, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2593440, "timers": {"training_iteration_time_ms": 2654.297, "sample_time_ms": 2632.911, "load_time_ms": 0.439, "load_throughput": 2734672.535, "learn_time_ms": 20.32, "learn_throughput": 59054.673, "synch_weights_time_ms": 0.589}, "counters": {"num_env_steps_sampled": 2593440, "num_env_steps_trained": 2593440, "num_agent_steps_sampled": 2593440, "num_agent_steps_trained": 2593440}, "done": false, "episodes_total": 7260, "training_iteration": 1609, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-49-15", "timestamp": 1691239755, "time_this_iter_s": 10.573811054229736, "time_total_s": 20468.012768745422, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1521.2019777297974, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 26.90666666666667, "ram_util_percent": 70.12000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.6667243109809, "policy_loss": -390782.6979166667, "vf_loss": 2916661.3506944445}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10431.5, "diff_num_grad_updates_vs_sampler_policy": 10430.5}}, "num_env_steps_sampled": 2598240, "num_env_steps_trained": 2598240, "num_agent_steps_sampled": 2598240, "num_agent_steps_trained": 2598240}, "sampler_results": {"episode_reward_max": -3766.528211505233, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -3996.6248575977697, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.382502905754088, "mean_inference_ms": 0.23513062462739684, "mean_action_processing_ms": 0.05769952205575221, "mean_env_wait_ms": 0.49175611480836023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026323795318603516, "StateBufferConnector_ms": 0.0017049312591552734, "ViewRequirementAgentConnector_ms": 0.04436135292053223}}, "episode_reward_max": -3766.528211505233, "episode_reward_min": -4295.27705809688, "episode_reward_mean": -3996.6248575977697, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4018.4479426019257, -3905.9098147973286, -4295.27705809688, -3941.119544395956, -3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.382502905754088, "mean_inference_ms": 0.23513062462739684, "mean_action_processing_ms": 0.05769952205575221, "mean_env_wait_ms": 0.49175611480836023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026323795318603516, "StateBufferConnector_ms": 0.0017049312591552734, "ViewRequirementAgentConnector_ms": 0.04436135292053223}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2598240, "num_agent_steps_trained": 2598240, "num_env_steps_sampled": 2598240, "num_env_steps_trained": 2598240, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 450.50842323813384, "num_env_steps_trained_throughput_per_sec": 450.50842323813384, "timesteps_total": 2598240, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2598240, "timers": {"training_iteration_time_ms": 2654.68, "sample_time_ms": 2633.601, "load_time_ms": 0.437, "load_throughput": 2748410.856, "learn_time_ms": 20.017, "learn_throughput": 59948.603, "synch_weights_time_ms": 0.587}, "counters": {"num_env_steps_sampled": 2598240, "num_env_steps_trained": 2598240, "num_agent_steps_sampled": 2598240, "num_agent_steps_trained": 2598240}, "done": false, "episodes_total": 7264, "training_iteration": 1610, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-49-26", "timestamp": 1691239766, "time_this_iter_s": 10.656743049621582, "time_total_s": 20478.669511795044, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1531.858720779419, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 28.119999999999997, "ram_util_percent": 69.75333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.0172576904297, "policy_loss": -1738918.3606770833, "vf_loss": 3196488.465277778}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10503.5, "diff_num_grad_updates_vs_sampler_policy": 10502.5}}, "num_env_steps_sampled": 2603040, "num_env_steps_trained": 2603040, "num_agent_steps_sampled": 2603040, "num_agent_steps_trained": 2603040}, "sampler_results": {"episode_reward_max": -3766.528211505233, "episode_reward_min": -4265.420903269212, "episode_reward_mean": -3997.312370569202, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3825516743193718, "mean_inference_ms": 0.23515429622553072, "mean_action_processing_ms": 0.05770358616815419, "mean_env_wait_ms": 0.49180259539927973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002633333206176758, "StateBufferConnector_ms": 0.0017020702362060547, "ViewRequirementAgentConnector_ms": 0.044315338134765625}}, "episode_reward_max": -3766.528211505233, "episode_reward_min": -4265.420903269212, "episode_reward_mean": -3997.312370569202, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3892.050956221129, -3893.0838830216494, -3906.1342406295494, -4265.420903269212, -3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3825516743193718, "mean_inference_ms": 0.23515429622553072, "mean_action_processing_ms": 0.05770358616815419, "mean_env_wait_ms": 0.49180259539927973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002633333206176758, "StateBufferConnector_ms": 0.0017020702362060547, "ViewRequirementAgentConnector_ms": 0.044315338134765625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2603040, "num_agent_steps_trained": 2603040, "num_env_steps_sampled": 2603040, "num_env_steps_trained": 2603040, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 451.27265953065637, "num_env_steps_trained_throughput_per_sec": 451.27265953065637, "timesteps_total": 2603040, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2603040, "timers": {"training_iteration_time_ms": 2661.743, "sample_time_ms": 2640.444, "load_time_ms": 0.428, "load_throughput": 2800714.93, "learn_time_ms": 20.248, "learn_throughput": 59263.764, "synch_weights_time_ms": 0.584}, "counters": {"num_env_steps_sampled": 2603040, "num_env_steps_trained": 2603040, "num_agent_steps_sampled": 2603040, "num_agent_steps_trained": 2603040}, "done": false, "episodes_total": 7268, "training_iteration": 1611, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-49-36", "timestamp": 1691239776, "time_this_iter_s": 10.6387038230896, "time_total_s": 20489.308215618134, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1542.4974246025085, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 27.439999999999998, "ram_util_percent": 69.76666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.2529788547092, "policy_loss": -1195717.8324652778, "vf_loss": 3184836.3125}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10575.5, "diff_num_grad_updates_vs_sampler_policy": 10574.5}}, "num_env_steps_sampled": 2607840, "num_env_steps_trained": 2607840, "num_agent_steps_sampled": 2607840, "num_agent_steps_trained": 2607840}, "sampler_results": {"episode_reward_max": -3766.528211505233, "episode_reward_min": -4268.845760115401, "episode_reward_mean": -4000.364190495268, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3826002287469157, "mean_inference_ms": 0.23517672004907225, "mean_action_processing_ms": 0.05770744465259312, "mean_env_wait_ms": 0.49184532293699773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002632617950439453, "StateBufferConnector_ms": 0.0016937255859375, "ViewRequirementAgentConnector_ms": 0.04428219795227051}}, "episode_reward_max": -3766.528211505233, "episode_reward_min": -4268.845760115401, "episode_reward_mean": -4000.364190495268, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3907.2637314516487, -4131.115916598982, -3907.0840499737506, -4105.984932426272, -4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3826002287469157, "mean_inference_ms": 0.23517672004907225, "mean_action_processing_ms": 0.05770744465259312, "mean_env_wait_ms": 0.49184532293699773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002632617950439453, "StateBufferConnector_ms": 0.0016937255859375, "ViewRequirementAgentConnector_ms": 0.04428219795227051}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2607840, "num_agent_steps_trained": 2607840, "num_env_steps_sampled": 2607840, "num_env_steps_trained": 2607840, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 451.0857261338328, "num_env_steps_trained_throughput_per_sec": 451.0857261338328, "timesteps_total": 2607840, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2607840, "timers": {"training_iteration_time_ms": 2653.136, "sample_time_ms": 2631.977, "load_time_ms": 0.426, "load_throughput": 2817174.969, "learn_time_ms": 20.128, "learn_throughput": 59619.325, "synch_weights_time_ms": 0.568}, "counters": {"num_env_steps_sampled": 2607840, "num_env_steps_trained": 2607840, "num_agent_steps_sampled": 2607840, "num_agent_steps_trained": 2607840}, "done": false, "episodes_total": 7272, "training_iteration": 1612, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-49-47", "timestamp": 1691239787, "time_this_iter_s": 10.643083810806274, "time_total_s": 20499.95129942894, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1553.1405084133148, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 28.793333333333333, "ram_util_percent": 69.77999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.0344051784939, "policy_loss": -2902176.9991319445, "vf_loss": 3480551.736111111}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10647.5, "diff_num_grad_updates_vs_sampler_policy": 10646.5}}, "num_env_steps_sampled": 2612640, "num_env_steps_trained": 2612640, "num_agent_steps_sampled": 2612640, "num_agent_steps_trained": 2612640}, "sampler_results": {"episode_reward_max": -3766.528211505233, "episode_reward_min": -4268.845760115401, "episode_reward_mean": -4007.2214922649273, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.382647727752775, "mean_inference_ms": 0.23520103469298134, "mean_action_processing_ms": 0.05771158595672092, "mean_env_wait_ms": 0.49189216161080523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026252269744873047, "StateBufferConnector_ms": 0.0016946792602539062, "ViewRequirementAgentConnector_ms": 0.04424619674682617}}, "episode_reward_max": -3766.528211505233, "episode_reward_min": -4268.845760115401, "episode_reward_mean": -4007.2214922649273, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4137.243941305211, -3779.8537676316732, -4177.940266221211, -3912.9311684290246, -4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.382647727752775, "mean_inference_ms": 0.23520103469298134, "mean_action_processing_ms": 0.05771158595672092, "mean_env_wait_ms": 0.49189216161080523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026252269744873047, "StateBufferConnector_ms": 0.0016946792602539062, "ViewRequirementAgentConnector_ms": 0.04424619674682617}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2612640, "num_agent_steps_trained": 2612640, "num_env_steps_sampled": 2612640, "num_env_steps_trained": 2612640, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 447.3957970483378, "num_env_steps_trained_throughput_per_sec": 447.3957970483378, "timesteps_total": 2612640, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2612640, "timers": {"training_iteration_time_ms": 2671.386, "sample_time_ms": 2650.303, "load_time_ms": 0.435, "load_throughput": 2757143.139, "learn_time_ms": 20.017, "learn_throughput": 59948.603, "synch_weights_time_ms": 0.593}, "counters": {"num_env_steps_sampled": 2612640, "num_env_steps_trained": 2612640, "num_agent_steps_sampled": 2612640, "num_agent_steps_trained": 2612640}, "done": false, "episodes_total": 7276, "training_iteration": 1613, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-49-58", "timestamp": 1691239798, "time_this_iter_s": 10.731118202209473, "time_total_s": 20510.68241763115, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1563.8716266155243, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 31.4125, "ram_util_percent": 69.73750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.09552171495227, "policy_loss": -1703827.8971354167, "vf_loss": 3115356.888888889}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10719.5, "diff_num_grad_updates_vs_sampler_policy": 10718.5}}, "num_env_steps_sampled": 2617440, "num_env_steps_trained": 2617440, "num_agent_steps_sampled": 2617440, "num_agent_steps_trained": 2617440}, "sampler_results": {"episode_reward_max": -3766.528211505233, "episode_reward_min": -4268.845760115401, "episode_reward_mean": -4003.6911580815818, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3826939424156723, "mean_inference_ms": 0.23522439146638782, "mean_action_processing_ms": 0.05771557406374808, "mean_env_wait_ms": 0.49193916027376416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002630472183227539, "StateBufferConnector_ms": 0.0016949176788330078, "ViewRequirementAgentConnector_ms": 0.0442807674407959}}, "episode_reward_max": -3766.528211505233, "episode_reward_min": -4268.845760115401, "episode_reward_mean": -4003.6911580815818, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4208.4960056648215, -3916.561992037412, -3922.094753638332, -4258.957210941761, -3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3826939424156723, "mean_inference_ms": 0.23522439146638782, "mean_action_processing_ms": 0.05771557406374808, "mean_env_wait_ms": 0.49193916027376416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002630472183227539, "StateBufferConnector_ms": 0.0016949176788330078, "ViewRequirementAgentConnector_ms": 0.0442807674407959}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2617440, "num_agent_steps_trained": 2617440, "num_env_steps_sampled": 2617440, "num_env_steps_trained": 2617440, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 452.9042308985481, "num_env_steps_trained_throughput_per_sec": 452.9042308985481, "timesteps_total": 2617440, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2617440, "timers": {"training_iteration_time_ms": 2666.442, "sample_time_ms": 2645.277, "load_time_ms": 0.439, "load_throughput": 2732890.699, "learn_time_ms": 20.092, "learn_throughput": 59725.162, "synch_weights_time_ms": 0.595}, "counters": {"num_env_steps_sampled": 2617440, "num_env_steps_trained": 2617440, "num_agent_steps_sampled": 2617440, "num_agent_steps_trained": 2617440}, "done": false, "episodes_total": 7280, "training_iteration": 1614, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-50-08", "timestamp": 1691239808, "time_this_iter_s": 10.600600004196167, "time_total_s": 20521.283017635345, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1574.4722266197205, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 29.066666666666666, "ram_util_percent": 69.79333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.24087693956164, "policy_loss": -1680568.2994791667, "vf_loss": 3327797.4375}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10791.5, "diff_num_grad_updates_vs_sampler_policy": 10790.5}}, "num_env_steps_sampled": 2622240, "num_env_steps_trained": 2622240, "num_agent_steps_sampled": 2622240, "num_agent_steps_trained": 2622240}, "sampler_results": {"episode_reward_max": -3766.528211505233, "episode_reward_min": -4268.845760115401, "episode_reward_mean": -4000.480894788548, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3827380357620283, "mean_inference_ms": 0.23524988495540405, "mean_action_processing_ms": 0.05771996219091534, "mean_env_wait_ms": 0.49199090460239503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002623319625854492, "StateBufferConnector_ms": 0.0017006397247314453, "ViewRequirementAgentConnector_ms": 0.04432082176208496}}, "episode_reward_max": -3766.528211505233, "episode_reward_min": -4268.845760115401, "episode_reward_mean": -4000.480894788548, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3895.6538225209756, -4062.1086787426657, -4137.290075582646, -4050.911137379196, -4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3827380357620283, "mean_inference_ms": 0.23524988495540405, "mean_action_processing_ms": 0.05771996219091534, "mean_env_wait_ms": 0.49199090460239503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002623319625854492, "StateBufferConnector_ms": 0.0017006397247314453, "ViewRequirementAgentConnector_ms": 0.04432082176208496}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2622240, "num_agent_steps_trained": 2622240, "num_env_steps_sampled": 2622240, "num_env_steps_trained": 2622240, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 448.8796947718019, "num_env_steps_trained_throughput_per_sec": 448.8796947718019, "timesteps_total": 2622240, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2622240, "timers": {"training_iteration_time_ms": 2666.348, "sample_time_ms": 2645.316, "load_time_ms": 0.438, "load_throughput": 2738094.223, "learn_time_ms": 19.961, "learn_throughput": 60118.092, "synch_weights_time_ms": 0.595}, "counters": {"num_env_steps_sampled": 2622240, "num_env_steps_trained": 2622240, "num_agent_steps_sampled": 2622240, "num_agent_steps_trained": 2622240}, "done": false, "episodes_total": 7284, "training_iteration": 1615, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-50-19", "timestamp": 1691239819, "time_this_iter_s": 10.695528745651245, "time_total_s": 20531.978546380997, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1585.1677553653717, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 27.953333333333337, "ram_util_percent": 69.79333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.2320743136936, "policy_loss": -1527236.459201389, "vf_loss": 3106892.1041666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10863.5, "diff_num_grad_updates_vs_sampler_policy": 10862.5}}, "num_env_steps_sampled": 2627040, "num_env_steps_trained": 2627040, "num_agent_steps_sampled": 2627040, "num_agent_steps_trained": 2627040}, "sampler_results": {"episode_reward_max": -3766.528211505233, "episode_reward_min": -4268.845760115401, "episode_reward_mean": -3999.9966863174313, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.382784266900127, "mean_inference_ms": 0.2352732148861927, "mean_action_processing_ms": 0.05772398426708635, "mean_env_wait_ms": 0.49203967976146484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002627134323120117, "StateBufferConnector_ms": 0.0016970634460449219, "ViewRequirementAgentConnector_ms": 0.04433250427246094}}, "episode_reward_max": -3766.528211505233, "episode_reward_min": -4268.845760115401, "episode_reward_mean": -3999.9966863174313, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4108.851255028444, -3873.3642396896457, -3961.57280943958, -3906.8476038442263, -4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.382784266900127, "mean_inference_ms": 0.2352732148861927, "mean_action_processing_ms": 0.05772398426708635, "mean_env_wait_ms": 0.49203967976146484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002627134323120117, "StateBufferConnector_ms": 0.0016970634460449219, "ViewRequirementAgentConnector_ms": 0.04433250427246094}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2627040, "num_agent_steps_trained": 2627040, "num_env_steps_sampled": 2627040, "num_env_steps_trained": 2627040, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 450.7491758122371, "num_env_steps_trained_throughput_per_sec": 450.7491758122371, "timesteps_total": 2627040, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2627040, "timers": {"training_iteration_time_ms": 2660.622, "sample_time_ms": 2639.653, "load_time_ms": 0.43, "load_throughput": 2792014.645, "learn_time_ms": 19.927, "learn_throughput": 60219.223, "synch_weights_time_ms": 0.575}, "counters": {"num_env_steps_sampled": 2627040, "num_env_steps_trained": 2627040, "num_agent_steps_sampled": 2627040, "num_agent_steps_trained": 2627040}, "done": false, "episodes_total": 7288, "training_iteration": 1616, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-50-30", "timestamp": 1691239830, "time_this_iter_s": 10.651056051254272, "time_total_s": 20542.62960243225, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1595.818811416626, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 29.466666666666665, "ram_util_percent": 69.88000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -321.9691111246745, "policy_loss": -3262422.802951389, "vf_loss": 3352176.451388889}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10935.5, "diff_num_grad_updates_vs_sampler_policy": 10934.5}}, "num_env_steps_sampled": 2631840, "num_env_steps_trained": 2631840, "num_agent_steps_sampled": 2631840, "num_agent_steps_trained": 2631840}, "sampler_results": {"episode_reward_max": -3766.528211505233, "episode_reward_min": -4268.845760115401, "episode_reward_mean": -4001.519848219254, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3828266558876487, "mean_inference_ms": 0.23529497668262953, "mean_action_processing_ms": 0.057727774198927474, "mean_env_wait_ms": 0.49208946300323186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002611398696899414, "StateBufferConnector_ms": 0.0017054080963134766, "ViewRequirementAgentConnector_ms": 0.04429364204406738}}, "episode_reward_max": -3766.528211505233, "episode_reward_min": -4268.845760115401, "episode_reward_mean": -4001.519848219254, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4138.747243790254, -4133.477162437161, -3934.7354633209047, -4178.729297871933, -4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3828266558876487, "mean_inference_ms": 0.23529497668262953, "mean_action_processing_ms": 0.057727774198927474, "mean_env_wait_ms": 0.49208946300323186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002611398696899414, "StateBufferConnector_ms": 0.0017054080963134766, "ViewRequirementAgentConnector_ms": 0.04429364204406738}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2631840, "num_agent_steps_trained": 2631840, "num_env_steps_sampled": 2631840, "num_env_steps_trained": 2631840, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 450.9074405488868, "num_env_steps_trained_throughput_per_sec": 450.9074405488868, "timesteps_total": 2631840, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2631840, "timers": {"training_iteration_time_ms": 2663.705, "sample_time_ms": 2642.612, "load_time_ms": 0.432, "load_throughput": 2775540.311, "learn_time_ms": 20.055, "learn_throughput": 59834.22, "synch_weights_time_ms": 0.568}, "counters": {"num_env_steps_sampled": 2631840, "num_env_steps_trained": 2631840, "num_agent_steps_sampled": 2631840, "num_agent_steps_trained": 2631840}, "done": false, "episodes_total": 7292, "training_iteration": 1617, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-50-40", "timestamp": 1691239840, "time_this_iter_s": 10.647629022598267, "time_total_s": 20553.27723145485, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1606.4664404392242, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 27.780000000000005, "ram_util_percent": 70.04666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.0445200602214, "policy_loss": -2911706.703125, "vf_loss": 3411433.5694444445}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11007.5, "diff_num_grad_updates_vs_sampler_policy": 11006.5}}, "num_env_steps_sampled": 2636640, "num_env_steps_trained": 2636640, "num_agent_steps_sampled": 2636640, "num_agent_steps_trained": 2636640}, "sampler_results": {"episode_reward_max": -3766.528211505233, "episode_reward_min": -4268.845760115401, "episode_reward_mean": -3997.39130922978, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3828696395912123, "mean_inference_ms": 0.23531584091300026, "mean_action_processing_ms": 0.05773143927344743, "mean_env_wait_ms": 0.4921322365076694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002625703811645508, "StateBufferConnector_ms": 0.0017139911651611328, "ViewRequirementAgentConnector_ms": 0.04436087608337402}}, "episode_reward_max": -3766.528211505233, "episode_reward_min": -4268.845760115401, "episode_reward_mean": -3997.39130922978, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4010.762147100617, -3954.050697688991, -4209.81496926387, -4191.088505025535, -3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3828696395912123, "mean_inference_ms": 0.23531584091300026, "mean_action_processing_ms": 0.05773143927344743, "mean_env_wait_ms": 0.4921322365076694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002625703811645508, "StateBufferConnector_ms": 0.0017139911651611328, "ViewRequirementAgentConnector_ms": 0.04436087608337402}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2636640, "num_agent_steps_trained": 2636640, "num_env_steps_sampled": 2636640, "num_env_steps_trained": 2636640, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 455.46729500333083, "num_env_steps_trained_throughput_per_sec": 455.46729500333083, "timesteps_total": 2636640, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2636640, "timers": {"training_iteration_time_ms": 2650.439, "sample_time_ms": 2629.498, "load_time_ms": 0.423, "load_throughput": 2835745.563, "learn_time_ms": 19.917, "learn_throughput": 60251.446, "synch_weights_time_ms": 0.565}, "counters": {"num_env_steps_sampled": 2636640, "num_env_steps_trained": 2636640, "num_agent_steps_sampled": 2636640, "num_agent_steps_trained": 2636640}, "done": false, "episodes_total": 7296, "training_iteration": 1618, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-50-51", "timestamp": 1691239851, "time_this_iter_s": 10.540881156921387, "time_total_s": 20563.81811261177, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1617.0073215961456, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 28.46, "ram_util_percent": 70.07333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.48131985134546, "policy_loss": -1115794.6059027778, "vf_loss": 3183598.7430555555}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11079.5, "diff_num_grad_updates_vs_sampler_policy": 11078.5}}, "num_env_steps_sampled": 2641440, "num_env_steps_trained": 2641440, "num_agent_steps_sampled": 2641440, "num_agent_steps_trained": 2641440}, "sampler_results": {"episode_reward_max": -3766.528211505233, "episode_reward_min": -4268.845760115401, "episode_reward_mean": -3993.3026215865275, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499, -4036.1711605483465, -3967.0472035295725, -3950.840098797094, -4002.7890918787502], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.382911492708707, "mean_inference_ms": 0.23533643246703484, "mean_action_processing_ms": 0.057734972825509934, "mean_env_wait_ms": 0.4921717604660867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026264190673828125, "StateBufferConnector_ms": 0.0017158985137939453, "ViewRequirementAgentConnector_ms": 0.04430270195007324}}, "episode_reward_max": -3766.528211505233, "episode_reward_min": -4268.845760115401, "episode_reward_mean": -3993.3026215865275, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3900.2697243505822, -4133.797190836131, -4114.210048123467, -4083.371716575912, -3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499, -4036.1711605483465, -3967.0472035295725, -3950.840098797094, -4002.7890918787502], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.382911492708707, "mean_inference_ms": 0.23533643246703484, "mean_action_processing_ms": 0.057734972825509934, "mean_env_wait_ms": 0.4921717604660867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026264190673828125, "StateBufferConnector_ms": 0.0017158985137939453, "ViewRequirementAgentConnector_ms": 0.04430270195007324}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2641440, "num_agent_steps_trained": 2641440, "num_env_steps_sampled": 2641440, "num_env_steps_trained": 2641440, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 448.1893172324686, "num_env_steps_trained_throughput_per_sec": 448.1893172324686, "timesteps_total": 2641440, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2641440, "timers": {"training_iteration_time_ms": 2662.586, "sample_time_ms": 2641.2, "load_time_ms": 0.425, "load_throughput": 2824288.648, "learn_time_ms": 20.333, "learn_throughput": 59016.727, "synch_weights_time_ms": 0.591}, "counters": {"num_env_steps_sampled": 2641440, "num_env_steps_trained": 2641440, "num_agent_steps_sampled": 2641440, "num_agent_steps_trained": 2641440}, "done": false, "episodes_total": 7300, "training_iteration": 1619, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-51-02", "timestamp": 1691239862, "time_this_iter_s": 10.7119779586792, "time_total_s": 20574.53009057045, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1627.7192995548248, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 27.573333333333334, "ram_util_percent": 70.07333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -321.9775899251302, "policy_loss": -2700874.301215278, "vf_loss": 3304793.7430555555}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11151.5, "diff_num_grad_updates_vs_sampler_policy": 11150.5}}, "num_env_steps_sampled": 2646240, "num_env_steps_trained": 2646240, "num_agent_steps_sampled": 2646240, "num_agent_steps_trained": 2646240}, "sampler_results": {"episode_reward_max": -3766.528211505233, "episode_reward_min": -4268.845760115401, "episode_reward_mean": -3995.5451014063315, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499, -4036.1711605483465, -3967.0472035295725, -3950.840098797094, -4002.7890918787502, -4127.8069136484555, -4031.8489539723896, -4254.229916304819, -4042.010877940848], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3829568530311718, "mean_inference_ms": 0.235355964044118, "mean_action_processing_ms": 0.0577382587832562, "mean_env_wait_ms": 0.492209775941714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026292800903320312, "StateBufferConnector_ms": 0.0017189979553222656, "ViewRequirementAgentConnector_ms": 0.04435157775878906}}, "episode_reward_max": -3766.528211505233, "episode_reward_min": -4268.845760115401, "episode_reward_mean": -3995.5451014063315, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3921.1380145289495, -4102.879235022788, -3962.3782743706065, -4260.881608483674, -4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499, -4036.1711605483465, -3967.0472035295725, -3950.840098797094, -4002.7890918787502, -4127.8069136484555, -4031.8489539723896, -4254.229916304819, -4042.010877940848], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3829568530311718, "mean_inference_ms": 0.235355964044118, "mean_action_processing_ms": 0.0577382587832562, "mean_env_wait_ms": 0.492209775941714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026292800903320312, "StateBufferConnector_ms": 0.0017189979553222656, "ViewRequirementAgentConnector_ms": 0.04435157775878906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2646240, "num_agent_steps_trained": 2646240, "num_env_steps_sampled": 2646240, "num_env_steps_trained": 2646240, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 448.18458794603254, "num_env_steps_trained_throughput_per_sec": 448.18458794603254, "timesteps_total": 2646240, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2646240, "timers": {"training_iteration_time_ms": 2665.535, "sample_time_ms": 2643.676, "load_time_ms": 0.437, "load_throughput": 2747660.662, "learn_time_ms": 20.782, "learn_throughput": 57742.824, "synch_weights_time_ms": 0.603}, "counters": {"num_env_steps_sampled": 2646240, "num_env_steps_trained": 2646240, "num_agent_steps_sampled": 2646240, "num_agent_steps_trained": 2646240}, "done": false, "episodes_total": 7304, "training_iteration": 1620, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-51-12", "timestamp": 1691239872, "time_this_iter_s": 10.712214946746826, "time_total_s": 20585.242305517197, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1638.4315145015717, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 33.42666666666666, "ram_util_percent": 70.06}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -321.9624769422743, "policy_loss": -1743284.657986111, "vf_loss": 3439334.5833333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11223.5, "diff_num_grad_updates_vs_sampler_policy": 11222.5}}, "num_env_steps_sampled": 2651040, "num_env_steps_trained": 2651040, "num_agent_steps_sampled": 2651040, "num_agent_steps_trained": 2651040}, "sampler_results": {"episode_reward_max": -3766.528211505233, "episode_reward_min": -4268.845760115401, "episode_reward_mean": -3996.6380301845243, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499, -4036.1711605483465, -3967.0472035295725, -3950.840098797094, -4002.7890918787502, -4127.8069136484555, -4031.8489539723896, -4254.229916304819, -4042.010877940848, -3936.5988775090946, -4061.4349536346094, -4245.946062587273, -4112.590116494385], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3829996251223955, "mean_inference_ms": 0.23537550510124514, "mean_action_processing_ms": 0.057741566299865515, "mean_env_wait_ms": 0.49224963328632654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002626657485961914, "StateBufferConnector_ms": 0.001714944839477539, "ViewRequirementAgentConnector_ms": 0.04435300827026367}}, "episode_reward_max": -3766.528211505233, "episode_reward_min": -4268.845760115401, "episode_reward_mean": -3996.6380301845243, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4026.0101695209196, -4049.892344226674, -4200.4712714132875, -3876.120602745678, -3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499, -4036.1711605483465, -3967.0472035295725, -3950.840098797094, -4002.7890918787502, -4127.8069136484555, -4031.8489539723896, -4254.229916304819, -4042.010877940848, -3936.5988775090946, -4061.4349536346094, -4245.946062587273, -4112.590116494385], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3829996251223955, "mean_inference_ms": 0.23537550510124514, "mean_action_processing_ms": 0.057741566299865515, "mean_env_wait_ms": 0.49224963328632654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002626657485961914, "StateBufferConnector_ms": 0.001714944839477539, "ViewRequirementAgentConnector_ms": 0.04435300827026367}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2651040, "num_agent_steps_trained": 2651040, "num_env_steps_sampled": 2651040, "num_env_steps_trained": 2651040, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 452.6381202526489, "num_env_steps_trained_throughput_per_sec": 452.6381202526489, "timesteps_total": 2651040, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2651040, "timers": {"training_iteration_time_ms": 2669.456, "sample_time_ms": 2648.049, "load_time_ms": 0.439, "load_throughput": 2731111.183, "learn_time_ms": 20.338, "learn_throughput": 59002.336, "synch_weights_time_ms": 0.588}, "counters": {"num_env_steps_sampled": 2651040, "num_env_steps_trained": 2651040, "num_agent_steps_sampled": 2651040, "num_agent_steps_trained": 2651040}, "done": false, "episodes_total": 7308, "training_iteration": 1621, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-51-23", "timestamp": 1691239883, "time_this_iter_s": 10.606552839279175, "time_total_s": 20595.848858356476, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1649.0380673408508, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 25.66, "ram_util_percent": 69.97333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.0692715115017, "policy_loss": -2648841.651909722, "vf_loss": 3363908.111111111}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11295.5, "diff_num_grad_updates_vs_sampler_policy": 11294.5}}, "num_env_steps_sampled": 2655840, "num_env_steps_trained": 2655840, "num_agent_steps_sampled": 2655840, "num_agent_steps_trained": 2655840}, "sampler_results": {"episode_reward_max": -3766.528211505233, "episode_reward_min": -4268.845760115401, "episode_reward_mean": -3994.494416519869, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499, -4036.1711605483465, -3967.0472035295725, -3950.840098797094, -4002.7890918787502, -4127.8069136484555, -4031.8489539723896, -4254.229916304819, -4042.010877940848, -3936.5988775090946, -4061.4349536346094, -4245.946062587273, -4112.590116494385, -4026.6495304377304, -4002.996250833489, -3860.3889669427726, -4048.0982732269777], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.38304256752455, "mean_inference_ms": 0.23539552211680037, "mean_action_processing_ms": 0.057744975802243054, "mean_env_wait_ms": 0.49229028904921873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002634763717651367, "StateBufferConnector_ms": 0.0017125606536865234, "ViewRequirementAgentConnector_ms": 0.044400930404663086}}, "episode_reward_max": -3766.528211505233, "episode_reward_min": -4268.845760115401, "episode_reward_mean": -3994.494416519869, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3863.1581881958414, -4143.043787727471, -3881.544714538193, -4039.3116287678413, -3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499, -4036.1711605483465, -3967.0472035295725, -3950.840098797094, -4002.7890918787502, -4127.8069136484555, -4031.8489539723896, -4254.229916304819, -4042.010877940848, -3936.5988775090946, -4061.4349536346094, -4245.946062587273, -4112.590116494385, -4026.6495304377304, -4002.996250833489, -3860.3889669427726, -4048.0982732269777], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.38304256752455, "mean_inference_ms": 0.23539552211680037, "mean_action_processing_ms": 0.057744975802243054, "mean_env_wait_ms": 0.49229028904921873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002634763717651367, "StateBufferConnector_ms": 0.0017125606536865234, "ViewRequirementAgentConnector_ms": 0.044400930404663086}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2655840, "num_agent_steps_trained": 2655840, "num_env_steps_sampled": 2655840, "num_env_steps_trained": 2655840, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 448.15830929911175, "num_env_steps_trained_throughput_per_sec": 448.15830929911175, "timesteps_total": 2655840, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2655840, "timers": {"training_iteration_time_ms": 2663.662, "sample_time_ms": 2642.309, "load_time_ms": 0.448, "load_throughput": 2676930.539, "learn_time_ms": 20.28, "learn_throughput": 59171.796, "synch_weights_time_ms": 0.585}, "counters": {"num_env_steps_sampled": 2655840, "num_env_steps_trained": 2655840, "num_agent_steps_sampled": 2655840, "num_agent_steps_trained": 2655840}, "done": false, "episodes_total": 7312, "training_iteration": 1622, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-51-34", "timestamp": 1691239894, "time_this_iter_s": 10.712653875350952, "time_total_s": 20606.561512231827, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1659.7507212162018, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 30.566666666666666, "ram_util_percent": 69.84666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -321.902101304796, "policy_loss": -1555309.3355034722, "vf_loss": 3370092.347222222}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11367.5, "diff_num_grad_updates_vs_sampler_policy": 11366.5}}, "num_env_steps_sampled": 2660640, "num_env_steps_trained": 2660640, "num_agent_steps_sampled": 2660640, "num_agent_steps_trained": 2660640}, "sampler_results": {"episode_reward_max": -3766.528211505233, "episode_reward_min": -4344.160697090055, "episode_reward_mean": -4000.3742876034876, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499, -4036.1711605483465, -3967.0472035295725, -3950.840098797094, -4002.7890918787502, -4127.8069136484555, -4031.8489539723896, -4254.229916304819, -4042.010877940848, -3936.5988775090946, -4061.4349536346094, -4245.946062587273, -4112.590116494385, -4026.6495304377304, -4002.996250833489, -3860.3889669427726, -4048.0982732269777, -4123.779095715762, -3941.464051393479, -4344.160697090055, -4105.641583391937], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3830817933533808, "mean_inference_ms": 0.23541678581372544, "mean_action_processing_ms": 0.057748566373609034, "mean_env_wait_ms": 0.49233274536760163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026311874389648438, "StateBufferConnector_ms": 0.001711130142211914, "ViewRequirementAgentConnector_ms": 0.04439592361450195}}, "episode_reward_max": -3766.528211505233, "episode_reward_min": -4344.160697090055, "episode_reward_mean": -4000.3742876034876, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3916.5521187175673, -3954.1221960297994, -4019.542636227318, -4103.509074243171, -4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499, -4036.1711605483465, -3967.0472035295725, -3950.840098797094, -4002.7890918787502, -4127.8069136484555, -4031.8489539723896, -4254.229916304819, -4042.010877940848, -3936.5988775090946, -4061.4349536346094, -4245.946062587273, -4112.590116494385, -4026.6495304377304, -4002.996250833489, -3860.3889669427726, -4048.0982732269777, -4123.779095715762, -3941.464051393479, -4344.160697090055, -4105.641583391937], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3830817933533808, "mean_inference_ms": 0.23541678581372544, "mean_action_processing_ms": 0.057748566373609034, "mean_env_wait_ms": 0.49233274536760163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026311874389648438, "StateBufferConnector_ms": 0.001711130142211914, "ViewRequirementAgentConnector_ms": 0.04439592361450195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2660640, "num_agent_steps_trained": 2660640, "num_env_steps_sampled": 2660640, "num_env_steps_trained": 2660640, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 450.3929343868198, "num_env_steps_trained_throughput_per_sec": 450.3929343868198, "timesteps_total": 2660640, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2660640, "timers": {"training_iteration_time_ms": 2664.472, "sample_time_ms": 2642.816, "load_time_ms": 0.443, "load_throughput": 2707895.196, "learn_time_ms": 20.576, "learn_throughput": 58319.967, "synch_weights_time_ms": 0.598}, "counters": {"num_env_steps_sampled": 2660640, "num_env_steps_trained": 2660640, "num_agent_steps_sampled": 2660640, "num_agent_steps_trained": 2660640}, "done": false, "episodes_total": 7316, "training_iteration": 1623, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-51-44", "timestamp": 1691239904, "time_this_iter_s": 10.659512042999268, "time_total_s": 20617.221024274826, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1670.410233259201, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 26.826666666666668, "ram_util_percent": 69.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -321.94525146484375, "policy_loss": -1220024.306423611, "vf_loss": 3276005.840277778}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11439.5, "diff_num_grad_updates_vs_sampler_policy": 11438.5}}, "num_env_steps_sampled": 2665440, "num_env_steps_trained": 2665440, "num_agent_steps_sampled": 2665440, "num_agent_steps_trained": 2665440}, "sampler_results": {"episode_reward_max": -3766.528211505233, "episode_reward_min": -4344.160697090055, "episode_reward_mean": -4000.236312817528, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499, -4036.1711605483465, -3967.0472035295725, -3950.840098797094, -4002.7890918787502, -4127.8069136484555, -4031.8489539723896, -4254.229916304819, -4042.010877940848, -3936.5988775090946, -4061.4349536346094, -4245.946062587273, -4112.590116494385, -4026.6495304377304, -4002.996250833489, -3860.3889669427726, -4048.0982732269777, -4123.779095715762, -3941.464051393479, -4344.160697090055, -4105.641583391937, -4078.9073256429865, -3993.1557047435213, -3893.097828397722, -4014.767687837649], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3831191834436105, "mean_inference_ms": 0.23543694116326147, "mean_action_processing_ms": 0.057751979518079165, "mean_env_wait_ms": 0.4923701853478555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026302337646484375, "StateBufferConnector_ms": 0.0017168521881103516, "ViewRequirementAgentConnector_ms": 0.04443478584289551}}, "episode_reward_max": -3766.528211505233, "episode_reward_min": -4344.160697090055, "episode_reward_mean": -4000.236312817528, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4099.9515494418465, -3842.8160223523823, -3963.218382512291, -3962.380404380947, -4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499, -4036.1711605483465, -3967.0472035295725, -3950.840098797094, -4002.7890918787502, -4127.8069136484555, -4031.8489539723896, -4254.229916304819, -4042.010877940848, -3936.5988775090946, -4061.4349536346094, -4245.946062587273, -4112.590116494385, -4026.6495304377304, -4002.996250833489, -3860.3889669427726, -4048.0982732269777, -4123.779095715762, -3941.464051393479, -4344.160697090055, -4105.641583391937, -4078.9073256429865, -3993.1557047435213, -3893.097828397722, -4014.767687837649], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3831191834436105, "mean_inference_ms": 0.23543694116326147, "mean_action_processing_ms": 0.057751979518079165, "mean_env_wait_ms": 0.4923701853478555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026302337646484375, "StateBufferConnector_ms": 0.0017168521881103516, "ViewRequirementAgentConnector_ms": 0.04443478584289551}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2665440, "num_agent_steps_trained": 2665440, "num_env_steps_sampled": 2665440, "num_env_steps_trained": 2665440, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 451.94322376403625, "num_env_steps_trained_throughput_per_sec": 451.94322376403625, "timesteps_total": 2665440, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2665440, "timers": {"training_iteration_time_ms": 2661.45, "sample_time_ms": 2640.065, "load_time_ms": 0.437, "load_throughput": 2747960.69, "learn_time_ms": 20.321, "learn_throughput": 59051.971, "synch_weights_time_ms": 0.59}, "counters": {"num_env_steps_sampled": 2665440, "num_env_steps_trained": 2665440, "num_agent_steps_sampled": 2665440, "num_agent_steps_trained": 2665440}, "done": false, "episodes_total": 7320, "training_iteration": 1624, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-51-55", "timestamp": 1691239915, "time_this_iter_s": 10.622997999191284, "time_total_s": 20627.844022274017, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1681.0332312583923, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 28.5, "ram_util_percent": 69.91875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.0506947835286, "policy_loss": -1147360.69921875, "vf_loss": 3130805.9444444445}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11511.5, "diff_num_grad_updates_vs_sampler_policy": 11510.5}}, "num_env_steps_sampled": 2670240, "num_env_steps_trained": 2670240, "num_agent_steps_sampled": 2670240, "num_agent_steps_trained": 2670240}, "sampler_results": {"episode_reward_max": -3766.528211505233, "episode_reward_min": -4344.160697090055, "episode_reward_mean": -4000.91690936494, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499, -4036.1711605483465, -3967.0472035295725, -3950.840098797094, -4002.7890918787502, -4127.8069136484555, -4031.8489539723896, -4254.229916304819, -4042.010877940848, -3936.5988775090946, -4061.4349536346094, -4245.946062587273, -4112.590116494385, -4026.6495304377304, -4002.996250833489, -3860.3889669427726, -4048.0982732269777, -4123.779095715762, -3941.464051393479, -4344.160697090055, -4105.641583391937, -4078.9073256429865, -3993.1557047435213, -3893.097828397722, -4014.767687837649, -4077.504184896635, -4090.875008154946, -3860.3468880873397, -3907.6999322896654], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3831538180226408, "mean_inference_ms": 0.2354571696588995, "mean_action_processing_ms": 0.05775542979801658, "mean_env_wait_ms": 0.49240989296560445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026330947875976562, "StateBufferConnector_ms": 0.001714468002319336, "ViewRequirementAgentConnector_ms": 0.044442176818847656}}, "episode_reward_max": -3766.528211505233, "episode_reward_min": -4344.160697090055, "episode_reward_mean": -4000.91690936494, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4089.980358823594, -3981.0973129282834, -3868.137334157374, -3856.755872843584, -4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499, -4036.1711605483465, -3967.0472035295725, -3950.840098797094, -4002.7890918787502, -4127.8069136484555, -4031.8489539723896, -4254.229916304819, -4042.010877940848, -3936.5988775090946, -4061.4349536346094, -4245.946062587273, -4112.590116494385, -4026.6495304377304, -4002.996250833489, -3860.3889669427726, -4048.0982732269777, -4123.779095715762, -3941.464051393479, -4344.160697090055, -4105.641583391937, -4078.9073256429865, -3993.1557047435213, -3893.097828397722, -4014.767687837649, -4077.504184896635, -4090.875008154946, -3860.3468880873397, -3907.6999322896654], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3831538180226408, "mean_inference_ms": 0.2354571696588995, "mean_action_processing_ms": 0.05775542979801658, "mean_env_wait_ms": 0.49240989296560445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026330947875976562, "StateBufferConnector_ms": 0.001714468002319336, "ViewRequirementAgentConnector_ms": 0.044442176818847656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2670240, "num_agent_steps_trained": 2670240, "num_env_steps_sampled": 2670240, "num_env_steps_trained": 2670240, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 452.5048465341358, "num_env_steps_trained_throughput_per_sec": 452.5048465341358, "timesteps_total": 2670240, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2670240, "timers": {"training_iteration_time_ms": 2660.564, "sample_time_ms": 2638.861, "load_time_ms": 0.438, "load_throughput": 2738988.246, "learn_time_ms": 20.63, "learn_throughput": 58168.518, "synch_weights_time_ms": 0.596}, "counters": {"num_env_steps_sampled": 2670240, "num_env_steps_trained": 2670240, "num_agent_steps_sampled": 2670240, "num_agent_steps_trained": 2670240}, "done": false, "episodes_total": 7324, "training_iteration": 1625, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-52-06", "timestamp": 1691239926, "time_this_iter_s": 10.609785079956055, "time_total_s": 20638.453807353973, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1691.6430163383484, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 27.473333333333336, "ram_util_percent": 69.85999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.1165652804905, "policy_loss": -1796304.9830729167, "vf_loss": 3531598.888888889}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11583.5, "diff_num_grad_updates_vs_sampler_policy": 11582.5}}, "num_env_steps_sampled": 2675040, "num_env_steps_trained": 2675040, "num_agent_steps_sampled": 2675040, "num_agent_steps_trained": 2675040}, "sampler_results": {"episode_reward_max": -3766.528211505233, "episode_reward_min": -4344.160697090055, "episode_reward_mean": -4003.653107523562, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499, -4036.1711605483465, -3967.0472035295725, -3950.840098797094, -4002.7890918787502, -4127.8069136484555, -4031.8489539723896, -4254.229916304819, -4042.010877940848, -3936.5988775090946, -4061.4349536346094, -4245.946062587273, -4112.590116494385, -4026.6495304377304, -4002.996250833489, -3860.3889669427726, -4048.0982732269777, -4123.779095715762, -3941.464051393479, -4344.160697090055, -4105.641583391937, -4078.9073256429865, -3993.1557047435213, -3893.097828397722, -4014.767687837649, -4077.504184896635, -4090.875008154946, -3860.3468880873397, -3907.6999322896654, -3960.693557374029, -3955.5404256040774, -3929.0451684869927, -4224.311543149952], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3831909683343344, "mean_inference_ms": 0.23547812011394315, "mean_action_processing_ms": 0.05775900682360875, "mean_env_wait_ms": 0.49245029496848863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002635478973388672, "StateBufferConnector_ms": 0.0017161369323730469, "ViewRequirementAgentConnector_ms": 0.04445838928222656}}, "episode_reward_max": -3766.528211505233, "episode_reward_min": -4344.160697090055, "episode_reward_mean": -4003.653107523562, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4138.163935336524, -3847.517800982062, -3872.741940391025, -4017.1791054991663, -3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499, -4036.1711605483465, -3967.0472035295725, -3950.840098797094, -4002.7890918787502, -4127.8069136484555, -4031.8489539723896, -4254.229916304819, -4042.010877940848, -3936.5988775090946, -4061.4349536346094, -4245.946062587273, -4112.590116494385, -4026.6495304377304, -4002.996250833489, -3860.3889669427726, -4048.0982732269777, -4123.779095715762, -3941.464051393479, -4344.160697090055, -4105.641583391937, -4078.9073256429865, -3993.1557047435213, -3893.097828397722, -4014.767687837649, -4077.504184896635, -4090.875008154946, -3860.3468880873397, -3907.6999322896654, -3960.693557374029, -3955.5404256040774, -3929.0451684869927, -4224.311543149952], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3831909683343344, "mean_inference_ms": 0.23547812011394315, "mean_action_processing_ms": 0.05775900682360875, "mean_env_wait_ms": 0.49245029496848863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002635478973388672, "StateBufferConnector_ms": 0.0017161369323730469, "ViewRequirementAgentConnector_ms": 0.04445838928222656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2675040, "num_agent_steps_trained": 2675040, "num_env_steps_sampled": 2675040, "num_env_steps_trained": 2675040, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 449.5015478627785, "num_env_steps_trained_throughput_per_sec": 449.5015478627785, "timesteps_total": 2675040, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2675040, "timers": {"training_iteration_time_ms": 2654.528, "sample_time_ms": 2633.201, "load_time_ms": 0.428, "load_throughput": 2806649.64, "learn_time_ms": 20.281, "learn_throughput": 59168.457, "synch_weights_time_ms": 0.581}, "counters": {"num_env_steps_sampled": 2675040, "num_env_steps_trained": 2675040, "num_agent_steps_sampled": 2675040, "num_agent_steps_trained": 2675040}, "done": false, "episodes_total": 7328, "training_iteration": 1626, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-52-16", "timestamp": 1691239936, "time_this_iter_s": 10.680660963058472, "time_total_s": 20649.134468317032, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1702.3236773014069, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 31.919999999999998, "ram_util_percent": 69.85333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -321.9622582329644, "policy_loss": -1878888.8307291667, "vf_loss": 3357854.6944444445}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11655.5, "diff_num_grad_updates_vs_sampler_policy": 11654.5}}, "num_env_steps_sampled": 2679840, "num_env_steps_trained": 2679840, "num_agent_steps_sampled": 2679840, "num_agent_steps_trained": 2679840}, "sampler_results": {"episode_reward_max": -3766.528211505233, "episode_reward_min": -4344.160697090055, "episode_reward_mean": -4004.4090187804777, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499, -4036.1711605483465, -3967.0472035295725, -3950.840098797094, -4002.7890918787502, -4127.8069136484555, -4031.8489539723896, -4254.229916304819, -4042.010877940848, -3936.5988775090946, -4061.4349536346094, -4245.946062587273, -4112.590116494385, -4026.6495304377304, -4002.996250833489, -3860.3889669427726, -4048.0982732269777, -4123.779095715762, -3941.464051393479, -4344.160697090055, -4105.641583391937, -4078.9073256429865, -3993.1557047435213, -3893.097828397722, -4014.767687837649, -4077.504184896635, -4090.875008154946, -3860.3468880873397, -3907.6999322896654, -3960.693557374029, -3955.5404256040774, -3929.0451684869927, -4224.311543149952, -3895.6249895260025, -3807.03572460847, -4188.651062905881, -4059.8821308600313], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.383222858425164, "mean_inference_ms": 0.23549862398368895, "mean_action_processing_ms": 0.057762493705775596, "mean_env_wait_ms": 0.4924902581956818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002625703811645508, "StateBufferConnector_ms": 0.0017125606536865234, "ViewRequirementAgentConnector_ms": 0.04438304901123047}}, "episode_reward_max": -3766.528211505233, "episode_reward_min": -4344.160697090055, "episode_reward_mean": -4004.4090187804777, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3936.5169174177036, -3962.66634017614, -3875.344015387173, -3896.1844235948693, -4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499, -4036.1711605483465, -3967.0472035295725, -3950.840098797094, -4002.7890918787502, -4127.8069136484555, -4031.8489539723896, -4254.229916304819, -4042.010877940848, -3936.5988775090946, -4061.4349536346094, -4245.946062587273, -4112.590116494385, -4026.6495304377304, -4002.996250833489, -3860.3889669427726, -4048.0982732269777, -4123.779095715762, -3941.464051393479, -4344.160697090055, -4105.641583391937, -4078.9073256429865, -3993.1557047435213, -3893.097828397722, -4014.767687837649, -4077.504184896635, -4090.875008154946, -3860.3468880873397, -3907.6999322896654, -3960.693557374029, -3955.5404256040774, -3929.0451684869927, -4224.311543149952, -3895.6249895260025, -3807.03572460847, -4188.651062905881, -4059.8821308600313], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.383222858425164, "mean_inference_ms": 0.23549862398368895, "mean_action_processing_ms": 0.057762493705775596, "mean_env_wait_ms": 0.4924902581956818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002625703811645508, "StateBufferConnector_ms": 0.0017125606536865234, "ViewRequirementAgentConnector_ms": 0.04438304901123047}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2679840, "num_agent_steps_trained": 2679840, "num_env_steps_sampled": 2679840, "num_env_steps_trained": 2679840, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 451.154534147327, "num_env_steps_trained_throughput_per_sec": 451.154534147327, "timesteps_total": 2679840, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2679840, "timers": {"training_iteration_time_ms": 2662.238, "sample_time_ms": 2640.118, "load_time_ms": 0.44, "load_throughput": 2724753.573, "learn_time_ms": 21.024, "learn_throughput": 57077.527, "synch_weights_time_ms": 0.617}, "counters": {"num_env_steps_sampled": 2679840, "num_env_steps_trained": 2679840, "num_agent_steps_sampled": 2679840, "num_agent_steps_trained": 2679840}, "done": false, "episodes_total": 7332, "training_iteration": 1627, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-52-27", "timestamp": 1691239947, "time_this_iter_s": 10.641633987426758, "time_total_s": 20659.77610230446, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1712.9653112888336, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 27.21333333333333, "ram_util_percent": 69.96000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.2445068359375, "policy_loss": -1531414.48046875, "vf_loss": 3073397.0208333335}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11727.5, "diff_num_grad_updates_vs_sampler_policy": 11726.5}}, "num_env_steps_sampled": 2684640, "num_env_steps_trained": 2684640, "num_agent_steps_sampled": 2684640, "num_agent_steps_trained": 2684640}, "sampler_results": {"episode_reward_max": -3766.528211505233, "episode_reward_min": -4344.160697090055, "episode_reward_mean": -4005.6305553132092, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499, -4036.1711605483465, -3967.0472035295725, -3950.840098797094, -4002.7890918787502, -4127.8069136484555, -4031.8489539723896, -4254.229916304819, -4042.010877940848, -3936.5988775090946, -4061.4349536346094, -4245.946062587273, -4112.590116494385, -4026.6495304377304, -4002.996250833489, -3860.3889669427726, -4048.0982732269777, -4123.779095715762, -3941.464051393479, -4344.160697090055, -4105.641583391937, -4078.9073256429865, -3993.1557047435213, -3893.097828397722, -4014.767687837649, -4077.504184896635, -4090.875008154946, -3860.3468880873397, -3907.6999322896654, -3960.693557374029, -3955.5404256040774, -3929.0451684869927, -4224.311543149952, -3895.6249895260025, -3807.03572460847, -4188.651062905881, -4059.8821308600313, -3982.3396036585013, -3869.6238159991685, -4059.683510316093, -3881.218419875296], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3832589561322117, "mean_inference_ms": 0.23551918378533082, "mean_action_processing_ms": 0.05776596849979356, "mean_env_wait_ms": 0.4925295177874197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002633333206176758, "StateBufferConnector_ms": 0.0017123222351074219, "ViewRequirementAgentConnector_ms": 0.04446673393249512}}, "episode_reward_max": -3766.528211505233, "episode_reward_min": -4344.160697090055, "episode_reward_mean": -4005.6305553132092, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4073.129441459564, -4165.188373348038, -3927.5321907368852, -3864.2269122687194, -3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499, -4036.1711605483465, -3967.0472035295725, -3950.840098797094, -4002.7890918787502, -4127.8069136484555, -4031.8489539723896, -4254.229916304819, -4042.010877940848, -3936.5988775090946, -4061.4349536346094, -4245.946062587273, -4112.590116494385, -4026.6495304377304, -4002.996250833489, -3860.3889669427726, -4048.0982732269777, -4123.779095715762, -3941.464051393479, -4344.160697090055, -4105.641583391937, -4078.9073256429865, -3993.1557047435213, -3893.097828397722, -4014.767687837649, -4077.504184896635, -4090.875008154946, -3860.3468880873397, -3907.6999322896654, -3960.693557374029, -3955.5404256040774, -3929.0451684869927, -4224.311543149952, -3895.6249895260025, -3807.03572460847, -4188.651062905881, -4059.8821308600313, -3982.3396036585013, -3869.6238159991685, -4059.683510316093, -3881.218419875296], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3832589561322117, "mean_inference_ms": 0.23551918378533082, "mean_action_processing_ms": 0.05776596849979356, "mean_env_wait_ms": 0.4925295177874197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002633333206176758, "StateBufferConnector_ms": 0.0017123222351074219, "ViewRequirementAgentConnector_ms": 0.04446673393249512}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2684640, "num_agent_steps_trained": 2684640, "num_env_steps_sampled": 2684640, "num_env_steps_trained": 2684640, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 449.93265645850005, "num_env_steps_trained_throughput_per_sec": 449.93265645850005, "timesteps_total": 2684640, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2684640, "timers": {"training_iteration_time_ms": 2660.077, "sample_time_ms": 2637.963, "load_time_ms": 0.436, "load_throughput": 2749912.473, "learn_time_ms": 21.023, "learn_throughput": 57080.699, "synch_weights_time_ms": 0.616}, "counters": {"num_env_steps_sampled": 2684640, "num_env_steps_trained": 2684640, "num_agent_steps_sampled": 2684640, "num_agent_steps_trained": 2684640}, "done": false, "episodes_total": 7336, "training_iteration": 1628, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-52-38", "timestamp": 1691239958, "time_this_iter_s": 10.670387983322144, "time_total_s": 20670.44649028778, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1723.6356992721558, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 34.626666666666665, "ram_util_percent": 70.00666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.2737799750434, "policy_loss": -1770823.6028645833, "vf_loss": 3040026.840277778}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11799.5, "diff_num_grad_updates_vs_sampler_policy": 11798.5}}, "num_env_steps_sampled": 2689440, "num_env_steps_trained": 2689440, "num_agent_steps_sampled": 2689440, "num_agent_steps_trained": 2689440}, "sampler_results": {"episode_reward_max": -3766.528211505233, "episode_reward_min": -4344.160697090055, "episode_reward_mean": -4005.329171691784, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499, -4036.1711605483465, -3967.0472035295725, -3950.840098797094, -4002.7890918787502, -4127.8069136484555, -4031.8489539723896, -4254.229916304819, -4042.010877940848, -3936.5988775090946, -4061.4349536346094, -4245.946062587273, -4112.590116494385, -4026.6495304377304, -4002.996250833489, -3860.3889669427726, -4048.0982732269777, -4123.779095715762, -3941.464051393479, -4344.160697090055, -4105.641583391937, -4078.9073256429865, -3993.1557047435213, -3893.097828397722, -4014.767687837649, -4077.504184896635, -4090.875008154946, -3860.3468880873397, -3907.6999322896654, -3960.693557374029, -3955.5404256040774, -3929.0451684869927, -4224.311543149952, -3895.6249895260025, -3807.03572460847, -4188.651062905881, -4059.8821308600313, -3982.3396036585013, -3869.6238159991685, -4059.683510316093, -3881.218419875296, -3841.067165988415, -4167.899865802564, -4142.959028095028, -3848.012495784686], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.383292020756796, "mean_inference_ms": 0.23553898790581995, "mean_action_processing_ms": 0.057769289715465265, "mean_env_wait_ms": 0.4925651890222389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026335716247558594, "StateBufferConnector_ms": 0.0017096996307373047, "ViewRequirementAgentConnector_ms": 0.04450845718383789}}, "episode_reward_max": -3766.528211505233, "episode_reward_min": -4344.160697090055, "episode_reward_mean": -4005.329171691784, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3930.2610988427837, -3944.565722093258, -3901.6889299529107, -4128.337968926016, -3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499, -4036.1711605483465, -3967.0472035295725, -3950.840098797094, -4002.7890918787502, -4127.8069136484555, -4031.8489539723896, -4254.229916304819, -4042.010877940848, -3936.5988775090946, -4061.4349536346094, -4245.946062587273, -4112.590116494385, -4026.6495304377304, -4002.996250833489, -3860.3889669427726, -4048.0982732269777, -4123.779095715762, -3941.464051393479, -4344.160697090055, -4105.641583391937, -4078.9073256429865, -3993.1557047435213, -3893.097828397722, -4014.767687837649, -4077.504184896635, -4090.875008154946, -3860.3468880873397, -3907.6999322896654, -3960.693557374029, -3955.5404256040774, -3929.0451684869927, -4224.311543149952, -3895.6249895260025, -3807.03572460847, -4188.651062905881, -4059.8821308600313, -3982.3396036585013, -3869.6238159991685, -4059.683510316093, -3881.218419875296, -3841.067165988415, -4167.899865802564, -4142.959028095028, -3848.012495784686], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.383292020756796, "mean_inference_ms": 0.23553898790581995, "mean_action_processing_ms": 0.057769289715465265, "mean_env_wait_ms": 0.4925651890222389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026335716247558594, "StateBufferConnector_ms": 0.0017096996307373047, "ViewRequirementAgentConnector_ms": 0.04450845718383789}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2689440, "num_agent_steps_trained": 2689440, "num_env_steps_sampled": 2689440, "num_env_steps_trained": 2689440, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 455.27454426547433, "num_env_steps_trained_throughput_per_sec": 455.27454426547433, "timesteps_total": 2689440, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2689440, "timers": {"training_iteration_time_ms": 2662.409, "sample_time_ms": 2640.919, "load_time_ms": 0.43, "load_throughput": 2790002.661, "learn_time_ms": 20.431, "learn_throughput": 58733.265, "synch_weights_time_ms": 0.591}, "counters": {"num_env_steps_sampled": 2689440, "num_env_steps_trained": 2689440, "num_agent_steps_sampled": 2689440, "num_agent_steps_trained": 2689440}, "done": false, "episodes_total": 7340, "training_iteration": 1629, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-52-48", "timestamp": 1691239968, "time_this_iter_s": 10.545300006866455, "time_total_s": 20680.991790294647, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1734.1809992790222, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 26.959999999999997, "ram_util_percent": 70.08666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.2840321858724, "policy_loss": -763781.2534722222, "vf_loss": 3058984.777777778}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11871.5, "diff_num_grad_updates_vs_sampler_policy": 11870.5}}, "num_env_steps_sampled": 2694240, "num_env_steps_trained": 2694240, "num_agent_steps_sampled": 2694240, "num_agent_steps_trained": 2694240}, "sampler_results": {"episode_reward_max": -3766.528211505233, "episode_reward_min": -4344.160697090055, "episode_reward_mean": -4009.8995599498808, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499, -4036.1711605483465, -3967.0472035295725, -3950.840098797094, -4002.7890918787502, -4127.8069136484555, -4031.8489539723896, -4254.229916304819, -4042.010877940848, -3936.5988775090946, -4061.4349536346094, -4245.946062587273, -4112.590116494385, -4026.6495304377304, -4002.996250833489, -3860.3889669427726, -4048.0982732269777, -4123.779095715762, -3941.464051393479, -4344.160697090055, -4105.641583391937, -4078.9073256429865, -3993.1557047435213, -3893.097828397722, -4014.767687837649, -4077.504184896635, -4090.875008154946, -3860.3468880873397, -3907.6999322896654, -3960.693557374029, -3955.5404256040774, -3929.0451684869927, -4224.311543149952, -3895.6249895260025, -3807.03572460847, -4188.651062905881, -4059.8821308600313, -3982.3396036585013, -3869.6238159991685, -4059.683510316093, -3881.218419875296, -3841.067165988415, -4167.899865802564, -4142.959028095028, -3848.012495784686, -4074.8260265514687, -4215.394140334438, -4208.921442525751, -3862.750936212934], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3833263050798426, "mean_inference_ms": 0.23555766002168688, "mean_action_processing_ms": 0.05777236032045467, "mean_env_wait_ms": 0.4926043421644304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002643108367919922, "StateBufferConnector_ms": 0.0017092227935791016, "ViewRequirementAgentConnector_ms": 0.04452919960021973}}, "episode_reward_max": -3766.528211505233, "episode_reward_min": -4344.160697090055, "episode_reward_mean": -4009.8995599498808, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3968.3293496585297, -3985.6691749701004, -3853.7176296910066, -3862.332537289444, -4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499, -4036.1711605483465, -3967.0472035295725, -3950.840098797094, -4002.7890918787502, -4127.8069136484555, -4031.8489539723896, -4254.229916304819, -4042.010877940848, -3936.5988775090946, -4061.4349536346094, -4245.946062587273, -4112.590116494385, -4026.6495304377304, -4002.996250833489, -3860.3889669427726, -4048.0982732269777, -4123.779095715762, -3941.464051393479, -4344.160697090055, -4105.641583391937, -4078.9073256429865, -3993.1557047435213, -3893.097828397722, -4014.767687837649, -4077.504184896635, -4090.875008154946, -3860.3468880873397, -3907.6999322896654, -3960.693557374029, -3955.5404256040774, -3929.0451684869927, -4224.311543149952, -3895.6249895260025, -3807.03572460847, -4188.651062905881, -4059.8821308600313, -3982.3396036585013, -3869.6238159991685, -4059.683510316093, -3881.218419875296, -3841.067165988415, -4167.899865802564, -4142.959028095028, -3848.012495784686, -4074.8260265514687, -4215.394140334438, -4208.921442525751, -3862.750936212934], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3833263050798426, "mean_inference_ms": 0.23555766002168688, "mean_action_processing_ms": 0.05777236032045467, "mean_env_wait_ms": 0.4926043421644304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002643108367919922, "StateBufferConnector_ms": 0.0017092227935791016, "ViewRequirementAgentConnector_ms": 0.04452919960021973}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2694240, "num_agent_steps_trained": 2694240, "num_env_steps_sampled": 2694240, "num_env_steps_trained": 2694240, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 450.5253095878256, "num_env_steps_trained_throughput_per_sec": 450.5253095878256, "timesteps_total": 2694240, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2694240, "timers": {"training_iteration_time_ms": 2645.91, "sample_time_ms": 2624.579, "load_time_ms": 0.428, "load_throughput": 2801338.454, "learn_time_ms": 20.278, "learn_throughput": 59176.179, "synch_weights_time_ms": 0.586}, "counters": {"num_env_steps_sampled": 2694240, "num_env_steps_trained": 2694240, "num_agent_steps_sampled": 2694240, "num_agent_steps_trained": 2694240}, "done": false, "episodes_total": 7344, "training_iteration": 1630, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-52-59", "timestamp": 1691239979, "time_this_iter_s": 10.656431198120117, "time_total_s": 20691.648221492767, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1744.8374304771423, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 28.399999999999995, "ram_util_percent": 70.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.04666307237414, "policy_loss": -3592912.6553819445, "vf_loss": 3686864.954861111}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11943.5, "diff_num_grad_updates_vs_sampler_policy": 11942.5}}, "num_env_steps_sampled": 2699040, "num_env_steps_trained": 2699040, "num_agent_steps_sampled": 2699040, "num_agent_steps_trained": 2699040}, "sampler_results": {"episode_reward_max": -3766.528211505233, "episode_reward_min": -4344.160697090055, "episode_reward_mean": -4019.8565476616313, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499, -4036.1711605483465, -3967.0472035295725, -3950.840098797094, -4002.7890918787502, -4127.8069136484555, -4031.8489539723896, -4254.229916304819, -4042.010877940848, -3936.5988775090946, -4061.4349536346094, -4245.946062587273, -4112.590116494385, -4026.6495304377304, -4002.996250833489, -3860.3889669427726, -4048.0982732269777, -4123.779095715762, -3941.464051393479, -4344.160697090055, -4105.641583391937, -4078.9073256429865, -3993.1557047435213, -3893.097828397722, -4014.767687837649, -4077.504184896635, -4090.875008154946, -3860.3468880873397, -3907.6999322896654, -3960.693557374029, -3955.5404256040774, -3929.0451684869927, -4224.311543149952, -3895.6249895260025, -3807.03572460847, -4188.651062905881, -4059.8821308600313, -3982.3396036585013, -3869.6238159991685, -4059.683510316093, -3881.218419875296, -3841.067165988415, -4167.899865802564, -4142.959028095028, -3848.012495784686, -4074.8260265514687, -4215.394140334438, -4208.921442525751, -3862.750936212934, -4157.463927457912, -4011.2126591063397, -4170.496887649328, -4326.573988570548], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.383360470379815, "mean_inference_ms": 0.235577220833807, "mean_action_processing_ms": 0.057775623869682526, "mean_env_wait_ms": 0.49264788512549346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026416778564453125, "StateBufferConnector_ms": 0.001703023910522461, "ViewRequirementAgentConnector_ms": 0.044464111328125}}, "episode_reward_max": -3766.528211505233, "episode_reward_min": -4344.160697090055, "episode_reward_mean": -4019.8565476616313, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4081.9374735864776, -3869.5115692581016, -3907.8933955341895, -4203.427067902289, -3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499, -4036.1711605483465, -3967.0472035295725, -3950.840098797094, -4002.7890918787502, -4127.8069136484555, -4031.8489539723896, -4254.229916304819, -4042.010877940848, -3936.5988775090946, -4061.4349536346094, -4245.946062587273, -4112.590116494385, -4026.6495304377304, -4002.996250833489, -3860.3889669427726, -4048.0982732269777, -4123.779095715762, -3941.464051393479, -4344.160697090055, -4105.641583391937, -4078.9073256429865, -3993.1557047435213, -3893.097828397722, -4014.767687837649, -4077.504184896635, -4090.875008154946, -3860.3468880873397, -3907.6999322896654, -3960.693557374029, -3955.5404256040774, -3929.0451684869927, -4224.311543149952, -3895.6249895260025, -3807.03572460847, -4188.651062905881, -4059.8821308600313, -3982.3396036585013, -3869.6238159991685, -4059.683510316093, -3881.218419875296, -3841.067165988415, -4167.899865802564, -4142.959028095028, -3848.012495784686, -4074.8260265514687, -4215.394140334438, -4208.921442525751, -3862.750936212934, -4157.463927457912, -4011.2126591063397, -4170.496887649328, -4326.573988570548], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.383360470379815, "mean_inference_ms": 0.235577220833807, "mean_action_processing_ms": 0.057775623869682526, "mean_env_wait_ms": 0.49264788512549346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026416778564453125, "StateBufferConnector_ms": 0.001703023910522461, "ViewRequirementAgentConnector_ms": 0.044464111328125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2699040, "num_agent_steps_trained": 2699040, "num_env_steps_sampled": 2699040, "num_env_steps_trained": 2699040, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 450.1322013232407, "num_env_steps_trained_throughput_per_sec": 450.1322013232407, "timesteps_total": 2699040, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2699040, "timers": {"training_iteration_time_ms": 2664.234, "sample_time_ms": 2642.514, "load_time_ms": 0.439, "load_throughput": 2733632.848, "learn_time_ms": 20.659, "learn_throughput": 58087.356, "synch_weights_time_ms": 0.584}, "counters": {"num_env_steps_sampled": 2699040, "num_env_steps_trained": 2699040, "num_agent_steps_sampled": 2699040, "num_agent_steps_trained": 2699040}, "done": false, "episodes_total": 7348, "training_iteration": 1631, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-53-10", "timestamp": 1691239990, "time_this_iter_s": 10.66573715209961, "time_total_s": 20702.313958644867, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1755.503167629242, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 27.54, "ram_util_percent": 70.02666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.10449557834204, "policy_loss": -809085.4930555555, "vf_loss": 3076036.590277778}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12015.5, "diff_num_grad_updates_vs_sampler_policy": 12014.5}}, "num_env_steps_sampled": 2703840, "num_env_steps_trained": 2703840, "num_agent_steps_sampled": 2703840, "num_agent_steps_trained": 2703840}, "sampler_results": {"episode_reward_max": -3766.528211505233, "episode_reward_min": -4344.160697090055, "episode_reward_mean": -4018.76445795403, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499, -4036.1711605483465, -3967.0472035295725, -3950.840098797094, -4002.7890918787502, -4127.8069136484555, -4031.8489539723896, -4254.229916304819, -4042.010877940848, -3936.5988775090946, -4061.4349536346094, -4245.946062587273, -4112.590116494385, -4026.6495304377304, -4002.996250833489, -3860.3889669427726, -4048.0982732269777, -4123.779095715762, -3941.464051393479, -4344.160697090055, -4105.641583391937, -4078.9073256429865, -3993.1557047435213, -3893.097828397722, -4014.767687837649, -4077.504184896635, -4090.875008154946, -3860.3468880873397, -3907.6999322896654, -3960.693557374029, -3955.5404256040774, -3929.0451684869927, -4224.311543149952, -3895.6249895260025, -3807.03572460847, -4188.651062905881, -4059.8821308600313, -3982.3396036585013, -3869.6238159991685, -4059.683510316093, -3881.218419875296, -3841.067165988415, -4167.899865802564, -4142.959028095028, -3848.012495784686, -4074.8260265514687, -4215.394140334438, -4208.921442525751, -3862.750936212934, -4157.463927457912, -4011.2126591063397, -4170.496887649328, -4326.573988570548, -4209.213331537751, -3859.1357285581325, -4012.188407237636, -3873.02306818754], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3833954037362692, "mean_inference_ms": 0.23559670632532168, "mean_action_processing_ms": 0.057778836199191136, "mean_env_wait_ms": 0.4926928432505078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026390552520751953, "StateBufferConnector_ms": 0.0017042160034179688, "ViewRequirementAgentConnector_ms": 0.04445672035217285}}, "episode_reward_max": -3766.528211505233, "episode_reward_min": -4344.160697090055, "episode_reward_mean": -4018.76445795403, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3828.074011018704, -3819.3106536572154, -4040.9756597976757, -3915.1461604336187, -4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499, -4036.1711605483465, -3967.0472035295725, -3950.840098797094, -4002.7890918787502, -4127.8069136484555, -4031.8489539723896, -4254.229916304819, -4042.010877940848, -3936.5988775090946, -4061.4349536346094, -4245.946062587273, -4112.590116494385, -4026.6495304377304, -4002.996250833489, -3860.3889669427726, -4048.0982732269777, -4123.779095715762, -3941.464051393479, -4344.160697090055, -4105.641583391937, -4078.9073256429865, -3993.1557047435213, -3893.097828397722, -4014.767687837649, -4077.504184896635, -4090.875008154946, -3860.3468880873397, -3907.6999322896654, -3960.693557374029, -3955.5404256040774, -3929.0451684869927, -4224.311543149952, -3895.6249895260025, -3807.03572460847, -4188.651062905881, -4059.8821308600313, -3982.3396036585013, -3869.6238159991685, -4059.683510316093, -3881.218419875296, -3841.067165988415, -4167.899865802564, -4142.959028095028, -3848.012495784686, -4074.8260265514687, -4215.394140334438, -4208.921442525751, -3862.750936212934, -4157.463927457912, -4011.2126591063397, -4170.496887649328, -4326.573988570548, -4209.213331537751, -3859.1357285581325, -4012.188407237636, -3873.02306818754], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3833954037362692, "mean_inference_ms": 0.23559670632532168, "mean_action_processing_ms": 0.057778836199191136, "mean_env_wait_ms": 0.4926928432505078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026390552520751953, "StateBufferConnector_ms": 0.0017042160034179688, "ViewRequirementAgentConnector_ms": 0.04445672035217285}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2703840, "num_agent_steps_trained": 2703840, "num_env_steps_sampled": 2703840, "num_env_steps_trained": 2703840, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 450.2988656852701, "num_env_steps_trained_throughput_per_sec": 450.2988656852701, "timesteps_total": 2703840, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2703840, "timers": {"training_iteration_time_ms": 2665.435, "sample_time_ms": 2643.34, "load_time_ms": 0.448, "load_throughput": 2676361.161, "learn_time_ms": 20.997, "learn_throughput": 57151.866, "synch_weights_time_ms": 0.612}, "counters": {"num_env_steps_sampled": 2703840, "num_env_steps_trained": 2703840, "num_agent_steps_sampled": 2703840, "num_agent_steps_trained": 2703840}, "done": false, "episodes_total": 7352, "training_iteration": 1632, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-53-20", "timestamp": 1691240000, "time_this_iter_s": 10.661910772323608, "time_total_s": 20712.97586941719, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1766.1650784015656, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 29.139999999999997, "ram_util_percent": 69.90666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.55525377061633, "policy_loss": -1909955.5390625, "vf_loss": 3077528.784722222}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12087.5, "diff_num_grad_updates_vs_sampler_policy": 12086.5}}, "num_env_steps_sampled": 2708640, "num_env_steps_trained": 2708640, "num_agent_steps_sampled": 2708640, "num_agent_steps_trained": 2708640}, "sampler_results": {"episode_reward_max": -3766.528211505233, "episode_reward_min": -4344.160697090055, "episode_reward_mean": -4019.091012941432, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499, -4036.1711605483465, -3967.0472035295725, -3950.840098797094, -4002.7890918787502, -4127.8069136484555, -4031.8489539723896, -4254.229916304819, -4042.010877940848, -3936.5988775090946, -4061.4349536346094, -4245.946062587273, -4112.590116494385, -4026.6495304377304, -4002.996250833489, -3860.3889669427726, -4048.0982732269777, -4123.779095715762, -3941.464051393479, -4344.160697090055, -4105.641583391937, -4078.9073256429865, -3993.1557047435213, -3893.097828397722, -4014.767687837649, -4077.504184896635, -4090.875008154946, -3860.3468880873397, -3907.6999322896654, -3960.693557374029, -3955.5404256040774, -3929.0451684869927, -4224.311543149952, -3895.6249895260025, -3807.03572460847, -4188.651062905881, -4059.8821308600313, -3982.3396036585013, -3869.6238159991685, -4059.683510316093, -3881.218419875296, -3841.067165988415, -4167.899865802564, -4142.959028095028, -3848.012495784686, -4074.8260265514687, -4215.394140334438, -4208.921442525751, -3862.750936212934, -4157.463927457912, -4011.2126591063397, -4170.496887649328, -4326.573988570548, -4209.213331537751, -3859.1357285581325, -4012.188407237636, -3873.02306818754, -3917.9148758445085, -4042.9165297282275, -3813.2699869522075, -3862.0605911224366], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.383427290832532, "mean_inference_ms": 0.2356186484810911, "mean_action_processing_ms": 0.05778197013800721, "mean_env_wait_ms": 0.49273575528547214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002635955810546875, "StateBufferConnector_ms": 0.001699686050415039, "ViewRequirementAgentConnector_ms": 0.044442176818847656}}, "episode_reward_max": -3766.528211505233, "episode_reward_min": -4344.160697090055, "episode_reward_mean": -4019.091012941432, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4037.0986352749405, -3819.6290856044297, -3858.0886424386663, -3955.7458080953347, -3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499, -4036.1711605483465, -3967.0472035295725, -3950.840098797094, -4002.7890918787502, -4127.8069136484555, -4031.8489539723896, -4254.229916304819, -4042.010877940848, -3936.5988775090946, -4061.4349536346094, -4245.946062587273, -4112.590116494385, -4026.6495304377304, -4002.996250833489, -3860.3889669427726, -4048.0982732269777, -4123.779095715762, -3941.464051393479, -4344.160697090055, -4105.641583391937, -4078.9073256429865, -3993.1557047435213, -3893.097828397722, -4014.767687837649, -4077.504184896635, -4090.875008154946, -3860.3468880873397, -3907.6999322896654, -3960.693557374029, -3955.5404256040774, -3929.0451684869927, -4224.311543149952, -3895.6249895260025, -3807.03572460847, -4188.651062905881, -4059.8821308600313, -3982.3396036585013, -3869.6238159991685, -4059.683510316093, -3881.218419875296, -3841.067165988415, -4167.899865802564, -4142.959028095028, -3848.012495784686, -4074.8260265514687, -4215.394140334438, -4208.921442525751, -3862.750936212934, -4157.463927457912, -4011.2126591063397, -4170.496887649328, -4326.573988570548, -4209.213331537751, -3859.1357285581325, -4012.188407237636, -3873.02306818754, -3917.9148758445085, -4042.9165297282275, -3813.2699869522075, -3862.0605911224366], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.383427290832532, "mean_inference_ms": 0.2356186484810911, "mean_action_processing_ms": 0.05778197013800721, "mean_env_wait_ms": 0.49273575528547214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002635955810546875, "StateBufferConnector_ms": 0.001699686050415039, "ViewRequirementAgentConnector_ms": 0.044442176818847656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2708640, "num_agent_steps_trained": 2708640, "num_env_steps_sampled": 2708640, "num_env_steps_trained": 2708640, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 453.24495721273115, "num_env_steps_trained_throughput_per_sec": 453.24495721273115, "timesteps_total": 2708640, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2708640, "timers": {"training_iteration_time_ms": 2657.851, "sample_time_ms": 2636.187, "load_time_ms": 0.446, "load_throughput": 2689518.435, "learn_time_ms": 20.573, "learn_throughput": 58328.753, "synch_weights_time_ms": 0.607}, "counters": {"num_env_steps_sampled": 2708640, "num_env_steps_trained": 2708640, "num_agent_steps_sampled": 2708640, "num_agent_steps_trained": 2708640}, "done": false, "episodes_total": 7356, "training_iteration": 1633, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-53-31", "timestamp": 1691240011, "time_this_iter_s": 10.5924232006073, "time_total_s": 20723.568292617798, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1776.7575016021729, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 27.513333333333332, "ram_util_percent": 69.74}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.07540215386285, "policy_loss": -2721116.783420139, "vf_loss": 3402483.0416666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12159.5, "diff_num_grad_updates_vs_sampler_policy": 12158.5}}, "num_env_steps_sampled": 2713440, "num_env_steps_trained": 2713440, "num_agent_steps_sampled": 2713440, "num_agent_steps_trained": 2713440}, "sampler_results": {"episode_reward_max": -3766.528211505233, "episode_reward_min": -4344.160697090055, "episode_reward_mean": -4022.460614425502, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499, -4036.1711605483465, -3967.0472035295725, -3950.840098797094, -4002.7890918787502, -4127.8069136484555, -4031.8489539723896, -4254.229916304819, -4042.010877940848, -3936.5988775090946, -4061.4349536346094, -4245.946062587273, -4112.590116494385, -4026.6495304377304, -4002.996250833489, -3860.3889669427726, -4048.0982732269777, -4123.779095715762, -3941.464051393479, -4344.160697090055, -4105.641583391937, -4078.9073256429865, -3993.1557047435213, -3893.097828397722, -4014.767687837649, -4077.504184896635, -4090.875008154946, -3860.3468880873397, -3907.6999322896654, -3960.693557374029, -3955.5404256040774, -3929.0451684869927, -4224.311543149952, -3895.6249895260025, -3807.03572460847, -4188.651062905881, -4059.8821308600313, -3982.3396036585013, -3869.6238159991685, -4059.683510316093, -3881.218419875296, -3841.067165988415, -4167.899865802564, -4142.959028095028, -3848.012495784686, -4074.8260265514687, -4215.394140334438, -4208.921442525751, -3862.750936212934, -4157.463927457912, -4011.2126591063397, -4170.496887649328, -4326.573988570548, -4209.213331537751, -3859.1357285581325, -4012.188407237636, -3873.02306818754, -3917.9148758445085, -4042.9165297282275, -3813.2699869522075, -3862.0605911224366, -3964.953644274485, -3884.304867092827, -4085.303962287181, -4072.9598461657674], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3834617140940033, "mean_inference_ms": 0.2356399230950242, "mean_action_processing_ms": 0.057784989007303104, "mean_env_wait_ms": 0.4927805385223709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026390552520751953, "StateBufferConnector_ms": 0.0017004013061523438, "ViewRequirementAgentConnector_ms": 0.044469356536865234}}, "episode_reward_max": -3766.528211505233, "episode_reward_min": -4344.160697090055, "episode_reward_mean": -4022.460614425502, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3870.965596265545, -4049.226518991597, -4040.1144922245144, -3766.528211505233, -4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499, -4036.1711605483465, -3967.0472035295725, -3950.840098797094, -4002.7890918787502, -4127.8069136484555, -4031.8489539723896, -4254.229916304819, -4042.010877940848, -3936.5988775090946, -4061.4349536346094, -4245.946062587273, -4112.590116494385, -4026.6495304377304, -4002.996250833489, -3860.3889669427726, -4048.0982732269777, -4123.779095715762, -3941.464051393479, -4344.160697090055, -4105.641583391937, -4078.9073256429865, -3993.1557047435213, -3893.097828397722, -4014.767687837649, -4077.504184896635, -4090.875008154946, -3860.3468880873397, -3907.6999322896654, -3960.693557374029, -3955.5404256040774, -3929.0451684869927, -4224.311543149952, -3895.6249895260025, -3807.03572460847, -4188.651062905881, -4059.8821308600313, -3982.3396036585013, -3869.6238159991685, -4059.683510316093, -3881.218419875296, -3841.067165988415, -4167.899865802564, -4142.959028095028, -3848.012495784686, -4074.8260265514687, -4215.394140334438, -4208.921442525751, -3862.750936212934, -4157.463927457912, -4011.2126591063397, -4170.496887649328, -4326.573988570548, -4209.213331537751, -3859.1357285581325, -4012.188407237636, -3873.02306818754, -3917.9148758445085, -4042.9165297282275, -3813.2699869522075, -3862.0605911224366, -3964.953644274485, -3884.304867092827, -4085.303962287181, -4072.9598461657674], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3834617140940033, "mean_inference_ms": 0.2356399230950242, "mean_action_processing_ms": 0.057784989007303104, "mean_env_wait_ms": 0.4927805385223709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026390552520751953, "StateBufferConnector_ms": 0.0017004013061523438, "ViewRequirementAgentConnector_ms": 0.044469356536865234}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2713440, "num_agent_steps_trained": 2713440, "num_env_steps_sampled": 2713440, "num_env_steps_trained": 2713440, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 450.30562386289364, "num_env_steps_trained_throughput_per_sec": 450.30562386289364, "timesteps_total": 2713440, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2713440, "timers": {"training_iteration_time_ms": 2652.381, "sample_time_ms": 2631.162, "load_time_ms": 0.434, "load_throughput": 2765931.088, "learn_time_ms": 20.173, "learn_throughput": 59484.463, "synch_weights_time_ms": 0.574}, "counters": {"num_env_steps_sampled": 2713440, "num_env_steps_trained": 2713440, "num_agent_steps_sampled": 2713440, "num_agent_steps_trained": 2713440}, "done": false, "episodes_total": 7360, "training_iteration": 1634, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-53-42", "timestamp": 1691240022, "time_this_iter_s": 10.661731719970703, "time_total_s": 20734.23002433777, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1787.4192333221436, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 28.42000000000001, "ram_util_percent": 69.33999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -321.85009765625, "policy_loss": -2359891.8372395835, "vf_loss": 3433065.7569444445}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12231.5, "diff_num_grad_updates_vs_sampler_policy": 12230.5}}, "num_env_steps_sampled": 2718240, "num_env_steps_trained": 2718240, "num_agent_steps_sampled": 2718240, "num_agent_steps_trained": 2718240}, "sampler_results": {"episode_reward_max": -3807.03572460847, "episode_reward_min": -4344.160697090055, "episode_reward_mean": -4026.213801088024, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499, -4036.1711605483465, -3967.0472035295725, -3950.840098797094, -4002.7890918787502, -4127.8069136484555, -4031.8489539723896, -4254.229916304819, -4042.010877940848, -3936.5988775090946, -4061.4349536346094, -4245.946062587273, -4112.590116494385, -4026.6495304377304, -4002.996250833489, -3860.3889669427726, -4048.0982732269777, -4123.779095715762, -3941.464051393479, -4344.160697090055, -4105.641583391937, -4078.9073256429865, -3993.1557047435213, -3893.097828397722, -4014.767687837649, -4077.504184896635, -4090.875008154946, -3860.3468880873397, -3907.6999322896654, -3960.693557374029, -3955.5404256040774, -3929.0451684869927, -4224.311543149952, -3895.6249895260025, -3807.03572460847, -4188.651062905881, -4059.8821308600313, -3982.3396036585013, -3869.6238159991685, -4059.683510316093, -3881.218419875296, -3841.067165988415, -4167.899865802564, -4142.959028095028, -3848.012495784686, -4074.8260265514687, -4215.394140334438, -4208.921442525751, -3862.750936212934, -4157.463927457912, -4011.2126591063397, -4170.496887649328, -4326.573988570548, -4209.213331537751, -3859.1357285581325, -4012.188407237636, -3873.02306818754, -3917.9148758445085, -4042.9165297282275, -3813.2699869522075, -3862.0605911224366, -3964.953644274485, -3884.304867092827, -4085.303962287181, -4072.9598461657674, -4020.6754533794174, -3905.408701054634, -4094.680923610875, -4081.3884071942425], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3834932057046354, "mean_inference_ms": 0.23566046808932348, "mean_action_processing_ms": 0.05778792848672614, "mean_env_wait_ms": 0.49282452657548587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026369094848632812, "StateBufferConnector_ms": 0.0017023086547851562, "ViewRequirementAgentConnector_ms": 0.044364213943481445}}, "episode_reward_max": -3807.03572460847, "episode_reward_min": -4344.160697090055, "episode_reward_mean": -4026.213801088024, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4081.3615134392257, -4224.0344444712755, -3985.206149114224, -3938.9035500105383, -4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499, -4036.1711605483465, -3967.0472035295725, -3950.840098797094, -4002.7890918787502, -4127.8069136484555, -4031.8489539723896, -4254.229916304819, -4042.010877940848, -3936.5988775090946, -4061.4349536346094, -4245.946062587273, -4112.590116494385, -4026.6495304377304, -4002.996250833489, -3860.3889669427726, -4048.0982732269777, -4123.779095715762, -3941.464051393479, -4344.160697090055, -4105.641583391937, -4078.9073256429865, -3993.1557047435213, -3893.097828397722, -4014.767687837649, -4077.504184896635, -4090.875008154946, -3860.3468880873397, -3907.6999322896654, -3960.693557374029, -3955.5404256040774, -3929.0451684869927, -4224.311543149952, -3895.6249895260025, -3807.03572460847, -4188.651062905881, -4059.8821308600313, -3982.3396036585013, -3869.6238159991685, -4059.683510316093, -3881.218419875296, -3841.067165988415, -4167.899865802564, -4142.959028095028, -3848.012495784686, -4074.8260265514687, -4215.394140334438, -4208.921442525751, -3862.750936212934, -4157.463927457912, -4011.2126591063397, -4170.496887649328, -4326.573988570548, -4209.213331537751, -3859.1357285581325, -4012.188407237636, -3873.02306818754, -3917.9148758445085, -4042.9165297282275, -3813.2699869522075, -3862.0605911224366, -3964.953644274485, -3884.304867092827, -4085.303962287181, -4072.9598461657674, -4020.6754533794174, -3905.408701054634, -4094.680923610875, -4081.3884071942425], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3834932057046354, "mean_inference_ms": 0.23566046808932348, "mean_action_processing_ms": 0.05778792848672614, "mean_env_wait_ms": 0.49282452657548587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026369094848632812, "StateBufferConnector_ms": 0.0017023086547851562, "ViewRequirementAgentConnector_ms": 0.044364213943481445}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2718240, "num_agent_steps_trained": 2718240, "num_env_steps_sampled": 2718240, "num_env_steps_trained": 2718240, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 453.23871253172786, "num_env_steps_trained_throughput_per_sec": 453.23871253172786, "timesteps_total": 2718240, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2718240, "timers": {"training_iteration_time_ms": 2655.32, "sample_time_ms": 2634.2, "load_time_ms": 0.439, "load_throughput": 2732445.603, "learn_time_ms": 20.063, "learn_throughput": 59811.04, "synch_weights_time_ms": 0.58}, "counters": {"num_env_steps_sampled": 2718240, "num_env_steps_trained": 2718240, "num_agent_steps_sampled": 2718240, "num_agent_steps_trained": 2718240}, "done": false, "episodes_total": 7364, "training_iteration": 1635, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-53-52", "timestamp": 1691240032, "time_this_iter_s": 10.59261417388916, "time_total_s": 20744.822638511658, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1798.0118474960327, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 24.173333333333332, "ram_util_percent": 68.93333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-12, "entropy_coeff": 0.10000000000000002, "policy_entropy": -322.0280575222439, "policy_loss": -1875805.6202256945, "vf_loss": 3310818.4791666665}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12303.5, "diff_num_grad_updates_vs_sampler_policy": 12302.5}}, "num_env_steps_sampled": 2723040, "num_env_steps_trained": 2723040, "num_agent_steps_sampled": 2723040, "num_agent_steps_trained": 2723040}, "sampler_results": {"episode_reward_max": -3807.03572460847, "episode_reward_min": -4344.160697090055, "episode_reward_mean": -4026.373508371324, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499, -4036.1711605483465, -3967.0472035295725, -3950.840098797094, -4002.7890918787502, -4127.8069136484555, -4031.8489539723896, -4254.229916304819, -4042.010877940848, -3936.5988775090946, -4061.4349536346094, -4245.946062587273, -4112.590116494385, -4026.6495304377304, -4002.996250833489, -3860.3889669427726, -4048.0982732269777, -4123.779095715762, -3941.464051393479, -4344.160697090055, -4105.641583391937, -4078.9073256429865, -3993.1557047435213, -3893.097828397722, -4014.767687837649, -4077.504184896635, -4090.875008154946, -3860.3468880873397, -3907.6999322896654, -3960.693557374029, -3955.5404256040774, -3929.0451684869927, -4224.311543149952, -3895.6249895260025, -3807.03572460847, -4188.651062905881, -4059.8821308600313, -3982.3396036585013, -3869.6238159991685, -4059.683510316093, -3881.218419875296, -3841.067165988415, -4167.899865802564, -4142.959028095028, -3848.012495784686, -4074.8260265514687, -4215.394140334438, -4208.921442525751, -3862.750936212934, -4157.463927457912, -4011.2126591063397, -4170.496887649328, -4326.573988570548, -4209.213331537751, -3859.1357285581325, -4012.188407237636, -3873.02306818754, -3917.9148758445085, -4042.9165297282275, -3813.2699869522075, -3862.0605911224366, -3964.953644274485, -3884.304867092827, -4085.303962287181, -4072.9598461657674, -4020.6754533794174, -3905.408701054634, -4094.680923610875, -4081.3884071942425, -4062.8340851930266, -4210.857254260067, -3944.7745708660473, -4027.0104750461305], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3835203758371222, "mean_inference_ms": 0.2356796223199955, "mean_action_processing_ms": 0.05779057626741364, "mean_env_wait_ms": 0.4928659873881931, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026388168334960938, "StateBufferConnector_ms": 0.0017044544219970703, "ViewRequirementAgentConnector_ms": 0.044393062591552734}}, "episode_reward_max": -3807.03572460847, "episode_reward_min": -4344.160697090055, "episode_reward_mean": -4026.373508371324, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4056.141726766158, -4001.768875872266, -4268.845760115401, -3935.1156129943834, -4146.7263031340135, -4188.369582257584, -4222.843866008766, -4179.239056016181, -3920.233377589048, -3937.326462155345, -3894.962446529709, -3902.4134389785286, -4091.1258641539325, -3855.1734791296863, -3924.4449905378597, -4114.339299157293, -4160.436431127516, -3927.3835314131684, -4112.37169996975, -3897.351204603473, -4001.421475166715, -3949.186814950545, -4008.817336732571, -4043.5264713344136, -3940.184353986518, -3900.7181549703196, -4020.943927130439, -4110.988832385499, -4036.1711605483465, -3967.0472035295725, -3950.840098797094, -4002.7890918787502, -4127.8069136484555, -4031.8489539723896, -4254.229916304819, -4042.010877940848, -3936.5988775090946, -4061.4349536346094, -4245.946062587273, -4112.590116494385, -4026.6495304377304, -4002.996250833489, -3860.3889669427726, -4048.0982732269777, -4123.779095715762, -3941.464051393479, -4344.160697090055, -4105.641583391937, -4078.9073256429865, -3993.1557047435213, -3893.097828397722, -4014.767687837649, -4077.504184896635, -4090.875008154946, -3860.3468880873397, -3907.6999322896654, -3960.693557374029, -3955.5404256040774, -3929.0451684869927, -4224.311543149952, -3895.6249895260025, -3807.03572460847, -4188.651062905881, -4059.8821308600313, -3982.3396036585013, -3869.6238159991685, -4059.683510316093, -3881.218419875296, -3841.067165988415, -4167.899865802564, -4142.959028095028, -3848.012495784686, -4074.8260265514687, -4215.394140334438, -4208.921442525751, -3862.750936212934, -4157.463927457912, -4011.2126591063397, -4170.496887649328, -4326.573988570548, -4209.213331537751, -3859.1357285581325, -4012.188407237636, -3873.02306818754, -3917.9148758445085, -4042.9165297282275, -3813.2699869522075, -3862.0605911224366, -3964.953644274485, -3884.304867092827, -4085.303962287181, -4072.9598461657674, -4020.6754533794174, -3905.408701054634, -4094.680923610875, -4081.3884071942425, -4062.8340851930266, -4210.857254260067, -3944.7745708660473, -4027.0104750461305], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3835203758371222, "mean_inference_ms": 0.2356796223199955, "mean_action_processing_ms": 0.05779057626741364, "mean_env_wait_ms": 0.4928659873881931, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026388168334960938, "StateBufferConnector_ms": 0.0017044544219970703, "ViewRequirementAgentConnector_ms": 0.044393062591552734}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2723040, "num_agent_steps_trained": 2723040, "num_env_steps_sampled": 2723040, "num_env_steps_trained": 2723040, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 457.9471415009652, "num_env_steps_trained_throughput_per_sec": 457.9471415009652, "timesteps_total": 2723040, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 2723040, "timers": {"training_iteration_time_ms": 2634.871, "sample_time_ms": 2613.728, "load_time_ms": 0.432, "load_throughput": 2779372.025, "learn_time_ms": 20.102, "learn_throughput": 59695.481, "synch_weights_time_ms": 0.573}, "counters": {"num_env_steps_sampled": 2723040, "num_env_steps_trained": 2723040, "num_agent_steps_sampled": 2723040, "num_agent_steps_trained": 2723040}, "done": false, "episodes_total": 7368, "training_iteration": 1636, "trial_id": "ed8ea_00000", "date": "2023-08-05_15-54-03", "timestamp": 1691240043, "time_this_iter_s": 10.483577251434326, "time_total_s": 20755.306215763092, "pid": 63782, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1907040, 1e-08], [1925040, 8e-09], [1943040, 2.5e-09], [1961040, 2.5e-09], [1979040, 2.5e-09], [1997040, 2.5e-09], [2015040, 1e-09], [2033040, 1e-09], [2051040, 1e-09], [2069040, 5e-10], [2087040, 5e-10], [2105040, 5e-10], [2123040, 5e-10], [2141040, 1e-10], [2159040, 1e-10], [2177040, 1e-10], [2195040, 1e-10], [2213040, 5e-11], [2231040, 5e-11], [2249040, 2.5e-11], [2267040, 2.5e-11], [2285040, 1e-11], [2303040, 1e-11], [2321040, 5e-12], [2339040, 5e-12], [2357040, 1e-12]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 1910940}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16c8b0b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1808.495424747467, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 27.58666666666667, "ram_util_percent": 69.03333333333333}}
