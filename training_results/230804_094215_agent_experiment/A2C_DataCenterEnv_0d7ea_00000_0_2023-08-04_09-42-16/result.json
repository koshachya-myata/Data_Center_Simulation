{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -324.79722290039064, "policy_loss": -3218552.5375, "vf_loss": 20760896.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}}, "num_env_steps_sampled": 121080, "num_env_steps_trained": 121080, "num_agent_steps_sampled": 121080, "num_agent_steps_trained": 121080}, "sampler_results": {"episode_reward_max": -3527.1732859128188, "episode_reward_min": -3530.0036985621336, "episode_reward_mean": -3528.323776017935, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852], "episode_lengths": [360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.26992173066964, "mean_inference_ms": 0.3736100739400548, "mean_action_processing_ms": 0.0920624340385557, "mean_env_wait_ms": 3.445847182225343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032901763916015625, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.0669399897257487}}, "episode_reward_max": -3527.1732859128188, "episode_reward_min": -3530.0036985621336, "episode_reward_mean": -3528.323776017935, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852], "episode_lengths": [360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.26992173066964, "mean_inference_ms": 0.3736100739400548, "mean_action_processing_ms": 0.0920624340385557, "mean_env_wait_ms": 3.445847182225343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032901763916015625, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.0669399897257487}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 121080, "num_agent_steps_trained": 121080, "num_env_steps_sampled": 121080, "num_env_steps_trained": 121080, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 88.72090258463416, "num_env_steps_trained_throughput_per_sec": 88.72090258463416, "timesteps_total": 121080, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 121080, "timers": {"training_iteration_time_ms": 4057.652, "sample_time_ms": 4039.774, "load_time_ms": 0.445, "load_throughput": 809624.365, "learn_time_ms": 16.575, "learn_throughput": 21719.745, "synch_weights_time_ms": 0.801}, "counters": {"num_env_steps_sampled": 121080, "num_env_steps_trained": 121080, "num_agent_steps_sampled": 121080, "num_agent_steps_trained": 121080}, "done": false, "episodes_total": 817, "training_iteration": 161, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-42-35", "timestamp": 1691131355, "time_this_iter_s": 12.176079988479614, "time_total_s": 1742.0068068504333, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12.176079988479614, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 25.783333333333335, "ram_util_percent": 63.87777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.966666666666667e-05, "entropy_coeff": 0.05, "policy_entropy": -331.82929077148435, "policy_loss": -5460057.32109375, "vf_loss": 25660230.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 32.0}}, "num_env_steps_sampled": 122520, "num_env_steps_trained": 122520, "num_agent_steps_sampled": 122520, "num_agent_steps_trained": 122520}, "sampler_results": {"episode_reward_max": -3523.3831370621847, "episode_reward_min": -3849.885417885919, "episode_reward_mean": -3573.572088077763, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919], "episode_lengths": [360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.329557369224036, "mean_inference_ms": 0.3729031385911713, "mean_action_processing_ms": 0.09192546621207211, "mean_env_wait_ms": 2.6055466708919828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035490308489118305, "StateBufferConnector_ms": 0.0026396342686244418, "ViewRequirementAgentConnector_ms": 0.06585121154785156}}, "episode_reward_max": -3523.3831370621847, "episode_reward_min": -3849.885417885919, "episode_reward_mean": -3573.572088077763, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919], "episode_lengths": [360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.329557369224036, "mean_inference_ms": 0.3729031385911713, "mean_action_processing_ms": 0.09192546621207211, "mean_env_wait_ms": 2.6055466708919828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035490308489118305, "StateBufferConnector_ms": 0.0026396342686244418, "ViewRequirementAgentConnector_ms": 0.06585121154785156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 122520, "num_agent_steps_trained": 122520, "num_env_steps_sampled": 122520, "num_env_steps_trained": 122520, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 113.11535474369056, "num_env_steps_trained_throughput_per_sec": 113.11535474369056, "timesteps_total": 122520, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 122520, "timers": {"training_iteration_time_ms": 3557.611, "sample_time_ms": 3543.746, "load_time_ms": 0.374, "load_throughput": 962364.207, "learn_time_ms": 12.682, "learn_throughput": 28385.633, "synch_weights_time_ms": 0.759}, "counters": {"num_env_steps_sampled": 122520, "num_env_steps_trained": 122520, "num_agent_steps_sampled": 122520, "num_agent_steps_trained": 122520}, "done": false, "episodes_total": 821, "training_iteration": 162, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-42-48", "timestamp": 1691131368, "time_this_iter_s": 12.732917070388794, "time_total_s": 1754.7397239208221, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 24.908997058868408, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 22.894444444444446, "ram_util_percent": 63.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.166666666666667e-05, "entropy_coeff": 0.05, "policy_entropy": -382.9525451660156, "policy_loss": -92681625.5625, "vf_loss": 136864576.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 53.0, "diff_num_grad_updates_vs_sampler_policy": 52.0}}, "num_env_steps_sampled": 123960, "num_env_steps_trained": 123960, "num_agent_steps_sampled": 123960, "num_agent_steps_trained": 123960}, "sampler_results": {"episode_reward_max": -3523.3831370621847, "episode_reward_min": -9071.540781892305, "episode_reward_mean": -5258.303392353894, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.367887567294814, "mean_inference_ms": 0.37187785153681735, "mean_action_processing_ms": 0.09178819822424611, "mean_env_wait_ms": 2.2398395350889486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035524368286132812, "StateBufferConnector_ms": 0.0026334415782581677, "ViewRequirementAgentConnector_ms": 0.06557161157781427}}, "episode_reward_max": -3523.3831370621847, "episode_reward_min": -9071.540781892305, "episode_reward_mean": -5258.303392353894, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.367887567294814, "mean_inference_ms": 0.37187785153681735, "mean_action_processing_ms": 0.09178819822424611, "mean_env_wait_ms": 2.2398395350889486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035524368286132812, "StateBufferConnector_ms": 0.0026334415782581677, "ViewRequirementAgentConnector_ms": 0.06557161157781427}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 123960, "num_agent_steps_trained": 123960, "num_env_steps_sampled": 123960, "num_env_steps_trained": 123960, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.18892518277475, "num_env_steps_trained_throughput_per_sec": 111.18892518277475, "timesteps_total": 123960, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 123960, "timers": {"training_iteration_time_ms": 3202.967, "sample_time_ms": 3191.539, "load_time_ms": 0.325, "load_throughput": 1107650.704, "learn_time_ms": 10.305, "learn_throughput": 34933.045, "synch_weights_time_ms": 0.75}, "counters": {"num_env_steps_sampled": 123960, "num_env_steps_trained": 123960, "num_agent_steps_sampled": 123960, "num_agent_steps_trained": 123960}, "done": false, "episodes_total": 825, "training_iteration": 163, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-43-01", "timestamp": 1691131381, "time_this_iter_s": 12.953421115875244, "time_total_s": 1767.6931450366974, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 37.86241817474365, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 22.75, "ram_util_percent": 63.60555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.327777777777778e-05, "entropy_coeff": 0.05, "policy_entropy": -433.45005493164064, "policy_loss": -127016001.2, "vf_loss": 130835867.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 73.0, "diff_num_grad_updates_vs_sampler_policy": 72.0}}, "num_env_steps_sampled": 125400, "num_env_steps_trained": 125400, "num_agent_steps_sampled": 125400, "num_agent_steps_trained": 125400}, "sampler_results": {"episode_reward_max": -3523.3831370621847, "episode_reward_min": -9071.540781892305, "episode_reward_mean": -6238.109348491027, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.399388286894244, "mean_inference_ms": 0.37140073687655667, "mean_action_processing_ms": 0.09172075809150411, "mean_env_wait_ms": 2.018521345382602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034316380818684897, "StateBufferConnector_ms": 0.0026257832845052085, "ViewRequirementAgentConnector_ms": 0.0657351811726888}}, "episode_reward_max": -3523.3831370621847, "episode_reward_min": -9071.540781892305, "episode_reward_mean": -6238.109348491027, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.399388286894244, "mean_inference_ms": 0.37140073687655667, "mean_action_processing_ms": 0.09172075809150411, "mean_env_wait_ms": 2.018521345382602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034316380818684897, "StateBufferConnector_ms": 0.0026257832845052085, "ViewRequirementAgentConnector_ms": 0.0657351811726888}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 125400, "num_agent_steps_trained": 125400, "num_env_steps_sampled": 125400, "num_env_steps_trained": 125400, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.765200428639, "num_env_steps_trained_throughput_per_sec": 110.765200428639, "timesteps_total": 125400, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 125400, "timers": {"training_iteration_time_ms": 3238.558, "sample_time_ms": 3227.839, "load_time_ms": 0.297, "load_throughput": 1212908.218, "learn_time_ms": 9.651, "learn_throughput": 37300.754, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 125400, "num_env_steps_trained": 125400, "num_agent_steps_sampled": 125400, "num_agent_steps_trained": 125400}, "done": false, "episodes_total": 829, "training_iteration": 164, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-43-14", "timestamp": 1691131394, "time_this_iter_s": 13.003017902374268, "time_total_s": 1780.6961629390717, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 50.86543607711792, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 20.384210526315787, "ram_util_percent": 63.68421052631578}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.127777777777778e-05, "entropy_coeff": 0.05, "policy_entropy": -457.3843505859375, "policy_loss": -38562884.21875, "vf_loss": 130781196.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 93.0, "diff_num_grad_updates_vs_sampler_policy": 92.0}}, "num_env_steps_sampled": 126840, "num_env_steps_trained": 126840, "num_agent_steps_sampled": 126840, "num_agent_steps_trained": 126840}, "sampler_results": {"episode_reward_max": -3523.3831370621847, "episode_reward_min": -9071.540781892305, "episode_reward_mean": -6805.113492716476, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.421203412907252, "mean_inference_ms": 0.37103109076144614, "mean_action_processing_ms": 0.09167145144577463, "mean_env_wait_ms": 1.866939071495426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003365466469212582, "StateBufferConnector_ms": 0.0025837044966848274, "ViewRequirementAgentConnector_ms": 0.06570816040039062}}, "episode_reward_max": -3523.3831370621847, "episode_reward_min": -9071.540781892305, "episode_reward_mean": -6805.113492716476, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.421203412907252, "mean_inference_ms": 0.37103109076144614, "mean_action_processing_ms": 0.09167145144577463, "mean_env_wait_ms": 1.866939071495426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003365466469212582, "StateBufferConnector_ms": 0.0025837044966848274, "ViewRequirementAgentConnector_ms": 0.06570816040039062}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126840, "num_agent_steps_trained": 126840, "num_env_steps_sampled": 126840, "num_env_steps_trained": 126840, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.61384573984328, "num_env_steps_trained_throughput_per_sec": 111.61384573984328, "timesteps_total": 126840, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 126840, "timers": {"training_iteration_time_ms": 3231.638, "sample_time_ms": 3220.955, "load_time_ms": 0.292, "load_throughput": 1230903.595, "learn_time_ms": 9.614, "learn_throughput": 37444.128, "synch_weights_time_ms": 0.734}, "counters": {"num_env_steps_sampled": 126840, "num_env_steps_trained": 126840, "num_agent_steps_sampled": 126840, "num_agent_steps_trained": 126840}, "done": false, "episodes_total": 833, "training_iteration": 165, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-43-26", "timestamp": 1691131406, "time_this_iter_s": 12.904161930084229, "time_total_s": 1793.6003248691559, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 63.76959800720215, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 19.34444444444444, "ram_util_percent": 63.57777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.9277777777777775e-05, "entropy_coeff": 0.05, "policy_entropy": -471.6698059082031, "policy_loss": -114673968.0625, "vf_loss": 132252457.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 113.0, "diff_num_grad_updates_vs_sampler_policy": 112.0}}, "num_env_steps_sampled": 128280, "num_env_steps_trained": 128280, "num_agent_steps_sampled": 128280, "num_agent_steps_trained": 128280}, "sampler_results": {"episode_reward_max": -3523.3831370621847, "episode_reward_min": -9071.540781892305, "episode_reward_mean": -7177.981102579335, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.431936108996686, "mean_inference_ms": 0.37075165479486094, "mean_action_processing_ms": 0.09162779720460323, "mean_env_wait_ms": 1.7556711840100403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003458105999490489, "StateBufferConnector_ms": 0.0025707742442255435, "ViewRequirementAgentConnector_ms": 0.06566773290219514}}, "episode_reward_max": -3523.3831370621847, "episode_reward_min": -9071.540781892305, "episode_reward_mean": -7177.981102579335, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.431936108996686, "mean_inference_ms": 0.37075165479486094, "mean_action_processing_ms": 0.09162779720460323, "mean_env_wait_ms": 1.7556711840100403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003458105999490489, "StateBufferConnector_ms": 0.0025707742442255435, "ViewRequirementAgentConnector_ms": 0.06566773290219514}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128280, "num_agent_steps_trained": 128280, "num_env_steps_sampled": 128280, "num_env_steps_trained": 128280, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 113.7888449550017, "num_env_steps_trained_throughput_per_sec": 113.7888449550017, "timesteps_total": 128280, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 128280, "timers": {"training_iteration_time_ms": 3201.537, "sample_time_ms": 3190.811, "load_time_ms": 0.296, "load_throughput": 1215251.058, "learn_time_ms": 9.669, "learn_throughput": 37232.783, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 128280, "num_env_steps_trained": 128280, "num_agent_steps_sampled": 128280, "num_agent_steps_trained": 128280}, "done": false, "episodes_total": 837, "training_iteration": 166, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-43-39", "timestamp": 1691131419, "time_this_iter_s": 12.657542943954468, "time_total_s": 1806.2578678131104, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 76.42714095115662, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 22.155555555555555, "ram_util_percent": 63.638888888888886}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -482.3623779296875, "policy_loss": -127887536.0125, "vf_loss": 130864563.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 133.0, "diff_num_grad_updates_vs_sampler_policy": 132.0}}, "num_env_steps_sampled": 129720, "num_env_steps_trained": 129720, "num_agent_steps_sampled": 129720, "num_agent_steps_trained": 129720}, "sampler_results": {"episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -7438.0696549343, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.441026154977994, "mean_inference_ms": 0.3705289506000336, "mean_action_processing_ms": 0.09159049013794483, "mean_env_wait_ms": 1.6699192724361949, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033961402045355905, "StateBufferConnector_ms": 0.0025758036860713254, "ViewRequirementAgentConnector_ms": 0.06574701379846644}}, "episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -7438.0696549343, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.441026154977994, "mean_inference_ms": 0.3705289506000336, "mean_action_processing_ms": 0.09159049013794483, "mean_env_wait_ms": 1.6699192724361949, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033961402045355905, "StateBufferConnector_ms": 0.0025758036860713254, "ViewRequirementAgentConnector_ms": 0.06574701379846644}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 129720, "num_agent_steps_trained": 129720, "num_env_steps_sampled": 129720, "num_env_steps_trained": 129720, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.69344020953503, "num_env_steps_trained_throughput_per_sec": 111.69344020953503, "timesteps_total": 129720, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 129720, "timers": {"training_iteration_time_ms": 3203.167, "sample_time_ms": 3192.406, "load_time_ms": 0.297, "load_throughput": 1210768.535, "learn_time_ms": 9.708, "learn_throughput": 37083.823, "synch_weights_time_ms": 0.712}, "counters": {"num_env_steps_sampled": 129720, "num_env_steps_trained": 129720, "num_agent_steps_sampled": 129720, "num_agent_steps_trained": 129720}, "done": false, "episodes_total": 841, "training_iteration": 167, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-43-52", "timestamp": 1691131432, "time_this_iter_s": 12.894983053207397, "time_total_s": 1819.1528508663177, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 89.32212400436401, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 21.489473684210527, "ram_util_percent": 63.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -494.62042846679685, "policy_loss": -239989896.95, "vf_loss": 131003282.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 153.0, "diff_num_grad_updates_vs_sampler_policy": 152.0}}, "num_env_steps_sampled": 131160, "num_env_steps_trained": 131160, "num_agent_steps_sampled": 131160, "num_agent_steps_trained": 131160}, "sampler_results": {"episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -7632.5546543386, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.448215741308468, "mean_inference_ms": 0.37030220026402094, "mean_action_processing_ms": 0.09155152230475017, "mean_env_wait_ms": 1.6014749629571103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003460145765735257, "StateBufferConnector_ms": 0.002597224327825731, "ViewRequirementAgentConnector_ms": 0.06589812617148122}}, "episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -7632.5546543386, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.448215741308468, "mean_inference_ms": 0.37030220026402094, "mean_action_processing_ms": 0.09155152230475017, "mean_env_wait_ms": 1.6014749629571103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003460145765735257, "StateBufferConnector_ms": 0.002597224327825731, "ViewRequirementAgentConnector_ms": 0.06589812617148122}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 131160, "num_agent_steps_trained": 131160, "num_env_steps_sampled": 131160, "num_env_steps_trained": 131160, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.16074019059273, "num_env_steps_trained_throughput_per_sec": 112.16074019059273, "timesteps_total": 131160, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 131160, "timers": {"training_iteration_time_ms": 3207.504, "sample_time_ms": 3196.85, "load_time_ms": 0.296, "load_throughput": 1217112.236, "learn_time_ms": 9.597, "learn_throughput": 37511.849, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 131160, "num_env_steps_trained": 131160, "num_agent_steps_sampled": 131160, "num_agent_steps_trained": 131160}, "done": false, "episodes_total": 845, "training_iteration": 168, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-44-05", "timestamp": 1691131445, "time_this_iter_s": 12.841580867767334, "time_total_s": 1831.994431734085, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 102.16370487213135, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 19.655555555555555, "ram_util_percent": 63.772222222222226}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -508.46526489257815, "policy_loss": -884352441.6, "vf_loss": 135970340.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 173.0, "diff_num_grad_updates_vs_sampler_policy": 172.0}}, "num_env_steps_sampled": 132600, "num_env_steps_trained": 132600, "num_agent_steps_sampled": 132600, "num_agent_steps_trained": 132600}, "sampler_results": {"episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -7782.001126862378, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.455228668603417, "mean_inference_ms": 0.3701445015232875, "mean_action_processing_ms": 0.0915279311413292, "mean_env_wait_ms": 1.545844114200157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034052985055106027, "StateBufferConnector_ms": 0.0025878633771623883, "ViewRequirementAgentConnector_ms": 0.06585393633161273}}, "episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -7782.001126862378, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.455228668603417, "mean_inference_ms": 0.3701445015232875, "mean_action_processing_ms": 0.0915279311413292, "mean_env_wait_ms": 1.545844114200157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034052985055106027, "StateBufferConnector_ms": 0.0025878633771623883, "ViewRequirementAgentConnector_ms": 0.06585393633161273}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132600, "num_agent_steps_trained": 132600, "num_env_steps_sampled": 132600, "num_env_steps_trained": 132600, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.54161531525565, "num_env_steps_trained_throughput_per_sec": 110.54161531525565, "timesteps_total": 132600, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 132600, "timers": {"training_iteration_time_ms": 3218.582, "sample_time_ms": 3207.977, "load_time_ms": 0.297, "load_throughput": 1213493.08, "learn_time_ms": 9.542, "learn_throughput": 37726.1, "synch_weights_time_ms": 0.722}, "counters": {"num_env_steps_sampled": 132600, "num_env_steps_trained": 132600, "num_agent_steps_sampled": 132600, "num_agent_steps_trained": 132600}, "done": false, "episodes_total": 849, "training_iteration": 169, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-44-18", "timestamp": 1691131458, "time_this_iter_s": 13.029222011566162, "time_total_s": 1845.0236537456512, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 115.19292688369751, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 20.02105263157895, "ram_util_percent": 63.86315789473684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -527.38447265625, "policy_loss": -222872338.675, "vf_loss": 131890270.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 193.0, "diff_num_grad_updates_vs_sampler_policy": 192.0}}, "num_env_steps_sampled": 134040, "num_env_steps_trained": 134040, "num_agent_steps_sampled": 134040, "num_agent_steps_trained": 134040}, "sampler_results": {"episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -7899.481450948429, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.461834045157801, "mean_inference_ms": 0.36999404444811845, "mean_action_processing_ms": 0.09150302117416721, "mean_env_wait_ms": 1.4993402407906424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033812645154121593, "StateBufferConnector_ms": 0.002588369907476963, "ViewRequirementAgentConnector_ms": 0.06598081344213241}}, "episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -7899.481450948429, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.461834045157801, "mean_inference_ms": 0.36999404444811845, "mean_action_processing_ms": 0.09150302117416721, "mean_env_wait_ms": 1.4993402407906424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033812645154121593, "StateBufferConnector_ms": 0.002588369907476963, "ViewRequirementAgentConnector_ms": 0.06598081344213241}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 134040, "num_agent_steps_trained": 134040, "num_env_steps_sampled": 134040, "num_env_steps_trained": 134040, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.92624384623403, "num_env_steps_trained_throughput_per_sec": 110.92624384623403, "timesteps_total": 134040, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 134040, "timers": {"training_iteration_time_ms": 3243.052, "sample_time_ms": 3232.456, "load_time_ms": 0.295, "load_throughput": 1218388.962, "learn_time_ms": 9.532, "learn_throughput": 37766.297, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 134040, "num_env_steps_trained": 134040, "num_agent_steps_sampled": 134040, "num_agent_steps_trained": 134040}, "done": false, "episodes_total": 853, "training_iteration": 170, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-44-31", "timestamp": 1691131471, "time_this_iter_s": 12.98426079750061, "time_total_s": 1858.0079145431519, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 128.17718768119812, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 22.544444444444444, "ram_util_percent": 63.87777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -542.0357666015625, "policy_loss": -447143972.846875, "vf_loss": 131423264.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 213.0, "diff_num_grad_updates_vs_sampler_policy": 212.0}}, "num_env_steps_sampled": 135480, "num_env_steps_trained": 135480, "num_agent_steps_sampled": 135480, "num_agent_steps_trained": 135480}, "sampler_results": {"episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -7997.314043291434, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.4682068695167025, "mean_inference_ms": 0.3698659222207723, "mean_action_processing_ms": 0.09147918512349236, "mean_env_wait_ms": 1.4596022663253034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003512515578159066, "StateBufferConnector_ms": 0.002582128657851108, "ViewRequirementAgentConnector_ms": 0.06589612295461256}}, "episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -7997.314043291434, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.4682068695167025, "mean_inference_ms": 0.3698659222207723, "mean_action_processing_ms": 0.09147918512349236, "mean_env_wait_ms": 1.4596022663253034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003512515578159066, "StateBufferConnector_ms": 0.002582128657851108, "ViewRequirementAgentConnector_ms": 0.06589612295461256}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 135480, "num_agent_steps_trained": 135480, "num_env_steps_sampled": 135480, "num_env_steps_trained": 135480, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.85387265279024, "num_env_steps_trained_throughput_per_sec": 110.85387265279024, "timesteps_total": 135480, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 135480, "timers": {"training_iteration_time_ms": 3252.863, "sample_time_ms": 3242.213, "load_time_ms": 0.296, "load_throughput": 1215936.093, "learn_time_ms": 9.597, "learn_throughput": 37509.799, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 135480, "num_env_steps_trained": 135480, "num_agent_steps_sampled": 135480, "num_agent_steps_trained": 135480}, "done": false, "episodes_total": 857, "training_iteration": 171, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-44-44", "timestamp": 1691131484, "time_this_iter_s": 12.992696285247803, "time_total_s": 1871.0006108283997, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 141.16988396644592, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 19.584210526315786, "ram_util_percent": 63.76315789473684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -551.8919311523438, "policy_loss": -549851524.8125, "vf_loss": 130841788.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 233.0, "diff_num_grad_updates_vs_sampler_policy": 232.0}}, "num_env_steps_sampled": 136920, "num_env_steps_trained": 136920, "num_agent_steps_sampled": 136920, "num_agent_steps_trained": 136920}, "sampler_results": {"episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8076.42573768646, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.473410909851006, "mean_inference_ms": 0.3697514387682855, "mean_action_processing_ms": 0.09145882333927463, "mean_env_wait_ms": 1.4253210578037736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035387404421542553, "StateBufferConnector_ms": 0.002586587946465675, "ViewRequirementAgentConnector_ms": 0.06596636264882189}}, "episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8076.42573768646, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.473410909851006, "mean_inference_ms": 0.3697514387682855, "mean_action_processing_ms": 0.09145882333927463, "mean_env_wait_ms": 1.4253210578037736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035387404421542553, "StateBufferConnector_ms": 0.002586587946465675, "ViewRequirementAgentConnector_ms": 0.06596636264882189}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136920, "num_agent_steps_trained": 136920, "num_env_steps_sampled": 136920, "num_env_steps_trained": 136920, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.08510231290714, "num_env_steps_trained_throughput_per_sec": 112.08510231290714, "timesteps_total": 136920, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 136920, "timers": {"training_iteration_time_ms": 3231.395, "sample_time_ms": 3220.73, "load_time_ms": 0.297, "load_throughput": 1213005.656, "learn_time_ms": 9.615, "learn_throughput": 37443.385, "synch_weights_time_ms": 0.711}, "counters": {"num_env_steps_sampled": 136920, "num_env_steps_trained": 136920, "num_agent_steps_sampled": 136920, "num_agent_steps_trained": 136920}, "done": false, "episodes_total": 861, "training_iteration": 172, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-44-57", "timestamp": 1691131497, "time_this_iter_s": 12.849971055984497, "time_total_s": 1883.8505818843842, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 154.01985502243042, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 19.777777777777782, "ram_util_percent": 63.85000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-05, "entropy_coeff": 0.05, "policy_entropy": -566.0213256835938, "policy_loss": -888618702.5125, "vf_loss": 133041614.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 253.0, "diff_num_grad_updates_vs_sampler_policy": 252.0}}, "num_env_steps_sampled": 138360, "num_env_steps_trained": 138360, "num_agent_steps_sampled": 138360, "num_agent_steps_trained": 138360}, "sampler_results": {"episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8145.732234769038, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.476765011168718, "mean_inference_ms": 0.3696605691320701, "mean_action_processing_ms": 0.0914425275959683, "mean_env_wait_ms": 1.3957884193419217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035108304491230087, "StateBufferConnector_ms": 0.0025795955283969057, "ViewRequirementAgentConnector_ms": 0.06594657897949219}}, "episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8145.732234769038, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.476765011168718, "mean_inference_ms": 0.3696605691320701, "mean_action_processing_ms": 0.0914425275959683, "mean_env_wait_ms": 1.3957884193419217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035108304491230087, "StateBufferConnector_ms": 0.0025795955283969057, "ViewRequirementAgentConnector_ms": 0.06594657897949219}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 138360, "num_agent_steps_trained": 138360, "num_env_steps_sampled": 138360, "num_env_steps_trained": 138360, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 113.25941333972408, "num_env_steps_trained_throughput_per_sec": 113.25941333972408, "timesteps_total": 138360, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 138360, "timers": {"training_iteration_time_ms": 3203.189, "sample_time_ms": 3192.549, "load_time_ms": 0.299, "load_throughput": 1205837.278, "learn_time_ms": 9.604, "learn_throughput": 37486.052, "synch_weights_time_ms": 0.694}, "counters": {"num_env_steps_sampled": 138360, "num_env_steps_trained": 138360, "num_agent_steps_sampled": 138360, "num_agent_steps_trained": 138360}, "done": false, "episodes_total": 865, "training_iteration": 173, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-45-10", "timestamp": 1691131510, "time_this_iter_s": 12.716812133789062, "time_total_s": 1896.5673940181732, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 166.73666715621948, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 21.716666666666665, "ram_util_percent": 63.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.316666666666667e-05, "entropy_coeff": 0.05, "policy_entropy": -581.0059448242188, "policy_loss": -546302164.2875, "vf_loss": 132074792.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 273.0, "diff_num_grad_updates_vs_sampler_policy": 272.0}}, "num_env_steps_sampled": 139800, "num_env_steps_trained": 139800, "num_agent_steps_sampled": 139800, "num_agent_steps_trained": 139800}, "sampler_results": {"episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8203.069214994195, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.480156651662483, "mean_inference_ms": 0.36958297182490124, "mean_action_processing_ms": 0.09142758204881984, "mean_env_wait_ms": 1.3698518141570477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003486113114790483, "StateBufferConnector_ms": 0.0025770880959250712, "ViewRequirementAgentConnector_ms": 0.06596608595414595}}, "episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8203.069214994195, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.480156651662483, "mean_inference_ms": 0.36958297182490124, "mean_action_processing_ms": 0.09142758204881984, "mean_env_wait_ms": 1.3698518141570477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003486113114790483, "StateBufferConnector_ms": 0.0025770880959250712, "ViewRequirementAgentConnector_ms": 0.06596608595414595}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 139800, "num_agent_steps_trained": 139800, "num_env_steps_sampled": 139800, "num_env_steps_trained": 139800, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.56413357341442, "num_env_steps_trained_throughput_per_sec": 110.56413357341442, "timesteps_total": 139800, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 139800, "timers": {"training_iteration_time_ms": 3222.963, "sample_time_ms": 3212.355, "load_time_ms": 0.297, "load_throughput": 1211545.727, "learn_time_ms": 9.579, "learn_throughput": 37582.34, "synch_weights_time_ms": 0.688}, "counters": {"num_env_steps_sampled": 139800, "num_env_steps_trained": 139800, "num_agent_steps_sampled": 139800, "num_agent_steps_trained": 139800}, "done": false, "episodes_total": 869, "training_iteration": 174, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-45-23", "timestamp": 1691131523, "time_this_iter_s": 13.02695918083191, "time_total_s": 1909.5943531990051, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 179.7636263370514, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 19.52777777777778, "ram_util_percent": 63.75555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.7166666666666666e-05, "entropy_coeff": 0.05, "policy_entropy": -586.6522705078125, "policy_loss": -720571858.2625, "vf_loss": 132604218.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 293.0, "diff_num_grad_updates_vs_sampler_policy": 292.0}}, "num_env_steps_sampled": 141240, "num_env_steps_trained": 141240, "num_agent_steps_sampled": 141240, "num_agent_steps_trained": 141240}, "sampler_results": {"episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8251.064271042409, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.483081431368692, "mean_inference_ms": 0.369510575540065, "mean_action_processing_ms": 0.09141362718059604, "mean_env_wait_ms": 1.3465895927361329, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034700005741442664, "StateBufferConnector_ms": 0.0025914887250480007, "ViewRequirementAgentConnector_ms": 0.06610700639627748}}, "episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8251.064271042409, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.483081431368692, "mean_inference_ms": 0.369510575540065, "mean_action_processing_ms": 0.09141362718059604, "mean_env_wait_ms": 1.3465895927361329, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034700005741442664, "StateBufferConnector_ms": 0.0025914887250480007, "ViewRequirementAgentConnector_ms": 0.06610700639627748}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 141240, "num_agent_steps_trained": 141240, "num_env_steps_sampled": 141240, "num_env_steps_trained": 141240, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.49360119999676, "num_env_steps_trained_throughput_per_sec": 112.49360119999676, "timesteps_total": 141240, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 141240, "timers": {"training_iteration_time_ms": 3220.304, "sample_time_ms": 3209.623, "load_time_ms": 0.297, "load_throughput": 1211157.006, "learn_time_ms": 9.644, "learn_throughput": 37330.633, "synch_weights_time_ms": 0.696}, "counters": {"num_env_steps_sampled": 141240, "num_env_steps_trained": 141240, "num_agent_steps_sampled": 141240, "num_agent_steps_trained": 141240}, "done": false, "episodes_total": 873, "training_iteration": 175, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-45-36", "timestamp": 1691131536, "time_this_iter_s": 12.803526878356934, "time_total_s": 1922.397880077362, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 192.56715321540833, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 20.72105263157895, "ram_util_percent": 63.70526315789474}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.1166666666666666e-05, "entropy_coeff": 0.05, "policy_entropy": -594.0861694335938, "policy_loss": -48523265.775, "vf_loss": 130164888.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 313.0, "diff_num_grad_updates_vs_sampler_policy": 312.0}}, "num_env_steps_sampled": 142680, "num_env_steps_trained": 142680, "num_agent_steps_sampled": 142680, "num_agent_steps_trained": 142680}, "sampler_results": {"episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8291.944752318741, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.485363078080989, "mean_inference_ms": 0.36944296091638384, "mean_action_processing_ms": 0.09140159125251278, "mean_env_wait_ms": 1.3256707777119345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034517712063259548, "StateBufferConnector_ms": 0.0025874092465355283, "ViewRequirementAgentConnector_ms": 0.06615850660536024}}, "episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8291.944752318741, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.485363078080989, "mean_inference_ms": 0.36944296091638384, "mean_action_processing_ms": 0.09140159125251278, "mean_env_wait_ms": 1.3256707777119345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034517712063259548, "StateBufferConnector_ms": 0.0025874092465355283, "ViewRequirementAgentConnector_ms": 0.06615850660536024}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 142680, "num_agent_steps_trained": 142680, "num_env_steps_sampled": 142680, "num_env_steps_trained": 142680, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 113.09562470993698, "num_env_steps_trained_throughput_per_sec": 113.09562470993698, "timesteps_total": 142680, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 142680, "timers": {"training_iteration_time_ms": 3198.94, "sample_time_ms": 3188.299, "load_time_ms": 0.296, "load_throughput": 1215446.704, "learn_time_ms": 9.591, "learn_throughput": 37534.135, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 142680, "num_env_steps_trained": 142680, "num_agent_steps_sampled": 142680, "num_agent_steps_trained": 142680}, "done": false, "episodes_total": 877, "training_iteration": 176, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-45-48", "timestamp": 1691131548, "time_this_iter_s": 12.735202074050903, "time_total_s": 1935.133082151413, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 205.30235528945923, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 27.305555555555557, "ram_util_percent": 63.75555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.05, "policy_entropy": -598.9328857421875, "policy_loss": -1874587289.6, "vf_loss": 132796980.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 333.0, "diff_num_grad_updates_vs_sampler_policy": 332.0}}, "num_env_steps_sampled": 144120, "num_env_steps_trained": 144120, "num_agent_steps_sampled": 144120, "num_agent_steps_trained": 144120}, "sampler_results": {"episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8330.612121672066, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.487231868200907, "mean_inference_ms": 0.36938286959409145, "mean_action_processing_ms": 0.09139063845673319, "mean_env_wait_ms": 1.3068799402542923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034745059796233674, "StateBufferConnector_ms": 0.0025791908378031718, "ViewRequirementAgentConnector_ms": 0.06608678333794893}}, "episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8330.612121672066, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.487231868200907, "mean_inference_ms": 0.36938286959409145, "mean_action_processing_ms": 0.09139063845673319, "mean_env_wait_ms": 1.3068799402542923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034745059796233674, "StateBufferConnector_ms": 0.0025791908378031718, "ViewRequirementAgentConnector_ms": 0.06608678333794893}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144120, "num_agent_steps_trained": 144120, "num_env_steps_sampled": 144120, "num_env_steps_trained": 144120, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.29358154318078, "num_env_steps_trained_throughput_per_sec": 112.29358154318078, "timesteps_total": 144120, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 144120, "timers": {"training_iteration_time_ms": 3202.546, "sample_time_ms": 3191.881, "load_time_ms": 0.3, "load_throughput": 1201137.093, "learn_time_ms": 9.601, "learn_throughput": 37495.827, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 144120, "num_env_steps_trained": 144120, "num_agent_steps_sampled": 144120, "num_agent_steps_trained": 144120}, "done": false, "episodes_total": 881, "training_iteration": 177, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-46-01", "timestamp": 1691131561, "time_this_iter_s": 12.826295852661133, "time_total_s": 1947.959378004074, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 218.12865114212036, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 23.39444444444445, "ram_util_percent": 64.02777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.05, "policy_entropy": -605.0641723632813, "policy_loss": -1383984377.1875, "vf_loss": 133535599.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 353.0, "diff_num_grad_updates_vs_sampler_policy": 352.0}}, "num_env_steps_sampled": 145560, "num_env_steps_trained": 145560, "num_agent_steps_sampled": 145560, "num_agent_steps_trained": 145560}, "sampler_results": {"episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8367.227340491747, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.489172582804172, "mean_inference_ms": 0.3693255934871643, "mean_action_processing_ms": 0.0913800505832593, "mean_env_wait_ms": 1.2898815773952965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034923284826144365, "StateBufferConnector_ms": 0.002579621865715779, "ViewRequirementAgentConnector_ms": 0.066039931606239}}, "episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8367.227340491747, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.489172582804172, "mean_inference_ms": 0.3693255934871643, "mean_action_processing_ms": 0.0913800505832593, "mean_env_wait_ms": 1.2898815773952965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034923284826144365, "StateBufferConnector_ms": 0.002579621865715779, "ViewRequirementAgentConnector_ms": 0.066039931606239}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 145560, "num_agent_steps_trained": 145560, "num_env_steps_sampled": 145560, "num_env_steps_trained": 145560, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.7939372334631, "num_env_steps_trained_throughput_per_sec": 110.7939372334631, "timesteps_total": 145560, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 145560, "timers": {"training_iteration_time_ms": 3213.543, "sample_time_ms": 3202.889, "load_time_ms": 0.298, "load_throughput": 1206222.591, "learn_time_ms": 9.6, "learn_throughput": 37500.11, "synch_weights_time_ms": 0.711}, "counters": {"num_env_steps_sampled": 145560, "num_env_steps_trained": 145560, "num_agent_steps_sampled": 145560, "num_agent_steps_trained": 145560}, "done": false, "episodes_total": 885, "training_iteration": 178, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-46-14", "timestamp": 1691131574, "time_this_iter_s": 12.99990200996399, "time_total_s": 1960.959280014038, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 231.12855315208435, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 19.815789473684212, "ram_util_percent": 64.0421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.05, "policy_entropy": -610.5317626953125, "policy_loss": -750339882.9, "vf_loss": 130266047.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 373.0, "diff_num_grad_updates_vs_sampler_policy": 372.0}}, "num_env_steps_sampled": 147000, "num_env_steps_trained": 147000, "num_agent_steps_sampled": 147000, "num_agent_steps_trained": 147000}, "sampler_results": {"episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8395.032781174075, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.490938582864005, "mean_inference_ms": 0.36927699696524563, "mean_action_processing_ms": 0.09137079699264862, "mean_env_wait_ms": 1.2743592512253363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034688313802083335, "StateBufferConnector_ms": 0.0025803248087565103, "ViewRequirementAgentConnector_ms": 0.06609153747558594}}, "episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8395.032781174075, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.490938582864005, "mean_inference_ms": 0.36927699696524563, "mean_action_processing_ms": 0.09137079699264862, "mean_env_wait_ms": 1.2743592512253363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034688313802083335, "StateBufferConnector_ms": 0.0025803248087565103, "ViewRequirementAgentConnector_ms": 0.06609153747558594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 147000, "num_agent_steps_trained": 147000, "num_env_steps_sampled": 147000, "num_env_steps_trained": 147000, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.9510103768716, "num_env_steps_trained_throughput_per_sec": 111.9510103768716, "timesteps_total": 147000, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 147000, "timers": {"training_iteration_time_ms": 3222.618, "sample_time_ms": 3211.944, "load_time_ms": 0.296, "load_throughput": 1217995.838, "learn_time_ms": 9.617, "learn_throughput": 37432.803, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 147000, "num_env_steps_trained": 147000, "num_agent_steps_sampled": 147000, "num_agent_steps_trained": 147000}, "done": false, "episodes_total": 889, "training_iteration": 179, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-46-27", "timestamp": 1691131587, "time_this_iter_s": 12.865588903427124, "time_total_s": 1973.8248689174652, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 243.99414205551147, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 21.516666666666666, "ram_util_percent": 63.88333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.05, "policy_entropy": -617.2693115234375, "policy_loss": -366009363.325, "vf_loss": 132572751.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 393.0, "diff_num_grad_updates_vs_sampler_policy": 392.0}}, "num_env_steps_sampled": 148440, "num_env_steps_trained": 148440, "num_agent_steps_sampled": 148440, "num_agent_steps_trained": 148440}, "sampler_results": {"episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8424.501490256527, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.492258052837486, "mean_inference_ms": 0.36923282478088426, "mean_action_processing_ms": 0.09136224698761805, "mean_env_wait_ms": 1.2602189756241826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003446506548531448, "StateBufferConnector_ms": 0.0025818619547010977, "ViewRequirementAgentConnector_ms": 0.06608540498757665}}, "episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8424.501490256527, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.492258052837486, "mean_inference_ms": 0.36923282478088426, "mean_action_processing_ms": 0.09136224698761805, "mean_env_wait_ms": 1.2602189756241826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003446506548531448, "StateBufferConnector_ms": 0.0025818619547010977, "ViewRequirementAgentConnector_ms": 0.06608540498757665}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148440, "num_agent_steps_trained": 148440, "num_env_steps_sampled": 148440, "num_env_steps_trained": 148440, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.93633821616727, "num_env_steps_trained_throughput_per_sec": 112.93633821616727, "timesteps_total": 148440, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 148440, "timers": {"training_iteration_time_ms": 3202.231, "sample_time_ms": 3191.603, "load_time_ms": 0.297, "load_throughput": 1212713.388, "learn_time_ms": 9.581, "learn_throughput": 37573.082, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 148440, "num_env_steps_trained": 148440, "num_agent_steps_sampled": 148440, "num_agent_steps_trained": 148440}, "done": false, "episodes_total": 893, "training_iteration": 180, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-46-40", "timestamp": 1691131600, "time_this_iter_s": 12.753175020217896, "time_total_s": 1986.578043937683, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 256.74731707572937, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 21.67777777777778, "ram_util_percent": 63.622222222222234}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.05, "policy_entropy": -621.8293334960938, "policy_loss": -1398393878.8, "vf_loss": 129194616.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 413.0, "diff_num_grad_updates_vs_sampler_policy": 412.0}}, "num_env_steps_sampled": 149880, "num_env_steps_trained": 149880, "num_agent_steps_sampled": 149880, "num_agent_steps_trained": 149880}, "sampler_results": {"episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8447.686098058639, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.49355224372995, "mean_inference_ms": 0.36919236864410643, "mean_action_processing_ms": 0.09135440293773796, "mean_env_wait_ms": 1.2472448548467265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003463963428175593, "StateBufferConnector_ms": 0.00258526170110128, "ViewRequirementAgentConnector_ms": 0.06605314921183758}}, "episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8447.686098058639, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.49355224372995, "mean_inference_ms": 0.36919236864410643, "mean_action_processing_ms": 0.09135440293773796, "mean_env_wait_ms": 1.2472448548467265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003463963428175593, "StateBufferConnector_ms": 0.00258526170110128, "ViewRequirementAgentConnector_ms": 0.06605314921183758}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149880, "num_agent_steps_trained": 149880, "num_env_steps_sampled": 149880, "num_env_steps_trained": 149880, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.31369374572284, "num_env_steps_trained_throughput_per_sec": 111.31369374572284, "timesteps_total": 149880, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 149880, "timers": {"training_iteration_time_ms": 3223.534, "sample_time_ms": 3212.824, "load_time_ms": 0.297, "load_throughput": 1212518.622, "learn_time_ms": 9.659, "learn_throughput": 37272.763, "synch_weights_time_ms": 0.711}, "counters": {"num_env_steps_sampled": 149880, "num_env_steps_trained": 149880, "num_agent_steps_sampled": 149880, "num_agent_steps_trained": 149880}, "done": false, "episodes_total": 897, "training_iteration": 181, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-46-53", "timestamp": 1691131613, "time_this_iter_s": 12.939447164535522, "time_total_s": 1999.5174911022186, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 269.6867642402649, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 21.084210526315786, "ram_util_percent": 63.63684210526316}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.38888888888889e-06, "entropy_coeff": 0.05, "policy_entropy": -627.2907958984375, "policy_loss": 1300971.3, "vf_loss": 130642548.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 433.0, "diff_num_grad_updates_vs_sampler_policy": 432.0}}, "num_env_steps_sampled": 151320, "num_env_steps_trained": 151320, "num_agent_steps_sampled": 151320, "num_agent_steps_trained": 151320}, "sampler_results": {"episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8468.723681186122, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.494783147062848, "mean_inference_ms": 0.3691559296096837, "mean_action_processing_ms": 0.09134671830784023, "mean_env_wait_ms": 1.235185291485961, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034833776539769665, "StateBufferConnector_ms": 0.002585882428048671, "ViewRequirementAgentConnector_ms": 0.06612717420205302}}, "episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8468.723681186122, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.494783147062848, "mean_inference_ms": 0.3691559296096837, "mean_action_processing_ms": 0.09134671830784023, "mean_env_wait_ms": 1.235185291485961, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034833776539769665, "StateBufferConnector_ms": 0.002585882428048671, "ViewRequirementAgentConnector_ms": 0.06612717420205302}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 151320, "num_agent_steps_trained": 151320, "num_env_steps_sampled": 151320, "num_env_steps_trained": 151320, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.14661603708716, "num_env_steps_trained_throughput_per_sec": 112.14661603708716, "timesteps_total": 151320, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 151320, "timers": {"training_iteration_time_ms": 3212.637, "sample_time_ms": 3201.924, "load_time_ms": 0.295, "load_throughput": 1218979.123, "learn_time_ms": 9.665, "learn_throughput": 37245.916, "synch_weights_time_ms": 0.707}, "counters": {"num_env_steps_sampled": 151320, "num_env_steps_trained": 151320, "num_agent_steps_sampled": 151320, "num_agent_steps_trained": 151320}, "done": false, "episodes_total": 901, "training_iteration": 182, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-47-06", "timestamp": 1691131626, "time_this_iter_s": 12.84304404258728, "time_total_s": 2012.360535144806, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 282.5298082828522, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 20.57777777777778, "ram_util_percent": 63.544444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.388888888888889e-06, "entropy_coeff": 0.05, "policy_entropy": -629.9325439453125, "policy_loss": -231778310.9, "vf_loss": 133357964.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 453.0, "diff_num_grad_updates_vs_sampler_policy": 452.0}}, "num_env_steps_sampled": 152760, "num_env_steps_trained": 152760, "num_agent_steps_sampled": 152760, "num_agent_steps_trained": 152760}, "sampler_results": {"episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8488.427635746662, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.496247590637523, "mean_inference_ms": 0.369121307471078, "mean_action_processing_ms": 0.09133991186143617, "mean_env_wait_ms": 1.2239981922844296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003462047367305546, "StateBufferConnector_ms": 0.002581732613699777, "ViewRequirementAgentConnector_ms": 0.06608805813632168}}, "episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8488.427635746662, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.496247590637523, "mean_inference_ms": 0.369121307471078, "mean_action_processing_ms": 0.09133991186143617, "mean_env_wait_ms": 1.2239981922844296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003462047367305546, "StateBufferConnector_ms": 0.002581732613699777, "ViewRequirementAgentConnector_ms": 0.06608805813632168}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152760, "num_agent_steps_trained": 152760, "num_env_steps_sampled": 152760, "num_env_steps_trained": 152760, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.92628176789366, "num_env_steps_trained_throughput_per_sec": 109.92628176789366, "timesteps_total": 152760, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 152760, "timers": {"training_iteration_time_ms": 3240.258, "sample_time_ms": 3229.534, "load_time_ms": 0.297, "load_throughput": 1213980.897, "learn_time_ms": 9.656, "learn_throughput": 37281.229, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 152760, "num_env_steps_trained": 152760, "num_agent_steps_sampled": 152760, "num_agent_steps_trained": 152760}, "done": false, "episodes_total": 905, "training_iteration": 183, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-47-19", "timestamp": 1691131639, "time_this_iter_s": 13.102388143539429, "time_total_s": 2025.4629232883453, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 295.6321964263916, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 19.189473684210526, "ram_util_percent": 63.60526315789475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.05, "policy_entropy": -632.2486938476562, "policy_loss": -1700438405.85, "vf_loss": 132423676.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 473.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 154200, "num_env_steps_trained": 154200, "num_agent_steps_sampled": 154200, "num_agent_steps_trained": 154200}, "sampler_results": {"episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8506.48082363931, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.497722983976642, "mean_inference_ms": 0.3690863674977104, "mean_action_processing_ms": 0.09133264232827248, "mean_env_wait_ms": 1.2135520313376975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034500423230622943, "StateBufferConnector_ms": 0.0025796890258789062, "ViewRequirementAgentConnector_ms": 0.06608034435071443}}, "episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8506.48082363931, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.497722983976642, "mean_inference_ms": 0.3690863674977104, "mean_action_processing_ms": 0.09133264232827248, "mean_env_wait_ms": 1.2135520313376975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034500423230622943, "StateBufferConnector_ms": 0.0025796890258789062, "ViewRequirementAgentConnector_ms": 0.06608034435071443}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 154200, "num_agent_steps_trained": 154200, "num_env_steps_sampled": 154200, "num_env_steps_trained": 154200, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.34942004090827, "num_env_steps_trained_throughput_per_sec": 111.34942004090827, "timesteps_total": 154200, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 154200, "timers": {"training_iteration_time_ms": 3248.425, "sample_time_ms": 3237.782, "load_time_ms": 0.297, "load_throughput": 1212421.262, "learn_time_ms": 9.575, "learn_throughput": 37598.343, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 154200, "num_env_steps_trained": 154200, "num_agent_steps_sampled": 154200, "num_agent_steps_trained": 154200}, "done": false, "episodes_total": 909, "training_iteration": 184, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-47-32", "timestamp": 1691131652, "time_this_iter_s": 12.93503999710083, "time_total_s": 2038.3979632854462, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 308.56723642349243, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 22.57222222222222, "ram_util_percent": 63.67222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.05, "policy_entropy": -635.2644287109375, "policy_loss": -2381973664.075, "vf_loss": 130124931.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 493.0, "diff_num_grad_updates_vs_sampler_policy": 492.0}}, "num_env_steps_sampled": 155640, "num_env_steps_trained": 155640, "num_agent_steps_sampled": 155640, "num_agent_steps_trained": 155640}, "sampler_results": {"episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8523.917876906062, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.499031301363813, "mean_inference_ms": 0.3690563196647153, "mean_action_processing_ms": 0.09132586460265153, "mean_env_wait_ms": 1.2038984450742003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034392482102519333, "StateBufferConnector_ms": 0.002583590420809659, "ViewRequirementAgentConnector_ms": 0.06612190092452849}}, "episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8523.917876906062, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3530.0036985621336, -3527.1732859128188, -3527.794343578852, -3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.499031301363813, "mean_inference_ms": 0.3690563196647153, "mean_action_processing_ms": 0.09132586460265153, "mean_env_wait_ms": 1.2038984450742003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034392482102519333, "StateBufferConnector_ms": 0.002583590420809659, "ViewRequirementAgentConnector_ms": 0.06612190092452849}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 155640, "num_agent_steps_trained": 155640, "num_env_steps_sampled": 155640, "num_env_steps_trained": 155640, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.60942577596234, "num_env_steps_trained_throughput_per_sec": 111.60942577596234, "timesteps_total": 155640, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 155640, "timers": {"training_iteration_time_ms": 3239.945, "sample_time_ms": 3229.283, "load_time_ms": 0.3, "load_throughput": 1201423.806, "learn_time_ms": 9.582, "learn_throughput": 37570.184, "synch_weights_time_ms": 0.736}, "counters": {"num_env_steps_sampled": 155640, "num_env_steps_trained": 155640, "num_agent_steps_sampled": 155640, "num_agent_steps_trained": 155640}, "done": false, "episodes_total": 913, "training_iteration": 185, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-47-45", "timestamp": 1691131665, "time_this_iter_s": 12.905000925064087, "time_total_s": 2051.3029642105103, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 321.4722373485565, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 20.105555555555554, "ram_util_percent": 63.71666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.05, "policy_entropy": -636.8606323242187, "policy_loss": -2115079663.625, "vf_loss": 134588252.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 513.0, "diff_num_grad_updates_vs_sampler_policy": 512.0}}, "num_env_steps_sampled": 157080, "num_env_steps_trained": 157080, "num_agent_steps_sampled": 157080, "num_agent_steps_trained": 157080}, "sampler_results": {"episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8690.137160222837, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5072560294349815, "mean_inference_ms": 0.3688914336175839, "mean_action_processing_ms": 0.09129722284265895, "mean_env_wait_ms": 1.1273465742016042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003429889678955078, "StateBufferConnector_ms": 0.0025930404663085938, "ViewRequirementAgentConnector_ms": 0.06607794761657715}}, "episode_reward_max": -3523.3831370621847, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8690.137160222837, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3528.8850440753654, -3523.3831370621847, -3527.8796894670654, -3849.885417885919, -5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5072560294349815, "mean_inference_ms": 0.3688914336175839, "mean_action_processing_ms": 0.09129722284265895, "mean_env_wait_ms": 1.1273465742016042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003429889678955078, "StateBufferConnector_ms": 0.0025930404663085938, "ViewRequirementAgentConnector_ms": 0.06607794761657715}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 157080, "num_agent_steps_trained": 157080, "num_env_steps_sampled": 157080, "num_env_steps_trained": 157080, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.00795733152343, "num_env_steps_trained_throughput_per_sec": 111.00795733152343, "timesteps_total": 157080, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 157080, "timers": {"training_iteration_time_ms": 3230.306, "sample_time_ms": 3219.657, "load_time_ms": 0.299, "load_throughput": 1202859.428, "learn_time_ms": 9.573, "learn_throughput": 37606.021, "synch_weights_time_ms": 0.732}, "counters": {"num_env_steps_sampled": 157080, "num_env_steps_trained": 157080, "num_agent_steps_sampled": 157080, "num_agent_steps_trained": 157080}, "done": false, "episodes_total": 917, "training_iteration": 186, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-47-58", "timestamp": 1691131678, "time_this_iter_s": 12.974907875061035, "time_total_s": 2064.2778720855713, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 334.44714522361755, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 21.978947368421053, "ram_util_percent": 63.921052631578945}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.05, "policy_entropy": -638.8569213867188, "policy_loss": -1878881051.525, "vf_loss": 131369468.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 533.0, "diff_num_grad_updates_vs_sampler_policy": 532.0}}, "num_env_steps_sampled": 158520, "num_env_steps_trained": 158520, "num_agent_steps_sampled": 158520, "num_agent_steps_trained": 158520}, "sampler_results": {"episode_reward_max": -5995.40001383304, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8901.924847791926, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.513545625945381, "mean_inference_ms": 0.36873407679055603, "mean_action_processing_ms": 0.09127118797799141, "mean_env_wait_ms": 1.087056620225105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00344085693359375, "StateBufferConnector_ms": 0.002593517303466797, "ViewRequirementAgentConnector_ms": 0.06622719764709473}}, "episode_reward_max": -5995.40001383304, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8901.924847791926, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5995.40001383304, -8903.829299285118, -8855.562604338034, -9071.540781892305, -8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.513545625945381, "mean_inference_ms": 0.36873407679055603, "mean_action_processing_ms": 0.09127118797799141, "mean_env_wait_ms": 1.087056620225105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00344085693359375, "StateBufferConnector_ms": 0.002593517303466797, "ViewRequirementAgentConnector_ms": 0.06622719764709473}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 158520, "num_agent_steps_trained": 158520, "num_env_steps_sampled": 158520, "num_env_steps_trained": 158520, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.46888701960002, "num_env_steps_trained_throughput_per_sec": 112.46888701960002, "timesteps_total": 158520, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 158520, "timers": {"training_iteration_time_ms": 3214.124, "sample_time_ms": 3203.492, "load_time_ms": 0.312, "load_throughput": 1154925.379, "learn_time_ms": 9.556, "learn_throughput": 37671.415, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 158520, "num_env_steps_trained": 158520, "num_agent_steps_sampled": 158520, "num_agent_steps_trained": 158520}, "done": false, "episodes_total": 921, "training_iteration": 187, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-48-10", "timestamp": 1691131690, "time_this_iter_s": 12.806216955184937, "time_total_s": 2077.084089040756, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 347.2533621788025, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 21.811111111111117, "ram_util_percent": 63.91111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.05, "policy_entropy": -640.981640625, "policy_loss": -768334235.275, "vf_loss": 131760572.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 553.0, "diff_num_grad_updates_vs_sampler_policy": 552.0}}, "num_env_steps_sampled": 159960, "num_env_steps_trained": 159960, "num_agent_steps_sampled": 159960, "num_agent_steps_trained": 159960}, "sampler_results": {"episode_reward_max": -8825.110291228948, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8930.905292053685, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5175451131957445, "mean_inference_ms": 0.36866995803677083, "mean_action_processing_ms": 0.0912561386293988, "mean_env_wait_ms": 1.0616658902399017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003449678421020508, "StateBufferConnector_ms": 0.002595663070678711, "ViewRequirementAgentConnector_ms": 0.0662531852722168}}, "episode_reward_max": -8825.110291228948, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8930.905292053685, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8987.581493271104, -8899.711164559956, -8948.742377044618, -8894.267876596907, -8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5175451131957445, "mean_inference_ms": 0.36866995803677083, "mean_action_processing_ms": 0.0912561386293988, "mean_env_wait_ms": 1.0616658902399017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003449678421020508, "StateBufferConnector_ms": 0.002595663070678711, "ViewRequirementAgentConnector_ms": 0.0662531852722168}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 159960, "num_agent_steps_trained": 159960, "num_env_steps_sampled": 159960, "num_env_steps_trained": 159960, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.798132269846, "num_env_steps_trained_throughput_per_sec": 110.798132269846, "timesteps_total": 159960, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 159960, "timers": {"training_iteration_time_ms": 3242.758, "sample_time_ms": 3232.122, "load_time_ms": 0.313, "load_throughput": 1150437.669, "learn_time_ms": 9.577, "learn_throughput": 37590.48, "synch_weights_time_ms": 0.702}, "counters": {"num_env_steps_sampled": 159960, "num_env_steps_trained": 159960, "num_agent_steps_sampled": 159960, "num_agent_steps_trained": 159960}, "done": false, "episodes_total": 925, "training_iteration": 188, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-48-24", "timestamp": 1691131704, "time_this_iter_s": 12.999566078186035, "time_total_s": 2090.0836551189423, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 360.2529282569885, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 19.138888888888893, "ram_util_percent": 63.87777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.05, "policy_entropy": -643.6571655273438, "policy_loss": -1217707868.275, "vf_loss": 129440681.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 573.0, "diff_num_grad_updates_vs_sampler_policy": 572.0}}, "num_env_steps_sampled": 161400, "num_env_steps_trained": 161400, "num_agent_steps_sampled": 161400, "num_agent_steps_trained": 161400}, "sampler_results": {"episode_reward_max": -8825.110291228948, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8930.379207499172, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.519479582647896, "mean_inference_ms": 0.3686031643845587, "mean_action_processing_ms": 0.09124136344882615, "mean_env_wait_ms": 1.0438028805223853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003449678421020508, "StateBufferConnector_ms": 0.0025949478149414062, "ViewRequirementAgentConnector_ms": 0.06621527671813965}}, "episode_reward_max": -8825.110291228948, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8930.379207499172, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8939.72114527803, -9005.134993193837, -8870.73773848045, -8909.922257295322, -8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.519479582647896, "mean_inference_ms": 0.3686031643845587, "mean_action_processing_ms": 0.09124136344882615, "mean_env_wait_ms": 1.0438028805223853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003449678421020508, "StateBufferConnector_ms": 0.0025949478149414062, "ViewRequirementAgentConnector_ms": 0.06621527671813965}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 161400, "num_agent_steps_trained": 161400, "num_env_steps_sampled": 161400, "num_env_steps_trained": 161400, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.80734460753169, "num_env_steps_trained_throughput_per_sec": 111.80734460753169, "timesteps_total": 161400, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 161400, "timers": {"training_iteration_time_ms": 3232.273, "sample_time_ms": 3221.579, "load_time_ms": 0.301, "load_throughput": 1196852.758, "learn_time_ms": 9.639, "learn_throughput": 37347.438, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 161400, "num_env_steps_trained": 161400, "num_agent_steps_sampled": 161400, "num_agent_steps_trained": 161400}, "done": false, "episodes_total": 929, "training_iteration": 189, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-48-36", "timestamp": 1691131716, "time_this_iter_s": 12.882237911224365, "time_total_s": 2102.9658930301666, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 373.1351661682129, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 20.299999999999997, "ram_util_percent": 63.85555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.05, "policy_entropy": -646.153466796875, "policy_loss": -4311343923.2, "vf_loss": 134396741.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 593.0, "diff_num_grad_updates_vs_sampler_policy": 592.0}}, "num_env_steps_sampled": 162840, "num_env_steps_trained": 162840, "num_agent_steps_sampled": 162840, "num_agent_steps_trained": 162840}, "sampler_results": {"episode_reward_max": -8825.110291228948, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8930.963081496093, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.52089268791679, "mean_inference_ms": 0.3685538857574456, "mean_action_processing_ms": 0.09122859294273963, "mean_env_wait_ms": 1.0303150362466296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034465789794921875, "StateBufferConnector_ms": 0.0025997161865234375, "ViewRequirementAgentConnector_ms": 0.06619524955749512}}, "episode_reward_max": -8825.110291228948, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8930.963081496093, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8999.67798563953, -8883.846361178294, -8961.547480826557, -8951.337170067309, -9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.52089268791679, "mean_inference_ms": 0.3685538857574456, "mean_action_processing_ms": 0.09122859294273963, "mean_env_wait_ms": 1.0303150362466296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034465789794921875, "StateBufferConnector_ms": 0.0025997161865234375, "ViewRequirementAgentConnector_ms": 0.06619524955749512}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 162840, "num_agent_steps_trained": 162840, "num_env_steps_sampled": 162840, "num_env_steps_trained": 162840, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.27663399977159, "num_env_steps_trained_throughput_per_sec": 110.27663399977159, "timesteps_total": 162840, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 162840, "timers": {"training_iteration_time_ms": 3237.841, "sample_time_ms": 3227.086, "load_time_ms": 0.302, "load_throughput": 1190999.716, "learn_time_ms": 9.682, "learn_throughput": 37182.814, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 162840, "num_env_steps_trained": 162840, "num_agent_steps_sampled": 162840, "num_agent_steps_trained": 162840}, "done": false, "episodes_total": 933, "training_iteration": 190, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-48-49", "timestamp": 1691131729, "time_this_iter_s": 13.060807228088379, "time_total_s": 2116.026700258255, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 386.19597339630127, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 19.42105263157895, "ram_util_percent": 63.584210526315786}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.05, "policy_entropy": -649.1641479492188, "policy_loss": -3288945679.175, "vf_loss": 134317352.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 613.0, "diff_num_grad_updates_vs_sampler_policy": 612.0}}, "num_env_steps_sampled": 164280, "num_env_steps_trained": 164280, "num_agent_steps_sampled": 164280, "num_agent_steps_trained": 164280}, "sampler_results": {"episode_reward_max": -8825.110291228948, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8931.925806256475, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.523235364806887, "mean_inference_ms": 0.3685101334649664, "mean_action_processing_ms": 0.09121795950928735, "mean_env_wait_ms": 1.0196060589029228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034432411193847656, "StateBufferConnector_ms": 0.0026035308837890625, "ViewRequirementAgentConnector_ms": 0.06624197959899902}}, "episode_reward_max": -8825.110291228948, "episode_reward_min": -9081.135421919753, "episode_reward_mean": -8931.925806256475, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9081.135421919753, -8880.499541772515, -8874.650266410345, -8898.030093798747, -8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.523235364806887, "mean_inference_ms": 0.3685101334649664, "mean_action_processing_ms": 0.09121795950928735, "mean_env_wait_ms": 1.0196060589029228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034432411193847656, "StateBufferConnector_ms": 0.0026035308837890625, "ViewRequirementAgentConnector_ms": 0.06624197959899902}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164280, "num_agent_steps_trained": 164280, "num_env_steps_sampled": 164280, "num_env_steps_trained": 164280, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.51831954635176, "num_env_steps_trained_throughput_per_sec": 110.51831954635176, "timesteps_total": 164280, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 164280, "timers": {"training_iteration_time_ms": 3255.51, "sample_time_ms": 3244.774, "load_time_ms": 0.305, "load_throughput": 1181309.216, "learn_time_ms": 9.659, "learn_throughput": 37272.671, "synch_weights_time_ms": 0.728}, "counters": {"num_env_steps_sampled": 164280, "num_env_steps_trained": 164280, "num_agent_steps_sampled": 164280, "num_agent_steps_trained": 164280}, "done": false, "episodes_total": 937, "training_iteration": 191, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-49-03", "timestamp": 1691131743, "time_this_iter_s": 13.032259941101074, "time_total_s": 2129.058960199356, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 399.22823333740234, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 22.16666666666667, "ram_util_percent": 63.62777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.7111111111111113e-06, "entropy_coeff": 0.05, "policy_entropy": -650.68076171875, "policy_loss": -931042189.65, "vf_loss": 134031332.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 633.0, "diff_num_grad_updates_vs_sampler_policy": 632.0}}, "num_env_steps_sampled": 165720, "num_env_steps_trained": 165720, "num_agent_steps_sampled": 165720, "num_agent_steps_trained": 165720}, "sampler_results": {"episode_reward_max": -8825.110291228948, "episode_reward_min": -9045.360696558068, "episode_reward_mean": -8933.36954502332, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.525268937415513, "mean_inference_ms": 0.36847716928106744, "mean_action_processing_ms": 0.09120970490996251, "mean_env_wait_ms": 1.010816843054611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034449100494384766, "StateBufferConnector_ms": 0.002602815628051758, "ViewRequirementAgentConnector_ms": 0.06620597839355469}}, "episode_reward_max": -8825.110291228948, "episode_reward_min": -9045.360696558068, "episode_reward_mean": -8933.36954502332, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8933.22687275342, -9027.827039331754, -8896.340381587514, -8923.919307597838, -8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.525268937415513, "mean_inference_ms": 0.36847716928106744, "mean_action_processing_ms": 0.09120970490996251, "mean_env_wait_ms": 1.010816843054611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034449100494384766, "StateBufferConnector_ms": 0.002602815628051758, "ViewRequirementAgentConnector_ms": 0.06620597839355469}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 165720, "num_agent_steps_trained": 165720, "num_env_steps_sampled": 165720, "num_env_steps_trained": 165720, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.76608000920196, "num_env_steps_trained_throughput_per_sec": 110.76608000920196, "timesteps_total": 165720, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 165720, "timers": {"training_iteration_time_ms": 3262.013, "sample_time_ms": 3251.213, "load_time_ms": 0.304, "load_throughput": 1184181.194, "learn_time_ms": 9.713, "learn_throughput": 37063.251, "synch_weights_time_ms": 0.737}, "counters": {"num_env_steps_sampled": 165720, "num_env_steps_trained": 165720, "num_agent_steps_sampled": 165720, "num_agent_steps_trained": 165720}, "done": false, "episodes_total": 941, "training_iteration": 192, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-49-16", "timestamp": 1691131756, "time_this_iter_s": 13.00316596031189, "time_total_s": 2142.062126159668, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 412.23139929771423, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 20.73157894736842, "ram_util_percent": 63.61578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.111111111111111e-06, "entropy_coeff": 0.05, "policy_entropy": -651.48427734375, "policy_loss": -1239443221.8, "vf_loss": 129519419.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 653.0, "diff_num_grad_updates_vs_sampler_policy": 652.0}}, "num_env_steps_sampled": 167160, "num_env_steps_trained": 167160, "num_agent_steps_sampled": 167160, "num_agent_steps_trained": 167160}, "sampler_results": {"episode_reward_max": -8825.110291228948, "episode_reward_min": -9045.360696558068, "episode_reward_mean": -8932.320022345335, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527226871723866, "mean_inference_ms": 0.3684607635489489, "mean_action_processing_ms": 0.09120454932379168, "mean_env_wait_ms": 1.0034372264695046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003457784652709961, "StateBufferConnector_ms": 0.0025911331176757812, "ViewRequirementAgentConnector_ms": 0.06614565849304199}}, "episode_reward_max": -8825.110291228948, "episode_reward_min": -9045.360696558068, "episode_reward_mean": -8932.320022345335, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8884.431106224536, -8922.807708174092, -8930.720355303463, -9022.885985984542, -8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.527226871723866, "mean_inference_ms": 0.3684607635489489, "mean_action_processing_ms": 0.09120454932379168, "mean_env_wait_ms": 1.0034372264695046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003457784652709961, "StateBufferConnector_ms": 0.0025911331176757812, "ViewRequirementAgentConnector_ms": 0.06614565849304199}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 167160, "num_agent_steps_trained": 167160, "num_env_steps_sampled": 167160, "num_env_steps_trained": 167160, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.20009634227623, "num_env_steps_trained_throughput_per_sec": 111.20009634227623, "timesteps_total": 167160, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 167160, "timers": {"training_iteration_time_ms": 3244.501, "sample_time_ms": 3233.739, "load_time_ms": 0.306, "load_throughput": 1175881.505, "learn_time_ms": 9.679, "learn_throughput": 37193.896, "synch_weights_time_ms": 0.731}, "counters": {"num_env_steps_sampled": 167160, "num_env_steps_trained": 167160, "num_agent_steps_sampled": 167160, "num_agent_steps_trained": 167160}, "done": false, "episodes_total": 945, "training_iteration": 193, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-49-29", "timestamp": 1691131769, "time_this_iter_s": 12.95251178741455, "time_total_s": 2155.0146379470825, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 425.1839110851288, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 19.538888888888888, "ram_util_percent": 63.566666666666656}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": -651.8878540039062, "policy_loss": -1858093143.025, "vf_loss": 131660218.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 673.0, "diff_num_grad_updates_vs_sampler_policy": 672.0}}, "num_env_steps_sampled": 168600, "num_env_steps_trained": 168600, "num_agent_steps_sampled": 168600, "num_agent_steps_trained": 168600}, "sampler_results": {"episode_reward_max": -8825.110291228948, "episode_reward_min": -9045.360696558068, "episode_reward_mean": -8930.841864644335, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528522594567214, "mean_inference_ms": 0.3684359317332342, "mean_action_processing_ms": 0.0911967948547936, "mean_env_wait_ms": 0.9969639776368178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034580230712890625, "StateBufferConnector_ms": 0.002587556838989258, "ViewRequirementAgentConnector_ms": 0.06613278388977051}}, "episode_reward_max": -8825.110291228948, "episode_reward_min": -9045.360696558068, "episode_reward_mean": -8930.841864644335, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8980.541512208514, -8915.762866852552, -8881.188449035717, -8932.244318708636, -8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.528522594567214, "mean_inference_ms": 0.3684359317332342, "mean_action_processing_ms": 0.0911967948547936, "mean_env_wait_ms": 0.9969639776368178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034580230712890625, "StateBufferConnector_ms": 0.002587556838989258, "ViewRequirementAgentConnector_ms": 0.06613278388977051}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168600, "num_agent_steps_trained": 168600, "num_env_steps_sampled": 168600, "num_env_steps_trained": 168600, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 113.45739262687474, "num_env_steps_trained_throughput_per_sec": 113.45739262687474, "timesteps_total": 168600, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 168600, "timers": {"training_iteration_time_ms": 3211.059, "sample_time_ms": 3200.42, "load_time_ms": 0.299, "load_throughput": 1205644.714, "learn_time_ms": 9.588, "learn_throughput": 37546.081, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 168600, "num_env_steps_trained": 168600, "num_agent_steps_sampled": 168600, "num_agent_steps_trained": 168600}, "done": false, "episodes_total": 949, "training_iteration": 194, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-49-41", "timestamp": 1691131781, "time_this_iter_s": 12.694700717926025, "time_total_s": 2167.7093386650085, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 437.8786118030548, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 21.755555555555556, "ram_util_percent": 63.65555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": -652.3682983398437, "policy_loss": -2250279307.5375, "vf_loss": 129539888.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 693.0, "diff_num_grad_updates_vs_sampler_policy": 692.0}}, "num_env_steps_sampled": 170040, "num_env_steps_trained": 170040, "num_agent_steps_sampled": 170040, "num_agent_steps_trained": 170040}, "sampler_results": {"episode_reward_max": -8798.502234096604, "episode_reward_min": -9045.360696558068, "episode_reward_mean": -8929.993698194836, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.529511310695198, "mean_inference_ms": 0.3684187740824929, "mean_action_processing_ms": 0.0911910240653855, "mean_env_wait_ms": 0.9913211746426203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003452777862548828, "StateBufferConnector_ms": 0.00258636474609375, "ViewRequirementAgentConnector_ms": 0.06606578826904297}}, "episode_reward_max": -8798.502234096604, "episode_reward_min": -9045.360696558068, "episode_reward_mean": -8929.993698194836, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8963.403081644472, -8923.203657291107, -8995.009676039606, -8923.110859567789, -8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.529511310695198, "mean_inference_ms": 0.3684187740824929, "mean_action_processing_ms": 0.0911910240653855, "mean_env_wait_ms": 0.9913211746426203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003452777862548828, "StateBufferConnector_ms": 0.00258636474609375, "ViewRequirementAgentConnector_ms": 0.06606578826904297}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 170040, "num_agent_steps_trained": 170040, "num_env_steps_sampled": 170040, "num_env_steps_trained": 170040, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.68693309647003, "num_env_steps_trained_throughput_per_sec": 110.68693309647003, "timesteps_total": 170040, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 170040, "timers": {"training_iteration_time_ms": 3223.994, "sample_time_ms": 3213.327, "load_time_ms": 0.299, "load_throughput": 1203051.103, "learn_time_ms": 9.608, "learn_throughput": 37469.216, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 170040, "num_env_steps_trained": 170040, "num_agent_steps_sampled": 170040, "num_agent_steps_trained": 170040}, "done": false, "episodes_total": 953, "training_iteration": 195, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-49-54", "timestamp": 1691131794, "time_this_iter_s": 13.012468099594116, "time_total_s": 2180.7218067646027, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 450.8910799026489, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 20.48421052631579, "ram_util_percent": 63.81578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": -652.464599609375, "policy_loss": -4351383939.5, "vf_loss": 129143189.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 713.0, "diff_num_grad_updates_vs_sampler_policy": 712.0}}, "num_env_steps_sampled": 171480, "num_env_steps_trained": 171480, "num_agent_steps_sampled": 171480, "num_agent_steps_trained": 171480}, "sampler_results": {"episode_reward_max": -8798.502234096604, "episode_reward_min": -9045.360696558068, "episode_reward_mean": -8928.032318538779, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.530063777027501, "mean_inference_ms": 0.36840570937235984, "mean_action_processing_ms": 0.09118722537643956, "mean_env_wait_ms": 0.9864215561854794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034570693969726562, "StateBufferConnector_ms": 0.002594470977783203, "ViewRequirementAgentConnector_ms": 0.06624388694763184}}, "episode_reward_max": -8798.502234096604, "episode_reward_min": -9045.360696558068, "episode_reward_mean": -8928.032318538779, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8891.471410382526, -8967.99966162155, -8943.928873209892, -8904.105864518002, -8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.530063777027501, "mean_inference_ms": 0.36840570937235984, "mean_action_processing_ms": 0.09118722537643956, "mean_env_wait_ms": 0.9864215561854794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034570693969726562, "StateBufferConnector_ms": 0.002594470977783203, "ViewRequirementAgentConnector_ms": 0.06624388694763184}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 171480, "num_agent_steps_trained": 171480, "num_env_steps_sampled": 171480, "num_env_steps_trained": 171480, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.82949533935899, "num_env_steps_trained_throughput_per_sec": 111.82949533935899, "timesteps_total": 171480, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 171480, "timers": {"training_iteration_time_ms": 3224.671, "sample_time_ms": 3214.052, "load_time_ms": 0.299, "load_throughput": 1202955.258, "learn_time_ms": 9.566, "learn_throughput": 37632.921, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 171480, "num_env_steps_trained": 171480, "num_agent_steps_sampled": 171480, "num_agent_steps_trained": 171480}, "done": false, "episodes_total": 957, "training_iteration": 196, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-50-07", "timestamp": 1691131807, "time_this_iter_s": 12.879520177841187, "time_total_s": 2193.601326942444, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 463.7706000804901, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 20.57222222222222, "ram_util_percent": 64.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": -652.7787109375, "policy_loss": -2027254121.1, "vf_loss": 132874691.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 733.0, "diff_num_grad_updates_vs_sampler_policy": 732.0}}, "num_env_steps_sampled": 172920, "num_env_steps_trained": 172920, "num_agent_steps_sampled": 172920, "num_agent_steps_trained": 172920}, "sampler_results": {"episode_reward_max": -8793.655782670709, "episode_reward_min": -9045.360696558068, "episode_reward_mean": -8925.998229734369, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5307686397773015, "mean_inference_ms": 0.36839726364859976, "mean_action_processing_ms": 0.0911835297332345, "mean_env_wait_ms": 0.9820790128948744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034537315368652344, "StateBufferConnector_ms": 0.002596139907836914, "ViewRequirementAgentConnector_ms": 0.0661764144897461}}, "episode_reward_max": -8793.655782670709, "episode_reward_min": -9045.360696558068, "episode_reward_mean": -8925.998229734369, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8893.957471781005, -9015.627866260089, -8950.969425026962, -8979.779538889243, -8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5307686397773015, "mean_inference_ms": 0.36839726364859976, "mean_action_processing_ms": 0.0911835297332345, "mean_env_wait_ms": 0.9820790128948744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034537315368652344, "StateBufferConnector_ms": 0.002596139907836914, "ViewRequirementAgentConnector_ms": 0.0661764144897461}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172920, "num_agent_steps_trained": 172920, "num_env_steps_sampled": 172920, "num_env_steps_trained": 172920, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.41429929141627, "num_env_steps_trained_throughput_per_sec": 110.41429929141627, "timesteps_total": 172920, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 172920, "timers": {"training_iteration_time_ms": 3235.794, "sample_time_ms": 3225.22, "load_time_ms": 0.303, "load_throughput": 1188281.609, "learn_time_ms": 9.519, "learn_throughput": 37819.648, "synch_weights_time_ms": 0.707}, "counters": {"num_env_steps_sampled": 172920, "num_env_steps_trained": 172920, "num_agent_steps_sampled": 172920, "num_agent_steps_trained": 172920}, "done": false, "episodes_total": 961, "training_iteration": 197, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-50-20", "timestamp": 1691131820, "time_this_iter_s": 13.044402360916138, "time_total_s": 2206.64572930336, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 476.81500244140625, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 19.75, "ram_util_percent": 64.01666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": -653.3270751953125, "policy_loss": -687660432.575, "vf_loss": 131066306.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 753.0, "diff_num_grad_updates_vs_sampler_policy": 752.0}}, "num_env_steps_sampled": 174360, "num_env_steps_trained": 174360, "num_agent_steps_sampled": 174360, "num_agent_steps_trained": 174360}, "sampler_results": {"episode_reward_max": -8793.655782670709, "episode_reward_min": -9045.360696558068, "episode_reward_mean": -8924.142945489195, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.532056902333109, "mean_inference_ms": 0.36838383668728425, "mean_action_processing_ms": 0.09117888871253096, "mean_env_wait_ms": 0.9779956917966467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034487247467041016, "StateBufferConnector_ms": 0.0025975704193115234, "ViewRequirementAgentConnector_ms": 0.06613707542419434}}, "episode_reward_max": -8793.655782670709, "episode_reward_min": -9045.360696558068, "episode_reward_mean": -8924.142945489195, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8875.821045703025, -8908.983094505276, -9003.575228397727, -8948.083482853815, -8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.532056902333109, "mean_inference_ms": 0.36838383668728425, "mean_action_processing_ms": 0.09117888871253096, "mean_env_wait_ms": 0.9779956917966467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034487247467041016, "StateBufferConnector_ms": 0.0025975704193115234, "ViewRequirementAgentConnector_ms": 0.06613707542419434}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 174360, "num_agent_steps_trained": 174360, "num_env_steps_sampled": 174360, "num_env_steps_trained": 174360, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.11302405250716, "num_env_steps_trained_throughput_per_sec": 111.11302405250716, "timesteps_total": 174360, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 174360, "timers": {"training_iteration_time_ms": 3256.294, "sample_time_ms": 3245.698, "load_time_ms": 0.304, "load_throughput": 1185482.798, "learn_time_ms": 9.537, "learn_throughput": 37746.66, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 174360, "num_env_steps_trained": 174360, "num_agent_steps_sampled": 174360, "num_agent_steps_trained": 174360}, "done": false, "episodes_total": 965, "training_iteration": 198, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-50-33", "timestamp": 1691131833, "time_this_iter_s": 12.962565898895264, "time_total_s": 2219.6082952022552, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 489.7775683403015, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 20.457894736842103, "ram_util_percent": 63.87894736842105}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": -653.5797729492188, "policy_loss": -1961455044.6, "vf_loss": 134095153.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 773.0, "diff_num_grad_updates_vs_sampler_policy": 772.0}}, "num_env_steps_sampled": 175800, "num_env_steps_trained": 175800, "num_agent_steps_sampled": 175800, "num_agent_steps_trained": 175800}, "sampler_results": {"episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8924.714797988154, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.533105050249528, "mean_inference_ms": 0.3683707105832972, "mean_action_processing_ms": 0.09117485418183868, "mean_env_wait_ms": 0.9742601016263609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003447294235229492, "StateBufferConnector_ms": 0.002599477767944336, "ViewRequirementAgentConnector_ms": 0.0661475658416748}}, "episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8924.714797988154, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8899.711164559956, -8895.467622460912, -8899.711164559956, -8949.095215240624, -8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.533105050249528, "mean_inference_ms": 0.3683707105832972, "mean_action_processing_ms": 0.09117485418183868, "mean_env_wait_ms": 0.9742601016263609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003447294235229492, "StateBufferConnector_ms": 0.002599477767944336, "ViewRequirementAgentConnector_ms": 0.0661475658416748}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 175800, "num_agent_steps_trained": 175800, "num_env_steps_sampled": 175800, "num_env_steps_trained": 175800, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.87568990761359, "num_env_steps_trained_throughput_per_sec": 110.87568990761359, "timesteps_total": 175800, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 175800, "timers": {"training_iteration_time_ms": 3253.958, "sample_time_ms": 3243.362, "load_time_ms": 0.3, "load_throughput": 1200850.517, "learn_time_ms": 9.531, "learn_throughput": 37772.155, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 175800, "num_env_steps_trained": 175800, "num_agent_steps_sampled": 175800, "num_agent_steps_trained": 175800}, "done": false, "episodes_total": 969, "training_iteration": 199, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-50-46", "timestamp": 1691131846, "time_this_iter_s": 12.990201950073242, "time_total_s": 2232.5984971523285, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 502.76777029037476, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 19.505555555555556, "ram_util_percent": 63.64999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": -654.0732421875, "policy_loss": -2160876281.475, "vf_loss": 130631028.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 793.0, "diff_num_grad_updates_vs_sampler_policy": 792.0}}, "num_env_steps_sampled": 177240, "num_env_steps_trained": 177240, "num_agent_steps_sampled": 177240, "num_agent_steps_trained": 177240}, "sampler_results": {"episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8924.899633846282, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.534262083862082, "mean_inference_ms": 0.368361129704697, "mean_action_processing_ms": 0.09117158407374898, "mean_env_wait_ms": 0.9709715424690981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034406185150146484, "StateBufferConnector_ms": 0.002587556838989258, "ViewRequirementAgentConnector_ms": 0.06601214408874512}}, "episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8924.899633846282, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8865.463378463508, -8933.722203725642, -8895.658854602045, -8884.882967787293, -9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.534262083862082, "mean_inference_ms": 0.368361129704697, "mean_action_processing_ms": 0.09117158407374898, "mean_env_wait_ms": 0.9709715424690981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034406185150146484, "StateBufferConnector_ms": 0.002587556838989258, "ViewRequirementAgentConnector_ms": 0.06601214408874512}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 177240, "num_agent_steps_trained": 177240, "num_env_steps_sampled": 177240, "num_env_steps_trained": 177240, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.33790159111668, "num_env_steps_trained_throughput_per_sec": 110.33790159111668, "timesteps_total": 177240, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 177240, "timers": {"training_iteration_time_ms": 3244.631, "sample_time_ms": 3233.925, "load_time_ms": 0.301, "load_throughput": 1194863.844, "learn_time_ms": 9.65, "learn_throughput": 37304.624, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 177240, "num_env_steps_trained": 177240, "num_agent_steps_sampled": 177240, "num_agent_steps_trained": 177240}, "done": false, "episodes_total": 973, "training_iteration": 200, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-50-59", "timestamp": 1691131859, "time_this_iter_s": 13.053590059280396, "time_total_s": 2245.652087211609, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 515.8213603496552, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 18.405263157894737, "ram_util_percent": 63.678947368421056}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.05, "policy_entropy": -654.3909912109375, "policy_loss": -3768541731.575, "vf_loss": 136226776.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 813.0, "diff_num_grad_updates_vs_sampler_policy": 812.0}}, "num_env_steps_sampled": 178680, "num_env_steps_trained": 178680, "num_agent_steps_sampled": 178680, "num_agent_steps_trained": 178680}, "sampler_results": {"episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8927.22861159948, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.535563985530424, "mean_inference_ms": 0.36836015303945346, "mean_action_processing_ms": 0.0911692646061306, "mean_env_wait_ms": 0.9680714476350988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034356117248535156, "StateBufferConnector_ms": 0.002588987350463867, "ViewRequirementAgentConnector_ms": 0.0660097599029541}}, "episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8927.22861159948, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9000.336539290398, -8896.583294233198, -8947.143544676343, -8914.429377747852, -9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.535563985530424, "mean_inference_ms": 0.36836015303945346, "mean_action_processing_ms": 0.0911692646061306, "mean_env_wait_ms": 0.9680714476350988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034356117248535156, "StateBufferConnector_ms": 0.002588987350463867, "ViewRequirementAgentConnector_ms": 0.0660097599029541}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 178680, "num_agent_steps_trained": 178680, "num_env_steps_sampled": 178680, "num_env_steps_trained": 178680, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.18715667284636, "num_env_steps_trained_throughput_per_sec": 111.18715667284636, "timesteps_total": 178680, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 178680, "timers": {"training_iteration_time_ms": 3245.429, "sample_time_ms": 3234.655, "load_time_ms": 0.301, "load_throughput": 1194769.299, "learn_time_ms": 9.723, "learn_throughput": 37024.173, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 178680, "num_env_steps_trained": 178680, "num_agent_steps_sampled": 178680, "num_agent_steps_trained": 178680}, "done": false, "episodes_total": 977, "training_iteration": 201, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-51-12", "timestamp": 1691131872, "time_this_iter_s": 12.954101085662842, "time_total_s": 2258.6061882972717, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 528.775461435318, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 20.833333333333332, "ram_util_percent": 63.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.388888888888888e-07, "entropy_coeff": 0.05, "policy_entropy": -654.9578491210938, "policy_loss": -1425458623.925, "vf_loss": 133899702.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 833.0, "diff_num_grad_updates_vs_sampler_policy": 832.0}}, "num_env_steps_sampled": 180120, "num_env_steps_trained": 180120, "num_agent_steps_sampled": 180120, "num_agent_steps_trained": 180120}, "sampler_results": {"episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8927.93397307453, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.537001706716683, "mean_inference_ms": 0.3683597216871605, "mean_action_processing_ms": 0.09116698932148402, "mean_env_wait_ms": 0.9653572097961294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034313201904296875, "StateBufferConnector_ms": 0.0025937557220458984, "ViewRequirementAgentConnector_ms": 0.0660257339477539}}, "episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8927.93397307453, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9036.869488423938, -9009.016219236557, -8873.817382621153, -9002.425932603988, -8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.537001706716683, "mean_inference_ms": 0.3683597216871605, "mean_action_processing_ms": 0.09116698932148402, "mean_env_wait_ms": 0.9653572097961294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034313201904296875, "StateBufferConnector_ms": 0.0025937557220458984, "ViewRequirementAgentConnector_ms": 0.0660257339477539}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180120, "num_agent_steps_trained": 180120, "num_env_steps_sampled": 180120, "num_env_steps_trained": 180120, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.2594330066286, "num_env_steps_trained_throughput_per_sec": 111.2594330066286, "timesteps_total": 180120, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 180120, "timers": {"training_iteration_time_ms": 3244.407, "sample_time_ms": 3233.619, "load_time_ms": 0.302, "load_throughput": 1191845.797, "learn_time_ms": 9.724, "learn_throughput": 37020.814, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 180120, "num_env_steps_trained": 180120, "num_agent_steps_sampled": 180120, "num_agent_steps_trained": 180120}, "done": false, "episodes_total": 981, "training_iteration": 202, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-51-25", "timestamp": 1691131885, "time_this_iter_s": 12.945428848266602, "time_total_s": 2271.5516171455383, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 541.7208902835846, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 19.083333333333336, "ram_util_percent": 63.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.388888888888889e-07, "entropy_coeff": 0.05, "policy_entropy": -655.46943359375, "policy_loss": -1550232899.2, "vf_loss": 130046753.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 853.0, "diff_num_grad_updates_vs_sampler_policy": 852.0}}, "num_env_steps_sampled": 181560, "num_env_steps_trained": 181560, "num_agent_steps_sampled": 181560, "num_agent_steps_trained": 181560}, "sampler_results": {"episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8926.066434390701, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538194263304486, "mean_inference_ms": 0.3683626354024684, "mean_action_processing_ms": 0.09116574734380169, "mean_env_wait_ms": 0.9628362029574398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003431558609008789, "StateBufferConnector_ms": 0.0025997161865234375, "ViewRequirementAgentConnector_ms": 0.06607222557067871}}, "episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8926.066434390701, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8906.652103402153, -8907.966100738638, -8853.913653562893, -8885.785555437897, -8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.538194263304486, "mean_inference_ms": 0.3683626354024684, "mean_action_processing_ms": 0.09116574734380169, "mean_env_wait_ms": 0.9628362029574398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003431558609008789, "StateBufferConnector_ms": 0.0025997161865234375, "ViewRequirementAgentConnector_ms": 0.06607222557067871}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 181560, "num_agent_steps_trained": 181560, "num_env_steps_sampled": 181560, "num_env_steps_trained": 181560, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.07955301919858, "num_env_steps_trained_throughput_per_sec": 112.07955301919858, "timesteps_total": 181560, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 181560, "timers": {"training_iteration_time_ms": 3226.361, "sample_time_ms": 3215.536, "load_time_ms": 0.303, "load_throughput": 1189873.475, "learn_time_ms": 9.754, "learn_throughput": 36908.514, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 181560, "num_env_steps_trained": 181560, "num_agent_steps_sampled": 181560, "num_agent_steps_trained": 181560}, "done": false, "episodes_total": 985, "training_iteration": 203, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-51-38", "timestamp": 1691131898, "time_this_iter_s": 12.850796699523926, "time_total_s": 2284.4024138450623, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 554.5716869831085, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 20.500000000000004, "ram_util_percent": 63.67894736842104}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.05, "policy_entropy": -655.5293579101562, "policy_loss": -1325702053.6, "vf_loss": 131056064.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 873.0, "diff_num_grad_updates_vs_sampler_policy": 872.0}}, "num_env_steps_sampled": 183000, "num_env_steps_trained": 183000, "num_agent_steps_sampled": 183000, "num_agent_steps_trained": 183000}, "sampler_results": {"episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8926.140388223299, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.539421253919673, "mean_inference_ms": 0.3683636464309636, "mean_action_processing_ms": 0.09116428003026207, "mean_env_wait_ms": 0.9605041477960172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003432750701904297, "StateBufferConnector_ms": 0.002597808837890625, "ViewRequirementAgentConnector_ms": 0.0660088062286377}}, "episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8926.140388223299, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8985.251850252478, -8969.596463207687, -8990.768213971496, -8962.542614778169, -8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.539421253919673, "mean_inference_ms": 0.3683636464309636, "mean_action_processing_ms": 0.09116428003026207, "mean_env_wait_ms": 0.9605041477960172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003432750701904297, "StateBufferConnector_ms": 0.002597808837890625, "ViewRequirementAgentConnector_ms": 0.0660088062286377}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 183000, "num_agent_steps_trained": 183000, "num_env_steps_sampled": 183000, "num_env_steps_trained": 183000, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.11295455228645, "num_env_steps_trained_throughput_per_sec": 111.11295455228645, "timesteps_total": 183000, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 183000, "timers": {"training_iteration_time_ms": 3219.657, "sample_time_ms": 3208.867, "load_time_ms": 0.302, "load_throughput": 1191751.728, "learn_time_ms": 9.727, "learn_throughput": 37011.377, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 183000, "num_env_steps_trained": 183000, "num_agent_steps_sampled": 183000, "num_agent_steps_trained": 183000}, "done": false, "episodes_total": 989, "training_iteration": 204, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-51-51", "timestamp": 1691131911, "time_this_iter_s": 12.96259093284607, "time_total_s": 2297.3650047779083, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 567.5342779159546, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 21.422222222222228, "ram_util_percent": 63.77777777777779}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.05, "policy_entropy": -655.7368286132812, "policy_loss": 1484366.375, "vf_loss": 130627992.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 893.0, "diff_num_grad_updates_vs_sampler_policy": 892.0}}, "num_env_steps_sampled": 184440, "num_env_steps_trained": 184440, "num_agent_steps_sampled": 184440, "num_agent_steps_trained": 184440}, "sampler_results": {"episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8922.843130263405, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.540890341632351, "mean_inference_ms": 0.368367557501813, "mean_action_processing_ms": 0.0911635146198767, "mean_env_wait_ms": 0.9582625982048364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003430604934692383, "StateBufferConnector_ms": 0.002599954605102539, "ViewRequirementAgentConnector_ms": 0.06607770919799805}}, "episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8922.843130263405, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8902.85436355833, -8931.077525045792, -8963.286228768382, -8825.110291228948, -8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.540890341632351, "mean_inference_ms": 0.368367557501813, "mean_action_processing_ms": 0.0911635146198767, "mean_env_wait_ms": 0.9582625982048364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003430604934692383, "StateBufferConnector_ms": 0.002599954605102539, "ViewRequirementAgentConnector_ms": 0.06607770919799805}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184440, "num_agent_steps_trained": 184440, "num_env_steps_sampled": 184440, "num_env_steps_trained": 184440, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.39225654776018, "num_env_steps_trained_throughput_per_sec": 111.39225654776018, "timesteps_total": 184440, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 184440, "timers": {"training_iteration_time_ms": 3245.628, "sample_time_ms": 3234.905, "load_time_ms": 0.3, "load_throughput": 1199038.704, "learn_time_ms": 9.684, "learn_throughput": 37175.856, "synch_weights_time_ms": 0.695}, "counters": {"num_env_steps_sampled": 184440, "num_env_steps_trained": 184440, "num_agent_steps_sampled": 184440, "num_agent_steps_trained": 184440}, "done": false, "episodes_total": 993, "training_iteration": 205, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-52-04", "timestamp": 1691131924, "time_this_iter_s": 12.930003881454468, "time_total_s": 2310.295008659363, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 580.4642817974091, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 21.816666666666663, "ram_util_percent": 63.96111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.05, "policy_entropy": -655.85126953125, "policy_loss": -3130735689.3, "vf_loss": 129430156.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 913.0, "diff_num_grad_updates_vs_sampler_policy": 912.0}}, "num_env_steps_sampled": 185880, "num_env_steps_trained": 185880, "num_agent_steps_sampled": 185880, "num_agent_steps_trained": 185880}, "sampler_results": {"episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8921.547138008928, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.542333920337155, "mean_inference_ms": 0.36837267730681345, "mean_action_processing_ms": 0.09116289841473366, "mean_env_wait_ms": 0.9561974886605534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003431081771850586, "StateBufferConnector_ms": 0.002591848373413086, "ViewRequirementAgentConnector_ms": 0.06613922119140625}}, "episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8921.547138008928, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8896.785853957976, -8920.684477211425, -8903.832628596168, -8899.711164559956, -8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.542333920337155, "mean_inference_ms": 0.36837267730681345, "mean_action_processing_ms": 0.09116289841473366, "mean_env_wait_ms": 0.9561974886605534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003431081771850586, "StateBufferConnector_ms": 0.002591848373413086, "ViewRequirementAgentConnector_ms": 0.06613922119140625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 185880, "num_agent_steps_trained": 185880, "num_env_steps_sampled": 185880, "num_env_steps_trained": 185880, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.02945226360842, "num_env_steps_trained_throughput_per_sec": 110.02945226360842, "timesteps_total": 185880, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 185880, "timers": {"training_iteration_time_ms": 3254.383, "sample_time_ms": 3243.666, "load_time_ms": 0.3, "load_throughput": 1200659.542, "learn_time_ms": 9.669, "learn_throughput": 37231.773, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 185880, "num_env_steps_trained": 185880, "num_agent_steps_sampled": 185880, "num_agent_steps_trained": 185880}, "done": false, "episodes_total": 997, "training_iteration": 206, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-52-17", "timestamp": 1691131937, "time_this_iter_s": 13.09014105796814, "time_total_s": 2323.385149717331, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 593.5544228553772, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 22.942105263157895, "ram_util_percent": 63.92105263157894}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.194444444444444e-07, "entropy_coeff": 0.05, "policy_entropy": -655.9671020507812, "policy_loss": -1987636995.1625, "vf_loss": 132447828.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 933.0, "diff_num_grad_updates_vs_sampler_policy": 932.0}}, "num_env_steps_sampled": 187320, "num_env_steps_trained": 187320, "num_agent_steps_sampled": 187320, "num_agent_steps_trained": 187320}, "sampler_results": {"episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8922.427671630032, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.543806833095481, "mean_inference_ms": 0.3683768091064249, "mean_action_processing_ms": 0.09116248822824033, "mean_env_wait_ms": 0.954339687969198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034265518188476562, "StateBufferConnector_ms": 0.002593994140625, "ViewRequirementAgentConnector_ms": 0.06603622436523438}}, "episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8922.427671630032, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8882.420573165478, -8870.169730690133, -8932.007357764058, -8983.356928134108, -8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.543806833095481, "mean_inference_ms": 0.3683768091064249, "mean_action_processing_ms": 0.09116248822824033, "mean_env_wait_ms": 0.954339687969198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034265518188476562, "StateBufferConnector_ms": 0.002593994140625, "ViewRequirementAgentConnector_ms": 0.06603622436523438}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 187320, "num_agent_steps_trained": 187320, "num_env_steps_sampled": 187320, "num_env_steps_trained": 187320, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.42482272245977, "num_env_steps_trained_throughput_per_sec": 110.42482272245977, "timesteps_total": 187320, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 187320, "timers": {"training_iteration_time_ms": 3246.317, "sample_time_ms": 3235.624, "load_time_ms": 0.3, "load_throughput": 1199610.265, "learn_time_ms": 9.624, "learn_throughput": 37404.799, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 187320, "num_env_steps_trained": 187320, "num_agent_steps_sampled": 187320, "num_agent_steps_trained": 187320}, "done": false, "episodes_total": 1001, "training_iteration": 207, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-52-30", "timestamp": 1691131950, "time_this_iter_s": 13.043301105499268, "time_total_s": 2336.42845082283, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 606.5977239608765, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 19.555555555555557, "ram_util_percent": 63.98333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.1944444444444447e-07, "entropy_coeff": 0.05, "policy_entropy": -655.856396484375, "policy_loss": -3389531129.45, "vf_loss": 135433721.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 953.0, "diff_num_grad_updates_vs_sampler_policy": 952.0}}, "num_env_steps_sampled": 188760, "num_env_steps_trained": 188760, "num_agent_steps_sampled": 188760, "num_agent_steps_trained": 188760}, "sampler_results": {"episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8923.576075208046, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.545026810721956, "mean_inference_ms": 0.3683817127464178, "mean_action_processing_ms": 0.0911616845580312, "mean_env_wait_ms": 0.9526141096846171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034258365631103516, "StateBufferConnector_ms": 0.0026013851165771484, "ViewRequirementAgentConnector_ms": 0.06607699394226074}}, "episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8923.576075208046, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8923.765575846139, -8842.719253762261, -8962.717354596818, -8939.56120858288, -8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.545026810721956, "mean_inference_ms": 0.3683817127464178, "mean_action_processing_ms": 0.0911616845580312, "mean_env_wait_ms": 0.9526141096846171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034258365631103516, "StateBufferConnector_ms": 0.0026013851165771484, "ViewRequirementAgentConnector_ms": 0.06607699394226074}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188760, "num_agent_steps_trained": 188760, "num_env_steps_sampled": 188760, "num_env_steps_trained": 188760, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.73496191781481, "num_env_steps_trained_throughput_per_sec": 110.73496191781481, "timesteps_total": 188760, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 188760, "timers": {"training_iteration_time_ms": 3267.995, "sample_time_ms": 3257.338, "load_time_ms": 0.3, "load_throughput": 1198372.571, "learn_time_ms": 9.591, "learn_throughput": 37534.788, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 188760, "num_env_steps_trained": 188760, "num_agent_steps_sampled": 188760, "num_agent_steps_trained": 188760}, "done": false, "episodes_total": 1005, "training_iteration": 208, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-52-43", "timestamp": 1691131963, "time_this_iter_s": 13.006989002227783, "time_total_s": 2349.435439825058, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 619.6047129631042, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 21.173684210526314, "ram_util_percent": 63.63157894736841}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-07, "entropy_coeff": 0.05, "policy_entropy": -656.1557739257812, "policy_loss": -3712048704.0, "vf_loss": 127965514.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 973.0, "diff_num_grad_updates_vs_sampler_policy": 972.0}}, "num_env_steps_sampled": 190200, "num_env_steps_trained": 190200, "num_agent_steps_sampled": 190200, "num_agent_steps_trained": 190200}, "sampler_results": {"episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8922.321614851657, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.546164958432139, "mean_inference_ms": 0.36839242297224956, "mean_action_processing_ms": 0.09116207996233047, "mean_env_wait_ms": 0.9510570214593224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003420591354370117, "StateBufferConnector_ms": 0.0025975704193115234, "ViewRequirementAgentConnector_ms": 0.06608176231384277}}, "episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8922.321614851657, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8985.436868861694, -8956.481014964138, -8935.620602487987, -8874.653081651846, -8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.546164958432139, "mean_inference_ms": 0.36839242297224956, "mean_action_processing_ms": 0.09116207996233047, "mean_env_wait_ms": 0.9510570214593224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003420591354370117, "StateBufferConnector_ms": 0.0025975704193115234, "ViewRequirementAgentConnector_ms": 0.06608176231384277}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 190200, "num_agent_steps_trained": 190200, "num_env_steps_sampled": 190200, "num_env_steps_trained": 190200, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.61231313035563, "num_env_steps_trained_throughput_per_sec": 110.61231313035563, "timesteps_total": 190200, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 190200, "timers": {"training_iteration_time_ms": 3254.733, "sample_time_ms": 3244.045, "load_time_ms": 0.3, "load_throughput": 1201137.093, "learn_time_ms": 9.618, "learn_throughput": 37430.669, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 190200, "num_env_steps_trained": 190200, "num_agent_steps_sampled": 190200, "num_agent_steps_trained": 190200}, "done": false, "episodes_total": 1009, "training_iteration": 209, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-52-56", "timestamp": 1691131976, "time_this_iter_s": 13.021350860595703, "time_total_s": 2362.4567906856537, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 632.6260638237, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 19.383333333333333, "ram_util_percent": 63.633333333333326}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-07, "entropy_coeff": 0.05, "policy_entropy": -656.16943359375, "policy_loss": -1819892652.2375, "vf_loss": 131989869.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 993.0, "diff_num_grad_updates_vs_sampler_policy": 992.0}}, "num_env_steps_sampled": 191640, "num_env_steps_trained": 191640, "num_agent_steps_sampled": 191640, "num_agent_steps_trained": 191640}, "sampler_results": {"episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8921.514039195303, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.547288776903204, "mean_inference_ms": 0.36840461398033236, "mean_action_processing_ms": 0.09116295787799902, "mean_env_wait_ms": 0.9495132053981815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003419160842895508, "StateBufferConnector_ms": 0.002598285675048828, "ViewRequirementAgentConnector_ms": 0.06606316566467285}}, "episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8921.514039195303, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8865.904486551437, -8946.285423088013, -8913.809594553113, -9004.818032444935, -8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.547288776903204, "mean_inference_ms": 0.36840461398033236, "mean_action_processing_ms": 0.09116295787799902, "mean_env_wait_ms": 0.9495132053981815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003419160842895508, "StateBufferConnector_ms": 0.002598285675048828, "ViewRequirementAgentConnector_ms": 0.06606316566467285}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 191640, "num_agent_steps_trained": 191640, "num_env_steps_sampled": 191640, "num_env_steps_trained": 191640, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.47798546821433, "num_env_steps_trained_throughput_per_sec": 112.47798546821433, "timesteps_total": 191640, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 191640, "timers": {"training_iteration_time_ms": 3234.932, "sample_time_ms": 3224.213, "load_time_ms": 0.301, "load_throughput": 1195052.98, "learn_time_ms": 9.654, "learn_throughput": 37291.726, "synch_weights_time_ms": 0.719}, "counters": {"num_env_steps_sampled": 191640, "num_env_steps_trained": 191640, "num_agent_steps_sampled": 191640, "num_agent_steps_trained": 191640}, "done": false, "episodes_total": 1013, "training_iteration": 210, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-53-09", "timestamp": 1691131989, "time_this_iter_s": 12.805386781692505, "time_total_s": 2375.262177467346, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 645.4314506053925, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 21.266666666666666, "ram_util_percent": 63.59444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-07, "entropy_coeff": 0.05, "policy_entropy": -656.1666015625, "policy_loss": -3152133238.2125, "vf_loss": 131535065.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1013.0, "diff_num_grad_updates_vs_sampler_policy": 1012.0}}, "num_env_steps_sampled": 193080, "num_env_steps_trained": 193080, "num_agent_steps_sampled": 193080, "num_agent_steps_trained": 193080}, "sampler_results": {"episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8920.772457221512, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.548252651901916, "mean_inference_ms": 0.3684190318121323, "mean_action_processing_ms": 0.0911639490589048, "mean_env_wait_ms": 0.9480866425978686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034122467041015625, "StateBufferConnector_ms": 0.0025849342346191406, "ViewRequirementAgentConnector_ms": 0.06603598594665527}}, "episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8920.772457221512, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8891.465751189147, -8899.711164559956, -8906.487516502188, -8911.137613148045, -8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.548252651901916, "mean_inference_ms": 0.3684190318121323, "mean_action_processing_ms": 0.0911639490589048, "mean_env_wait_ms": 0.9480866425978686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034122467041015625, "StateBufferConnector_ms": 0.0025849342346191406, "ViewRequirementAgentConnector_ms": 0.06603598594665527}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 193080, "num_agent_steps_trained": 193080, "num_env_steps_sampled": 193080, "num_env_steps_trained": 193080, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.8825209013365, "num_env_steps_trained_throughput_per_sec": 111.8825209013365, "timesteps_total": 193080, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 193080, "timers": {"training_iteration_time_ms": 3206.216, "sample_time_ms": 3195.557, "load_time_ms": 0.3, "load_throughput": 1199133.926, "learn_time_ms": 9.611, "learn_throughput": 37457.783, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 193080, "num_env_steps_trained": 193080, "num_agent_steps_sampled": 193080, "num_agent_steps_trained": 193080}, "done": false, "episodes_total": 1017, "training_iteration": 211, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-53-22", "timestamp": 1691132002, "time_this_iter_s": 12.873417139053345, "time_total_s": 2388.1355946063995, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 658.3048677444458, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 20.610526315789468, "ram_util_percent": 63.57368421052631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.0166666666666666e-07, "entropy_coeff": 0.05, "policy_entropy": -656.1821044921875, "policy_loss": -1613270773.0375, "vf_loss": 131926676.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1033.0, "diff_num_grad_updates_vs_sampler_policy": 1032.0}}, "num_env_steps_sampled": 194520, "num_env_steps_trained": 194520, "num_agent_steps_sampled": 194520, "num_agent_steps_trained": 194520}, "sampler_results": {"episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8921.774129527283, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.549343763373306, "mean_inference_ms": 0.36842813233714317, "mean_action_processing_ms": 0.09116440538663455, "mean_env_wait_ms": 0.9467468942380977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034050941467285156, "StateBufferConnector_ms": 0.0025887489318847656, "ViewRequirementAgentConnector_ms": 0.06592345237731934}}, "episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8921.774129527283, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8959.558698406827, -8980.07094843233, -8855.870821134995, -8928.876657550214, -8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.549343763373306, "mean_inference_ms": 0.36842813233714317, "mean_action_processing_ms": 0.09116440538663455, "mean_env_wait_ms": 0.9467468942380977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034050941467285156, "StateBufferConnector_ms": 0.0025887489318847656, "ViewRequirementAgentConnector_ms": 0.06592345237731934}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 194520, "num_agent_steps_trained": 194520, "num_env_steps_sampled": 194520, "num_env_steps_trained": 194520, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.7094213151257, "num_env_steps_trained_throughput_per_sec": 110.7094213151257, "timesteps_total": 194520, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 194520, "timers": {"training_iteration_time_ms": 3236.041, "sample_time_ms": 3225.3, "load_time_ms": 0.3, "load_throughput": 1199038.704, "learn_time_ms": 9.698, "learn_throughput": 37121.75, "synch_weights_time_ms": 0.698}, "counters": {"num_env_steps_sampled": 194520, "num_env_steps_trained": 194520, "num_agent_steps_sampled": 194520, "num_agent_steps_trained": 194520}, "done": false, "episodes_total": 1021, "training_iteration": 212, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-53-35", "timestamp": 1691132015, "time_this_iter_s": 13.009870052337646, "time_total_s": 2401.145464658737, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 671.3147377967834, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 20.511111111111116, "ram_util_percent": 63.58888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.4166666666666665e-07, "entropy_coeff": 0.05, "policy_entropy": -656.2868041992188, "policy_loss": -527600326.2, "vf_loss": 131530736.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1053.0, "diff_num_grad_updates_vs_sampler_policy": 1052.0}}, "num_env_steps_sampled": 195960, "num_env_steps_trained": 195960, "num_agent_steps_sampled": 195960, "num_agent_steps_trained": 195960}, "sampler_results": {"episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8923.009644754022, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5504058868156765, "mean_inference_ms": 0.36843422377702745, "mean_action_processing_ms": 0.09116460304787502, "mean_env_wait_ms": 0.9454898431155527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034019947052001953, "StateBufferConnector_ms": 0.002587556838989258, "ViewRequirementAgentConnector_ms": 0.0659327507019043}}, "episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8923.009644754022, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8940.69700005637, -9023.755936794443, -8857.08923586684, -8856.15228330376, -8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5504058868156765, "mean_inference_ms": 0.36843422377702745, "mean_action_processing_ms": 0.09116460304787502, "mean_env_wait_ms": 0.9454898431155527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034019947052001953, "StateBufferConnector_ms": 0.002587556838989258, "ViewRequirementAgentConnector_ms": 0.0659327507019043}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 195960, "num_agent_steps_trained": 195960, "num_env_steps_sampled": 195960, "num_env_steps_trained": 195960, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.91745541451316, "num_env_steps_trained_throughput_per_sec": 109.91745541451316, "timesteps_total": 195960, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 195960, "timers": {"training_iteration_time_ms": 3251.848, "sample_time_ms": 3241.121, "load_time_ms": 0.3, "load_throughput": 1200564.077, "learn_time_ms": 9.677, "learn_throughput": 37200.127, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 195960, "num_env_steps_trained": 195960, "num_agent_steps_sampled": 195960, "num_agent_steps_trained": 195960}, "done": false, "episodes_total": 1025, "training_iteration": 213, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-53-48", "timestamp": 1691132028, "time_this_iter_s": 13.103682041168213, "time_total_s": 2414.2491466999054, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 684.4184198379517, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 19.96315789473684, "ram_util_percent": 63.61052631578947}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": -656.3235473632812, "policy_loss": -1568915106.1, "vf_loss": 130936359.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1073.0, "diff_num_grad_updates_vs_sampler_policy": 1072.0}}, "num_env_steps_sampled": 197400, "num_env_steps_trained": 197400, "num_agent_steps_sampled": 197400, "num_agent_steps_trained": 197400}, "sampler_results": {"episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8922.811617841922, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.551485897134466, "mean_inference_ms": 0.36844168715022024, "mean_action_processing_ms": 0.09116496323206891, "mean_env_wait_ms": 0.9442487909329812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003399372100830078, "StateBufferConnector_ms": 0.0025849342346191406, "ViewRequirementAgentConnector_ms": 0.06593847274780273}}, "episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8922.811617841922, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8859.841556426598, -8932.024506287797, -8953.31278043088, -9038.724690794365, -8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.551485897134466, "mean_inference_ms": 0.36844168715022024, "mean_action_processing_ms": 0.09116496323206891, "mean_env_wait_ms": 0.9442487909329812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003399372100830078, "StateBufferConnector_ms": 0.0025849342346191406, "ViewRequirementAgentConnector_ms": 0.06593847274780273}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 197400, "num_agent_steps_trained": 197400, "num_env_steps_sampled": 197400, "num_env_steps_trained": 197400, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.02584188848063, "num_env_steps_trained_throughput_per_sec": 112.02584188848063, "timesteps_total": 197400, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 197400, "timers": {"training_iteration_time_ms": 3239.135, "sample_time_ms": 3228.387, "load_time_ms": 0.301, "load_throughput": 1195052.98, "learn_time_ms": 9.682, "learn_throughput": 37180.525, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 197400, "num_env_steps_trained": 197400, "num_agent_steps_sampled": 197400, "num_agent_steps_trained": 197400}, "done": false, "episodes_total": 1029, "training_iteration": 214, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-54-01", "timestamp": 1691132041, "time_this_iter_s": 12.857011795043945, "time_total_s": 2427.1061584949493, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 697.2754316329956, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 21.66111111111111, "ram_util_percent": 63.94444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": -656.2505249023437, "policy_loss": -265160858.6, "vf_loss": 131844621.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1093.0, "diff_num_grad_updates_vs_sampler_policy": 1092.0}}, "num_env_steps_sampled": 198840, "num_env_steps_trained": 198840, "num_agent_steps_sampled": 198840, "num_agent_steps_trained": 198840}, "sampler_results": {"episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8922.818096654604, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.552476699078101, "mean_inference_ms": 0.3684495553378207, "mean_action_processing_ms": 0.09116553892787067, "mean_env_wait_ms": 0.9430570968862912, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003397226333618164, "StateBufferConnector_ms": 0.0025932788848876953, "ViewRequirementAgentConnector_ms": 0.0659642219543457}}, "episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8922.818096654604, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8888.266604640592, -8996.14110049974, -8962.913072051611, -9045.360696558068, -8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.552476699078101, "mean_inference_ms": 0.3684495553378207, "mean_action_processing_ms": 0.09116553892787067, "mean_env_wait_ms": 0.9430570968862912, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003397226333618164, "StateBufferConnector_ms": 0.0025932788848876953, "ViewRequirementAgentConnector_ms": 0.0659642219543457}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 198840, "num_agent_steps_trained": 198840, "num_env_steps_sampled": 198840, "num_env_steps_trained": 198840, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.3814257367919, "num_env_steps_trained_throughput_per_sec": 110.3814257367919, "timesteps_total": 198840, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 198840, "timers": {"training_iteration_time_ms": 3241.797, "sample_time_ms": 3231.096, "load_time_ms": 0.303, "load_throughput": 1188936.567, "learn_time_ms": 9.637, "learn_throughput": 37356.216, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 198840, "num_env_steps_trained": 198840, "num_agent_steps_sampled": 198840, "num_agent_steps_trained": 198840}, "done": false, "episodes_total": 1033, "training_iteration": 215, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-54-14", "timestamp": 1691132054, "time_this_iter_s": 13.048487901687622, "time_total_s": 2440.154646396637, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 710.3239195346832, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 21.227777777777778, "ram_util_percent": 63.97222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05, "policy_entropy": -656.1621948242188, "policy_loss": -2183248919.575, "vf_loss": 133400053.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1113.0, "diff_num_grad_updates_vs_sampler_policy": 1112.0}}, "num_env_steps_sampled": 200280, "num_env_steps_trained": 200280, "num_agent_steps_sampled": 200280, "num_agent_steps_trained": 200280}, "sampler_results": {"episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8921.34178503341, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5534355096948325, "mean_inference_ms": 0.36846050330137703, "mean_action_processing_ms": 0.09116642413230601, "mean_env_wait_ms": 0.9418932547359905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003401041030883789, "StateBufferConnector_ms": 0.002584218978881836, "ViewRequirementAgentConnector_ms": 0.06586503982543945}}, "episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8921.34178503341, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8985.75399796021, -8917.705093691664, -8986.693845549578, -8988.53626338417, -8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5534355096948325, "mean_inference_ms": 0.36846050330137703, "mean_action_processing_ms": 0.09116642413230601, "mean_env_wait_ms": 0.9418932547359905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003401041030883789, "StateBufferConnector_ms": 0.002584218978881836, "ViewRequirementAgentConnector_ms": 0.06586503982543945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200280, "num_agent_steps_trained": 200280, "num_env_steps_sampled": 200280, "num_env_steps_trained": 200280, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.2449310047145, "num_env_steps_trained_throughput_per_sec": 110.2449310047145, "timesteps_total": 200280, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 200280, "timers": {"training_iteration_time_ms": 3253.33, "sample_time_ms": 3242.65, "load_time_ms": 0.303, "load_throughput": 1189123.831, "learn_time_ms": 9.607, "learn_throughput": 37471.168, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 200280, "num_env_steps_trained": 200280, "num_agent_steps_sampled": 200280, "num_agent_steps_trained": 200280}, "done": false, "episodes_total": 1037, "training_iteration": 216, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-54-27", "timestamp": 1691132067, "time_this_iter_s": 13.064762115478516, "time_total_s": 2453.2194085121155, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 723.3886816501617, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 19.85263157894737, "ram_util_percent": 63.942105263157885}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.388888888888888e-08, "entropy_coeff": 0.05, "policy_entropy": -656.23115234375, "policy_loss": -1720356032.625, "vf_loss": 131493024.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1133.0, "diff_num_grad_updates_vs_sampler_policy": 1132.0}}, "num_env_steps_sampled": 201720, "num_env_steps_trained": 201720, "num_agent_steps_sampled": 201720, "num_agent_steps_trained": 201720}, "sampler_results": {"episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8919.2641783747, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.55429480125088, "mean_inference_ms": 0.3684683580557763, "mean_action_processing_ms": 0.09116674679467916, "mean_env_wait_ms": 0.9408039725657712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003396272659301758, "StateBufferConnector_ms": 0.002577066421508789, "ViewRequirementAgentConnector_ms": 0.06586980819702148}}, "episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8919.2641783747, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8958.628214796641, -8923.30594081797, -8935.288249560315, -8859.138928297121, -8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.55429480125088, "mean_inference_ms": 0.3684683580557763, "mean_action_processing_ms": 0.09116674679467916, "mean_env_wait_ms": 0.9408039725657712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003396272659301758, "StateBufferConnector_ms": 0.002577066421508789, "ViewRequirementAgentConnector_ms": 0.06586980819702148}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 201720, "num_agent_steps_trained": 201720, "num_env_steps_sampled": 201720, "num_env_steps_trained": 201720, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.19813298711016, "num_env_steps_trained_throughput_per_sec": 111.19813298711016, "timesteps_total": 201720, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 201720, "timers": {"training_iteration_time_ms": 3250.491, "sample_time_ms": 3239.931, "load_time_ms": 0.302, "load_throughput": 1193635.921, "learn_time_ms": 9.486, "learn_throughput": 37949.966, "synch_weights_time_ms": 0.728}, "counters": {"num_env_steps_sampled": 201720, "num_env_steps_trained": 201720, "num_agent_steps_sampled": 201720, "num_agent_steps_trained": 201720}, "done": false, "episodes_total": 1041, "training_iteration": 217, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-54-40", "timestamp": 1691132080, "time_this_iter_s": 12.952769994735718, "time_total_s": 2466.172178506851, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 736.3414516448975, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 20.06111111111111, "ram_util_percent": 63.68333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.388888888888888e-08, "entropy_coeff": 0.05, "policy_entropy": -656.2973388671875, "policy_loss": -978589982.9875, "vf_loss": 131879623.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1153.0, "diff_num_grad_updates_vs_sampler_policy": 1152.0}}, "num_env_steps_sampled": 203160, "num_env_steps_trained": 203160, "num_agent_steps_sampled": 203160, "num_agent_steps_trained": 203160}, "sampler_results": {"episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8919.067056712427, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5549782861403045, "mean_inference_ms": 0.3684799226644296, "mean_action_processing_ms": 0.09116769843193427, "mean_env_wait_ms": 0.9397621446470511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003381013870239258, "StateBufferConnector_ms": 0.002574443817138672, "ViewRequirementAgentConnector_ms": 0.06585478782653809}}, "episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8919.067056712427, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8888.020092383162, -8884.335702853268, -8913.505927464561, -8927.167662885602, -8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.5549782861403045, "mean_inference_ms": 0.3684799226644296, "mean_action_processing_ms": 0.09116769843193427, "mean_env_wait_ms": 0.9397621446470511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003381013870239258, "StateBufferConnector_ms": 0.002574443817138672, "ViewRequirementAgentConnector_ms": 0.06585478782653809}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 203160, "num_agent_steps_trained": 203160, "num_env_steps_sampled": 203160, "num_env_steps_trained": 203160, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 113.741757377657, "num_env_steps_trained_throughput_per_sec": 113.741757377657, "timesteps_total": 203160, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 203160, "timers": {"training_iteration_time_ms": 3214.706, "sample_time_ms": 3204.15, "load_time_ms": 0.301, "load_throughput": 1197992.256, "learn_time_ms": 9.489, "learn_throughput": 37939.286, "synch_weights_time_ms": 0.722}, "counters": {"num_env_steps_sampled": 203160, "num_env_steps_trained": 203160, "num_agent_steps_sampled": 203160, "num_agent_steps_trained": 203160}, "done": false, "episodes_total": 1045, "training_iteration": 218, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-54-53", "timestamp": 1691132093, "time_this_iter_s": 12.663114070892334, "time_total_s": 2478.8352925777435, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 749.0045657157898, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 22.272222222222226, "ram_util_percent": 63.655555555555566}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-08, "entropy_coeff": 0.05, "policy_entropy": -656.1874389648438, "policy_loss": -2684502124.625, "vf_loss": 131338427.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1173.0, "diff_num_grad_updates_vs_sampler_policy": 1172.0}}, "num_env_steps_sampled": 204600, "num_env_steps_trained": 204600, "num_agent_steps_sampled": 204600, "num_agent_steps_trained": 204600}, "sampler_results": {"episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8919.618471695338, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.555766870827073, "mean_inference_ms": 0.36849433993696595, "mean_action_processing_ms": 0.09116901033159927, "mean_env_wait_ms": 0.9387734221526951, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033838748931884766, "StateBufferConnector_ms": 0.0025796890258789062, "ViewRequirementAgentConnector_ms": 0.06591916084289551}}, "episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8919.618471695338, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8965.866605945808, -8905.344923165425, -8955.206738647727, -8798.502234096604, -8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.555766870827073, "mean_inference_ms": 0.36849433993696595, "mean_action_processing_ms": 0.09116901033159927, "mean_env_wait_ms": 0.9387734221526951, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033838748931884766, "StateBufferConnector_ms": 0.0025796890258789062, "ViewRequirementAgentConnector_ms": 0.06591916084289551}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204600, "num_agent_steps_trained": 204600, "num_env_steps_sampled": 204600, "num_env_steps_trained": 204600, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.4231741032216, "num_env_steps_trained_throughput_per_sec": 112.4231741032216, "timesteps_total": 204600, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 204600, "timers": {"training_iteration_time_ms": 3206.764, "sample_time_ms": 3196.16, "load_time_ms": 0.302, "load_throughput": 1190436.329, "learn_time_ms": 9.533, "learn_throughput": 37763.747, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 204600, "num_env_steps_trained": 204600, "num_agent_steps_sampled": 204600, "num_agent_steps_trained": 204600}, "done": false, "episodes_total": 1049, "training_iteration": 219, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-55-06", "timestamp": 1691132106, "time_this_iter_s": 12.811554908752441, "time_total_s": 2491.646847486496, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 761.8161206245422, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 20.747368421052634, "ram_util_percent": 63.657894736842096}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-08, "entropy_coeff": 0.05, "policy_entropy": -656.2055419921875, "policy_loss": -974985741.1125, "vf_loss": 131299158.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1193.0, "diff_num_grad_updates_vs_sampler_policy": 1192.0}}, "num_env_steps_sampled": 206040, "num_env_steps_trained": 206040, "num_agent_steps_sampled": 206040, "num_agent_steps_trained": 206040}, "sampler_results": {"episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8919.64541487959, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.556497643016985, "mean_inference_ms": 0.36850936253758376, "mean_action_processing_ms": 0.09117055993843813, "mean_env_wait_ms": 0.9377978282979536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003383159637451172, "StateBufferConnector_ms": 0.002574443817138672, "ViewRequirementAgentConnector_ms": 0.0659186840057373}}, "episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8919.64541487959, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8910.318790089726, -8885.334381312134, -8968.333792911646, -8844.60234462391, -8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.556497643016985, "mean_inference_ms": 0.36850936253758376, "mean_action_processing_ms": 0.09117055993843813, "mean_env_wait_ms": 0.9377978282979536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003383159637451172, "StateBufferConnector_ms": 0.002574443817138672, "ViewRequirementAgentConnector_ms": 0.0659186840057373}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 206040, "num_agent_steps_trained": 206040, "num_env_steps_sampled": 206040, "num_env_steps_trained": 206040, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.30291407604606, "num_env_steps_trained_throughput_per_sec": 111.30291407604606, "timesteps_total": 206040, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 206040, "timers": {"training_iteration_time_ms": 3207.379, "sample_time_ms": 3196.788, "load_time_ms": 0.302, "load_throughput": 1191751.728, "learn_time_ms": 9.532, "learn_throughput": 37767.431, "synch_weights_time_ms": 0.712}, "counters": {"num_env_steps_sampled": 206040, "num_env_steps_trained": 206040, "num_agent_steps_sampled": 206040, "num_agent_steps_trained": 206040}, "done": false, "episodes_total": 1053, "training_iteration": 220, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-55-19", "timestamp": 1691132119, "time_this_iter_s": 12.940436840057373, "time_total_s": 2504.5872843265533, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 774.7565574645996, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 20.333333333333332, "ram_util_percent": 63.57777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-08, "entropy_coeff": 0.05, "policy_entropy": -656.1699096679688, "policy_loss": -1892014728.125, "vf_loss": 131568624.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1213.0, "diff_num_grad_updates_vs_sampler_policy": 1212.0}}, "num_env_steps_sampled": 207480, "num_env_steps_trained": 207480, "num_agent_steps_sampled": 207480, "num_agent_steps_trained": 207480}, "sampler_results": {"episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8921.816351388381, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.557276865594469, "mean_inference_ms": 0.36852218161944267, "mean_action_processing_ms": 0.09117144651251624, "mean_env_wait_ms": 0.9368472350601796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033884048461914062, "StateBufferConnector_ms": 0.002566099166870117, "ViewRequirementAgentConnector_ms": 0.06580924987792969}}, "episode_reward_max": -8793.655782670709, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8921.816351388381, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8874.421590811398, -8793.655782670709, -8867.987702632136, -8968.031853176899, -8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.557276865594469, "mean_inference_ms": 0.36852218161944267, "mean_action_processing_ms": 0.09117144651251624, "mean_env_wait_ms": 0.9368472350601796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033884048461914062, "StateBufferConnector_ms": 0.002566099166870117, "ViewRequirementAgentConnector_ms": 0.06580924987792969}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 207480, "num_agent_steps_trained": 207480, "num_env_steps_sampled": 207480, "num_env_steps_trained": 207480, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.14346737457366, "num_env_steps_trained_throughput_per_sec": 111.14346737457366, "timesteps_total": 207480, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 207480, "timers": {"training_iteration_time_ms": 3226.168, "sample_time_ms": 3215.618, "load_time_ms": 0.302, "load_throughput": 1190717.956, "learn_time_ms": 9.478, "learn_throughput": 37982.518, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 207480, "num_env_steps_trained": 207480, "num_agent_steps_sampled": 207480, "num_agent_steps_trained": 207480}, "done": false, "episodes_total": 1057, "training_iteration": 221, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-55-32", "timestamp": 1691132132, "time_this_iter_s": 12.959009885787964, "time_total_s": 2517.5462942123413, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 787.7155673503876, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 20.67222222222222, "ram_util_percent": 63.70555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.711111111111111e-08, "entropy_coeff": 0.05, "policy_entropy": -656.187060546875, "policy_loss": -1297466064.0, "vf_loss": 129687315.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1233.0, "diff_num_grad_updates_vs_sampler_policy": 1232.0}}, "num_env_steps_sampled": 208920, "num_env_steps_trained": 208920, "num_agent_steps_sampled": 208920, "num_agent_steps_trained": 208920}, "sampler_results": {"episode_reward_max": -8815.574794954508, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8923.186490327045, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.558034989944092, "mean_inference_ms": 0.36853410743262716, "mean_action_processing_ms": 0.09117239468890387, "mean_env_wait_ms": 0.9359206967414616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033919811248779297, "StateBufferConnector_ms": 0.0025610923767089844, "ViewRequirementAgentConnector_ms": 0.06581497192382812}}, "episode_reward_max": -8815.574794954508, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8923.186490327045, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8969.273050435288, -8878.704890884495, -8895.691410956839, -8911.136525163332, -8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.558034989944092, "mean_inference_ms": 0.36853410743262716, "mean_action_processing_ms": 0.09117239468890387, "mean_env_wait_ms": 0.9359206967414616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033919811248779297, "StateBufferConnector_ms": 0.0025610923767089844, "ViewRequirementAgentConnector_ms": 0.06581497192382812}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208920, "num_agent_steps_trained": 208920, "num_env_steps_sampled": 208920, "num_env_steps_trained": 208920, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.98670791621966, "num_env_steps_trained_throughput_per_sec": 109.98670791621966, "timesteps_total": 208920, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 208920, "timers": {"training_iteration_time_ms": 3252.694, "sample_time_ms": 3242.152, "load_time_ms": 0.299, "load_throughput": 1204106.411, "learn_time_ms": 9.48, "learn_throughput": 37974.112, "synch_weights_time_ms": 0.719}, "counters": {"num_env_steps_sampled": 208920, "num_env_steps_trained": 208920, "num_agent_steps_sampled": 208920, "num_agent_steps_trained": 208920}, "done": false, "episodes_total": 1061, "training_iteration": 222, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-55-45", "timestamp": 1691132145, "time_this_iter_s": 13.095313787460327, "time_total_s": 2530.6416079998016, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 800.8108811378479, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 21.03157894736842, "ram_util_percent": 63.73684210526317}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.1111111111111107e-08, "entropy_coeff": 0.05, "policy_entropy": -656.0682250976563, "policy_loss": -2368532626.9, "vf_loss": 133268362.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1253.0, "diff_num_grad_updates_vs_sampler_policy": 1252.0}}, "num_env_steps_sampled": 210360, "num_env_steps_trained": 210360, "num_agent_steps_sampled": 210360, "num_agent_steps_trained": 210360}, "sampler_results": {"episode_reward_max": -8815.574794954508, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8923.477158337477, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.558666560474972, "mean_inference_ms": 0.3685498697131343, "mean_action_processing_ms": 0.09117439876405772, "mean_env_wait_ms": 0.9350330682965802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003390073776245117, "StateBufferConnector_ms": 0.002569913864135742, "ViewRequirementAgentConnector_ms": 0.06590580940246582}}, "episode_reward_max": -8815.574794954508, "episode_reward_min": -9051.64481212707, "episode_reward_mean": -8923.477158337477, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8837.914262776123, -8906.37847737707, -9051.64481212707, -8997.710549075138, -8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.558666560474972, "mean_inference_ms": 0.3685498697131343, "mean_action_processing_ms": 0.09117439876405772, "mean_env_wait_ms": 0.9350330682965802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003390073776245117, "StateBufferConnector_ms": 0.002569913864135742, "ViewRequirementAgentConnector_ms": 0.06590580940246582}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 210360, "num_agent_steps_trained": 210360, "num_env_steps_sampled": 210360, "num_env_steps_trained": 210360, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.84130870034687, "num_env_steps_trained_throughput_per_sec": 112.84130870034687, "timesteps_total": 210360, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 210360, "timers": {"training_iteration_time_ms": 3232.081, "sample_time_ms": 3221.388, "load_time_ms": 0.299, "load_throughput": 1204971.223, "learn_time_ms": 9.618, "learn_throughput": 37428.906, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 210360, "num_env_steps_trained": 210360, "num_agent_steps_sampled": 210360, "num_agent_steps_trained": 210360}, "done": false, "episodes_total": 1065, "training_iteration": 223, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-55-58", "timestamp": 1691132158, "time_this_iter_s": 12.764127016067505, "time_total_s": 2543.405735015869, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 813.5750081539154, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 25.327777777777776, "ram_util_percent": 63.92222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.1652587890625, "policy_loss": -1312554732.1375, "vf_loss": 130144175.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1273.0, "diff_num_grad_updates_vs_sampler_policy": 1272.0}}, "num_env_steps_sampled": 211800, "num_env_steps_trained": 211800, "num_agent_steps_sampled": 211800, "num_agent_steps_trained": 211800}, "sampler_results": {"episode_reward_max": -8815.574794954508, "episode_reward_min": -9047.560557525958, "episode_reward_mean": -8923.587357467068, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.559270781074454, "mean_inference_ms": 0.3685698154656549, "mean_action_processing_ms": 0.09117674138683526, "mean_env_wait_ms": 0.9341776367295576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033893585205078125, "StateBufferConnector_ms": 0.0025637149810791016, "ViewRequirementAgentConnector_ms": 0.06589627265930176}}, "episode_reward_max": -8815.574794954508, "episode_reward_min": -9047.560557525958, "episode_reward_mean": -8923.587357467068, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8907.909768987456, -8975.820732494509, -8882.377516425286, -8896.360734727175, -8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.559270781074454, "mean_inference_ms": 0.3685698154656549, "mean_action_processing_ms": 0.09117674138683526, "mean_env_wait_ms": 0.9341776367295576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033893585205078125, "StateBufferConnector_ms": 0.0025637149810791016, "ViewRequirementAgentConnector_ms": 0.06589627265930176}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 211800, "num_agent_steps_trained": 211800, "num_env_steps_sampled": 211800, "num_env_steps_trained": 211800, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.67513064134062, "num_env_steps_trained_throughput_per_sec": 110.67513064134062, "timesteps_total": 211800, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 211800, "timers": {"training_iteration_time_ms": 3228.134, "sample_time_ms": 3217.446, "load_time_ms": 0.3, "load_throughput": 1200182.37, "learn_time_ms": 9.621, "learn_throughput": 37417.312, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 211800, "num_env_steps_trained": 211800, "num_agent_steps_sampled": 211800, "num_agent_steps_trained": 211800}, "done": false, "episodes_total": 1069, "training_iteration": 224, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-56-11", "timestamp": 1691132171, "time_this_iter_s": 13.013813018798828, "time_total_s": 2556.419548034668, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 826.5888211727142, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 20.08888888888889, "ram_util_percent": 63.849999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.0665283203125, "policy_loss": -3105517912.45, "vf_loss": 134265203.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1293.0, "diff_num_grad_updates_vs_sampler_policy": 1292.0}}, "num_env_steps_sampled": 213240, "num_env_steps_trained": 213240, "num_agent_steps_sampled": 213240, "num_agent_steps_trained": 213240}, "sampler_results": {"episode_reward_max": -8815.574794954508, "episode_reward_min": -9047.560557525958, "episode_reward_mean": -8924.75439532534, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.559741327378948, "mean_inference_ms": 0.3685891190523913, "mean_action_processing_ms": 0.09117892400857518, "mean_env_wait_ms": 0.9333473140183736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003393411636352539, "StateBufferConnector_ms": 0.002570629119873047, "ViewRequirementAgentConnector_ms": 0.06597304344177246}}, "episode_reward_max": -8815.574794954508, "episode_reward_min": -9047.560557525958, "episode_reward_mean": -8924.75439532534, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8980.678131475177, -8862.394752410324, -8921.991738486548, -9047.560557525958, -8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.559741327378948, "mean_inference_ms": 0.3685891190523913, "mean_action_processing_ms": 0.09117892400857518, "mean_env_wait_ms": 0.9333473140183736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003393411636352539, "StateBufferConnector_ms": 0.002570629119873047, "ViewRequirementAgentConnector_ms": 0.06597304344177246}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 213240, "num_agent_steps_trained": 213240, "num_env_steps_sampled": 213240, "num_env_steps_trained": 213240, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.1829228322441, "num_env_steps_trained_throughput_per_sec": 112.1829228322441, "timesteps_total": 213240, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 213240, "timers": {"training_iteration_time_ms": 3228.7, "sample_time_ms": 3218.129, "load_time_ms": 0.301, "load_throughput": 1196094.297, "learn_time_ms": 9.499, "learn_throughput": 37897.864, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 213240, "num_env_steps_trained": 213240, "num_agent_steps_sampled": 213240, "num_agent_steps_trained": 213240}, "done": false, "episodes_total": 1073, "training_iteration": 225, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-56-24", "timestamp": 1691132184, "time_this_iter_s": 12.839010953903198, "time_total_s": 2569.258558988571, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 839.4278321266174, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 20.557894736842105, "ram_util_percent": 63.85263157894736}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.1210327148438, "policy_loss": -1697860287.875, "vf_loss": 132740953.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1313.0, "diff_num_grad_updates_vs_sampler_policy": 1312.0}}, "num_env_steps_sampled": 214680, "num_env_steps_trained": 214680, "num_agent_steps_sampled": 214680, "num_agent_steps_trained": 214680}, "sampler_results": {"episode_reward_max": -8815.574794954508, "episode_reward_min": -9041.186235854519, "episode_reward_mean": -8924.208110912907, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.560226598390377, "mean_inference_ms": 0.368602044609541, "mean_action_processing_ms": 0.09117992719603783, "mean_env_wait_ms": 0.9324810804094108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003393411636352539, "StateBufferConnector_ms": 0.002570629119873047, "ViewRequirementAgentConnector_ms": 0.06595373153686523}}, "episode_reward_max": -8815.574794954508, "episode_reward_min": -9041.186235854519, "episode_reward_mean": -8924.208110912907, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8955.321972855629, -8949.970090999504, -8936.539885892977, -8987.19695370498, -8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.560226598390377, "mean_inference_ms": 0.368602044609541, "mean_action_processing_ms": 0.09117992719603783, "mean_env_wait_ms": 0.9324810804094108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003393411636352539, "StateBufferConnector_ms": 0.002570629119873047, "ViewRequirementAgentConnector_ms": 0.06595373153686523}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 214680, "num_agent_steps_trained": 214680, "num_env_steps_sampled": 214680, "num_env_steps_trained": 214680, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.01354444884292, "num_env_steps_trained_throughput_per_sec": 112.01354444884292, "timesteps_total": 214680, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 214680, "timers": {"training_iteration_time_ms": 3230.925, "sample_time_ms": 3220.38, "load_time_ms": 0.303, "load_throughput": 1186600.739, "learn_time_ms": 9.467, "learn_throughput": 38026.52, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 214680, "num_env_steps_trained": 214680, "num_agent_steps_sampled": 214680, "num_agent_steps_trained": 214680}, "done": false, "episodes_total": 1077, "training_iteration": 226, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-56-36", "timestamp": 1691132196, "time_this_iter_s": 12.858412027359009, "time_total_s": 2582.11697101593, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 852.2862441539764, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 19.383333333333336, "ram_util_percent": 63.727777777777774}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.0596435546875, "policy_loss": -3479946521.6, "vf_loss": 132196668.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1333.0, "diff_num_grad_updates_vs_sampler_policy": 1332.0}}, "num_env_steps_sampled": 216120, "num_env_steps_trained": 216120, "num_agent_steps_sampled": 216120, "num_agent_steps_trained": 216120}, "sampler_results": {"episode_reward_max": -8815.574794954508, "episode_reward_min": -9041.186235854519, "episode_reward_mean": -8922.70377497911, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457, -8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.560686724128686, "mean_inference_ms": 0.3686161992625474, "mean_action_processing_ms": 0.09118126802023933, "mean_env_wait_ms": 0.9316663847403593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003401517868041992, "StateBufferConnector_ms": 0.002573251724243164, "ViewRequirementAgentConnector_ms": 0.06601643562316895}}, "episode_reward_max": -8815.574794954508, "episode_reward_min": -9041.186235854519, "episode_reward_mean": -8922.70377497911, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8928.81810120148, -8881.782496233649, -9041.186235854519, -8883.588321212867, -8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457, -8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.560686724128686, "mean_inference_ms": 0.3686161992625474, "mean_action_processing_ms": 0.09118126802023933, "mean_env_wait_ms": 0.9316663847403593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003401517868041992, "StateBufferConnector_ms": 0.002573251724243164, "ViewRequirementAgentConnector_ms": 0.06601643562316895}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216120, "num_agent_steps_trained": 216120, "num_env_steps_sampled": 216120, "num_env_steps_trained": 216120, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.96350152276784, "num_env_steps_trained_throughput_per_sec": 110.96350152276784, "timesteps_total": 216120, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 216120, "timers": {"training_iteration_time_ms": 3224.809, "sample_time_ms": 3214.265, "load_time_ms": 0.302, "load_throughput": 1193635.921, "learn_time_ms": 9.459, "learn_throughput": 38060.931, "synch_weights_time_ms": 0.74}, "counters": {"num_env_steps_sampled": 216120, "num_env_steps_trained": 216120, "num_agent_steps_sampled": 216120, "num_agent_steps_trained": 216120}, "done": false, "episodes_total": 1081, "training_iteration": 227, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-56-49", "timestamp": 1691132209, "time_this_iter_s": 12.980143070220947, "time_total_s": 2595.097114086151, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 865.2663872241974, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 20.183333333333337, "ram_util_percent": 63.52777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.2277709960938, "policy_loss": -570091026.4, "vf_loss": 130308428.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1353.0, "diff_num_grad_updates_vs_sampler_policy": 1352.0}}, "num_env_steps_sampled": 217560, "num_env_steps_trained": 217560, "num_agent_steps_sampled": 217560, "num_agent_steps_trained": 217560}, "sampler_results": {"episode_reward_max": -8815.574794954508, "episode_reward_min": -9033.108546160227, "episode_reward_mean": -8920.920382558243, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457, -8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889, -8889.472635975251, -8906.619853432872, -8878.168071336153, -8882.775351671515], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.56116800720708, "mean_inference_ms": 0.3686289770115359, "mean_action_processing_ms": 0.09118198641336736, "mean_env_wait_ms": 0.9308737572798715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003402233123779297, "StateBufferConnector_ms": 0.0025691986083984375, "ViewRequirementAgentConnector_ms": 0.06603884696960449}}, "episode_reward_max": -8815.574794954508, "episode_reward_min": -9033.108546160227, "episode_reward_mean": -8920.920382558243, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8888.70344845801, -8899.711164559956, -8867.14448226821, -8906.153701115449, -8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457, -8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889, -8889.472635975251, -8906.619853432872, -8878.168071336153, -8882.775351671515], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.56116800720708, "mean_inference_ms": 0.3686289770115359, "mean_action_processing_ms": 0.09118198641336736, "mean_env_wait_ms": 0.9308737572798715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003402233123779297, "StateBufferConnector_ms": 0.0025691986083984375, "ViewRequirementAgentConnector_ms": 0.06603884696960449}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 217560, "num_agent_steps_trained": 217560, "num_env_steps_sampled": 217560, "num_env_steps_trained": 217560, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.96383580480149, "num_env_steps_trained_throughput_per_sec": 111.96383580480149, "timesteps_total": 217560, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 217560, "timers": {"training_iteration_time_ms": 3220.421, "sample_time_ms": 3209.893, "load_time_ms": 0.304, "load_throughput": 1184645.724, "learn_time_ms": 9.464, "learn_throughput": 38040.411, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 217560, "num_env_steps_trained": 217560, "num_agent_steps_sampled": 217560, "num_agent_steps_trained": 217560}, "done": false, "episodes_total": 1085, "training_iteration": 228, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-57-02", "timestamp": 1691132222, "time_this_iter_s": 12.864065885543823, "time_total_s": 2607.961179971695, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 878.1304531097412, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 20.28333333333333, "ram_util_percent": 63.54444444444443}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.1103881835937, "policy_loss": -1015645649.125, "vf_loss": 132853772.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1373.0, "diff_num_grad_updates_vs_sampler_policy": 1372.0}}, "num_env_steps_sampled": 219000, "num_env_steps_trained": 219000, "num_agent_steps_sampled": 219000, "num_agent_steps_trained": 219000}, "sampler_results": {"episode_reward_max": -8815.574794954508, "episode_reward_min": -9033.108546160227, "episode_reward_mean": -8922.989318923317, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457, -8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889, -8889.472635975251, -8906.619853432872, -8878.168071336153, -8882.775351671515, -8932.84739972312, -8901.64930350409, -8967.770229630327, -8966.339500051401], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.561680102747321, "mean_inference_ms": 0.36864191780632216, "mean_action_processing_ms": 0.09118281876552446, "mean_env_wait_ms": 0.9301227922302183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003401517868041992, "StateBufferConnector_ms": 0.0025680065155029297, "ViewRequirementAgentConnector_ms": 0.06604433059692383}}, "episode_reward_max": -8815.574794954508, "episode_reward_min": -9033.108546160227, "episode_reward_mean": -8922.989318923317, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8893.331934687852, -8891.542605115876, -8893.84764185681, -8899.711164559956, -8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457, -8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889, -8889.472635975251, -8906.619853432872, -8878.168071336153, -8882.775351671515, -8932.84739972312, -8901.64930350409, -8967.770229630327, -8966.339500051401], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.561680102747321, "mean_inference_ms": 0.36864191780632216, "mean_action_processing_ms": 0.09118281876552446, "mean_env_wait_ms": 0.9301227922302183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003401517868041992, "StateBufferConnector_ms": 0.0025680065155029297, "ViewRequirementAgentConnector_ms": 0.06604433059692383}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 219000, "num_agent_steps_trained": 219000, "num_env_steps_sampled": 219000, "num_env_steps_trained": 219000, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.72042046418306, "num_env_steps_trained_throughput_per_sec": 109.72042046418306, "timesteps_total": 219000, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 219000, "timers": {"training_iteration_time_ms": 3256.304, "sample_time_ms": 3245.728, "load_time_ms": 0.302, "load_throughput": 1192410.519, "learn_time_ms": 9.532, "learn_throughput": 37769.226, "synch_weights_time_ms": 0.698}, "counters": {"num_env_steps_sampled": 219000, "num_env_steps_trained": 219000, "num_agent_steps_sampled": 219000, "num_agent_steps_trained": 219000}, "done": false, "episodes_total": 1089, "training_iteration": 229, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-57-16", "timestamp": 1691132236, "time_this_iter_s": 13.126997947692871, "time_total_s": 2621.088177919388, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 891.2574510574341, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 20.415789473684214, "ram_util_percent": 63.59473684210526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.0721435546875, "policy_loss": -2556853120.35, "vf_loss": 132158228.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1393.0, "diff_num_grad_updates_vs_sampler_policy": 1392.0}}, "num_env_steps_sampled": 220440, "num_env_steps_trained": 220440, "num_agent_steps_sampled": 220440, "num_agent_steps_trained": 220440}, "sampler_results": {"episode_reward_max": -8815.574794954508, "episode_reward_min": -9066.232257208054, "episode_reward_mean": -8925.634335862449, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457, -8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889, -8889.472635975251, -8906.619853432872, -8878.168071336153, -8882.775351671515, -8932.84739972312, -8901.64930350409, -8967.770229630327, -8966.339500051401, -9066.232257208054, -8911.72112933767, -8932.513071091309, -8932.4685824968], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.562248239466662, "mean_inference_ms": 0.36865191550747967, "mean_action_processing_ms": 0.09118289494771986, "mean_env_wait_ms": 0.9294098884218149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034008026123046875, "StateBufferConnector_ms": 0.0025691986083984375, "ViewRequirementAgentConnector_ms": 0.06600117683410645}}, "episode_reward_max": -8815.574794954508, "episode_reward_min": -9066.232257208054, "episode_reward_mean": -8925.634335862449, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8841.498478929065, -8894.647920421576, -8900.684172019279, -8855.898611783761, -8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457, -8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889, -8889.472635975251, -8906.619853432872, -8878.168071336153, -8882.775351671515, -8932.84739972312, -8901.64930350409, -8967.770229630327, -8966.339500051401, -9066.232257208054, -8911.72112933767, -8932.513071091309, -8932.4685824968], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.562248239466662, "mean_inference_ms": 0.36865191550747967, "mean_action_processing_ms": 0.09118289494771986, "mean_env_wait_ms": 0.9294098884218149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034008026123046875, "StateBufferConnector_ms": 0.0025691986083984375, "ViewRequirementAgentConnector_ms": 0.06600117683410645}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220440, "num_agent_steps_trained": 220440, "num_env_steps_sampled": 220440, "num_env_steps_trained": 220440, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 109.73028573542274, "num_env_steps_trained_throughput_per_sec": 109.73028573542274, "timesteps_total": 220440, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 220440, "timers": {"training_iteration_time_ms": 3272.194, "sample_time_ms": 3261.596, "load_time_ms": 0.305, "load_throughput": 1181032.022, "learn_time_ms": 9.532, "learn_throughput": 37767.431, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 220440, "num_env_steps_trained": 220440, "num_agent_steps_sampled": 220440, "num_agent_steps_trained": 220440}, "done": false, "episodes_total": 1093, "training_iteration": 230, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-57-29", "timestamp": 1691132249, "time_this_iter_s": 13.125818014144897, "time_total_s": 2634.2139959335327, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 904.383269071579, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 20.61052631578947, "ram_util_percent": 63.563157894736854}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.136181640625, "policy_loss": -1964232174.275, "vf_loss": 131548445.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1413.0, "diff_num_grad_updates_vs_sampler_policy": 1412.0}}, "num_env_steps_sampled": 221880, "num_env_steps_trained": 221880, "num_agent_steps_sampled": 221880, "num_agent_steps_trained": 221880}, "sampler_results": {"episode_reward_max": -8815.574794954508, "episode_reward_min": -9066.232257208054, "episode_reward_mean": -8926.136308309737, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457, -8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889, -8889.472635975251, -8906.619853432872, -8878.168071336153, -8882.775351671515, -8932.84739972312, -8901.64930350409, -8967.770229630327, -8966.339500051401, -9066.232257208054, -8911.72112933767, -8932.513071091309, -8932.4685824968, -8893.745840755053, -8863.09819644699, -8878.527586944105, -8907.55480373617], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.562681432870652, "mean_inference_ms": 0.3686612206329409, "mean_action_processing_ms": 0.09118280810647876, "mean_env_wait_ms": 0.9286644701409011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003404378890991211, "StateBufferConnector_ms": 0.0025763511657714844, "ViewRequirementAgentConnector_ms": 0.06598830223083496}}, "episode_reward_max": -8815.574794954508, "episode_reward_min": -9066.232257208054, "episode_reward_mean": -8926.136308309737, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8834.3424494325, -8899.145515425433, -8997.500782444551, -8978.078739133285, -8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457, -8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889, -8889.472635975251, -8906.619853432872, -8878.168071336153, -8882.775351671515, -8932.84739972312, -8901.64930350409, -8967.770229630327, -8966.339500051401, -9066.232257208054, -8911.72112933767, -8932.513071091309, -8932.4685824968, -8893.745840755053, -8863.09819644699, -8878.527586944105, -8907.55480373617], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.562681432870652, "mean_inference_ms": 0.3686612206329409, "mean_action_processing_ms": 0.09118280810647876, "mean_env_wait_ms": 0.9286644701409011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003404378890991211, "StateBufferConnector_ms": 0.0025763511657714844, "ViewRequirementAgentConnector_ms": 0.06598830223083496}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 221880, "num_agent_steps_trained": 221880, "num_env_steps_sampled": 221880, "num_env_steps_trained": 221880, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 113.21522240881698, "num_env_steps_trained_throughput_per_sec": 113.21522240881698, "timesteps_total": 221880, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 221880, "timers": {"training_iteration_time_ms": 3238.414, "sample_time_ms": 3227.82, "load_time_ms": 0.302, "load_throughput": 1190717.956, "learn_time_ms": 9.52, "learn_throughput": 37814.723, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 221880, "num_env_steps_trained": 221880, "num_agent_steps_sampled": 221880, "num_agent_steps_trained": 221880}, "done": false, "episodes_total": 1097, "training_iteration": 231, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-57-41", "timestamp": 1691132261, "time_this_iter_s": 12.722023248672485, "time_total_s": 2646.936019182205, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 917.1052923202515, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 24.37222222222222, "ram_util_percent": 64.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.163818359375, "policy_loss": -1980800529.525, "vf_loss": 130775445.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1433.0, "diff_num_grad_updates_vs_sampler_policy": 1432.0}}, "num_env_steps_sampled": 223320, "num_env_steps_trained": 223320, "num_agent_steps_sampled": 223320, "num_agent_steps_trained": 223320}, "sampler_results": {"episode_reward_max": -8815.574794954508, "episode_reward_min": -9066.232257208054, "episode_reward_mean": -8923.945546281659, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457, -8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889, -8889.472635975251, -8906.619853432872, -8878.168071336153, -8882.775351671515, -8932.84739972312, -8901.64930350409, -8967.770229630327, -8966.339500051401, -9066.232257208054, -8911.72112933767, -8932.513071091309, -8932.4685824968, -8893.745840755053, -8863.09819644699, -8878.527586944105, -8907.55480373617, -8897.078607422802, -8821.22980054152, -8867.004527413315, -8904.678348250238], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.562889786096374, "mean_inference_ms": 0.3686715507901749, "mean_action_processing_ms": 0.09118298780451523, "mean_env_wait_ms": 0.9279466559351895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003408670425415039, "StateBufferConnector_ms": 0.002568483352661133, "ViewRequirementAgentConnector_ms": 0.06598734855651855}}, "episode_reward_max": -8815.574794954508, "episode_reward_min": -9066.232257208054, "episode_reward_mean": -8923.945546281659, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8899.711164559956, -8938.89984798986, -8923.14427921984, -9021.039655785542, -8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457, -8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889, -8889.472635975251, -8906.619853432872, -8878.168071336153, -8882.775351671515, -8932.84739972312, -8901.64930350409, -8967.770229630327, -8966.339500051401, -9066.232257208054, -8911.72112933767, -8932.513071091309, -8932.4685824968, -8893.745840755053, -8863.09819644699, -8878.527586944105, -8907.55480373617, -8897.078607422802, -8821.22980054152, -8867.004527413315, -8904.678348250238], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.562889786096374, "mean_inference_ms": 0.3686715507901749, "mean_action_processing_ms": 0.09118298780451523, "mean_env_wait_ms": 0.9279466559351895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003408670425415039, "StateBufferConnector_ms": 0.002568483352661133, "ViewRequirementAgentConnector_ms": 0.06598734855651855}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 223320, "num_agent_steps_trained": 223320, "num_env_steps_sampled": 223320, "num_env_steps_trained": 223320, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 114.64178036750336, "num_env_steps_trained_throughput_per_sec": 114.64178036750336, "timesteps_total": 223320, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 223320, "timers": {"training_iteration_time_ms": 3183.546, "sample_time_ms": 3173.013, "load_time_ms": 0.301, "load_throughput": 1194958.405, "learn_time_ms": 9.475, "learn_throughput": 37994.752, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 223320, "num_env_steps_trained": 223320, "num_agent_steps_sampled": 223320, "num_agent_steps_trained": 223320}, "done": false, "episodes_total": 1101, "training_iteration": 232, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-57-54", "timestamp": 1691132274, "time_this_iter_s": 12.563674926757812, "time_total_s": 2659.499694108963, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 929.6689672470093, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 25.67058823529412, "ram_util_percent": 64.11176470588236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.0107788085937, "policy_loss": -4293107102.1, "vf_loss": 133194502.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1453.0, "diff_num_grad_updates_vs_sampler_policy": 1452.0}}, "num_env_steps_sampled": 224760, "num_env_steps_trained": 224760, "num_agent_steps_sampled": 224760, "num_agent_steps_trained": 224760}, "sampler_results": {"episode_reward_max": -8815.574794954508, "episode_reward_min": -9066.232257208054, "episode_reward_mean": -8923.995052650946, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457, -8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889, -8889.472635975251, -8906.619853432872, -8878.168071336153, -8882.775351671515, -8932.84739972312, -8901.64930350409, -8967.770229630327, -8966.339500051401, -9066.232257208054, -8911.72112933767, -8932.513071091309, -8932.4685824968, -8893.745840755053, -8863.09819644699, -8878.527586944105, -8907.55480373617, -8897.078607422802, -8821.22980054152, -8867.004527413315, -8904.678348250238, -8983.15717370784, -8922.883652300165, -8922.485820161637, -8959.21893831433], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.562160387669512, "mean_inference_ms": 0.36865404527833584, "mean_action_processing_ms": 0.0911759647830333, "mean_env_wait_ms": 0.9271720553614098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003397226333618164, "StateBufferConnector_ms": 0.002544879913330078, "ViewRequirementAgentConnector_ms": 0.06551265716552734}}, "episode_reward_max": -8815.574794954508, "episode_reward_min": -9066.232257208054, "episode_reward_mean": -8923.995052650946, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8907.416349054974, -8890.114733447625, -8930.211479692, -8815.574794954508, -8896.617429531183, -8888.952131610356, -8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457, -8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889, -8889.472635975251, -8906.619853432872, -8878.168071336153, -8882.775351671515, -8932.84739972312, -8901.64930350409, -8967.770229630327, -8966.339500051401, -9066.232257208054, -8911.72112933767, -8932.513071091309, -8932.4685824968, -8893.745840755053, -8863.09819644699, -8878.527586944105, -8907.55480373617, -8897.078607422802, -8821.22980054152, -8867.004527413315, -8904.678348250238, -8983.15717370784, -8922.883652300165, -8922.485820161637, -8959.21893831433], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.562160387669512, "mean_inference_ms": 0.36865404527833584, "mean_action_processing_ms": 0.0911759647830333, "mean_env_wait_ms": 0.9271720553614098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003397226333618164, "StateBufferConnector_ms": 0.002544879913330078, "ViewRequirementAgentConnector_ms": 0.06551265716552734}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224760, "num_agent_steps_trained": 224760, "num_env_steps_sampled": 224760, "num_env_steps_trained": 224760, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 139.8806273411538, "num_env_steps_trained_throughput_per_sec": 139.8806273411538, "timesteps_total": 224760, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 224760, "timers": {"training_iteration_time_ms": 2944.379, "sample_time_ms": 2934.546, "load_time_ms": 0.288, "load_throughput": 1252134.87, "learn_time_ms": 8.829, "learn_throughput": 40773.85, "synch_weights_time_ms": 0.675}, "counters": {"num_env_steps_sampled": 224760, "num_env_steps_trained": 224760, "num_agent_steps_sampled": 224760, "num_agent_steps_trained": 224760}, "done": false, "episodes_total": 1105, "training_iteration": 233, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-58-04", "timestamp": 1691132284, "time_this_iter_s": 10.296450853347778, "time_total_s": 2669.796144962311, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 939.965418100357, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 27.02, "ram_util_percent": 64.11333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.1426025390625, "policy_loss": -1849506453.05, "vf_loss": 132640788.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1483.0, "diff_num_grad_updates_vs_sampler_policy": 1482.0}}, "num_env_steps_sampled": 226920, "num_env_steps_trained": 226920, "num_agent_steps_sampled": 226920, "num_agent_steps_trained": 226920}, "sampler_results": {"episode_reward_max": -8821.22980054152, "episode_reward_min": -9066.232257208054, "episode_reward_mean": -8924.523234645718, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457, -8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889, -8889.472635975251, -8906.619853432872, -8878.168071336153, -8882.775351671515, -8932.84739972312, -8901.64930350409, -8967.770229630327, -8966.339500051401, -9066.232257208054, -8911.72112933767, -8932.513071091309, -8932.4685824968, -8893.745840755053, -8863.09819644699, -8878.527586944105, -8907.55480373617, -8897.078607422802, -8821.22980054152, -8867.004527413315, -8904.678348250238, -8983.15717370784, -8922.883652300165, -8922.485820161637, -8959.21893831433, -8910.547173860863, -8891.906074672048, -8906.214432990762, -8874.088703230042, -8833.014803664486, -8965.933929349756], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.557175003833686, "mean_inference_ms": 0.36845938863780264, "mean_action_processing_ms": 0.0911236644828638, "mean_env_wait_ms": 0.9256413907543972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033402442932128906, "StateBufferConnector_ms": 0.0024886131286621094, "ViewRequirementAgentConnector_ms": 0.06410336494445801}}, "episode_reward_max": -8821.22980054152, "episode_reward_min": -9066.232257208054, "episode_reward_mean": -8924.523234645718, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8949.90210129751, -8935.962339891355, -8958.878168696714, -8870.741762961785, -8916.765368909979, -8910.274038689924, -8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457, -8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889, -8889.472635975251, -8906.619853432872, -8878.168071336153, -8882.775351671515, -8932.84739972312, -8901.64930350409, -8967.770229630327, -8966.339500051401, -9066.232257208054, -8911.72112933767, -8932.513071091309, -8932.4685824968, -8893.745840755053, -8863.09819644699, -8878.527586944105, -8907.55480373617, -8897.078607422802, -8821.22980054152, -8867.004527413315, -8904.678348250238, -8983.15717370784, -8922.883652300165, -8922.485820161637, -8959.21893831433, -8910.547173860863, -8891.906074672048, -8906.214432990762, -8874.088703230042, -8833.014803664486, -8965.933929349756], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.557175003833686, "mean_inference_ms": 0.36845938863780264, "mean_action_processing_ms": 0.0911236644828638, "mean_env_wait_ms": 0.9256413907543972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033402442932128906, "StateBufferConnector_ms": 0.0024886131286621094, "ViewRequirementAgentConnector_ms": 0.06410336494445801}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 226920, "num_agent_steps_trained": 226920, "num_env_steps_sampled": 226920, "num_env_steps_trained": 226920, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.1890454243329, "num_env_steps_trained_throughput_per_sec": 190.1890454243329, "timesteps_total": 226920, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 226920, "timers": {"training_iteration_time_ms": 2165.152, "sample_time_ms": 2157.486, "load_time_ms": 0.239, "load_throughput": 1504533.121, "learn_time_ms": 6.835, "learn_throughput": 52673.696, "synch_weights_time_ms": 0.557}, "counters": {"num_env_steps_sampled": 226920, "num_env_steps_trained": 226920, "num_agent_steps_sampled": 226920, "num_agent_steps_trained": 226920}, "done": false, "episodes_total": 1111, "training_iteration": 234, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-58-16", "timestamp": 1691132296, "time_this_iter_s": 11.359311819076538, "time_total_s": 2681.1554567813873, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 951.3247299194336, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 44.63125, "ram_util_percent": 64.16874999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.167724609375, "policy_loss": -465206687.2, "vf_loss": 131679786.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1513.0, "diff_num_grad_updates_vs_sampler_policy": 1512.0}}, "num_env_steps_sampled": 229080, "num_env_steps_trained": 229080, "num_agent_steps_sampled": 229080, "num_agent_steps_trained": 229080}, "sampler_results": {"episode_reward_max": -8821.22980054152, "episode_reward_min": -9066.232257208054, "episode_reward_mean": -8925.044671735268, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457, -8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889, -8889.472635975251, -8906.619853432872, -8878.168071336153, -8882.775351671515, -8932.84739972312, -8901.64930350409, -8967.770229630327, -8966.339500051401, -9066.232257208054, -8911.72112933767, -8932.513071091309, -8932.4685824968, -8893.745840755053, -8863.09819644699, -8878.527586944105, -8907.55480373617, -8897.078607422802, -8821.22980054152, -8867.004527413315, -8904.678348250238, -8983.15717370784, -8922.883652300165, -8922.485820161637, -8959.21893831433, -8910.547173860863, -8891.906074672048, -8906.214432990762, -8874.088703230042, -8833.014803664486, -8965.933929349756, -8891.548541044538, -8862.603318572787, -8992.496484738396, -8904.14311699125, -9013.821254439341, -8930.054773615759], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.548605248083669, "mean_inference_ms": 0.36810386835608455, "mean_action_processing_ms": 0.09103163224737593, "mean_env_wait_ms": 0.9237653281430441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032837390899658203, "StateBufferConnector_ms": 0.002429962158203125, "ViewRequirementAgentConnector_ms": 0.06278538703918457}}, "episode_reward_max": -8821.22980054152, "episode_reward_min": -9066.232257208054, "episode_reward_mean": -8925.044671735268, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8909.991142695606, -8910.093893357216, -8955.261613749572, -8933.622626174007, -8942.011576193014, -8978.587924234125, -8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457, -8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889, -8889.472635975251, -8906.619853432872, -8878.168071336153, -8882.775351671515, -8932.84739972312, -8901.64930350409, -8967.770229630327, -8966.339500051401, -9066.232257208054, -8911.72112933767, -8932.513071091309, -8932.4685824968, -8893.745840755053, -8863.09819644699, -8878.527586944105, -8907.55480373617, -8897.078607422802, -8821.22980054152, -8867.004527413315, -8904.678348250238, -8983.15717370784, -8922.883652300165, -8922.485820161637, -8959.21893831433, -8910.547173860863, -8891.906074672048, -8906.214432990762, -8874.088703230042, -8833.014803664486, -8965.933929349756, -8891.548541044538, -8862.603318572787, -8992.496484738396, -8904.14311699125, -9013.821254439341, -8930.054773615759], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.548605248083669, "mean_inference_ms": 0.36810386835608455, "mean_action_processing_ms": 0.09103163224737593, "mean_env_wait_ms": 0.9237653281430441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032837390899658203, "StateBufferConnector_ms": 0.002429962158203125, "ViewRequirementAgentConnector_ms": 0.06278538703918457}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 229080, "num_agent_steps_trained": 229080, "num_env_steps_sampled": 229080, "num_env_steps_trained": 229080, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.53390608380906, "num_env_steps_trained_throughput_per_sec": 189.53390608380906, "timesteps_total": 229080, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 229080, "timers": {"training_iteration_time_ms": 1895.952, "sample_time_ms": 1889.094, "load_time_ms": 0.217, "load_throughput": 1660379.855, "learn_time_ms": 6.1, "learn_throughput": 59017.211, "synch_weights_time_ms": 0.509}, "counters": {"num_env_steps_sampled": 229080, "num_env_steps_trained": 229080, "num_agent_steps_sampled": 229080, "num_agent_steps_trained": 229080}, "done": false, "episodes_total": 1117, "training_iteration": 235, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-58-27", "timestamp": 1691132307, "time_this_iter_s": 11.398524045944214, "time_total_s": 2692.5539808273315, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 962.7232539653778, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 22.775, "ram_util_percent": 64.275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.2117797851563, "policy_loss": -973235410.375, "vf_loss": 131299865.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1543.0, "diff_num_grad_updates_vs_sampler_policy": 1542.0}}, "num_env_steps_sampled": 231240, "num_env_steps_trained": 231240, "num_agent_steps_sampled": 231240, "num_agent_steps_trained": 231240}, "sampler_results": {"episode_reward_max": -8821.22980054152, "episode_reward_min": -9066.232257208054, "episode_reward_mean": -8923.071510096535, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457, -8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889, -8889.472635975251, -8906.619853432872, -8878.168071336153, -8882.775351671515, -8932.84739972312, -8901.64930350409, -8967.770229630327, -8966.339500051401, -9066.232257208054, -8911.72112933767, -8932.513071091309, -8932.4685824968, -8893.745840755053, -8863.09819644699, -8878.527586944105, -8907.55480373617, -8897.078607422802, -8821.22980054152, -8867.004527413315, -8904.678348250238, -8983.15717370784, -8922.883652300165, -8922.485820161637, -8959.21893831433, -8910.547173860863, -8891.906074672048, -8906.214432990762, -8874.088703230042, -8833.014803664486, -8965.933929349756, -8891.548541044538, -8862.603318572787, -8992.496484738396, -8904.14311699125, -9013.821254439341, -8930.054773615759, -8923.094447037833, -8840.298915340903, -8919.482050470837, -8868.101437723672, -8946.006904564709, -8935.268857392382], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.536330395509819, "mean_inference_ms": 0.3676017955052852, "mean_action_processing_ms": 0.09090209134242082, "mean_env_wait_ms": 0.9215766700279009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003216266632080078, "StateBufferConnector_ms": 0.0023627281188964844, "ViewRequirementAgentConnector_ms": 0.0614011287689209}}, "episode_reward_max": -8821.22980054152, "episode_reward_min": -9066.232257208054, "episode_reward_mean": -8923.071510096535, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8999.701143097343, -8927.62800467389, -8874.387038813926, -8907.78939156922, -8970.515051562928, -8905.200282865391, -8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457, -8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889, -8889.472635975251, -8906.619853432872, -8878.168071336153, -8882.775351671515, -8932.84739972312, -8901.64930350409, -8967.770229630327, -8966.339500051401, -9066.232257208054, -8911.72112933767, -8932.513071091309, -8932.4685824968, -8893.745840755053, -8863.09819644699, -8878.527586944105, -8907.55480373617, -8897.078607422802, -8821.22980054152, -8867.004527413315, -8904.678348250238, -8983.15717370784, -8922.883652300165, -8922.485820161637, -8959.21893831433, -8910.547173860863, -8891.906074672048, -8906.214432990762, -8874.088703230042, -8833.014803664486, -8965.933929349756, -8891.548541044538, -8862.603318572787, -8992.496484738396, -8904.14311699125, -9013.821254439341, -8930.054773615759, -8923.094447037833, -8840.298915340903, -8919.482050470837, -8868.101437723672, -8946.006904564709, -8935.268857392382], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.536330395509819, "mean_inference_ms": 0.3676017955052852, "mean_action_processing_ms": 0.09090209134242082, "mean_env_wait_ms": 0.9215766700279009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003216266632080078, "StateBufferConnector_ms": 0.0023627281188964844, "ViewRequirementAgentConnector_ms": 0.0614011287689209}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 231240, "num_agent_steps_trained": 231240, "num_env_steps_sampled": 231240, "num_env_steps_trained": 231240, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 191.05193766892637, "num_env_steps_trained_throughput_per_sec": 191.05193766892637, "timesteps_total": 231240, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 231240, "timers": {"training_iteration_time_ms": 1888.798, "sample_time_ms": 1881.902, "load_time_ms": 0.219, "load_throughput": 1644287.749, "learn_time_ms": 6.126, "learn_throughput": 58769.132, "synch_weights_time_ms": 0.518}, "counters": {"num_env_steps_sampled": 231240, "num_env_steps_trained": 231240, "num_agent_steps_sampled": 231240, "num_agent_steps_trained": 231240}, "done": false, "episodes_total": 1123, "training_iteration": 236, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-58-38", "timestamp": 1691132318, "time_this_iter_s": 11.307838916778564, "time_total_s": 2703.86181974411, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 974.0310928821564, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 31.81875, "ram_util_percent": 64.28125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.2232299804688, "policy_loss": -407114463.6375, "vf_loss": 130123540.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1573.0, "diff_num_grad_updates_vs_sampler_policy": 1572.0}}, "num_env_steps_sampled": 233400, "num_env_steps_trained": 233400, "num_agent_steps_sampled": 233400, "num_agent_steps_trained": 233400}, "sampler_results": {"episode_reward_max": -8821.22980054152, "episode_reward_min": -9066.232257208054, "episode_reward_mean": -8922.987596282688, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457, -8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889, -8889.472635975251, -8906.619853432872, -8878.168071336153, -8882.775351671515, -8932.84739972312, -8901.64930350409, -8967.770229630327, -8966.339500051401, -9066.232257208054, -8911.72112933767, -8932.513071091309, -8932.4685824968, -8893.745840755053, -8863.09819644699, -8878.527586944105, -8907.55480373617, -8897.078607422802, -8821.22980054152, -8867.004527413315, -8904.678348250238, -8983.15717370784, -8922.883652300165, -8922.485820161637, -8959.21893831433, -8910.547173860863, -8891.906074672048, -8906.214432990762, -8874.088703230042, -8833.014803664486, -8965.933929349756, -8891.548541044538, -8862.603318572787, -8992.496484738396, -8904.14311699125, -9013.821254439341, -8930.054773615759, -8923.094447037833, -8840.298915340903, -8919.482050470837, -8868.101437723672, -8946.006904564709, -8935.268857392382, -8985.667082333623, -8960.965083934294, -8896.093997598005, -8868.591017729454, -8982.88825193997, -8882.624097662685], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.520503867441692, "mean_inference_ms": 0.3669583869857563, "mean_action_processing_ms": 0.0907365460319253, "mean_env_wait_ms": 0.919108834930979, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031664371490478516, "StateBufferConnector_ms": 0.002311229705810547, "ViewRequirementAgentConnector_ms": 0.060132741928100586}}, "episode_reward_max": -8821.22980054152, "episode_reward_min": -9066.232257208054, "episode_reward_mean": -8922.987596282688, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8905.670477820624, -9000.865535198043, -8943.464093642531, -8934.551308546592, -8899.772045561376, -8920.77158434103, -8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457, -8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889, -8889.472635975251, -8906.619853432872, -8878.168071336153, -8882.775351671515, -8932.84739972312, -8901.64930350409, -8967.770229630327, -8966.339500051401, -9066.232257208054, -8911.72112933767, -8932.513071091309, -8932.4685824968, -8893.745840755053, -8863.09819644699, -8878.527586944105, -8907.55480373617, -8897.078607422802, -8821.22980054152, -8867.004527413315, -8904.678348250238, -8983.15717370784, -8922.883652300165, -8922.485820161637, -8959.21893831433, -8910.547173860863, -8891.906074672048, -8906.214432990762, -8874.088703230042, -8833.014803664486, -8965.933929349756, -8891.548541044538, -8862.603318572787, -8992.496484738396, -8904.14311699125, -9013.821254439341, -8930.054773615759, -8923.094447037833, -8840.298915340903, -8919.482050470837, -8868.101437723672, -8946.006904564709, -8935.268857392382, -8985.667082333623, -8960.965083934294, -8896.093997598005, -8868.591017729454, -8982.88825193997, -8882.624097662685], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.520503867441692, "mean_inference_ms": 0.3669583869857563, "mean_action_processing_ms": 0.0907365460319253, "mean_env_wait_ms": 0.919108834930979, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031664371490478516, "StateBufferConnector_ms": 0.002311229705810547, "ViewRequirementAgentConnector_ms": 0.060132741928100586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 233400, "num_agent_steps_trained": 233400, "num_env_steps_sampled": 233400, "num_env_steps_trained": 233400, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.92031075533743, "num_env_steps_trained_throughput_per_sec": 190.92031075533743, "timesteps_total": 233400, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 233400, "timers": {"training_iteration_time_ms": 1886.035, "sample_time_ms": 1879.148, "load_time_ms": 0.221, "load_throughput": 1626399.655, "learn_time_ms": 6.122, "learn_throughput": 58801.402, "synch_weights_time_ms": 0.51}, "counters": {"num_env_steps_sampled": 233400, "num_env_steps_trained": 233400, "num_agent_steps_sampled": 233400, "num_agent_steps_trained": 233400}, "done": false, "episodes_total": 1129, "training_iteration": 237, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-58-50", "timestamp": 1691132330, "time_this_iter_s": 11.315907955169678, "time_total_s": 2715.17772769928, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 985.347000837326, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 26.61764705882353, "ram_util_percent": 63.829411764705874}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.2042358398437, "policy_loss": -1269580207.85, "vf_loss": 130384708.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1603.0, "diff_num_grad_updates_vs_sampler_policy": 1602.0}}, "num_env_steps_sampled": 235560, "num_env_steps_trained": 235560, "num_agent_steps_sampled": 235560, "num_agent_steps_trained": 235560}, "sampler_results": {"episode_reward_max": -8821.22980054152, "episode_reward_min": -9066.232257208054, "episode_reward_mean": -8921.201720468789, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457, -8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889, -8889.472635975251, -8906.619853432872, -8878.168071336153, -8882.775351671515, -8932.84739972312, -8901.64930350409, -8967.770229630327, -8966.339500051401, -9066.232257208054, -8911.72112933767, -8932.513071091309, -8932.4685824968, -8893.745840755053, -8863.09819644699, -8878.527586944105, -8907.55480373617, -8897.078607422802, -8821.22980054152, -8867.004527413315, -8904.678348250238, -8983.15717370784, -8922.883652300165, -8922.485820161637, -8959.21893831433, -8910.547173860863, -8891.906074672048, -8906.214432990762, -8874.088703230042, -8833.014803664486, -8965.933929349756, -8891.548541044538, -8862.603318572787, -8992.496484738396, -8904.14311699125, -9013.821254439341, -8930.054773615759, -8923.094447037833, -8840.298915340903, -8919.482050470837, -8868.101437723672, -8946.006904564709, -8935.268857392382, -8985.667082333623, -8960.965083934294, -8896.093997598005, -8868.591017729454, -8982.88825193997, -8882.624097662685, -8876.430231376777, -8986.857490106484, -8879.262860422888, -8846.723525995047, -8939.435238088616, -8897.798117730641], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.501215440696551, "mean_inference_ms": 0.36617650894684806, "mean_action_processing_ms": 0.09053558084176613, "mean_env_wait_ms": 0.9163946297485137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031092166900634766, "StateBufferConnector_ms": 0.0022630691528320312, "ViewRequirementAgentConnector_ms": 0.058878421783447266}}, "episode_reward_max": -8821.22980054152, "episode_reward_min": -9066.232257208054, "episode_reward_mean": -8921.201720468789, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8942.997144431516, -8981.509537296613, -8865.3277624234, -8935.199109371355, -8948.741058853242, -8921.66060406659, -8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457, -8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889, -8889.472635975251, -8906.619853432872, -8878.168071336153, -8882.775351671515, -8932.84739972312, -8901.64930350409, -8967.770229630327, -8966.339500051401, -9066.232257208054, -8911.72112933767, -8932.513071091309, -8932.4685824968, -8893.745840755053, -8863.09819644699, -8878.527586944105, -8907.55480373617, -8897.078607422802, -8821.22980054152, -8867.004527413315, -8904.678348250238, -8983.15717370784, -8922.883652300165, -8922.485820161637, -8959.21893831433, -8910.547173860863, -8891.906074672048, -8906.214432990762, -8874.088703230042, -8833.014803664486, -8965.933929349756, -8891.548541044538, -8862.603318572787, -8992.496484738396, -8904.14311699125, -9013.821254439341, -8930.054773615759, -8923.094447037833, -8840.298915340903, -8919.482050470837, -8868.101437723672, -8946.006904564709, -8935.268857392382, -8985.667082333623, -8960.965083934294, -8896.093997598005, -8868.591017729454, -8982.88825193997, -8882.624097662685, -8876.430231376777, -8986.857490106484, -8879.262860422888, -8846.723525995047, -8939.435238088616, -8897.798117730641], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.501215440696551, "mean_inference_ms": 0.36617650894684806, "mean_action_processing_ms": 0.09053558084176613, "mean_env_wait_ms": 0.9163946297485137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031092166900634766, "StateBufferConnector_ms": 0.0022630691528320312, "ViewRequirementAgentConnector_ms": 0.058878421783447266}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 235560, "num_agent_steps_trained": 235560, "num_env_steps_sampled": 235560, "num_env_steps_trained": 235560, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.3164871693823, "num_env_steps_trained_throughput_per_sec": 190.3164871693823, "timesteps_total": 235560, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 235560, "timers": {"training_iteration_time_ms": 1888.035, "sample_time_ms": 1881.138, "load_time_ms": 0.222, "load_throughput": 1622031.84, "learn_time_ms": 6.129, "learn_throughput": 58737.812, "synch_weights_time_ms": 0.513}, "counters": {"num_env_steps_sampled": 235560, "num_env_steps_trained": 235560, "num_agent_steps_sampled": 235560, "num_agent_steps_trained": 235560}, "done": false, "episodes_total": 1135, "training_iteration": 238, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-59-01", "timestamp": 1691132341, "time_this_iter_s": 11.351493835449219, "time_total_s": 2726.529221534729, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 996.6984946727753, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 20.1125, "ram_util_percent": 63.88125000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.0543334960937, "policy_loss": -3245163060.65, "vf_loss": 132656752.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1633.0, "diff_num_grad_updates_vs_sampler_policy": 1632.0}}, "num_env_steps_sampled": 237720, "num_env_steps_trained": 237720, "num_agent_steps_sampled": 237720, "num_agent_steps_trained": 237720}, "sampler_results": {"episode_reward_max": -8821.22980054152, "episode_reward_min": -9066.232257208054, "episode_reward_mean": -8920.580162030094, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457, -8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889, -8889.472635975251, -8906.619853432872, -8878.168071336153, -8882.775351671515, -8932.84739972312, -8901.64930350409, -8967.770229630327, -8966.339500051401, -9066.232257208054, -8911.72112933767, -8932.513071091309, -8932.4685824968, -8893.745840755053, -8863.09819644699, -8878.527586944105, -8907.55480373617, -8897.078607422802, -8821.22980054152, -8867.004527413315, -8904.678348250238, -8983.15717370784, -8922.883652300165, -8922.485820161637, -8959.21893831433, -8910.547173860863, -8891.906074672048, -8906.214432990762, -8874.088703230042, -8833.014803664486, -8965.933929349756, -8891.548541044538, -8862.603318572787, -8992.496484738396, -8904.14311699125, -9013.821254439341, -8930.054773615759, -8923.094447037833, -8840.298915340903, -8919.482050470837, -8868.101437723672, -8946.006904564709, -8935.268857392382, -8985.667082333623, -8960.965083934294, -8896.093997598005, -8868.591017729454, -8982.88825193997, -8882.624097662685, -8876.430231376777, -8986.857490106484, -8879.262860422888, -8846.723525995047, -8939.435238088616, -8897.798117730641, -8975.553234674177, -8954.013636267562, -8921.580708788566, -8882.341541296597, -8859.242211943978, -8940.54803960217], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.478662236919917, "mean_inference_ms": 0.36526166708263963, "mean_action_processing_ms": 0.0903014237037895, "mean_env_wait_ms": 0.9134083749467422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030410289764404297, "StateBufferConnector_ms": 0.0022134780883789062, "ViewRequirementAgentConnector_ms": 0.05765581130981445}}, "episode_reward_max": -8821.22980054152, "episode_reward_min": -9066.232257208054, "episode_reward_mean": -8920.580162030094, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8881.52250927416, -8883.41106655106, -8933.216015395896, -8958.499576023676, -8865.11911872425, -8934.676789236215, -8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457, -8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889, -8889.472635975251, -8906.619853432872, -8878.168071336153, -8882.775351671515, -8932.84739972312, -8901.64930350409, -8967.770229630327, -8966.339500051401, -9066.232257208054, -8911.72112933767, -8932.513071091309, -8932.4685824968, -8893.745840755053, -8863.09819644699, -8878.527586944105, -8907.55480373617, -8897.078607422802, -8821.22980054152, -8867.004527413315, -8904.678348250238, -8983.15717370784, -8922.883652300165, -8922.485820161637, -8959.21893831433, -8910.547173860863, -8891.906074672048, -8906.214432990762, -8874.088703230042, -8833.014803664486, -8965.933929349756, -8891.548541044538, -8862.603318572787, -8992.496484738396, -8904.14311699125, -9013.821254439341, -8930.054773615759, -8923.094447037833, -8840.298915340903, -8919.482050470837, -8868.101437723672, -8946.006904564709, -8935.268857392382, -8985.667082333623, -8960.965083934294, -8896.093997598005, -8868.591017729454, -8982.88825193997, -8882.624097662685, -8876.430231376777, -8986.857490106484, -8879.262860422888, -8846.723525995047, -8939.435238088616, -8897.798117730641, -8975.553234674177, -8954.013636267562, -8921.580708788566, -8882.341541296597, -8859.242211943978, -8940.54803960217], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.478662236919917, "mean_inference_ms": 0.36526166708263963, "mean_action_processing_ms": 0.0903014237037895, "mean_env_wait_ms": 0.9134083749467422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030410289764404297, "StateBufferConnector_ms": 0.0022134780883789062, "ViewRequirementAgentConnector_ms": 0.05765581130981445}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 237720, "num_agent_steps_trained": 237720, "num_env_steps_sampled": 237720, "num_env_steps_trained": 237720, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.5629433967649, "num_env_steps_trained_throughput_per_sec": 189.5629433967649, "timesteps_total": 237720, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 237720, "timers": {"training_iteration_time_ms": 1896.819, "sample_time_ms": 1889.933, "load_time_ms": 0.217, "load_throughput": 1656009.476, "learn_time_ms": 6.122, "learn_throughput": 58805.982, "synch_weights_time_ms": 0.514}, "counters": {"num_env_steps_sampled": 237720, "num_env_steps_trained": 237720, "num_agent_steps_sampled": 237720, "num_agent_steps_trained": 237720}, "done": false, "episodes_total": 1141, "training_iteration": 239, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-59-13", "timestamp": 1691132353, "time_this_iter_s": 11.39660120010376, "time_total_s": 2737.9258227348328, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1008.095095872879, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 23.30625, "ram_util_percent": 64.04375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.1066650390625, "policy_loss": -2161150811.875, "vf_loss": 132909157.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1663.0, "diff_num_grad_updates_vs_sampler_policy": 1662.0}}, "num_env_steps_sampled": 239880, "num_env_steps_trained": 239880, "num_agent_steps_sampled": 239880, "num_agent_steps_trained": 239880}, "sampler_results": {"episode_reward_max": -8821.22980054152, "episode_reward_min": -9066.232257208054, "episode_reward_mean": -8923.052857289644, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457, -8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889, -8889.472635975251, -8906.619853432872, -8878.168071336153, -8882.775351671515, -8932.84739972312, -8901.64930350409, -8967.770229630327, -8966.339500051401, -9066.232257208054, -8911.72112933767, -8932.513071091309, -8932.4685824968, -8893.745840755053, -8863.09819644699, -8878.527586944105, -8907.55480373617, -8897.078607422802, -8821.22980054152, -8867.004527413315, -8904.678348250238, -8983.15717370784, -8922.883652300165, -8922.485820161637, -8959.21893831433, -8910.547173860863, -8891.906074672048, -8906.214432990762, -8874.088703230042, -8833.014803664486, -8965.933929349756, -8891.548541044538, -8862.603318572787, -8992.496484738396, -8904.14311699125, -9013.821254439341, -8930.054773615759, -8923.094447037833, -8840.298915340903, -8919.482050470837, -8868.101437723672, -8946.006904564709, -8935.268857392382, -8985.667082333623, -8960.965083934294, -8896.093997598005, -8868.591017729454, -8982.88825193997, -8882.624097662685, -8876.430231376777, -8986.857490106484, -8879.262860422888, -8846.723525995047, -8939.435238088616, -8897.798117730641, -8975.553234674177, -8954.013636267562, -8921.580708788566, -8882.341541296597, -8859.242211943978, -8940.54803960217, -9060.240958378688, -8892.868959338033, -8866.977993793265, -8917.897705626423, -8994.113473994106, -8971.615510029722], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.453447118602935, "mean_inference_ms": 0.3642291127208477, "mean_action_processing_ms": 0.09003665830402931, "mean_env_wait_ms": 0.9101683813000815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002977132797241211, "StateBufferConnector_ms": 0.002177000045776367, "ViewRequirementAgentConnector_ms": 0.0564732551574707}}, "episode_reward_max": -8821.22980054152, "episode_reward_min": -9066.232257208054, "episode_reward_mean": -8923.052857289644, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8962.302396614448, -8906.07257930271, -8920.581028141405, -8904.206445274895, -8889.432955623492, -8913.394391241007, -9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457, -8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889, -8889.472635975251, -8906.619853432872, -8878.168071336153, -8882.775351671515, -8932.84739972312, -8901.64930350409, -8967.770229630327, -8966.339500051401, -9066.232257208054, -8911.72112933767, -8932.513071091309, -8932.4685824968, -8893.745840755053, -8863.09819644699, -8878.527586944105, -8907.55480373617, -8897.078607422802, -8821.22980054152, -8867.004527413315, -8904.678348250238, -8983.15717370784, -8922.883652300165, -8922.485820161637, -8959.21893831433, -8910.547173860863, -8891.906074672048, -8906.214432990762, -8874.088703230042, -8833.014803664486, -8965.933929349756, -8891.548541044538, -8862.603318572787, -8992.496484738396, -8904.14311699125, -9013.821254439341, -8930.054773615759, -8923.094447037833, -8840.298915340903, -8919.482050470837, -8868.101437723672, -8946.006904564709, -8935.268857392382, -8985.667082333623, -8960.965083934294, -8896.093997598005, -8868.591017729454, -8982.88825193997, -8882.624097662685, -8876.430231376777, -8986.857490106484, -8879.262860422888, -8846.723525995047, -8939.435238088616, -8897.798117730641, -8975.553234674177, -8954.013636267562, -8921.580708788566, -8882.341541296597, -8859.242211943978, -8940.54803960217, -9060.240958378688, -8892.868959338033, -8866.977993793265, -8917.897705626423, -8994.113473994106, -8971.615510029722], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.453447118602935, "mean_inference_ms": 0.3642291127208477, "mean_action_processing_ms": 0.09003665830402931, "mean_env_wait_ms": 0.9101683813000815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002977132797241211, "StateBufferConnector_ms": 0.002177000045776367, "ViewRequirementAgentConnector_ms": 0.0564732551574707}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 239880, "num_agent_steps_trained": 239880, "num_env_steps_sampled": 239880, "num_env_steps_trained": 239880, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 182.92805416790085, "num_env_steps_trained_throughput_per_sec": 182.92805416790085, "timesteps_total": 239880, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 239880, "timers": {"training_iteration_time_ms": 1941.38, "sample_time_ms": 1934.253, "load_time_ms": 0.234, "load_throughput": 1535750.041, "learn_time_ms": 6.32, "learn_throughput": 56959.02, "synch_weights_time_ms": 0.539}, "counters": {"num_env_steps_sampled": 239880, "num_env_steps_trained": 239880, "num_agent_steps_sampled": 239880, "num_agent_steps_trained": 239880}, "done": false, "episodes_total": 1147, "training_iteration": 240, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-59-24", "timestamp": 1691132364, "time_this_iter_s": 11.809905290603638, "time_total_s": 2749.7357280254364, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1019.9050011634827, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 47.89411764705883, "ram_util_percent": 64.91764705882352}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.0369018554687, "policy_loss": -3003942416.6875, "vf_loss": 132720524.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1693.0, "diff_num_grad_updates_vs_sampler_policy": 1692.0}}, "num_env_steps_sampled": 242040, "num_env_steps_trained": 242040, "num_agent_steps_sampled": 242040, "num_agent_steps_trained": 242040}, "sampler_results": {"episode_reward_max": -8821.22980054152, "episode_reward_min": -9066.232257208054, "episode_reward_mean": -8923.932909766481, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457, -8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889, -8889.472635975251, -8906.619853432872, -8878.168071336153, -8882.775351671515, -8932.84739972312, -8901.64930350409, -8967.770229630327, -8966.339500051401, -9066.232257208054, -8911.72112933767, -8932.513071091309, -8932.4685824968, -8893.745840755053, -8863.09819644699, -8878.527586944105, -8907.55480373617, -8897.078607422802, -8821.22980054152, -8867.004527413315, -8904.678348250238, -8983.15717370784, -8922.883652300165, -8922.485820161637, -8959.21893831433, -8910.547173860863, -8891.906074672048, -8906.214432990762, -8874.088703230042, -8833.014803664486, -8965.933929349756, -8891.548541044538, -8862.603318572787, -8992.496484738396, -8904.14311699125, -9013.821254439341, -8930.054773615759, -8923.094447037833, -8840.298915340903, -8919.482050470837, -8868.101437723672, -8946.006904564709, -8935.268857392382, -8985.667082333623, -8960.965083934294, -8896.093997598005, -8868.591017729454, -8982.88825193997, -8882.624097662685, -8876.430231376777, -8986.857490106484, -8879.262860422888, -8846.723525995047, -8939.435238088616, -8897.798117730641, -8975.553234674177, -8954.013636267562, -8921.580708788566, -8882.341541296597, -8859.242211943978, -8940.54803960217, -9060.240958378688, -8892.868959338033, -8866.977993793265, -8917.897705626423, -8994.113473994106, -8971.615510029722, -8901.701018000687, -8918.512362732507, -8870.904096379423, -8939.192816879746, -9002.24447245013, -8951.440277439457], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.425312293956336, "mean_inference_ms": 0.36307544490671767, "mean_action_processing_ms": 0.08974099956117611, "mean_env_wait_ms": 0.906664736441703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029134750366210938, "StateBufferConnector_ms": 0.0021238327026367188, "ViewRequirementAgentConnector_ms": 0.055117130279541016}}, "episode_reward_max": -8821.22980054152, "episode_reward_min": -9066.232257208054, "episode_reward_mean": -8923.932909766481, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9003.898217522345, -8900.279808505116, -8997.745293246027, -8923.75964054313, -8906.140043062363, -8938.839685659337, -8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457, -8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889, -8889.472635975251, -8906.619853432872, -8878.168071336153, -8882.775351671515, -8932.84739972312, -8901.64930350409, -8967.770229630327, -8966.339500051401, -9066.232257208054, -8911.72112933767, -8932.513071091309, -8932.4685824968, -8893.745840755053, -8863.09819644699, -8878.527586944105, -8907.55480373617, -8897.078607422802, -8821.22980054152, -8867.004527413315, -8904.678348250238, -8983.15717370784, -8922.883652300165, -8922.485820161637, -8959.21893831433, -8910.547173860863, -8891.906074672048, -8906.214432990762, -8874.088703230042, -8833.014803664486, -8965.933929349756, -8891.548541044538, -8862.603318572787, -8992.496484738396, -8904.14311699125, -9013.821254439341, -8930.054773615759, -8923.094447037833, -8840.298915340903, -8919.482050470837, -8868.101437723672, -8946.006904564709, -8935.268857392382, -8985.667082333623, -8960.965083934294, -8896.093997598005, -8868.591017729454, -8982.88825193997, -8882.624097662685, -8876.430231376777, -8986.857490106484, -8879.262860422888, -8846.723525995047, -8939.435238088616, -8897.798117730641, -8975.553234674177, -8954.013636267562, -8921.580708788566, -8882.341541296597, -8859.242211943978, -8940.54803960217, -9060.240958378688, -8892.868959338033, -8866.977993793265, -8917.897705626423, -8994.113473994106, -8971.615510029722, -8901.701018000687, -8918.512362732507, -8870.904096379423, -8939.192816879746, -9002.24447245013, -8951.440277439457], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.425312293956336, "mean_inference_ms": 0.36307544490671767, "mean_action_processing_ms": 0.08974099956117611, "mean_env_wait_ms": 0.906664736441703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029134750366210938, "StateBufferConnector_ms": 0.0021238327026367188, "ViewRequirementAgentConnector_ms": 0.055117130279541016}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 242040, "num_agent_steps_trained": 242040, "num_env_steps_sampled": 242040, "num_env_steps_trained": 242040, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.8104304365895, "num_env_steps_trained_throughput_per_sec": 189.8104304365895, "timesteps_total": 242040, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 242040, "timers": {"training_iteration_time_ms": 1944.333, "sample_time_ms": 1937.134, "load_time_ms": 0.238, "load_throughput": 1512672.25, "learn_time_ms": 6.377, "learn_throughput": 56452.195, "synch_weights_time_ms": 0.55}, "counters": {"num_env_steps_sampled": 242040, "num_env_steps_trained": 242040, "num_agent_steps_sampled": 242040, "num_agent_steps_trained": 242040}, "done": false, "episodes_total": 1153, "training_iteration": 241, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-59-36", "timestamp": 1691132376, "time_this_iter_s": 11.381826877593994, "time_total_s": 2761.1175549030304, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1031.2868280410767, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 35.43125, "ram_util_percent": 65.8125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.090185546875, "policy_loss": -2094472333.9, "vf_loss": 133199732.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1723.0, "diff_num_grad_updates_vs_sampler_policy": 1722.0}}, "num_env_steps_sampled": 244200, "num_env_steps_trained": 244200, "num_agent_steps_sampled": 244200, "num_agent_steps_trained": 244200}, "sampler_results": {"episode_reward_max": -8821.22980054152, "episode_reward_min": -9066.232257208054, "episode_reward_mean": -8921.879127140994, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457, -8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889, -8889.472635975251, -8906.619853432872, -8878.168071336153, -8882.775351671515, -8932.84739972312, -8901.64930350409, -8967.770229630327, -8966.339500051401, -9066.232257208054, -8911.72112933767, -8932.513071091309, -8932.4685824968, -8893.745840755053, -8863.09819644699, -8878.527586944105, -8907.55480373617, -8897.078607422802, -8821.22980054152, -8867.004527413315, -8904.678348250238, -8983.15717370784, -8922.883652300165, -8922.485820161637, -8959.21893831433, -8910.547173860863, -8891.906074672048, -8906.214432990762, -8874.088703230042, -8833.014803664486, -8965.933929349756, -8891.548541044538, -8862.603318572787, -8992.496484738396, -8904.14311699125, -9013.821254439341, -8930.054773615759, -8923.094447037833, -8840.298915340903, -8919.482050470837, -8868.101437723672, -8946.006904564709, -8935.268857392382, -8985.667082333623, -8960.965083934294, -8896.093997598005, -8868.591017729454, -8982.88825193997, -8882.624097662685, -8876.430231376777, -8986.857490106484, -8879.262860422888, -8846.723525995047, -8939.435238088616, -8897.798117730641, -8975.553234674177, -8954.013636267562, -8921.580708788566, -8882.341541296597, -8859.242211943978, -8940.54803960217, -9060.240958378688, -8892.868959338033, -8866.977993793265, -8917.897705626423, -8994.113473994106, -8971.615510029722, -8901.701018000687, -8918.512362732507, -8870.904096379423, -8939.192816879746, -9002.24447245013, -8951.440277439457, -8914.190600267351, -8840.542490959271, -8855.501852324938, -8947.818236836198, -8941.06196356747, -8966.169282034045], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.39422185709526, "mean_inference_ms": 0.3618023750529802, "mean_action_processing_ms": 0.08941528627314005, "mean_env_wait_ms": 0.902950015245493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028388500213623047, "StateBufferConnector_ms": 0.002072572708129883, "ViewRequirementAgentConnector_ms": 0.05377054214477539}}, "episode_reward_max": -8821.22980054152, "episode_reward_min": -9066.232257208054, "episode_reward_mean": -8921.879127140994, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8923.241564530874, -8872.889529904834, -8841.355762725674, -8959.910433026764, -8904.629413015593, -8977.977069715258, -9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457, -8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889, -8889.472635975251, -8906.619853432872, -8878.168071336153, -8882.775351671515, -8932.84739972312, -8901.64930350409, -8967.770229630327, -8966.339500051401, -9066.232257208054, -8911.72112933767, -8932.513071091309, -8932.4685824968, -8893.745840755053, -8863.09819644699, -8878.527586944105, -8907.55480373617, -8897.078607422802, -8821.22980054152, -8867.004527413315, -8904.678348250238, -8983.15717370784, -8922.883652300165, -8922.485820161637, -8959.21893831433, -8910.547173860863, -8891.906074672048, -8906.214432990762, -8874.088703230042, -8833.014803664486, -8965.933929349756, -8891.548541044538, -8862.603318572787, -8992.496484738396, -8904.14311699125, -9013.821254439341, -8930.054773615759, -8923.094447037833, -8840.298915340903, -8919.482050470837, -8868.101437723672, -8946.006904564709, -8935.268857392382, -8985.667082333623, -8960.965083934294, -8896.093997598005, -8868.591017729454, -8982.88825193997, -8882.624097662685, -8876.430231376777, -8986.857490106484, -8879.262860422888, -8846.723525995047, -8939.435238088616, -8897.798117730641, -8975.553234674177, -8954.013636267562, -8921.580708788566, -8882.341541296597, -8859.242211943978, -8940.54803960217, -9060.240958378688, -8892.868959338033, -8866.977993793265, -8917.897705626423, -8994.113473994106, -8971.615510029722, -8901.701018000687, -8918.512362732507, -8870.904096379423, -8939.192816879746, -9002.24447245013, -8951.440277439457, -8914.190600267351, -8840.542490959271, -8855.501852324938, -8947.818236836198, -8941.06196356747, -8966.169282034045], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.39422185709526, "mean_inference_ms": 0.3618023750529802, "mean_action_processing_ms": 0.08941528627314005, "mean_env_wait_ms": 0.902950015245493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028388500213623047, "StateBufferConnector_ms": 0.002072572708129883, "ViewRequirementAgentConnector_ms": 0.05377054214477539}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244200, "num_agent_steps_trained": 244200, "num_env_steps_sampled": 244200, "num_env_steps_trained": 244200, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.62462068050058, "num_env_steps_trained_throughput_per_sec": 189.62462068050058, "timesteps_total": 244200, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 244200, "timers": {"training_iteration_time_ms": 1900.347, "sample_time_ms": 1893.365, "load_time_ms": 0.222, "load_throughput": 1624474.922, "learn_time_ms": 6.196, "learn_throughput": 58103.136, "synch_weights_time_ms": 0.531}, "counters": {"num_env_steps_sampled": 244200, "num_env_steps_trained": 244200, "num_agent_steps_sampled": 244200, "num_agent_steps_trained": 244200}, "done": false, "episodes_total": 1159, "training_iteration": 242, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-59-47", "timestamp": 1691132387, "time_this_iter_s": 11.392903327941895, "time_total_s": 2772.5104582309723, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1042.6797313690186, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 22.9875, "ram_util_percent": 65.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.1192016601562, "policy_loss": -2372827941.575, "vf_loss": 132679797.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1753.0, "diff_num_grad_updates_vs_sampler_policy": 1752.0}}, "num_env_steps_sampled": 246360, "num_env_steps_trained": 246360, "num_agent_steps_sampled": 246360, "num_agent_steps_trained": 246360}, "sampler_results": {"episode_reward_max": -8821.22980054152, "episode_reward_min": -9066.232257208054, "episode_reward_mean": -8923.420961543039, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457, -8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889, -8889.472635975251, -8906.619853432872, -8878.168071336153, -8882.775351671515, -8932.84739972312, -8901.64930350409, -8967.770229630327, -8966.339500051401, -9066.232257208054, -8911.72112933767, -8932.513071091309, -8932.4685824968, -8893.745840755053, -8863.09819644699, -8878.527586944105, -8907.55480373617, -8897.078607422802, -8821.22980054152, -8867.004527413315, -8904.678348250238, -8983.15717370784, -8922.883652300165, -8922.485820161637, -8959.21893831433, -8910.547173860863, -8891.906074672048, -8906.214432990762, -8874.088703230042, -8833.014803664486, -8965.933929349756, -8891.548541044538, -8862.603318572787, -8992.496484738396, -8904.14311699125, -9013.821254439341, -8930.054773615759, -8923.094447037833, -8840.298915340903, -8919.482050470837, -8868.101437723672, -8946.006904564709, -8935.268857392382, -8985.667082333623, -8960.965083934294, -8896.093997598005, -8868.591017729454, -8982.88825193997, -8882.624097662685, -8876.430231376777, -8986.857490106484, -8879.262860422888, -8846.723525995047, -8939.435238088616, -8897.798117730641, -8975.553234674177, -8954.013636267562, -8921.580708788566, -8882.341541296597, -8859.242211943978, -8940.54803960217, -9060.240958378688, -8892.868959338033, -8866.977993793265, -8917.897705626423, -8994.113473994106, -8971.615510029722, -8901.701018000687, -8918.512362732507, -8870.904096379423, -8939.192816879746, -9002.24447245013, -8951.440277439457, -8914.190600267351, -8840.542490959271, -8855.501852324938, -8947.818236836198, -8941.06196356747, -8966.169282034045, -8967.971227791108, -8926.774892993142, -8885.257849338594, -8904.362617876262, -8993.38222815749, -8956.438396966978], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.360339414841199, "mean_inference_ms": 0.3604112927594379, "mean_action_processing_ms": 0.08905965833520411, "mean_env_wait_ms": 0.898996434027342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027761459350585938, "StateBufferConnector_ms": 0.0020134449005126953, "ViewRequirementAgentConnector_ms": 0.05245709419250488}}, "episode_reward_max": -8821.22980054152, "episode_reward_min": -9066.232257208054, "episode_reward_mean": -8923.420961543039, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9033.108546160227, -8927.23072157474, -8968.974171068723, -8875.354575510633, -8902.5860938228, -8940.167268844514, -8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457, -8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889, -8889.472635975251, -8906.619853432872, -8878.168071336153, -8882.775351671515, -8932.84739972312, -8901.64930350409, -8967.770229630327, -8966.339500051401, -9066.232257208054, -8911.72112933767, -8932.513071091309, -8932.4685824968, -8893.745840755053, -8863.09819644699, -8878.527586944105, -8907.55480373617, -8897.078607422802, -8821.22980054152, -8867.004527413315, -8904.678348250238, -8983.15717370784, -8922.883652300165, -8922.485820161637, -8959.21893831433, -8910.547173860863, -8891.906074672048, -8906.214432990762, -8874.088703230042, -8833.014803664486, -8965.933929349756, -8891.548541044538, -8862.603318572787, -8992.496484738396, -8904.14311699125, -9013.821254439341, -8930.054773615759, -8923.094447037833, -8840.298915340903, -8919.482050470837, -8868.101437723672, -8946.006904564709, -8935.268857392382, -8985.667082333623, -8960.965083934294, -8896.093997598005, -8868.591017729454, -8982.88825193997, -8882.624097662685, -8876.430231376777, -8986.857490106484, -8879.262860422888, -8846.723525995047, -8939.435238088616, -8897.798117730641, -8975.553234674177, -8954.013636267562, -8921.580708788566, -8882.341541296597, -8859.242211943978, -8940.54803960217, -9060.240958378688, -8892.868959338033, -8866.977993793265, -8917.897705626423, -8994.113473994106, -8971.615510029722, -8901.701018000687, -8918.512362732507, -8870.904096379423, -8939.192816879746, -9002.24447245013, -8951.440277439457, -8914.190600267351, -8840.542490959271, -8855.501852324938, -8947.818236836198, -8941.06196356747, -8966.169282034045, -8967.971227791108, -8926.774892993142, -8885.257849338594, -8904.362617876262, -8993.38222815749, -8956.438396966978], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.360339414841199, "mean_inference_ms": 0.3604112927594379, "mean_action_processing_ms": 0.08905965833520411, "mean_env_wait_ms": 0.898996434027342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027761459350585938, "StateBufferConnector_ms": 0.0020134449005126953, "ViewRequirementAgentConnector_ms": 0.05245709419250488}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 246360, "num_agent_steps_trained": 246360, "num_env_steps_sampled": 246360, "num_env_steps_trained": 246360, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.552331271303, "num_env_steps_trained_throughput_per_sec": 190.552331271303, "timesteps_total": 246360, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 246360, "timers": {"training_iteration_time_ms": 1893.696, "sample_time_ms": 1886.694, "load_time_ms": 0.216, "load_throughput": 1670298.053, "learn_time_ms": 6.206, "learn_throughput": 58005.595, "synch_weights_time_ms": 0.546}, "counters": {"num_env_steps_sampled": 246360, "num_env_steps_trained": 246360, "num_agent_steps_sampled": 246360, "num_agent_steps_trained": 246360}, "done": false, "episodes_total": 1165, "training_iteration": 243, "trial_id": "0d7ea_00000", "date": "2023-08-04_09-59-59", "timestamp": 1691132399, "time_this_iter_s": 11.337563276290894, "time_total_s": 2783.848021507263, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1054.0172946453094, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 21.893749999999997, "ram_util_percent": 65.90625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -655.995458984375, "policy_loss": -1852006996.725, "vf_loss": 134634347.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1783.0, "diff_num_grad_updates_vs_sampler_policy": 1782.0}}, "num_env_steps_sampled": 248520, "num_env_steps_trained": 248520, "num_agent_steps_sampled": 248520, "num_agent_steps_trained": 248520}, "sampler_results": {"episode_reward_max": -8821.22980054152, "episode_reward_min": -9066.232257208054, "episode_reward_mean": -8922.59219738833, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457, -8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889, -8889.472635975251, -8906.619853432872, -8878.168071336153, -8882.775351671515, -8932.84739972312, -8901.64930350409, -8967.770229630327, -8966.339500051401, -9066.232257208054, -8911.72112933767, -8932.513071091309, -8932.4685824968, -8893.745840755053, -8863.09819644699, -8878.527586944105, -8907.55480373617, -8897.078607422802, -8821.22980054152, -8867.004527413315, -8904.678348250238, -8983.15717370784, -8922.883652300165, -8922.485820161637, -8959.21893831433, -8910.547173860863, -8891.906074672048, -8906.214432990762, -8874.088703230042, -8833.014803664486, -8965.933929349756, -8891.548541044538, -8862.603318572787, -8992.496484738396, -8904.14311699125, -9013.821254439341, -8930.054773615759, -8923.094447037833, -8840.298915340903, -8919.482050470837, -8868.101437723672, -8946.006904564709, -8935.268857392382, -8985.667082333623, -8960.965083934294, -8896.093997598005, -8868.591017729454, -8982.88825193997, -8882.624097662685, -8876.430231376777, -8986.857490106484, -8879.262860422888, -8846.723525995047, -8939.435238088616, -8897.798117730641, -8975.553234674177, -8954.013636267562, -8921.580708788566, -8882.341541296597, -8859.242211943978, -8940.54803960217, -9060.240958378688, -8892.868959338033, -8866.977993793265, -8917.897705626423, -8994.113473994106, -8971.615510029722, -8901.701018000687, -8918.512362732507, -8870.904096379423, -8939.192816879746, -9002.24447245013, -8951.440277439457, -8914.190600267351, -8840.542490959271, -8855.501852324938, -8947.818236836198, -8941.06196356747, -8966.169282034045, -8967.971227791108, -8926.774892993142, -8885.257849338594, -8904.362617876262, -8993.38222815749, -8956.438396966978, -8923.546626800271, -8941.585616587068, -8877.418929787571, -8919.24202497797, -8885.04730585097, -9017.704457507014], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.3238198789167495, "mean_inference_ms": 0.3588997557924128, "mean_action_processing_ms": 0.08867472422670943, "mean_env_wait_ms": 0.8947666979258956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027060508728027344, "StateBufferConnector_ms": 0.0019545555114746094, "ViewRequirementAgentConnector_ms": 0.05102968215942383}}, "episode_reward_max": -8821.22980054152, "episode_reward_min": -9066.232257208054, "episode_reward_mean": -8922.59219738833, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8920.697418775704, -9015.721757018446, -8882.37764225103, -8996.144223447272, -8907.069567292034, -8972.40530566457, -8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889, -8889.472635975251, -8906.619853432872, -8878.168071336153, -8882.775351671515, -8932.84739972312, -8901.64930350409, -8967.770229630327, -8966.339500051401, -9066.232257208054, -8911.72112933767, -8932.513071091309, -8932.4685824968, -8893.745840755053, -8863.09819644699, -8878.527586944105, -8907.55480373617, -8897.078607422802, -8821.22980054152, -8867.004527413315, -8904.678348250238, -8983.15717370784, -8922.883652300165, -8922.485820161637, -8959.21893831433, -8910.547173860863, -8891.906074672048, -8906.214432990762, -8874.088703230042, -8833.014803664486, -8965.933929349756, -8891.548541044538, -8862.603318572787, -8992.496484738396, -8904.14311699125, -9013.821254439341, -8930.054773615759, -8923.094447037833, -8840.298915340903, -8919.482050470837, -8868.101437723672, -8946.006904564709, -8935.268857392382, -8985.667082333623, -8960.965083934294, -8896.093997598005, -8868.591017729454, -8982.88825193997, -8882.624097662685, -8876.430231376777, -8986.857490106484, -8879.262860422888, -8846.723525995047, -8939.435238088616, -8897.798117730641, -8975.553234674177, -8954.013636267562, -8921.580708788566, -8882.341541296597, -8859.242211943978, -8940.54803960217, -9060.240958378688, -8892.868959338033, -8866.977993793265, -8917.897705626423, -8994.113473994106, -8971.615510029722, -8901.701018000687, -8918.512362732507, -8870.904096379423, -8939.192816879746, -9002.24447245013, -8951.440277439457, -8914.190600267351, -8840.542490959271, -8855.501852324938, -8947.818236836198, -8941.06196356747, -8966.169282034045, -8967.971227791108, -8926.774892993142, -8885.257849338594, -8904.362617876262, -8993.38222815749, -8956.438396966978, -8923.546626800271, -8941.585616587068, -8877.418929787571, -8919.24202497797, -8885.04730585097, -9017.704457507014], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.3238198789167495, "mean_inference_ms": 0.3588997557924128, "mean_action_processing_ms": 0.08867472422670943, "mean_env_wait_ms": 0.8947666979258956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027060508728027344, "StateBufferConnector_ms": 0.0019545555114746094, "ViewRequirementAgentConnector_ms": 0.05102968215942383}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248520, "num_agent_steps_trained": 248520, "num_env_steps_sampled": 248520, "num_env_steps_trained": 248520, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.53664571422468, "num_env_steps_trained_throughput_per_sec": 190.53664571422468, "timesteps_total": 248520, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 248520, "timers": {"training_iteration_time_ms": 1886.293, "sample_time_ms": 1879.273, "load_time_ms": 0.214, "load_throughput": 1682020.096, "learn_time_ms": 6.25, "learn_throughput": 57596.045, "synch_weights_time_ms": 0.523}, "counters": {"num_env_steps_sampled": 248520, "num_env_steps_trained": 248520, "num_agent_steps_sampled": 248520, "num_agent_steps_trained": 248520}, "done": false, "episodes_total": 1171, "training_iteration": 244, "trial_id": "0d7ea_00000", "date": "2023-08-04_10-00-10", "timestamp": 1691132410, "time_this_iter_s": 11.338477611541748, "time_total_s": 2795.186499118805, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1065.3557722568512, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 29.25, "ram_util_percent": 65.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.1139404296875, "policy_loss": -1894044612.125, "vf_loss": 131210064.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1813.0, "diff_num_grad_updates_vs_sampler_policy": 1812.0}}, "num_env_steps_sampled": 250680, "num_env_steps_trained": 250680, "num_agent_steps_sampled": 250680, "num_agent_steps_trained": 250680}, "sampler_results": {"episode_reward_max": -8821.22980054152, "episode_reward_min": -9066.232257208054, "episode_reward_mean": -8921.673802969624, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889, -8889.472635975251, -8906.619853432872, -8878.168071336153, -8882.775351671515, -8932.84739972312, -8901.64930350409, -8967.770229630327, -8966.339500051401, -9066.232257208054, -8911.72112933767, -8932.513071091309, -8932.4685824968, -8893.745840755053, -8863.09819644699, -8878.527586944105, -8907.55480373617, -8897.078607422802, -8821.22980054152, -8867.004527413315, -8904.678348250238, -8983.15717370784, -8922.883652300165, -8922.485820161637, -8959.21893831433, -8910.547173860863, -8891.906074672048, -8906.214432990762, -8874.088703230042, -8833.014803664486, -8965.933929349756, -8891.548541044538, -8862.603318572787, -8992.496484738396, -8904.14311699125, -9013.821254439341, -8930.054773615759, -8923.094447037833, -8840.298915340903, -8919.482050470837, -8868.101437723672, -8946.006904564709, -8935.268857392382, -8985.667082333623, -8960.965083934294, -8896.093997598005, -8868.591017729454, -8982.88825193997, -8882.624097662685, -8876.430231376777, -8986.857490106484, -8879.262860422888, -8846.723525995047, -8939.435238088616, -8897.798117730641, -8975.553234674177, -8954.013636267562, -8921.580708788566, -8882.341541296597, -8859.242211943978, -8940.54803960217, -9060.240958378688, -8892.868959338033, -8866.977993793265, -8917.897705626423, -8994.113473994106, -8971.615510029722, -8901.701018000687, -8918.512362732507, -8870.904096379423, -8939.192816879746, -9002.24447245013, -8951.440277439457, -8914.190600267351, -8840.542490959271, -8855.501852324938, -8947.818236836198, -8941.06196356747, -8966.169282034045, -8967.971227791108, -8926.774892993142, -8885.257849338594, -8904.362617876262, -8993.38222815749, -8956.438396966978, -8923.546626800271, -8941.585616587068, -8877.418929787571, -8919.24202497797, -8885.04730585097, -9017.704457507014, -8943.205447766752, -9003.632255150242, -8882.037010058475, -8899.711164559956, -8957.612484430603, -8916.378110612406], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.284776488060115, "mean_inference_ms": 0.3572814755405023, "mean_action_processing_ms": 0.08826249995212661, "mean_env_wait_ms": 0.8903056636397768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002654552459716797, "StateBufferConnector_ms": 0.0019059181213378906, "ViewRequirementAgentConnector_ms": 0.049695730209350586}}, "episode_reward_max": -8821.22980054152, "episode_reward_min": -9066.232257208054, "episode_reward_mean": -8921.673802969624, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8933.63729705029, -8934.353366448213, -8855.721798910145, -8954.882847664889, -8889.472635975251, -8906.619853432872, -8878.168071336153, -8882.775351671515, -8932.84739972312, -8901.64930350409, -8967.770229630327, -8966.339500051401, -9066.232257208054, -8911.72112933767, -8932.513071091309, -8932.4685824968, -8893.745840755053, -8863.09819644699, -8878.527586944105, -8907.55480373617, -8897.078607422802, -8821.22980054152, -8867.004527413315, -8904.678348250238, -8983.15717370784, -8922.883652300165, -8922.485820161637, -8959.21893831433, -8910.547173860863, -8891.906074672048, -8906.214432990762, -8874.088703230042, -8833.014803664486, -8965.933929349756, -8891.548541044538, -8862.603318572787, -8992.496484738396, -8904.14311699125, -9013.821254439341, -8930.054773615759, -8923.094447037833, -8840.298915340903, -8919.482050470837, -8868.101437723672, -8946.006904564709, -8935.268857392382, -8985.667082333623, -8960.965083934294, -8896.093997598005, -8868.591017729454, -8982.88825193997, -8882.624097662685, -8876.430231376777, -8986.857490106484, -8879.262860422888, -8846.723525995047, -8939.435238088616, -8897.798117730641, -8975.553234674177, -8954.013636267562, -8921.580708788566, -8882.341541296597, -8859.242211943978, -8940.54803960217, -9060.240958378688, -8892.868959338033, -8866.977993793265, -8917.897705626423, -8994.113473994106, -8971.615510029722, -8901.701018000687, -8918.512362732507, -8870.904096379423, -8939.192816879746, -9002.24447245013, -8951.440277439457, -8914.190600267351, -8840.542490959271, -8855.501852324938, -8947.818236836198, -8941.06196356747, -8966.169282034045, -8967.971227791108, -8926.774892993142, -8885.257849338594, -8904.362617876262, -8993.38222815749, -8956.438396966978, -8923.546626800271, -8941.585616587068, -8877.418929787571, -8919.24202497797, -8885.04730585097, -9017.704457507014, -8943.205447766752, -9003.632255150242, -8882.037010058475, -8899.711164559956, -8957.612484430603, -8916.378110612406], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.284776488060115, "mean_inference_ms": 0.3572814755405023, "mean_action_processing_ms": 0.08826249995212661, "mean_env_wait_ms": 0.8903056636397768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002654552459716797, "StateBufferConnector_ms": 0.0019059181213378906, "ViewRequirementAgentConnector_ms": 0.049695730209350586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 250680, "num_agent_steps_trained": 250680, "num_env_steps_sampled": 250680, "num_env_steps_trained": 250680, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.07384847057182, "num_env_steps_trained_throughput_per_sec": 190.07384847057182, "timesteps_total": 250680, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 250680, "timers": {"training_iteration_time_ms": 1892.274, "sample_time_ms": 1885.201, "load_time_ms": 0.217, "load_throughput": 1662573.706, "learn_time_ms": 6.287, "learn_throughput": 57257.517, "synch_weights_time_ms": 0.535}, "counters": {"num_env_steps_sampled": 250680, "num_env_steps_trained": 250680, "num_agent_steps_sampled": 250680, "num_agent_steps_trained": 250680}, "done": false, "episodes_total": 1177, "training_iteration": 245, "trial_id": "0d7ea_00000", "date": "2023-08-04_10-00-21", "timestamp": 1691132421, "time_this_iter_s": 11.366176128387451, "time_total_s": 2806.5526752471924, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1076.7219483852386, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 25.65294117647059, "ram_util_percent": 65.68823529411765}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.20439453125, "policy_loss": -887212617.475, "vf_loss": 130530007.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1843.0, "diff_num_grad_updates_vs_sampler_policy": 1842.0}}, "num_env_steps_sampled": 252840, "num_env_steps_trained": 252840, "num_agent_steps_sampled": 252840, "num_agent_steps_trained": 252840}, "sampler_results": {"episode_reward_max": -8821.22980054152, "episode_reward_min": -9066.232257208054, "episode_reward_mean": -8922.067311237282, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8878.168071336153, -8882.775351671515, -8932.84739972312, -8901.64930350409, -8967.770229630327, -8966.339500051401, -9066.232257208054, -8911.72112933767, -8932.513071091309, -8932.4685824968, -8893.745840755053, -8863.09819644699, -8878.527586944105, -8907.55480373617, -8897.078607422802, -8821.22980054152, -8867.004527413315, -8904.678348250238, -8983.15717370784, -8922.883652300165, -8922.485820161637, -8959.21893831433, -8910.547173860863, -8891.906074672048, -8906.214432990762, -8874.088703230042, -8833.014803664486, -8965.933929349756, -8891.548541044538, -8862.603318572787, -8992.496484738396, -8904.14311699125, -9013.821254439341, -8930.054773615759, -8923.094447037833, -8840.298915340903, -8919.482050470837, -8868.101437723672, -8946.006904564709, -8935.268857392382, -8985.667082333623, -8960.965083934294, -8896.093997598005, -8868.591017729454, -8982.88825193997, -8882.624097662685, -8876.430231376777, -8986.857490106484, -8879.262860422888, -8846.723525995047, -8939.435238088616, -8897.798117730641, -8975.553234674177, -8954.013636267562, -8921.580708788566, -8882.341541296597, -8859.242211943978, -8940.54803960217, -9060.240958378688, -8892.868959338033, -8866.977993793265, -8917.897705626423, -8994.113473994106, -8971.615510029722, -8901.701018000687, -8918.512362732507, -8870.904096379423, -8939.192816879746, -9002.24447245013, -8951.440277439457, -8914.190600267351, -8840.542490959271, -8855.501852324938, -8947.818236836198, -8941.06196356747, -8966.169282034045, -8967.971227791108, -8926.774892993142, -8885.257849338594, -8904.362617876262, -8993.38222815749, -8956.438396966978, -8923.546626800271, -8941.585616587068, -8877.418929787571, -8919.24202497797, -8885.04730585097, -9017.704457507014, -8943.205447766752, -9003.632255150242, -8882.037010058475, -8899.711164559956, -8957.612484430603, -8916.378110612406, -8841.980689143511, -8899.711164559956, -9008.497150793028, -8945.53574265254, -8921.478756117105, -8896.83512298153], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.243261157667361, "mean_inference_ms": 0.35556083215375855, "mean_action_processing_ms": 0.08782424439685119, "mean_env_wait_ms": 0.8856208643972937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025665760040283203, "StateBufferConnector_ms": 0.0018486976623535156, "ViewRequirementAgentConnector_ms": 0.04839825630187988}}, "episode_reward_max": -8821.22980054152, "episode_reward_min": -9066.232257208054, "episode_reward_mean": -8922.067311237282, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8878.168071336153, -8882.775351671515, -8932.84739972312, -8901.64930350409, -8967.770229630327, -8966.339500051401, -9066.232257208054, -8911.72112933767, -8932.513071091309, -8932.4685824968, -8893.745840755053, -8863.09819644699, -8878.527586944105, -8907.55480373617, -8897.078607422802, -8821.22980054152, -8867.004527413315, -8904.678348250238, -8983.15717370784, -8922.883652300165, -8922.485820161637, -8959.21893831433, -8910.547173860863, -8891.906074672048, -8906.214432990762, -8874.088703230042, -8833.014803664486, -8965.933929349756, -8891.548541044538, -8862.603318572787, -8992.496484738396, -8904.14311699125, -9013.821254439341, -8930.054773615759, -8923.094447037833, -8840.298915340903, -8919.482050470837, -8868.101437723672, -8946.006904564709, -8935.268857392382, -8985.667082333623, -8960.965083934294, -8896.093997598005, -8868.591017729454, -8982.88825193997, -8882.624097662685, -8876.430231376777, -8986.857490106484, -8879.262860422888, -8846.723525995047, -8939.435238088616, -8897.798117730641, -8975.553234674177, -8954.013636267562, -8921.580708788566, -8882.341541296597, -8859.242211943978, -8940.54803960217, -9060.240958378688, -8892.868959338033, -8866.977993793265, -8917.897705626423, -8994.113473994106, -8971.615510029722, -8901.701018000687, -8918.512362732507, -8870.904096379423, -8939.192816879746, -9002.24447245013, -8951.440277439457, -8914.190600267351, -8840.542490959271, -8855.501852324938, -8947.818236836198, -8941.06196356747, -8966.169282034045, -8967.971227791108, -8926.774892993142, -8885.257849338594, -8904.362617876262, -8993.38222815749, -8956.438396966978, -8923.546626800271, -8941.585616587068, -8877.418929787571, -8919.24202497797, -8885.04730585097, -9017.704457507014, -8943.205447766752, -9003.632255150242, -8882.037010058475, -8899.711164559956, -8957.612484430603, -8916.378110612406, -8841.980689143511, -8899.711164559956, -9008.497150793028, -8945.53574265254, -8921.478756117105, -8896.83512298153], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.243261157667361, "mean_inference_ms": 0.35556083215375855, "mean_action_processing_ms": 0.08782424439685119, "mean_env_wait_ms": 0.8856208643972937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025665760040283203, "StateBufferConnector_ms": 0.0018486976623535156, "ViewRequirementAgentConnector_ms": 0.04839825630187988}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252840, "num_agent_steps_trained": 252840, "num_env_steps_sampled": 252840, "num_env_steps_trained": 252840, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 188.75137555087403, "num_env_steps_trained_throughput_per_sec": 188.75137555087403, "timesteps_total": 252840, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 252840, "timers": {"training_iteration_time_ms": 1901.334, "sample_time_ms": 1894.283, "load_time_ms": 0.22, "load_throughput": 1639467.362, "learn_time_ms": 6.254, "learn_throughput": 57563.548, "synch_weights_time_ms": 0.544}, "counters": {"num_env_steps_sampled": 252840, "num_env_steps_trained": 252840, "num_agent_steps_sampled": 252840, "num_agent_steps_trained": 252840}, "done": false, "episodes_total": 1183, "training_iteration": 246, "trial_id": "0d7ea_00000", "date": "2023-08-04_10-00-33", "timestamp": 1691132433, "time_this_iter_s": 11.445755004882812, "time_total_s": 2817.998430252075, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1088.1677033901215, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 23.875, "ram_util_percent": 65.5625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -655.9878784179688, "policy_loss": -3399824391.15, "vf_loss": 133762376.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1873.0, "diff_num_grad_updates_vs_sampler_policy": 1872.0}}, "num_env_steps_sampled": 255000, "num_env_steps_trained": 255000, "num_agent_steps_sampled": 255000, "num_agent_steps_trained": 255000}, "sampler_results": {"episode_reward_max": -8821.22980054152, "episode_reward_min": -9066.232257208054, "episode_reward_mean": -8922.776163101978, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9066.232257208054, -8911.72112933767, -8932.513071091309, -8932.4685824968, -8893.745840755053, -8863.09819644699, -8878.527586944105, -8907.55480373617, -8897.078607422802, -8821.22980054152, -8867.004527413315, -8904.678348250238, -8983.15717370784, -8922.883652300165, -8922.485820161637, -8959.21893831433, -8910.547173860863, -8891.906074672048, -8906.214432990762, -8874.088703230042, -8833.014803664486, -8965.933929349756, -8891.548541044538, -8862.603318572787, -8992.496484738396, -8904.14311699125, -9013.821254439341, -8930.054773615759, -8923.094447037833, -8840.298915340903, -8919.482050470837, -8868.101437723672, -8946.006904564709, -8935.268857392382, -8985.667082333623, -8960.965083934294, -8896.093997598005, -8868.591017729454, -8982.88825193997, -8882.624097662685, -8876.430231376777, -8986.857490106484, -8879.262860422888, -8846.723525995047, -8939.435238088616, -8897.798117730641, -8975.553234674177, -8954.013636267562, -8921.580708788566, -8882.341541296597, -8859.242211943978, -8940.54803960217, -9060.240958378688, -8892.868959338033, -8866.977993793265, -8917.897705626423, -8994.113473994106, -8971.615510029722, -8901.701018000687, -8918.512362732507, -8870.904096379423, -8939.192816879746, -9002.24447245013, -8951.440277439457, -8914.190600267351, -8840.542490959271, -8855.501852324938, -8947.818236836198, -8941.06196356747, -8966.169282034045, -8967.971227791108, -8926.774892993142, -8885.257849338594, -8904.362617876262, -8993.38222815749, -8956.438396966978, -8923.546626800271, -8941.585616587068, -8877.418929787571, -8919.24202497797, -8885.04730585097, -9017.704457507014, -8943.205447766752, -9003.632255150242, -8882.037010058475, -8899.711164559956, -8957.612484430603, -8916.378110612406, -8841.980689143511, -8899.711164559956, -9008.497150793028, -8945.53574265254, -8921.478756117105, -8896.83512298153, -8903.108197599877, -8929.351346803516, -8880.08891469026, -8987.55658932177, -8921.81482367714, -8978.515170293447], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.199257681480651, "mean_inference_ms": 0.35373916574066255, "mean_action_processing_ms": 0.08736027894770135, "mean_env_wait_ms": 0.8807062927562228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002507448196411133, "StateBufferConnector_ms": 0.0017921924591064453, "ViewRequirementAgentConnector_ms": 0.04700946807861328}}, "episode_reward_max": -8821.22980054152, "episode_reward_min": -9066.232257208054, "episode_reward_mean": -8922.776163101978, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9066.232257208054, -8911.72112933767, -8932.513071091309, -8932.4685824968, -8893.745840755053, -8863.09819644699, -8878.527586944105, -8907.55480373617, -8897.078607422802, -8821.22980054152, -8867.004527413315, -8904.678348250238, -8983.15717370784, -8922.883652300165, -8922.485820161637, -8959.21893831433, -8910.547173860863, -8891.906074672048, -8906.214432990762, -8874.088703230042, -8833.014803664486, -8965.933929349756, -8891.548541044538, -8862.603318572787, -8992.496484738396, -8904.14311699125, -9013.821254439341, -8930.054773615759, -8923.094447037833, -8840.298915340903, -8919.482050470837, -8868.101437723672, -8946.006904564709, -8935.268857392382, -8985.667082333623, -8960.965083934294, -8896.093997598005, -8868.591017729454, -8982.88825193997, -8882.624097662685, -8876.430231376777, -8986.857490106484, -8879.262860422888, -8846.723525995047, -8939.435238088616, -8897.798117730641, -8975.553234674177, -8954.013636267562, -8921.580708788566, -8882.341541296597, -8859.242211943978, -8940.54803960217, -9060.240958378688, -8892.868959338033, -8866.977993793265, -8917.897705626423, -8994.113473994106, -8971.615510029722, -8901.701018000687, -8918.512362732507, -8870.904096379423, -8939.192816879746, -9002.24447245013, -8951.440277439457, -8914.190600267351, -8840.542490959271, -8855.501852324938, -8947.818236836198, -8941.06196356747, -8966.169282034045, -8967.971227791108, -8926.774892993142, -8885.257849338594, -8904.362617876262, -8993.38222815749, -8956.438396966978, -8923.546626800271, -8941.585616587068, -8877.418929787571, -8919.24202497797, -8885.04730585097, -9017.704457507014, -8943.205447766752, -9003.632255150242, -8882.037010058475, -8899.711164559956, -8957.612484430603, -8916.378110612406, -8841.980689143511, -8899.711164559956, -9008.497150793028, -8945.53574265254, -8921.478756117105, -8896.83512298153, -8903.108197599877, -8929.351346803516, -8880.08891469026, -8987.55658932177, -8921.81482367714, -8978.515170293447], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.199257681480651, "mean_inference_ms": 0.35373916574066255, "mean_action_processing_ms": 0.08736027894770135, "mean_env_wait_ms": 0.8807062927562228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002507448196411133, "StateBufferConnector_ms": 0.0017921924591064453, "ViewRequirementAgentConnector_ms": 0.04700946807861328}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 255000, "num_agent_steps_trained": 255000, "num_env_steps_sampled": 255000, "num_env_steps_trained": 255000, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.79713013817187, "num_env_steps_trained_throughput_per_sec": 190.79713013817187, "timesteps_total": 255000, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 255000, "timers": {"training_iteration_time_ms": 1900.054, "sample_time_ms": 1893.216, "load_time_ms": 0.218, "load_throughput": 1648776.414, "learn_time_ms": 6.077, "learn_throughput": 59239.955, "synch_weights_time_ms": 0.51}, "counters": {"num_env_steps_sampled": 255000, "num_env_steps_trained": 255000, "num_agent_steps_sampled": 255000, "num_agent_steps_trained": 255000}, "done": false, "episodes_total": 1189, "training_iteration": 247, "trial_id": "0d7ea_00000", "date": "2023-08-04_10-00-44", "timestamp": 1691132444, "time_this_iter_s": 11.322951078414917, "time_total_s": 2829.32138133049, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1099.4906544685364, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 21.825, "ram_util_percent": 65.17500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.1582153320312, "policy_loss": -1581024274.5, "vf_loss": 132044091.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1903.0, "diff_num_grad_updates_vs_sampler_policy": 1902.0}}, "num_env_steps_sampled": 257160, "num_env_steps_trained": 257160, "num_agent_steps_sampled": 257160, "num_agent_steps_trained": 257160}, "sampler_results": {"episode_reward_max": -8821.22980054152, "episode_reward_min": -9060.240958378688, "episode_reward_mean": -8922.0695637636, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8878.527586944105, -8907.55480373617, -8897.078607422802, -8821.22980054152, -8867.004527413315, -8904.678348250238, -8983.15717370784, -8922.883652300165, -8922.485820161637, -8959.21893831433, -8910.547173860863, -8891.906074672048, -8906.214432990762, -8874.088703230042, -8833.014803664486, -8965.933929349756, -8891.548541044538, -8862.603318572787, -8992.496484738396, -8904.14311699125, -9013.821254439341, -8930.054773615759, -8923.094447037833, -8840.298915340903, -8919.482050470837, -8868.101437723672, -8946.006904564709, -8935.268857392382, -8985.667082333623, -8960.965083934294, -8896.093997598005, -8868.591017729454, -8982.88825193997, -8882.624097662685, -8876.430231376777, -8986.857490106484, -8879.262860422888, -8846.723525995047, -8939.435238088616, -8897.798117730641, -8975.553234674177, -8954.013636267562, -8921.580708788566, -8882.341541296597, -8859.242211943978, -8940.54803960217, -9060.240958378688, -8892.868959338033, -8866.977993793265, -8917.897705626423, -8994.113473994106, -8971.615510029722, -8901.701018000687, -8918.512362732507, -8870.904096379423, -8939.192816879746, -9002.24447245013, -8951.440277439457, -8914.190600267351, -8840.542490959271, -8855.501852324938, -8947.818236836198, -8941.06196356747, -8966.169282034045, -8967.971227791108, -8926.774892993142, -8885.257849338594, -8904.362617876262, -8993.38222815749, -8956.438396966978, -8923.546626800271, -8941.585616587068, -8877.418929787571, -8919.24202497797, -8885.04730585097, -9017.704457507014, -8943.205447766752, -9003.632255150242, -8882.037010058475, -8899.711164559956, -8957.612484430603, -8916.378110612406, -8841.980689143511, -8899.711164559956, -9008.497150793028, -8945.53574265254, -8921.478756117105, -8896.83512298153, -8903.108197599877, -8929.351346803516, -8880.08891469026, -8987.55658932177, -8921.81482367714, -8978.515170293447, -8885.322273119331, -8911.46351425718, -8944.716083708232, -8959.682408795197, -8883.05698917871, -8944.877874439333], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.152777364073487, "mean_inference_ms": 0.35181837790694426, "mean_action_processing_ms": 0.0868714741055641, "mean_env_wait_ms": 0.8755836838251543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002447843551635742, "StateBufferConnector_ms": 0.0017304420471191406, "ViewRequirementAgentConnector_ms": 0.04562640190124512}}, "episode_reward_max": -8821.22980054152, "episode_reward_min": -9060.240958378688, "episode_reward_mean": -8922.0695637636, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8878.527586944105, -8907.55480373617, -8897.078607422802, -8821.22980054152, -8867.004527413315, -8904.678348250238, -8983.15717370784, -8922.883652300165, -8922.485820161637, -8959.21893831433, -8910.547173860863, -8891.906074672048, -8906.214432990762, -8874.088703230042, -8833.014803664486, -8965.933929349756, -8891.548541044538, -8862.603318572787, -8992.496484738396, -8904.14311699125, -9013.821254439341, -8930.054773615759, -8923.094447037833, -8840.298915340903, -8919.482050470837, -8868.101437723672, -8946.006904564709, -8935.268857392382, -8985.667082333623, -8960.965083934294, -8896.093997598005, -8868.591017729454, -8982.88825193997, -8882.624097662685, -8876.430231376777, -8986.857490106484, -8879.262860422888, -8846.723525995047, -8939.435238088616, -8897.798117730641, -8975.553234674177, -8954.013636267562, -8921.580708788566, -8882.341541296597, -8859.242211943978, -8940.54803960217, -9060.240958378688, -8892.868959338033, -8866.977993793265, -8917.897705626423, -8994.113473994106, -8971.615510029722, -8901.701018000687, -8918.512362732507, -8870.904096379423, -8939.192816879746, -9002.24447245013, -8951.440277439457, -8914.190600267351, -8840.542490959271, -8855.501852324938, -8947.818236836198, -8941.06196356747, -8966.169282034045, -8967.971227791108, -8926.774892993142, -8885.257849338594, -8904.362617876262, -8993.38222815749, -8956.438396966978, -8923.546626800271, -8941.585616587068, -8877.418929787571, -8919.24202497797, -8885.04730585097, -9017.704457507014, -8943.205447766752, -9003.632255150242, -8882.037010058475, -8899.711164559956, -8957.612484430603, -8916.378110612406, -8841.980689143511, -8899.711164559956, -9008.497150793028, -8945.53574265254, -8921.478756117105, -8896.83512298153, -8903.108197599877, -8929.351346803516, -8880.08891469026, -8987.55658932177, -8921.81482367714, -8978.515170293447, -8885.322273119331, -8911.46351425718, -8944.716083708232, -8959.682408795197, -8883.05698917871, -8944.877874439333], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.152777364073487, "mean_inference_ms": 0.35181837790694426, "mean_action_processing_ms": 0.0868714741055641, "mean_env_wait_ms": 0.8755836838251543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002447843551635742, "StateBufferConnector_ms": 0.0017304420471191406, "ViewRequirementAgentConnector_ms": 0.04562640190124512}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 257160, "num_agent_steps_trained": 257160, "num_env_steps_sampled": 257160, "num_env_steps_trained": 257160, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.69439225840722, "num_env_steps_trained_throughput_per_sec": 190.69439225840722, "timesteps_total": 257160, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 257160, "timers": {"training_iteration_time_ms": 1889.478, "sample_time_ms": 1882.622, "load_time_ms": 0.218, "load_throughput": 1648956.47, "learn_time_ms": 6.093, "learn_throughput": 59085.569, "synch_weights_time_ms": 0.512}, "counters": {"num_env_steps_sampled": 257160, "num_env_steps_trained": 257160, "num_agent_steps_sampled": 257160, "num_agent_steps_trained": 257160}, "done": false, "episodes_total": 1195, "training_iteration": 248, "trial_id": "0d7ea_00000", "date": "2023-08-04_10-00-55", "timestamp": 1691132455, "time_this_iter_s": 11.329103946685791, "time_total_s": 2840.650485277176, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1110.8197584152222, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 21.8625, "ram_util_percent": 65.2375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.15654296875, "policy_loss": -1840060057.6, "vf_loss": 131142731.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1933.0, "diff_num_grad_updates_vs_sampler_policy": 1932.0}}, "num_env_steps_sampled": 259320, "num_env_steps_trained": 259320, "num_agent_steps_sampled": 259320, "num_agent_steps_trained": 259320}, "sampler_results": {"episode_reward_max": -8833.014803664486, "episode_reward_min": -9060.240958378688, "episode_reward_mean": -8923.173621095439, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8983.15717370784, -8922.883652300165, -8922.485820161637, -8959.21893831433, -8910.547173860863, -8891.906074672048, -8906.214432990762, -8874.088703230042, -8833.014803664486, -8965.933929349756, -8891.548541044538, -8862.603318572787, -8992.496484738396, -8904.14311699125, -9013.821254439341, -8930.054773615759, -8923.094447037833, -8840.298915340903, -8919.482050470837, -8868.101437723672, -8946.006904564709, -8935.268857392382, -8985.667082333623, -8960.965083934294, -8896.093997598005, -8868.591017729454, -8982.88825193997, -8882.624097662685, -8876.430231376777, -8986.857490106484, -8879.262860422888, -8846.723525995047, -8939.435238088616, -8897.798117730641, -8975.553234674177, -8954.013636267562, -8921.580708788566, -8882.341541296597, -8859.242211943978, -8940.54803960217, -9060.240958378688, -8892.868959338033, -8866.977993793265, -8917.897705626423, -8994.113473994106, -8971.615510029722, -8901.701018000687, -8918.512362732507, -8870.904096379423, -8939.192816879746, -9002.24447245013, -8951.440277439457, -8914.190600267351, -8840.542490959271, -8855.501852324938, -8947.818236836198, -8941.06196356747, -8966.169282034045, -8967.971227791108, -8926.774892993142, -8885.257849338594, -8904.362617876262, -8993.38222815749, -8956.438396966978, -8923.546626800271, -8941.585616587068, -8877.418929787571, -8919.24202497797, -8885.04730585097, -9017.704457507014, -8943.205447766752, -9003.632255150242, -8882.037010058475, -8899.711164559956, -8957.612484430603, -8916.378110612406, -8841.980689143511, -8899.711164559956, -9008.497150793028, -8945.53574265254, -8921.478756117105, -8896.83512298153, -8903.108197599877, -8929.351346803516, -8880.08891469026, -8987.55658932177, -8921.81482367714, -8978.515170293447, -8885.322273119331, -8911.46351425718, -8944.716083708232, -8959.682408795197, -8883.05698917871, -8944.877874439333, -8936.721945689345, -8926.545879836951, -8896.634335661105, -8875.263761329721, -8850.140133103665, -8901.173351871355], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.104244344317641, "mean_inference_ms": 0.34980154856613, "mean_action_processing_ms": 0.08635858359491927, "mean_env_wait_ms": 0.8702580058741671, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023794174194335938, "StateBufferConnector_ms": 0.0016787052154541016, "ViewRequirementAgentConnector_ms": 0.044328927993774414}}, "episode_reward_max": -8833.014803664486, "episode_reward_min": -9060.240958378688, "episode_reward_mean": -8923.173621095439, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8983.15717370784, -8922.883652300165, -8922.485820161637, -8959.21893831433, -8910.547173860863, -8891.906074672048, -8906.214432990762, -8874.088703230042, -8833.014803664486, -8965.933929349756, -8891.548541044538, -8862.603318572787, -8992.496484738396, -8904.14311699125, -9013.821254439341, -8930.054773615759, -8923.094447037833, -8840.298915340903, -8919.482050470837, -8868.101437723672, -8946.006904564709, -8935.268857392382, -8985.667082333623, -8960.965083934294, -8896.093997598005, -8868.591017729454, -8982.88825193997, -8882.624097662685, -8876.430231376777, -8986.857490106484, -8879.262860422888, -8846.723525995047, -8939.435238088616, -8897.798117730641, -8975.553234674177, -8954.013636267562, -8921.580708788566, -8882.341541296597, -8859.242211943978, -8940.54803960217, -9060.240958378688, -8892.868959338033, -8866.977993793265, -8917.897705626423, -8994.113473994106, -8971.615510029722, -8901.701018000687, -8918.512362732507, -8870.904096379423, -8939.192816879746, -9002.24447245013, -8951.440277439457, -8914.190600267351, -8840.542490959271, -8855.501852324938, -8947.818236836198, -8941.06196356747, -8966.169282034045, -8967.971227791108, -8926.774892993142, -8885.257849338594, -8904.362617876262, -8993.38222815749, -8956.438396966978, -8923.546626800271, -8941.585616587068, -8877.418929787571, -8919.24202497797, -8885.04730585097, -9017.704457507014, -8943.205447766752, -9003.632255150242, -8882.037010058475, -8899.711164559956, -8957.612484430603, -8916.378110612406, -8841.980689143511, -8899.711164559956, -9008.497150793028, -8945.53574265254, -8921.478756117105, -8896.83512298153, -8903.108197599877, -8929.351346803516, -8880.08891469026, -8987.55658932177, -8921.81482367714, -8978.515170293447, -8885.322273119331, -8911.46351425718, -8944.716083708232, -8959.682408795197, -8883.05698917871, -8944.877874439333, -8936.721945689345, -8926.545879836951, -8896.634335661105, -8875.263761329721, -8850.140133103665, -8901.173351871355], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.104244344317641, "mean_inference_ms": 0.34980154856613, "mean_action_processing_ms": 0.08635858359491927, "mean_env_wait_ms": 0.8702580058741671, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023794174194335938, "StateBufferConnector_ms": 0.0016787052154541016, "ViewRequirementAgentConnector_ms": 0.044328927993774414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 259320, "num_agent_steps_trained": 259320, "num_env_steps_sampled": 259320, "num_env_steps_trained": 259320, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.0626793579921, "num_env_steps_trained_throughput_per_sec": 190.0626793579921, "timesteps_total": 259320, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 259320, "timers": {"training_iteration_time_ms": 1893.279, "sample_time_ms": 1886.326, "load_time_ms": 0.217, "load_throughput": 1655464.796, "learn_time_ms": 6.173, "learn_throughput": 58320.598, "synch_weights_time_ms": 0.529}, "counters": {"num_env_steps_sampled": 259320, "num_env_steps_trained": 259320, "num_agent_steps_sampled": 259320, "num_agent_steps_trained": 259320}, "done": false, "episodes_total": 1201, "training_iteration": 249, "trial_id": "0d7ea_00000", "date": "2023-08-04_10-01-07", "timestamp": 1691132467, "time_this_iter_s": 11.36670184135437, "time_total_s": 2852.0171871185303, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1122.1864602565765, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 21.15625, "ram_util_percent": 65.2125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.105224609375, "policy_loss": -2889037732.525, "vf_loss": 130595377.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1963.0, "diff_num_grad_updates_vs_sampler_policy": 1962.0}}, "num_env_steps_sampled": 261480, "num_env_steps_trained": 261480, "num_agent_steps_sampled": 261480, "num_agent_steps_trained": 261480}, "sampler_results": {"episode_reward_max": -8833.014803664486, "episode_reward_min": -9060.240958378688, "episode_reward_mean": -8923.142996009647, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8906.214432990762, -8874.088703230042, -8833.014803664486, -8965.933929349756, -8891.548541044538, -8862.603318572787, -8992.496484738396, -8904.14311699125, -9013.821254439341, -8930.054773615759, -8923.094447037833, -8840.298915340903, -8919.482050470837, -8868.101437723672, -8946.006904564709, -8935.268857392382, -8985.667082333623, -8960.965083934294, -8896.093997598005, -8868.591017729454, -8982.88825193997, -8882.624097662685, -8876.430231376777, -8986.857490106484, -8879.262860422888, -8846.723525995047, -8939.435238088616, -8897.798117730641, -8975.553234674177, -8954.013636267562, -8921.580708788566, -8882.341541296597, -8859.242211943978, -8940.54803960217, -9060.240958378688, -8892.868959338033, -8866.977993793265, -8917.897705626423, -8994.113473994106, -8971.615510029722, -8901.701018000687, -8918.512362732507, -8870.904096379423, -8939.192816879746, -9002.24447245013, -8951.440277439457, -8914.190600267351, -8840.542490959271, -8855.501852324938, -8947.818236836198, -8941.06196356747, -8966.169282034045, -8967.971227791108, -8926.774892993142, -8885.257849338594, -8904.362617876262, -8993.38222815749, -8956.438396966978, -8923.546626800271, -8941.585616587068, -8877.418929787571, -8919.24202497797, -8885.04730585097, -9017.704457507014, -8943.205447766752, -9003.632255150242, -8882.037010058475, -8899.711164559956, -8957.612484430603, -8916.378110612406, -8841.980689143511, -8899.711164559956, -9008.497150793028, -8945.53574265254, -8921.478756117105, -8896.83512298153, -8903.108197599877, -8929.351346803516, -8880.08891469026, -8987.55658932177, -8921.81482367714, -8978.515170293447, -8885.322273119331, -8911.46351425718, -8944.716083708232, -8959.682408795197, -8883.05698917871, -8944.877874439333, -8936.721945689345, -8926.545879836951, -8896.634335661105, -8875.263761329721, -8850.140133103665, -8901.173351871355, -8968.548668396683, -8949.266295967176, -8923.787237849454, -8945.90234785922, -8911.020553319246, -8888.61122104573], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.056199219324316, "mean_inference_ms": 0.34778787001512884, "mean_action_processing_ms": 0.0858470009356856, "mean_env_wait_ms": 0.8649823961154993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023412704467773438, "StateBufferConnector_ms": 0.0016646385192871094, "ViewRequirementAgentConnector_ms": 0.043915748596191406}}, "episode_reward_max": -8833.014803664486, "episode_reward_min": -9060.240958378688, "episode_reward_mean": -8923.142996009647, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8906.214432990762, -8874.088703230042, -8833.014803664486, -8965.933929349756, -8891.548541044538, -8862.603318572787, -8992.496484738396, -8904.14311699125, -9013.821254439341, -8930.054773615759, -8923.094447037833, -8840.298915340903, -8919.482050470837, -8868.101437723672, -8946.006904564709, -8935.268857392382, -8985.667082333623, -8960.965083934294, -8896.093997598005, -8868.591017729454, -8982.88825193997, -8882.624097662685, -8876.430231376777, -8986.857490106484, -8879.262860422888, -8846.723525995047, -8939.435238088616, -8897.798117730641, -8975.553234674177, -8954.013636267562, -8921.580708788566, -8882.341541296597, -8859.242211943978, -8940.54803960217, -9060.240958378688, -8892.868959338033, -8866.977993793265, -8917.897705626423, -8994.113473994106, -8971.615510029722, -8901.701018000687, -8918.512362732507, -8870.904096379423, -8939.192816879746, -9002.24447245013, -8951.440277439457, -8914.190600267351, -8840.542490959271, -8855.501852324938, -8947.818236836198, -8941.06196356747, -8966.169282034045, -8967.971227791108, -8926.774892993142, -8885.257849338594, -8904.362617876262, -8993.38222815749, -8956.438396966978, -8923.546626800271, -8941.585616587068, -8877.418929787571, -8919.24202497797, -8885.04730585097, -9017.704457507014, -8943.205447766752, -9003.632255150242, -8882.037010058475, -8899.711164559956, -8957.612484430603, -8916.378110612406, -8841.980689143511, -8899.711164559956, -9008.497150793028, -8945.53574265254, -8921.478756117105, -8896.83512298153, -8903.108197599877, -8929.351346803516, -8880.08891469026, -8987.55658932177, -8921.81482367714, -8978.515170293447, -8885.322273119331, -8911.46351425718, -8944.716083708232, -8959.682408795197, -8883.05698917871, -8944.877874439333, -8936.721945689345, -8926.545879836951, -8896.634335661105, -8875.263761329721, -8850.140133103665, -8901.173351871355, -8968.548668396683, -8949.266295967176, -8923.787237849454, -8945.90234785922, -8911.020553319246, -8888.61122104573], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.056199219324316, "mean_inference_ms": 0.34778787001512884, "mean_action_processing_ms": 0.0858470009356856, "mean_env_wait_ms": 0.8649823961154993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023412704467773438, "StateBufferConnector_ms": 0.0016646385192871094, "ViewRequirementAgentConnector_ms": 0.043915748596191406}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 261480, "num_agent_steps_trained": 261480, "num_env_steps_sampled": 261480, "num_env_steps_trained": 261480, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.00384487541527, "num_env_steps_trained_throughput_per_sec": 190.00384487541527, "timesteps_total": 261480, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 261480, "timers": {"training_iteration_time_ms": 1895.458, "sample_time_ms": 1888.524, "load_time_ms": 0.218, "load_throughput": 1653651.78, "learn_time_ms": 6.169, "learn_throughput": 58356.662, "synch_weights_time_ms": 0.515}, "counters": {"num_env_steps_sampled": 261480, "num_env_steps_trained": 261480, "num_agent_steps_sampled": 261480, "num_agent_steps_trained": 261480}, "done": false, "episodes_total": 1207, "training_iteration": 250, "trial_id": "0d7ea_00000", "date": "2023-08-04_10-01-18", "timestamp": 1691132478, "time_this_iter_s": 11.370409965515137, "time_total_s": 2863.3875970840454, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1133.5568702220917, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 20.170588235294115, "ram_util_percent": 65.34705882352942}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.2071044921875, "policy_loss": -2570841177.15, "vf_loss": 128846787.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1993.0, "diff_num_grad_updates_vs_sampler_policy": 1992.0}}, "num_env_steps_sampled": 263640, "num_env_steps_trained": 263640, "num_agent_steps_sampled": 263640, "num_agent_steps_trained": 263640}, "sampler_results": {"episode_reward_max": -8836.863764607675, "episode_reward_min": -9060.240958378688, "episode_reward_mean": -8923.850971386217, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8992.496484738396, -8904.14311699125, -9013.821254439341, -8930.054773615759, -8923.094447037833, -8840.298915340903, -8919.482050470837, -8868.101437723672, -8946.006904564709, -8935.268857392382, -8985.667082333623, -8960.965083934294, -8896.093997598005, -8868.591017729454, -8982.88825193997, -8882.624097662685, -8876.430231376777, -8986.857490106484, -8879.262860422888, -8846.723525995047, -8939.435238088616, -8897.798117730641, -8975.553234674177, -8954.013636267562, -8921.580708788566, -8882.341541296597, -8859.242211943978, -8940.54803960217, -9060.240958378688, -8892.868959338033, -8866.977993793265, -8917.897705626423, -8994.113473994106, -8971.615510029722, -8901.701018000687, -8918.512362732507, -8870.904096379423, -8939.192816879746, -9002.24447245013, -8951.440277439457, -8914.190600267351, -8840.542490959271, -8855.501852324938, -8947.818236836198, -8941.06196356747, -8966.169282034045, -8967.971227791108, -8926.774892993142, -8885.257849338594, -8904.362617876262, -8993.38222815749, -8956.438396966978, -8923.546626800271, -8941.585616587068, -8877.418929787571, -8919.24202497797, -8885.04730585097, -9017.704457507014, -8943.205447766752, -9003.632255150242, -8882.037010058475, -8899.711164559956, -8957.612484430603, -8916.378110612406, -8841.980689143511, -8899.711164559956, -9008.497150793028, -8945.53574265254, -8921.478756117105, -8896.83512298153, -8903.108197599877, -8929.351346803516, -8880.08891469026, -8987.55658932177, -8921.81482367714, -8978.515170293447, -8885.322273119331, -8911.46351425718, -8944.716083708232, -8959.682408795197, -8883.05698917871, -8944.877874439333, -8936.721945689345, -8926.545879836951, -8896.634335661105, -8875.263761329721, -8850.140133103665, -8901.173351871355, -8968.548668396683, -8949.266295967176, -8923.787237849454, -8945.90234785922, -8911.020553319246, -8888.61122104573, -8988.714318125938, -8869.896766306152, -8921.29845579144, -8885.134067175082, -8902.293894502995, -8836.863764607675], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.0098657383953, "mean_inference_ms": 0.3458437464198065, "mean_action_processing_ms": 0.08535318858092854, "mean_env_wait_ms": 0.859876825725845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002347230911254883, "StateBufferConnector_ms": 0.001669168472290039, "ViewRequirementAgentConnector_ms": 0.04393649101257324}}, "episode_reward_max": -8836.863764607675, "episode_reward_min": -9060.240958378688, "episode_reward_mean": -8923.850971386217, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8992.496484738396, -8904.14311699125, -9013.821254439341, -8930.054773615759, -8923.094447037833, -8840.298915340903, -8919.482050470837, -8868.101437723672, -8946.006904564709, -8935.268857392382, -8985.667082333623, -8960.965083934294, -8896.093997598005, -8868.591017729454, -8982.88825193997, -8882.624097662685, -8876.430231376777, -8986.857490106484, -8879.262860422888, -8846.723525995047, -8939.435238088616, -8897.798117730641, -8975.553234674177, -8954.013636267562, -8921.580708788566, -8882.341541296597, -8859.242211943978, -8940.54803960217, -9060.240958378688, -8892.868959338033, -8866.977993793265, -8917.897705626423, -8994.113473994106, -8971.615510029722, -8901.701018000687, -8918.512362732507, -8870.904096379423, -8939.192816879746, -9002.24447245013, -8951.440277439457, -8914.190600267351, -8840.542490959271, -8855.501852324938, -8947.818236836198, -8941.06196356747, -8966.169282034045, -8967.971227791108, -8926.774892993142, -8885.257849338594, -8904.362617876262, -8993.38222815749, -8956.438396966978, -8923.546626800271, -8941.585616587068, -8877.418929787571, -8919.24202497797, -8885.04730585097, -9017.704457507014, -8943.205447766752, -9003.632255150242, -8882.037010058475, -8899.711164559956, -8957.612484430603, -8916.378110612406, -8841.980689143511, -8899.711164559956, -9008.497150793028, -8945.53574265254, -8921.478756117105, -8896.83512298153, -8903.108197599877, -8929.351346803516, -8880.08891469026, -8987.55658932177, -8921.81482367714, -8978.515170293447, -8885.322273119331, -8911.46351425718, -8944.716083708232, -8959.682408795197, -8883.05698917871, -8944.877874439333, -8936.721945689345, -8926.545879836951, -8896.634335661105, -8875.263761329721, -8850.140133103665, -8901.173351871355, -8968.548668396683, -8949.266295967176, -8923.787237849454, -8945.90234785922, -8911.020553319246, -8888.61122104573, -8988.714318125938, -8869.896766306152, -8921.29845579144, -8885.134067175082, -8902.293894502995, -8836.863764607675], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.0098657383953, "mean_inference_ms": 0.3458437464198065, "mean_action_processing_ms": 0.08535318858092854, "mean_env_wait_ms": 0.859876825725845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002347230911254883, "StateBufferConnector_ms": 0.001669168472290039, "ViewRequirementAgentConnector_ms": 0.04393649101257324}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 263640, "num_agent_steps_trained": 263640, "num_env_steps_sampled": 263640, "num_env_steps_trained": 263640, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.03403233545825, "num_env_steps_trained_throughput_per_sec": 189.03403233545825, "timesteps_total": 263640, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 263640, "timers": {"training_iteration_time_ms": 1900.509, "sample_time_ms": 1893.42, "load_time_ms": 0.22, "load_throughput": 1634321.29, "learn_time_ms": 6.296, "learn_throughput": 57180.11, "synch_weights_time_ms": 0.539}, "counters": {"num_env_steps_sampled": 263640, "num_env_steps_trained": 263640, "num_agent_steps_sampled": 263640, "num_agent_steps_trained": 263640}, "done": false, "episodes_total": 1213, "training_iteration": 251, "trial_id": "0d7ea_00000", "date": "2023-08-04_10-01-30", "timestamp": 1691132490, "time_this_iter_s": 11.429015874862671, "time_total_s": 2874.816612958908, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1144.9858860969543, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 23.418750000000003, "ram_util_percent": 65.55625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.0545776367187, "policy_loss": -4399760020.4, "vf_loss": 132219225.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2023.0, "diff_num_grad_updates_vs_sampler_policy": 2022.0}}, "num_env_steps_sampled": 265800, "num_env_steps_trained": 265800, "num_agent_steps_sampled": 265800, "num_agent_steps_trained": 265800}, "sampler_results": {"episode_reward_max": -8836.863764607675, "episode_reward_min": -9060.240958378688, "episode_reward_mean": -8921.820095762174, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8919.482050470837, -8868.101437723672, -8946.006904564709, -8935.268857392382, -8985.667082333623, -8960.965083934294, -8896.093997598005, -8868.591017729454, -8982.88825193997, -8882.624097662685, -8876.430231376777, -8986.857490106484, -8879.262860422888, -8846.723525995047, -8939.435238088616, -8897.798117730641, -8975.553234674177, -8954.013636267562, -8921.580708788566, -8882.341541296597, -8859.242211943978, -8940.54803960217, -9060.240958378688, -8892.868959338033, -8866.977993793265, -8917.897705626423, -8994.113473994106, -8971.615510029722, -8901.701018000687, -8918.512362732507, -8870.904096379423, -8939.192816879746, -9002.24447245013, -8951.440277439457, -8914.190600267351, -8840.542490959271, -8855.501852324938, -8947.818236836198, -8941.06196356747, -8966.169282034045, -8967.971227791108, -8926.774892993142, -8885.257849338594, -8904.362617876262, -8993.38222815749, -8956.438396966978, -8923.546626800271, -8941.585616587068, -8877.418929787571, -8919.24202497797, -8885.04730585097, -9017.704457507014, -8943.205447766752, -9003.632255150242, -8882.037010058475, -8899.711164559956, -8957.612484430603, -8916.378110612406, -8841.980689143511, -8899.711164559956, -9008.497150793028, -8945.53574265254, -8921.478756117105, -8896.83512298153, -8903.108197599877, -8929.351346803516, -8880.08891469026, -8987.55658932177, -8921.81482367714, -8978.515170293447, -8885.322273119331, -8911.46351425718, -8944.716083708232, -8959.682408795197, -8883.05698917871, -8944.877874439333, -8936.721945689345, -8926.545879836951, -8896.634335661105, -8875.263761329721, -8850.140133103665, -8901.173351871355, -8968.548668396683, -8949.266295967176, -8923.787237849454, -8945.90234785922, -8911.020553319246, -8888.61122104573, -8988.714318125938, -8869.896766306152, -8921.29845579144, -8885.134067175082, -8902.293894502995, -8836.863764607675, -8838.560045561908, -8941.830307912205, -8899.711164559956, -8899.711164559956, -8892.629286006326, -8928.379461159047], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.965162552926347, "mean_inference_ms": 0.3439814532679607, "mean_action_processing_ms": 0.08487886294166765, "mean_env_wait_ms": 0.8549661771277993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00235748291015625, "StateBufferConnector_ms": 0.001676321029663086, "ViewRequirementAgentConnector_ms": 0.04416799545288086}}, "episode_reward_max": -8836.863764607675, "episode_reward_min": -9060.240958378688, "episode_reward_mean": -8921.820095762174, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8919.482050470837, -8868.101437723672, -8946.006904564709, -8935.268857392382, -8985.667082333623, -8960.965083934294, -8896.093997598005, -8868.591017729454, -8982.88825193997, -8882.624097662685, -8876.430231376777, -8986.857490106484, -8879.262860422888, -8846.723525995047, -8939.435238088616, -8897.798117730641, -8975.553234674177, -8954.013636267562, -8921.580708788566, -8882.341541296597, -8859.242211943978, -8940.54803960217, -9060.240958378688, -8892.868959338033, -8866.977993793265, -8917.897705626423, -8994.113473994106, -8971.615510029722, -8901.701018000687, -8918.512362732507, -8870.904096379423, -8939.192816879746, -9002.24447245013, -8951.440277439457, -8914.190600267351, -8840.542490959271, -8855.501852324938, -8947.818236836198, -8941.06196356747, -8966.169282034045, -8967.971227791108, -8926.774892993142, -8885.257849338594, -8904.362617876262, -8993.38222815749, -8956.438396966978, -8923.546626800271, -8941.585616587068, -8877.418929787571, -8919.24202497797, -8885.04730585097, -9017.704457507014, -8943.205447766752, -9003.632255150242, -8882.037010058475, -8899.711164559956, -8957.612484430603, -8916.378110612406, -8841.980689143511, -8899.711164559956, -9008.497150793028, -8945.53574265254, -8921.478756117105, -8896.83512298153, -8903.108197599877, -8929.351346803516, -8880.08891469026, -8987.55658932177, -8921.81482367714, -8978.515170293447, -8885.322273119331, -8911.46351425718, -8944.716083708232, -8959.682408795197, -8883.05698917871, -8944.877874439333, -8936.721945689345, -8926.545879836951, -8896.634335661105, -8875.263761329721, -8850.140133103665, -8901.173351871355, -8968.548668396683, -8949.266295967176, -8923.787237849454, -8945.90234785922, -8911.020553319246, -8888.61122104573, -8988.714318125938, -8869.896766306152, -8921.29845579144, -8885.134067175082, -8902.293894502995, -8836.863764607675, -8838.560045561908, -8941.830307912205, -8899.711164559956, -8899.711164559956, -8892.629286006326, -8928.379461159047], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.965162552926347, "mean_inference_ms": 0.3439814532679607, "mean_action_processing_ms": 0.08487886294166765, "mean_env_wait_ms": 0.8549661771277993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00235748291015625, "StateBufferConnector_ms": 0.001676321029663086, "ViewRequirementAgentConnector_ms": 0.04416799545288086}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 265800, "num_agent_steps_trained": 265800, "num_env_steps_sampled": 265800, "num_env_steps_trained": 265800, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 186.79778798446293, "num_env_steps_trained_throughput_per_sec": 186.79778798446293, "timesteps_total": 265800, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 265800, "timers": {"training_iteration_time_ms": 1920.307, "sample_time_ms": 1913.303, "load_time_ms": 0.218, "load_throughput": 1652023.457, "learn_time_ms": 6.218, "learn_throughput": 57893.949, "synch_weights_time_ms": 0.534}, "counters": {"num_env_steps_sampled": 265800, "num_env_steps_trained": 265800, "num_agent_steps_sampled": 265800, "num_agent_steps_trained": 265800}, "done": false, "episodes_total": 1219, "training_iteration": 252, "trial_id": "0d7ea_00000", "date": "2023-08-04_10-01-41", "timestamp": 1691132501, "time_this_iter_s": 11.565372943878174, "time_total_s": 2886.3819859027863, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1156.5512590408325, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 26.112499999999997, "ram_util_percent": 65.78125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.1313110351563, "policy_loss": -1504218173.6, "vf_loss": 131799648.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2053.0, "diff_num_grad_updates_vs_sampler_policy": 2052.0}}, "num_env_steps_sampled": 267960, "num_env_steps_trained": 267960, "num_agent_steps_sampled": 267960, "num_agent_steps_trained": 267960}, "sampler_results": {"episode_reward_max": -8836.863764607675, "episode_reward_min": -9060.240958378688, "episode_reward_mean": -8920.95574103824, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8896.093997598005, -8868.591017729454, -8982.88825193997, -8882.624097662685, -8876.430231376777, -8986.857490106484, -8879.262860422888, -8846.723525995047, -8939.435238088616, -8897.798117730641, -8975.553234674177, -8954.013636267562, -8921.580708788566, -8882.341541296597, -8859.242211943978, -8940.54803960217, -9060.240958378688, -8892.868959338033, -8866.977993793265, -8917.897705626423, -8994.113473994106, -8971.615510029722, -8901.701018000687, -8918.512362732507, -8870.904096379423, -8939.192816879746, -9002.24447245013, -8951.440277439457, -8914.190600267351, -8840.542490959271, -8855.501852324938, -8947.818236836198, -8941.06196356747, -8966.169282034045, -8967.971227791108, -8926.774892993142, -8885.257849338594, -8904.362617876262, -8993.38222815749, -8956.438396966978, -8923.546626800271, -8941.585616587068, -8877.418929787571, -8919.24202497797, -8885.04730585097, -9017.704457507014, -8943.205447766752, -9003.632255150242, -8882.037010058475, -8899.711164559956, -8957.612484430603, -8916.378110612406, -8841.980689143511, -8899.711164559956, -9008.497150793028, -8945.53574265254, -8921.478756117105, -8896.83512298153, -8903.108197599877, -8929.351346803516, -8880.08891469026, -8987.55658932177, -8921.81482367714, -8978.515170293447, -8885.322273119331, -8911.46351425718, -8944.716083708232, -8959.682408795197, -8883.05698917871, -8944.877874439333, -8936.721945689345, -8926.545879836951, -8896.634335661105, -8875.263761329721, -8850.140133103665, -8901.173351871355, -8968.548668396683, -8949.266295967176, -8923.787237849454, -8945.90234785922, -8911.020553319246, -8888.61122104573, -8988.714318125938, -8869.896766306152, -8921.29845579144, -8885.134067175082, -8902.293894502995, -8836.863764607675, -8838.560045561908, -8941.830307912205, -8899.711164559956, -8899.711164559956, -8892.629286006326, -8928.379461159047, -8996.15776876015, -8856.698032727956, -8879.706364882837, -8939.096236386886, -8921.787059349352, -8935.610481918733], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.922115242994559, "mean_inference_ms": 0.342192157130931, "mean_action_processing_ms": 0.0844222459718694, "mean_env_wait_ms": 0.8502540314304311, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023593902587890625, "StateBufferConnector_ms": 0.0016770362854003906, "ViewRequirementAgentConnector_ms": 0.0442349910736084}}, "episode_reward_max": -8836.863764607675, "episode_reward_min": -9060.240958378688, "episode_reward_mean": -8920.95574103824, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8896.093997598005, -8868.591017729454, -8982.88825193997, -8882.624097662685, -8876.430231376777, -8986.857490106484, -8879.262860422888, -8846.723525995047, -8939.435238088616, -8897.798117730641, -8975.553234674177, -8954.013636267562, -8921.580708788566, -8882.341541296597, -8859.242211943978, -8940.54803960217, -9060.240958378688, -8892.868959338033, -8866.977993793265, -8917.897705626423, -8994.113473994106, -8971.615510029722, -8901.701018000687, -8918.512362732507, -8870.904096379423, -8939.192816879746, -9002.24447245013, -8951.440277439457, -8914.190600267351, -8840.542490959271, -8855.501852324938, -8947.818236836198, -8941.06196356747, -8966.169282034045, -8967.971227791108, -8926.774892993142, -8885.257849338594, -8904.362617876262, -8993.38222815749, -8956.438396966978, -8923.546626800271, -8941.585616587068, -8877.418929787571, -8919.24202497797, -8885.04730585097, -9017.704457507014, -8943.205447766752, -9003.632255150242, -8882.037010058475, -8899.711164559956, -8957.612484430603, -8916.378110612406, -8841.980689143511, -8899.711164559956, -9008.497150793028, -8945.53574265254, -8921.478756117105, -8896.83512298153, -8903.108197599877, -8929.351346803516, -8880.08891469026, -8987.55658932177, -8921.81482367714, -8978.515170293447, -8885.322273119331, -8911.46351425718, -8944.716083708232, -8959.682408795197, -8883.05698917871, -8944.877874439333, -8936.721945689345, -8926.545879836951, -8896.634335661105, -8875.263761329721, -8850.140133103665, -8901.173351871355, -8968.548668396683, -8949.266295967176, -8923.787237849454, -8945.90234785922, -8911.020553319246, -8888.61122104573, -8988.714318125938, -8869.896766306152, -8921.29845579144, -8885.134067175082, -8902.293894502995, -8836.863764607675, -8838.560045561908, -8941.830307912205, -8899.711164559956, -8899.711164559956, -8892.629286006326, -8928.379461159047, -8996.15776876015, -8856.698032727956, -8879.706364882837, -8939.096236386886, -8921.787059349352, -8935.610481918733], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.922115242994559, "mean_inference_ms": 0.342192157130931, "mean_action_processing_ms": 0.0844222459718694, "mean_env_wait_ms": 0.8502540314304311, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023593902587890625, "StateBufferConnector_ms": 0.0016770362854003906, "ViewRequirementAgentConnector_ms": 0.0442349910736084}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 267960, "num_agent_steps_trained": 267960, "num_env_steps_sampled": 267960, "num_env_steps_trained": 267960, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 183.48321619178162, "num_env_steps_trained_throughput_per_sec": 183.48321619178162, "timesteps_total": 267960, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 267960, "timers": {"training_iteration_time_ms": 1938.068, "sample_time_ms": 1931.026, "load_time_ms": 0.222, "load_throughput": 1620987.053, "learn_time_ms": 6.247, "learn_throughput": 57623.74, "synch_weights_time_ms": 0.538}, "counters": {"num_env_steps_sampled": 267960, "num_env_steps_trained": 267960, "num_agent_steps_sampled": 267960, "num_agent_steps_trained": 267960}, "done": false, "episodes_total": 1225, "training_iteration": 253, "trial_id": "0d7ea_00000", "date": "2023-08-04_10-01-53", "timestamp": 1691132513, "time_this_iter_s": 11.77524471282959, "time_total_s": 2898.157230615616, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1168.326503753662, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 31.935294117647064, "ram_util_percent": 65.89411764705882}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.0508666992188, "policy_loss": -2716005575.55, "vf_loss": 131564850.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2083.0, "diff_num_grad_updates_vs_sampler_policy": 2082.0}}, "num_env_steps_sampled": 270120, "num_env_steps_trained": 270120, "num_agent_steps_sampled": 270120, "num_agent_steps_trained": 270120}, "sampler_results": {"episode_reward_max": -8836.863764607675, "episode_reward_min": -9060.240958378688, "episode_reward_mean": -8921.191225090819, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8879.262860422888, -8846.723525995047, -8939.435238088616, -8897.798117730641, -8975.553234674177, -8954.013636267562, -8921.580708788566, -8882.341541296597, -8859.242211943978, -8940.54803960217, -9060.240958378688, -8892.868959338033, -8866.977993793265, -8917.897705626423, -8994.113473994106, -8971.615510029722, -8901.701018000687, -8918.512362732507, -8870.904096379423, -8939.192816879746, -9002.24447245013, -8951.440277439457, -8914.190600267351, -8840.542490959271, -8855.501852324938, -8947.818236836198, -8941.06196356747, -8966.169282034045, -8967.971227791108, -8926.774892993142, -8885.257849338594, -8904.362617876262, -8993.38222815749, -8956.438396966978, -8923.546626800271, -8941.585616587068, -8877.418929787571, -8919.24202497797, -8885.04730585097, -9017.704457507014, -8943.205447766752, -9003.632255150242, -8882.037010058475, -8899.711164559956, -8957.612484430603, -8916.378110612406, -8841.980689143511, -8899.711164559956, -9008.497150793028, -8945.53574265254, -8921.478756117105, -8896.83512298153, -8903.108197599877, -8929.351346803516, -8880.08891469026, -8987.55658932177, -8921.81482367714, -8978.515170293447, -8885.322273119331, -8911.46351425718, -8944.716083708232, -8959.682408795197, -8883.05698917871, -8944.877874439333, -8936.721945689345, -8926.545879836951, -8896.634335661105, -8875.263761329721, -8850.140133103665, -8901.173351871355, -8968.548668396683, -8949.266295967176, -8923.787237849454, -8945.90234785922, -8911.020553319246, -8888.61122104573, -8988.714318125938, -8869.896766306152, -8921.29845579144, -8885.134067175082, -8902.293894502995, -8836.863764607675, -8838.560045561908, -8941.830307912205, -8899.711164559956, -8899.711164559956, -8892.629286006326, -8928.379461159047, -8996.15776876015, -8856.698032727956, -8879.706364882837, -8939.096236386886, -8921.787059349352, -8935.610481918733, -8953.960872106121, -8930.321022008251, -8899.711164559956, -8928.676233803611, -8896.760659244415, -8907.603539949092], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.880542771652696, "mean_inference_ms": 0.3404686662962022, "mean_action_processing_ms": 0.08398216937045234, "mean_env_wait_ms": 0.8457101377872885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023508071899414062, "StateBufferConnector_ms": 0.0016694068908691406, "ViewRequirementAgentConnector_ms": 0.04422926902770996}}, "episode_reward_max": -8836.863764607675, "episode_reward_min": -9060.240958378688, "episode_reward_mean": -8921.191225090819, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8879.262860422888, -8846.723525995047, -8939.435238088616, -8897.798117730641, -8975.553234674177, -8954.013636267562, -8921.580708788566, -8882.341541296597, -8859.242211943978, -8940.54803960217, -9060.240958378688, -8892.868959338033, -8866.977993793265, -8917.897705626423, -8994.113473994106, -8971.615510029722, -8901.701018000687, -8918.512362732507, -8870.904096379423, -8939.192816879746, -9002.24447245013, -8951.440277439457, -8914.190600267351, -8840.542490959271, -8855.501852324938, -8947.818236836198, -8941.06196356747, -8966.169282034045, -8967.971227791108, -8926.774892993142, -8885.257849338594, -8904.362617876262, -8993.38222815749, -8956.438396966978, -8923.546626800271, -8941.585616587068, -8877.418929787571, -8919.24202497797, -8885.04730585097, -9017.704457507014, -8943.205447766752, -9003.632255150242, -8882.037010058475, -8899.711164559956, -8957.612484430603, -8916.378110612406, -8841.980689143511, -8899.711164559956, -9008.497150793028, -8945.53574265254, -8921.478756117105, -8896.83512298153, -8903.108197599877, -8929.351346803516, -8880.08891469026, -8987.55658932177, -8921.81482367714, -8978.515170293447, -8885.322273119331, -8911.46351425718, -8944.716083708232, -8959.682408795197, -8883.05698917871, -8944.877874439333, -8936.721945689345, -8926.545879836951, -8896.634335661105, -8875.263761329721, -8850.140133103665, -8901.173351871355, -8968.548668396683, -8949.266295967176, -8923.787237849454, -8945.90234785922, -8911.020553319246, -8888.61122104573, -8988.714318125938, -8869.896766306152, -8921.29845579144, -8885.134067175082, -8902.293894502995, -8836.863764607675, -8838.560045561908, -8941.830307912205, -8899.711164559956, -8899.711164559956, -8892.629286006326, -8928.379461159047, -8996.15776876015, -8856.698032727956, -8879.706364882837, -8939.096236386886, -8921.787059349352, -8935.610481918733, -8953.960872106121, -8930.321022008251, -8899.711164559956, -8928.676233803611, -8896.760659244415, -8907.603539949092], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.880542771652696, "mean_inference_ms": 0.3404686662962022, "mean_action_processing_ms": 0.08398216937045234, "mean_env_wait_ms": 0.8457101377872885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023508071899414062, "StateBufferConnector_ms": 0.0016694068908691406, "ViewRequirementAgentConnector_ms": 0.04422926902770996}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 270120, "num_agent_steps_trained": 270120, "num_env_steps_sampled": 270120, "num_env_steps_trained": 270120, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 188.1975112185364, "num_env_steps_trained_throughput_per_sec": 188.1975112185364, "timesteps_total": 270120, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 270120, "timers": {"training_iteration_time_ms": 1940.887, "sample_time_ms": 1933.771, "load_time_ms": 0.224, "load_throughput": 1608896.58, "learn_time_ms": 6.301, "learn_throughput": 57134.241, "synch_weights_time_ms": 0.557}, "counters": {"num_env_steps_sampled": 270120, "num_env_steps_trained": 270120, "num_agent_steps_sampled": 270120, "num_agent_steps_trained": 270120}, "done": false, "episodes_total": 1231, "training_iteration": 254, "trial_id": "0d7ea_00000", "date": "2023-08-04_10-02-05", "timestamp": 1691132525, "time_this_iter_s": 11.479345083236694, "time_total_s": 2909.6365756988525, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1179.8058488368988, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 25.16875, "ram_util_percent": 65.94999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.0442504882812, "policy_loss": -2669205000.3375, "vf_loss": 132552657.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2113.0, "diff_num_grad_updates_vs_sampler_policy": 2112.0}}, "num_env_steps_sampled": 272280, "num_env_steps_trained": 272280, "num_agent_steps_sampled": 272280, "num_agent_steps_trained": 272280}, "sampler_results": {"episode_reward_max": -8827.150455368672, "episode_reward_min": -9060.240958378688, "episode_reward_mean": -8921.737244357391, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8921.580708788566, -8882.341541296597, -8859.242211943978, -8940.54803960217, -9060.240958378688, -8892.868959338033, -8866.977993793265, -8917.897705626423, -8994.113473994106, -8971.615510029722, -8901.701018000687, -8918.512362732507, -8870.904096379423, -8939.192816879746, -9002.24447245013, -8951.440277439457, -8914.190600267351, -8840.542490959271, -8855.501852324938, -8947.818236836198, -8941.06196356747, -8966.169282034045, -8967.971227791108, -8926.774892993142, -8885.257849338594, -8904.362617876262, -8993.38222815749, -8956.438396966978, -8923.546626800271, -8941.585616587068, -8877.418929787571, -8919.24202497797, -8885.04730585097, -9017.704457507014, -8943.205447766752, -9003.632255150242, -8882.037010058475, -8899.711164559956, -8957.612484430603, -8916.378110612406, -8841.980689143511, -8899.711164559956, -9008.497150793028, -8945.53574265254, -8921.478756117105, -8896.83512298153, -8903.108197599877, -8929.351346803516, -8880.08891469026, -8987.55658932177, -8921.81482367714, -8978.515170293447, -8885.322273119331, -8911.46351425718, -8944.716083708232, -8959.682408795197, -8883.05698917871, -8944.877874439333, -8936.721945689345, -8926.545879836951, -8896.634335661105, -8875.263761329721, -8850.140133103665, -8901.173351871355, -8968.548668396683, -8949.266295967176, -8923.787237849454, -8945.90234785922, -8911.020553319246, -8888.61122104573, -8988.714318125938, -8869.896766306152, -8921.29845579144, -8885.134067175082, -8902.293894502995, -8836.863764607675, -8838.560045561908, -8941.830307912205, -8899.711164559956, -8899.711164559956, -8892.629286006326, -8928.379461159047, -8996.15776876015, -8856.698032727956, -8879.706364882837, -8939.096236386886, -8921.787059349352, -8935.610481918733, -8953.960872106121, -8930.321022008251, -8899.711164559956, -8928.676233803611, -8896.760659244415, -8907.603539949092, -8827.150455368672, -8926.00694087174, -8965.905019405493, -8945.018075954626, -8933.197486769855, -8950.110561465774], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.840393509850103, "mean_inference_ms": 0.33880096315098457, "mean_action_processing_ms": 0.08355618674151699, "mean_env_wait_ms": 0.8413084118357661, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023508071899414062, "StateBufferConnector_ms": 0.0016713142395019531, "ViewRequirementAgentConnector_ms": 0.0442051887512207}}, "episode_reward_max": -8827.150455368672, "episode_reward_min": -9060.240958378688, "episode_reward_mean": -8921.737244357391, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8921.580708788566, -8882.341541296597, -8859.242211943978, -8940.54803960217, -9060.240958378688, -8892.868959338033, -8866.977993793265, -8917.897705626423, -8994.113473994106, -8971.615510029722, -8901.701018000687, -8918.512362732507, -8870.904096379423, -8939.192816879746, -9002.24447245013, -8951.440277439457, -8914.190600267351, -8840.542490959271, -8855.501852324938, -8947.818236836198, -8941.06196356747, -8966.169282034045, -8967.971227791108, -8926.774892993142, -8885.257849338594, -8904.362617876262, -8993.38222815749, -8956.438396966978, -8923.546626800271, -8941.585616587068, -8877.418929787571, -8919.24202497797, -8885.04730585097, -9017.704457507014, -8943.205447766752, -9003.632255150242, -8882.037010058475, -8899.711164559956, -8957.612484430603, -8916.378110612406, -8841.980689143511, -8899.711164559956, -9008.497150793028, -8945.53574265254, -8921.478756117105, -8896.83512298153, -8903.108197599877, -8929.351346803516, -8880.08891469026, -8987.55658932177, -8921.81482367714, -8978.515170293447, -8885.322273119331, -8911.46351425718, -8944.716083708232, -8959.682408795197, -8883.05698917871, -8944.877874439333, -8936.721945689345, -8926.545879836951, -8896.634335661105, -8875.263761329721, -8850.140133103665, -8901.173351871355, -8968.548668396683, -8949.266295967176, -8923.787237849454, -8945.90234785922, -8911.020553319246, -8888.61122104573, -8988.714318125938, -8869.896766306152, -8921.29845579144, -8885.134067175082, -8902.293894502995, -8836.863764607675, -8838.560045561908, -8941.830307912205, -8899.711164559956, -8899.711164559956, -8892.629286006326, -8928.379461159047, -8996.15776876015, -8856.698032727956, -8879.706364882837, -8939.096236386886, -8921.787059349352, -8935.610481918733, -8953.960872106121, -8930.321022008251, -8899.711164559956, -8928.676233803611, -8896.760659244415, -8907.603539949092, -8827.150455368672, -8926.00694087174, -8965.905019405493, -8945.018075954626, -8933.197486769855, -8950.110561465774], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.840393509850103, "mean_inference_ms": 0.33880096315098457, "mean_action_processing_ms": 0.08355618674151699, "mean_env_wait_ms": 0.8413084118357661, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023508071899414062, "StateBufferConnector_ms": 0.0016713142395019531, "ViewRequirementAgentConnector_ms": 0.0442051887512207}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272280, "num_agent_steps_trained": 272280, "num_env_steps_sampled": 272280, "num_env_steps_trained": 272280, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 187.67867001718145, "num_env_steps_trained_throughput_per_sec": 187.67867001718145, "timesteps_total": 272280, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 272280, "timers": {"training_iteration_time_ms": 1916.615, "sample_time_ms": 1909.654, "load_time_ms": 0.217, "load_throughput": 1655827.876, "learn_time_ms": 6.189, "learn_throughput": 58163.118, "synch_weights_time_ms": 0.521}, "counters": {"num_env_steps_sampled": 272280, "num_env_steps_trained": 272280, "num_agent_steps_sampled": 272280, "num_agent_steps_trained": 272280}, "done": false, "episodes_total": 1237, "training_iteration": 255, "trial_id": "0d7ea_00000", "date": "2023-08-04_10-02-16", "timestamp": 1691132536, "time_this_iter_s": 11.511338949203491, "time_total_s": 2921.147914648056, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1191.3171877861023, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 22.56470588235294, "ram_util_percent": 65.78823529411765}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.1181762695312, "policy_loss": -1654213434.925, "vf_loss": 130514743.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2143.0, "diff_num_grad_updates_vs_sampler_policy": 2142.0}}, "num_env_steps_sampled": 274440, "num_env_steps_trained": 274440, "num_agent_steps_sampled": 274440, "num_agent_steps_trained": 274440}, "sampler_results": {"episode_reward_max": -8827.150455368672, "episode_reward_min": -9017.704457507014, "episode_reward_mean": -8921.190030610655, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8866.977993793265, -8917.897705626423, -8994.113473994106, -8971.615510029722, -8901.701018000687, -8918.512362732507, -8870.904096379423, -8939.192816879746, -9002.24447245013, -8951.440277439457, -8914.190600267351, -8840.542490959271, -8855.501852324938, -8947.818236836198, -8941.06196356747, -8966.169282034045, -8967.971227791108, -8926.774892993142, -8885.257849338594, -8904.362617876262, -8993.38222815749, -8956.438396966978, -8923.546626800271, -8941.585616587068, -8877.418929787571, -8919.24202497797, -8885.04730585097, -9017.704457507014, -8943.205447766752, -9003.632255150242, -8882.037010058475, -8899.711164559956, -8957.612484430603, -8916.378110612406, -8841.980689143511, -8899.711164559956, -9008.497150793028, -8945.53574265254, -8921.478756117105, -8896.83512298153, -8903.108197599877, -8929.351346803516, -8880.08891469026, -8987.55658932177, -8921.81482367714, -8978.515170293447, -8885.322273119331, -8911.46351425718, -8944.716083708232, -8959.682408795197, -8883.05698917871, -8944.877874439333, -8936.721945689345, -8926.545879836951, -8896.634335661105, -8875.263761329721, -8850.140133103665, -8901.173351871355, -8968.548668396683, -8949.266295967176, -8923.787237849454, -8945.90234785922, -8911.020553319246, -8888.61122104573, -8988.714318125938, -8869.896766306152, -8921.29845579144, -8885.134067175082, -8902.293894502995, -8836.863764607675, -8838.560045561908, -8941.830307912205, -8899.711164559956, -8899.711164559956, -8892.629286006326, -8928.379461159047, -8996.15776876015, -8856.698032727956, -8879.706364882837, -8939.096236386886, -8921.787059349352, -8935.610481918733, -8953.960872106121, -8930.321022008251, -8899.711164559956, -8928.676233803611, -8896.760659244415, -8907.603539949092, -8827.150455368672, -8926.00694087174, -8965.905019405493, -8945.018075954626, -8933.197486769855, -8950.110561465774, -8924.838695545377, -8896.87769425596, -8939.959546670378, -8975.054061906023, -8875.092070877165, -8890.278975419353], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.801471651380097, "mean_inference_ms": 0.33718292614919093, "mean_action_processing_ms": 0.08314294592982971, "mean_env_wait_ms": 0.8370477436947354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023462772369384766, "StateBufferConnector_ms": 0.001668691635131836, "ViewRequirementAgentConnector_ms": 0.04403090476989746}}, "episode_reward_max": -8827.150455368672, "episode_reward_min": -9017.704457507014, "episode_reward_mean": -8921.190030610655, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8866.977993793265, -8917.897705626423, -8994.113473994106, -8971.615510029722, -8901.701018000687, -8918.512362732507, -8870.904096379423, -8939.192816879746, -9002.24447245013, -8951.440277439457, -8914.190600267351, -8840.542490959271, -8855.501852324938, -8947.818236836198, -8941.06196356747, -8966.169282034045, -8967.971227791108, -8926.774892993142, -8885.257849338594, -8904.362617876262, -8993.38222815749, -8956.438396966978, -8923.546626800271, -8941.585616587068, -8877.418929787571, -8919.24202497797, -8885.04730585097, -9017.704457507014, -8943.205447766752, -9003.632255150242, -8882.037010058475, -8899.711164559956, -8957.612484430603, -8916.378110612406, -8841.980689143511, -8899.711164559956, -9008.497150793028, -8945.53574265254, -8921.478756117105, -8896.83512298153, -8903.108197599877, -8929.351346803516, -8880.08891469026, -8987.55658932177, -8921.81482367714, -8978.515170293447, -8885.322273119331, -8911.46351425718, -8944.716083708232, -8959.682408795197, -8883.05698917871, -8944.877874439333, -8936.721945689345, -8926.545879836951, -8896.634335661105, -8875.263761329721, -8850.140133103665, -8901.173351871355, -8968.548668396683, -8949.266295967176, -8923.787237849454, -8945.90234785922, -8911.020553319246, -8888.61122104573, -8988.714318125938, -8869.896766306152, -8921.29845579144, -8885.134067175082, -8902.293894502995, -8836.863764607675, -8838.560045561908, -8941.830307912205, -8899.711164559956, -8899.711164559956, -8892.629286006326, -8928.379461159047, -8996.15776876015, -8856.698032727956, -8879.706364882837, -8939.096236386886, -8921.787059349352, -8935.610481918733, -8953.960872106121, -8930.321022008251, -8899.711164559956, -8928.676233803611, -8896.760659244415, -8907.603539949092, -8827.150455368672, -8926.00694087174, -8965.905019405493, -8945.018075954626, -8933.197486769855, -8950.110561465774, -8924.838695545377, -8896.87769425596, -8939.959546670378, -8975.054061906023, -8875.092070877165, -8890.278975419353], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.801471651380097, "mean_inference_ms": 0.33718292614919093, "mean_action_processing_ms": 0.08314294592982971, "mean_env_wait_ms": 0.8370477436947354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023462772369384766, "StateBufferConnector_ms": 0.001668691635131836, "ViewRequirementAgentConnector_ms": 0.04403090476989746}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 274440, "num_agent_steps_trained": 274440, "num_env_steps_sampled": 274440, "num_env_steps_trained": 274440, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.47455044664264, "num_env_steps_trained_throughput_per_sec": 189.47455044664264, "timesteps_total": 274440, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 274440, "timers": {"training_iteration_time_ms": 1910.133, "sample_time_ms": 1903.19, "load_time_ms": 0.216, "load_throughput": 1669374.726, "learn_time_ms": 6.167, "learn_throughput": 58379.224, "synch_weights_time_ms": 0.529}, "counters": {"num_env_steps_sampled": 274440, "num_env_steps_trained": 274440, "num_agent_steps_sampled": 274440, "num_agent_steps_trained": 274440}, "done": false, "episodes_total": 1243, "training_iteration": 256, "trial_id": "0d7ea_00000", "date": "2023-08-04_10-02-27", "timestamp": 1691132547, "time_this_iter_s": 11.402114152908325, "time_total_s": 2932.5500288009644, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1202.7193019390106, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 23.381249999999998, "ram_util_percent": 65.67499999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.0862182617187, "policy_loss": -1570544748.25, "vf_loss": 132521103.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2173.0, "diff_num_grad_updates_vs_sampler_policy": 2172.0}}, "num_env_steps_sampled": 276600, "num_env_steps_trained": 276600, "num_agent_steps_sampled": 276600, "num_agent_steps_trained": 276600}, "sampler_results": {"episode_reward_max": -8827.150455368672, "episode_reward_min": -9017.704457507014, "episode_reward_mean": -8920.487902636216, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8870.904096379423, -8939.192816879746, -9002.24447245013, -8951.440277439457, -8914.190600267351, -8840.542490959271, -8855.501852324938, -8947.818236836198, -8941.06196356747, -8966.169282034045, -8967.971227791108, -8926.774892993142, -8885.257849338594, -8904.362617876262, -8993.38222815749, -8956.438396966978, -8923.546626800271, -8941.585616587068, -8877.418929787571, -8919.24202497797, -8885.04730585097, -9017.704457507014, -8943.205447766752, -9003.632255150242, -8882.037010058475, -8899.711164559956, -8957.612484430603, -8916.378110612406, -8841.980689143511, -8899.711164559956, -9008.497150793028, -8945.53574265254, -8921.478756117105, -8896.83512298153, -8903.108197599877, -8929.351346803516, -8880.08891469026, -8987.55658932177, -8921.81482367714, -8978.515170293447, -8885.322273119331, -8911.46351425718, -8944.716083708232, -8959.682408795197, -8883.05698917871, -8944.877874439333, -8936.721945689345, -8926.545879836951, -8896.634335661105, -8875.263761329721, -8850.140133103665, -8901.173351871355, -8968.548668396683, -8949.266295967176, -8923.787237849454, -8945.90234785922, -8911.020553319246, -8888.61122104573, -8988.714318125938, -8869.896766306152, -8921.29845579144, -8885.134067175082, -8902.293894502995, -8836.863764607675, -8838.560045561908, -8941.830307912205, -8899.711164559956, -8899.711164559956, -8892.629286006326, -8928.379461159047, -8996.15776876015, -8856.698032727956, -8879.706364882837, -8939.096236386886, -8921.787059349352, -8935.610481918733, -8953.960872106121, -8930.321022008251, -8899.711164559956, -8928.676233803611, -8896.760659244415, -8907.603539949092, -8827.150455368672, -8926.00694087174, -8965.905019405493, -8945.018075954626, -8933.197486769855, -8950.110561465774, -8924.838695545377, -8896.87769425596, -8939.959546670378, -8975.054061906023, -8875.092070877165, -8890.278975419353, -8913.278003799973, -8907.841541551557, -8899.711164559956, -8906.922991867526, -8924.356207908566, -8948.49535704537], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.763637947667085, "mean_inference_ms": 0.3356056795445796, "mean_action_processing_ms": 0.08274094963753552, "mean_env_wait_ms": 0.8329175775147093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002346515655517578, "StateBufferConnector_ms": 0.0016582012176513672, "ViewRequirementAgentConnector_ms": 0.04396653175354004}}, "episode_reward_max": -8827.150455368672, "episode_reward_min": -9017.704457507014, "episode_reward_mean": -8920.487902636216, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8870.904096379423, -8939.192816879746, -9002.24447245013, -8951.440277439457, -8914.190600267351, -8840.542490959271, -8855.501852324938, -8947.818236836198, -8941.06196356747, -8966.169282034045, -8967.971227791108, -8926.774892993142, -8885.257849338594, -8904.362617876262, -8993.38222815749, -8956.438396966978, -8923.546626800271, -8941.585616587068, -8877.418929787571, -8919.24202497797, -8885.04730585097, -9017.704457507014, -8943.205447766752, -9003.632255150242, -8882.037010058475, -8899.711164559956, -8957.612484430603, -8916.378110612406, -8841.980689143511, -8899.711164559956, -9008.497150793028, -8945.53574265254, -8921.478756117105, -8896.83512298153, -8903.108197599877, -8929.351346803516, -8880.08891469026, -8987.55658932177, -8921.81482367714, -8978.515170293447, -8885.322273119331, -8911.46351425718, -8944.716083708232, -8959.682408795197, -8883.05698917871, -8944.877874439333, -8936.721945689345, -8926.545879836951, -8896.634335661105, -8875.263761329721, -8850.140133103665, -8901.173351871355, -8968.548668396683, -8949.266295967176, -8923.787237849454, -8945.90234785922, -8911.020553319246, -8888.61122104573, -8988.714318125938, -8869.896766306152, -8921.29845579144, -8885.134067175082, -8902.293894502995, -8836.863764607675, -8838.560045561908, -8941.830307912205, -8899.711164559956, -8899.711164559956, -8892.629286006326, -8928.379461159047, -8996.15776876015, -8856.698032727956, -8879.706364882837, -8939.096236386886, -8921.787059349352, -8935.610481918733, -8953.960872106121, -8930.321022008251, -8899.711164559956, -8928.676233803611, -8896.760659244415, -8907.603539949092, -8827.150455368672, -8926.00694087174, -8965.905019405493, -8945.018075954626, -8933.197486769855, -8950.110561465774, -8924.838695545377, -8896.87769425596, -8939.959546670378, -8975.054061906023, -8875.092070877165, -8890.278975419353, -8913.278003799973, -8907.841541551557, -8899.711164559956, -8906.922991867526, -8924.356207908566, -8948.49535704537], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.763637947667085, "mean_inference_ms": 0.3356056795445796, "mean_action_processing_ms": 0.08274094963753552, "mean_env_wait_ms": 0.8329175775147093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002346515655517578, "StateBufferConnector_ms": 0.0016582012176513672, "ViewRequirementAgentConnector_ms": 0.04396653175354004}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276600, "num_agent_steps_trained": 276600, "num_env_steps_sampled": 276600, "num_env_steps_trained": 276600, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.5542751136807, "num_env_steps_trained_throughput_per_sec": 190.5542751136807, "timesteps_total": 276600, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 276600, "timers": {"training_iteration_time_ms": 1893.483, "sample_time_ms": 1886.492, "load_time_ms": 0.22, "load_throughput": 1633790.781, "learn_time_ms": 6.213, "learn_throughput": 57942.157, "synch_weights_time_ms": 0.524}, "counters": {"num_env_steps_sampled": 276600, "num_env_steps_trained": 276600, "num_agent_steps_sampled": 276600, "num_agent_steps_trained": 276600}, "done": false, "episodes_total": 1249, "training_iteration": 257, "trial_id": "0d7ea_00000", "date": "2023-08-04_10-02-39", "timestamp": 1691132559, "time_this_iter_s": 11.337456941604614, "time_total_s": 2943.887485742569, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1214.0567588806152, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 23.8375, "ram_util_percent": 65.6375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.1058959960938, "policy_loss": -1816952570.4375, "vf_loss": 131333245.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2203.0, "diff_num_grad_updates_vs_sampler_policy": 2202.0}}, "num_env_steps_sampled": 278760, "num_env_steps_trained": 278760, "num_agent_steps_sampled": 278760, "num_agent_steps_trained": 278760}, "sampler_results": {"episode_reward_max": -8827.150455368672, "episode_reward_min": -9017.704457507014, "episode_reward_mean": -8920.912125914188, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8855.501852324938, -8947.818236836198, -8941.06196356747, -8966.169282034045, -8967.971227791108, -8926.774892993142, -8885.257849338594, -8904.362617876262, -8993.38222815749, -8956.438396966978, -8923.546626800271, -8941.585616587068, -8877.418929787571, -8919.24202497797, -8885.04730585097, -9017.704457507014, -8943.205447766752, -9003.632255150242, -8882.037010058475, -8899.711164559956, -8957.612484430603, -8916.378110612406, -8841.980689143511, -8899.711164559956, -9008.497150793028, -8945.53574265254, -8921.478756117105, -8896.83512298153, -8903.108197599877, -8929.351346803516, -8880.08891469026, -8987.55658932177, -8921.81482367714, -8978.515170293447, -8885.322273119331, -8911.46351425718, -8944.716083708232, -8959.682408795197, -8883.05698917871, -8944.877874439333, -8936.721945689345, -8926.545879836951, -8896.634335661105, -8875.263761329721, -8850.140133103665, -8901.173351871355, -8968.548668396683, -8949.266295967176, -8923.787237849454, -8945.90234785922, -8911.020553319246, -8888.61122104573, -8988.714318125938, -8869.896766306152, -8921.29845579144, -8885.134067175082, -8902.293894502995, -8836.863764607675, -8838.560045561908, -8941.830307912205, -8899.711164559956, -8899.711164559956, -8892.629286006326, -8928.379461159047, -8996.15776876015, -8856.698032727956, -8879.706364882837, -8939.096236386886, -8921.787059349352, -8935.610481918733, -8953.960872106121, -8930.321022008251, -8899.711164559956, -8928.676233803611, -8896.760659244415, -8907.603539949092, -8827.150455368672, -8926.00694087174, -8965.905019405493, -8945.018075954626, -8933.197486769855, -8950.110561465774, -8924.838695545377, -8896.87769425596, -8939.959546670378, -8975.054061906023, -8875.092070877165, -8890.278975419353, -8913.278003799973, -8907.841541551557, -8899.711164559956, -8906.922991867526, -8924.356207908566, -8948.49535704537, -8945.221056756416, -8968.19527252281, -8867.812123691156, -8968.94830328423, -8894.646539796293, -8916.113786121698], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.726965014190655, "mean_inference_ms": 0.3340743130847508, "mean_action_processing_ms": 0.08235096807954508, "mean_env_wait_ms": 0.8289335492397727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023345947265625, "StateBufferConnector_ms": 0.0016710758209228516, "ViewRequirementAgentConnector_ms": 0.04395008087158203}}, "episode_reward_max": -8827.150455368672, "episode_reward_min": -9017.704457507014, "episode_reward_mean": -8920.912125914188, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8855.501852324938, -8947.818236836198, -8941.06196356747, -8966.169282034045, -8967.971227791108, -8926.774892993142, -8885.257849338594, -8904.362617876262, -8993.38222815749, -8956.438396966978, -8923.546626800271, -8941.585616587068, -8877.418929787571, -8919.24202497797, -8885.04730585097, -9017.704457507014, -8943.205447766752, -9003.632255150242, -8882.037010058475, -8899.711164559956, -8957.612484430603, -8916.378110612406, -8841.980689143511, -8899.711164559956, -9008.497150793028, -8945.53574265254, -8921.478756117105, -8896.83512298153, -8903.108197599877, -8929.351346803516, -8880.08891469026, -8987.55658932177, -8921.81482367714, -8978.515170293447, -8885.322273119331, -8911.46351425718, -8944.716083708232, -8959.682408795197, -8883.05698917871, -8944.877874439333, -8936.721945689345, -8926.545879836951, -8896.634335661105, -8875.263761329721, -8850.140133103665, -8901.173351871355, -8968.548668396683, -8949.266295967176, -8923.787237849454, -8945.90234785922, -8911.020553319246, -8888.61122104573, -8988.714318125938, -8869.896766306152, -8921.29845579144, -8885.134067175082, -8902.293894502995, -8836.863764607675, -8838.560045561908, -8941.830307912205, -8899.711164559956, -8899.711164559956, -8892.629286006326, -8928.379461159047, -8996.15776876015, -8856.698032727956, -8879.706364882837, -8939.096236386886, -8921.787059349352, -8935.610481918733, -8953.960872106121, -8930.321022008251, -8899.711164559956, -8928.676233803611, -8896.760659244415, -8907.603539949092, -8827.150455368672, -8926.00694087174, -8965.905019405493, -8945.018075954626, -8933.197486769855, -8950.110561465774, -8924.838695545377, -8896.87769425596, -8939.959546670378, -8975.054061906023, -8875.092070877165, -8890.278975419353, -8913.278003799973, -8907.841541551557, -8899.711164559956, -8906.922991867526, -8924.356207908566, -8948.49535704537, -8945.221056756416, -8968.19527252281, -8867.812123691156, -8968.94830328423, -8894.646539796293, -8916.113786121698], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.726965014190655, "mean_inference_ms": 0.3340743130847508, "mean_action_processing_ms": 0.08235096807954508, "mean_env_wait_ms": 0.8289335492397727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023345947265625, "StateBufferConnector_ms": 0.0016710758209228516, "ViewRequirementAgentConnector_ms": 0.04395008087158203}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 278760, "num_agent_steps_trained": 278760, "num_env_steps_sampled": 278760, "num_env_steps_trained": 278760, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.73776755151442, "num_env_steps_trained_throughput_per_sec": 189.73776755151442, "timesteps_total": 278760, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 278760, "timers": {"training_iteration_time_ms": 1892.023, "sample_time_ms": 1885.055, "load_time_ms": 0.219, "load_throughput": 1645004.292, "learn_time_ms": 6.206, "learn_throughput": 58012.949, "synch_weights_time_ms": 0.51}, "counters": {"num_env_steps_sampled": 278760, "num_env_steps_trained": 278760, "num_agent_steps_sampled": 278760, "num_agent_steps_trained": 278760}, "done": false, "episodes_total": 1255, "training_iteration": 258, "trial_id": "0d7ea_00000", "date": "2023-08-04_10-02-50", "timestamp": 1691132570, "time_this_iter_s": 11.386168956756592, "time_total_s": 2955.2736546993256, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1225.4429278373718, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 25.225, "ram_util_percent": 65.61875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.0770751953125, "policy_loss": -1104998678.275, "vf_loss": 132955548.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2233.0, "diff_num_grad_updates_vs_sampler_policy": 2232.0}}, "num_env_steps_sampled": 280920, "num_env_steps_trained": 280920, "num_agent_steps_sampled": 280920, "num_agent_steps_trained": 280920}, "sampler_results": {"episode_reward_max": -8827.150455368672, "episode_reward_min": -9017.704457507014, "episode_reward_mean": -8919.725059464547, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8885.257849338594, -8904.362617876262, -8993.38222815749, -8956.438396966978, -8923.546626800271, -8941.585616587068, -8877.418929787571, -8919.24202497797, -8885.04730585097, -9017.704457507014, -8943.205447766752, -9003.632255150242, -8882.037010058475, -8899.711164559956, -8957.612484430603, -8916.378110612406, -8841.980689143511, -8899.711164559956, -9008.497150793028, -8945.53574265254, -8921.478756117105, -8896.83512298153, -8903.108197599877, -8929.351346803516, -8880.08891469026, -8987.55658932177, -8921.81482367714, -8978.515170293447, -8885.322273119331, -8911.46351425718, -8944.716083708232, -8959.682408795197, -8883.05698917871, -8944.877874439333, -8936.721945689345, -8926.545879836951, -8896.634335661105, -8875.263761329721, -8850.140133103665, -8901.173351871355, -8968.548668396683, -8949.266295967176, -8923.787237849454, -8945.90234785922, -8911.020553319246, -8888.61122104573, -8988.714318125938, -8869.896766306152, -8921.29845579144, -8885.134067175082, -8902.293894502995, -8836.863764607675, -8838.560045561908, -8941.830307912205, -8899.711164559956, -8899.711164559956, -8892.629286006326, -8928.379461159047, -8996.15776876015, -8856.698032727956, -8879.706364882837, -8939.096236386886, -8921.787059349352, -8935.610481918733, -8953.960872106121, -8930.321022008251, -8899.711164559956, -8928.676233803611, -8896.760659244415, -8907.603539949092, -8827.150455368672, -8926.00694087174, -8965.905019405493, -8945.018075954626, -8933.197486769855, -8950.110561465774, -8924.838695545377, -8896.87769425596, -8939.959546670378, -8975.054061906023, -8875.092070877165, -8890.278975419353, -8913.278003799973, -8907.841541551557, -8899.711164559956, -8906.922991867526, -8924.356207908566, -8948.49535704537, -8945.221056756416, -8968.19527252281, -8867.812123691156, -8968.94830328423, -8894.646539796293, -8916.113786121698, -8911.388711531734, -8926.36708093509, -8919.966526945997, -8899.711164559956, -8873.484313910787, -8955.67301269914], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.691396964809286, "mean_inference_ms": 0.3325916314387532, "mean_action_processing_ms": 0.08197331422320861, "mean_env_wait_ms": 0.8250717902270867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023283958435058594, "StateBufferConnector_ms": 0.0016548633575439453, "ViewRequirementAgentConnector_ms": 0.04388737678527832}}, "episode_reward_max": -8827.150455368672, "episode_reward_min": -9017.704457507014, "episode_reward_mean": -8919.725059464547, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8885.257849338594, -8904.362617876262, -8993.38222815749, -8956.438396966978, -8923.546626800271, -8941.585616587068, -8877.418929787571, -8919.24202497797, -8885.04730585097, -9017.704457507014, -8943.205447766752, -9003.632255150242, -8882.037010058475, -8899.711164559956, -8957.612484430603, -8916.378110612406, -8841.980689143511, -8899.711164559956, -9008.497150793028, -8945.53574265254, -8921.478756117105, -8896.83512298153, -8903.108197599877, -8929.351346803516, -8880.08891469026, -8987.55658932177, -8921.81482367714, -8978.515170293447, -8885.322273119331, -8911.46351425718, -8944.716083708232, -8959.682408795197, -8883.05698917871, -8944.877874439333, -8936.721945689345, -8926.545879836951, -8896.634335661105, -8875.263761329721, -8850.140133103665, -8901.173351871355, -8968.548668396683, -8949.266295967176, -8923.787237849454, -8945.90234785922, -8911.020553319246, -8888.61122104573, -8988.714318125938, -8869.896766306152, -8921.29845579144, -8885.134067175082, -8902.293894502995, -8836.863764607675, -8838.560045561908, -8941.830307912205, -8899.711164559956, -8899.711164559956, -8892.629286006326, -8928.379461159047, -8996.15776876015, -8856.698032727956, -8879.706364882837, -8939.096236386886, -8921.787059349352, -8935.610481918733, -8953.960872106121, -8930.321022008251, -8899.711164559956, -8928.676233803611, -8896.760659244415, -8907.603539949092, -8827.150455368672, -8926.00694087174, -8965.905019405493, -8945.018075954626, -8933.197486769855, -8950.110561465774, -8924.838695545377, -8896.87769425596, -8939.959546670378, -8975.054061906023, -8875.092070877165, -8890.278975419353, -8913.278003799973, -8907.841541551557, -8899.711164559956, -8906.922991867526, -8924.356207908566, -8948.49535704537, -8945.221056756416, -8968.19527252281, -8867.812123691156, -8968.94830328423, -8894.646539796293, -8916.113786121698, -8911.388711531734, -8926.36708093509, -8919.966526945997, -8899.711164559956, -8873.484313910787, -8955.67301269914], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.691396964809286, "mean_inference_ms": 0.3325916314387532, "mean_action_processing_ms": 0.08197331422320861, "mean_env_wait_ms": 0.8250717902270867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023283958435058594, "StateBufferConnector_ms": 0.0016548633575439453, "ViewRequirementAgentConnector_ms": 0.04388737678527832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280920, "num_agent_steps_trained": 280920, "num_env_steps_sampled": 280920, "num_env_steps_trained": 280920, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.59297184027085, "num_env_steps_trained_throughput_per_sec": 190.59297184027085, "timesteps_total": 280920, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 280920, "timers": {"training_iteration_time_ms": 1891.118, "sample_time_ms": 1884.195, "load_time_ms": 0.216, "load_throughput": 1669374.726, "learn_time_ms": 6.144, "learn_throughput": 58593.304, "synch_weights_time_ms": 0.53}, "counters": {"num_env_steps_sampled": 280920, "num_env_steps_trained": 280920, "num_agent_steps_sampled": 280920, "num_agent_steps_trained": 280920}, "done": false, "episodes_total": 1261, "training_iteration": 259, "trial_id": "0d7ea_00000", "date": "2023-08-04_10-03-02", "timestamp": 1691132582, "time_this_iter_s": 11.335172176361084, "time_total_s": 2966.6088268756866, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1236.778100013733, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 22.35, "ram_util_percent": 65.7125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.0082275390625, "policy_loss": -2866738662.475, "vf_loss": 133662930.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2263.0, "diff_num_grad_updates_vs_sampler_policy": 2262.0}}, "num_env_steps_sampled": 283080, "num_env_steps_trained": 283080, "num_agent_steps_sampled": 283080, "num_agent_steps_trained": 283080}, "sampler_results": {"episode_reward_max": -8827.150455368672, "episode_reward_min": -9017.704457507014, "episode_reward_mean": -8918.92557232253, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8877.418929787571, -8919.24202497797, -8885.04730585097, -9017.704457507014, -8943.205447766752, -9003.632255150242, -8882.037010058475, -8899.711164559956, -8957.612484430603, -8916.378110612406, -8841.980689143511, -8899.711164559956, -9008.497150793028, -8945.53574265254, -8921.478756117105, -8896.83512298153, -8903.108197599877, -8929.351346803516, -8880.08891469026, -8987.55658932177, -8921.81482367714, -8978.515170293447, -8885.322273119331, -8911.46351425718, -8944.716083708232, -8959.682408795197, -8883.05698917871, -8944.877874439333, -8936.721945689345, -8926.545879836951, -8896.634335661105, -8875.263761329721, -8850.140133103665, -8901.173351871355, -8968.548668396683, -8949.266295967176, -8923.787237849454, -8945.90234785922, -8911.020553319246, -8888.61122104573, -8988.714318125938, -8869.896766306152, -8921.29845579144, -8885.134067175082, -8902.293894502995, -8836.863764607675, -8838.560045561908, -8941.830307912205, -8899.711164559956, -8899.711164559956, -8892.629286006326, -8928.379461159047, -8996.15776876015, -8856.698032727956, -8879.706364882837, -8939.096236386886, -8921.787059349352, -8935.610481918733, -8953.960872106121, -8930.321022008251, -8899.711164559956, -8928.676233803611, -8896.760659244415, -8907.603539949092, -8827.150455368672, -8926.00694087174, -8965.905019405493, -8945.018075954626, -8933.197486769855, -8950.110561465774, -8924.838695545377, -8896.87769425596, -8939.959546670378, -8975.054061906023, -8875.092070877165, -8890.278975419353, -8913.278003799973, -8907.841541551557, -8899.711164559956, -8906.922991867526, -8924.356207908566, -8948.49535704537, -8945.221056756416, -8968.19527252281, -8867.812123691156, -8968.94830328423, -8894.646539796293, -8916.113786121698, -8911.388711531734, -8926.36708093509, -8919.966526945997, -8899.711164559956, -8873.484313910787, -8955.67301269914, -8929.312162706985, -8896.04926388056, -8858.383102382395, -9005.097387706863, -8855.940530674105, -8979.842174174102], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.657001976783715, "mean_inference_ms": 0.33115925296673815, "mean_action_processing_ms": 0.08160798981320423, "mean_env_wait_ms": 0.8213423570143186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002335071563720703, "StateBufferConnector_ms": 0.0016601085662841797, "ViewRequirementAgentConnector_ms": 0.04394888877868652}}, "episode_reward_max": -8827.150455368672, "episode_reward_min": -9017.704457507014, "episode_reward_mean": -8918.92557232253, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8877.418929787571, -8919.24202497797, -8885.04730585097, -9017.704457507014, -8943.205447766752, -9003.632255150242, -8882.037010058475, -8899.711164559956, -8957.612484430603, -8916.378110612406, -8841.980689143511, -8899.711164559956, -9008.497150793028, -8945.53574265254, -8921.478756117105, -8896.83512298153, -8903.108197599877, -8929.351346803516, -8880.08891469026, -8987.55658932177, -8921.81482367714, -8978.515170293447, -8885.322273119331, -8911.46351425718, -8944.716083708232, -8959.682408795197, -8883.05698917871, -8944.877874439333, -8936.721945689345, -8926.545879836951, -8896.634335661105, -8875.263761329721, -8850.140133103665, -8901.173351871355, -8968.548668396683, -8949.266295967176, -8923.787237849454, -8945.90234785922, -8911.020553319246, -8888.61122104573, -8988.714318125938, -8869.896766306152, -8921.29845579144, -8885.134067175082, -8902.293894502995, -8836.863764607675, -8838.560045561908, -8941.830307912205, -8899.711164559956, -8899.711164559956, -8892.629286006326, -8928.379461159047, -8996.15776876015, -8856.698032727956, -8879.706364882837, -8939.096236386886, -8921.787059349352, -8935.610481918733, -8953.960872106121, -8930.321022008251, -8899.711164559956, -8928.676233803611, -8896.760659244415, -8907.603539949092, -8827.150455368672, -8926.00694087174, -8965.905019405493, -8945.018075954626, -8933.197486769855, -8950.110561465774, -8924.838695545377, -8896.87769425596, -8939.959546670378, -8975.054061906023, -8875.092070877165, -8890.278975419353, -8913.278003799973, -8907.841541551557, -8899.711164559956, -8906.922991867526, -8924.356207908566, -8948.49535704537, -8945.221056756416, -8968.19527252281, -8867.812123691156, -8968.94830328423, -8894.646539796293, -8916.113786121698, -8911.388711531734, -8926.36708093509, -8919.966526945997, -8899.711164559956, -8873.484313910787, -8955.67301269914, -8929.312162706985, -8896.04926388056, -8858.383102382395, -9005.097387706863, -8855.940530674105, -8979.842174174102], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.657001976783715, "mean_inference_ms": 0.33115925296673815, "mean_action_processing_ms": 0.08160798981320423, "mean_env_wait_ms": 0.8213423570143186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002335071563720703, "StateBufferConnector_ms": 0.0016601085662841797, "ViewRequirementAgentConnector_ms": 0.04394888877868652}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 283080, "num_agent_steps_trained": 283080, "num_env_steps_sampled": 283080, "num_env_steps_trained": 283080, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 185.20682765549435, "num_env_steps_trained_throughput_per_sec": 185.20682765549435, "timesteps_total": 283080, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 283080, "timers": {"training_iteration_time_ms": 1922.188, "sample_time_ms": 1915.178, "load_time_ms": 0.233, "load_throughput": 1545495.844, "learn_time_ms": 6.206, "learn_throughput": 58012.726, "synch_weights_time_ms": 0.538}, "counters": {"num_env_steps_sampled": 283080, "num_env_steps_trained": 283080, "num_agent_steps_sampled": 283080, "num_agent_steps_trained": 283080}, "done": false, "episodes_total": 1267, "training_iteration": 260, "trial_id": "0d7ea_00000", "date": "2023-08-04_10-03-13", "timestamp": 1691132593, "time_this_iter_s": 11.664873123168945, "time_total_s": 2978.2736999988556, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1248.4429731369019, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 26.458823529411767, "ram_util_percent": 65.72941176470589}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -655.9631225585938, "policy_loss": -4004431346.225, "vf_loss": 133872262.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2293.0, "diff_num_grad_updates_vs_sampler_policy": 2292.0}}, "num_env_steps_sampled": 285240, "num_env_steps_trained": 285240, "num_agent_steps_sampled": 285240, "num_agent_steps_trained": 285240}, "sampler_results": {"episode_reward_max": -8827.150455368672, "episode_reward_min": -9008.497150793028, "episode_reward_mean": -8918.909457311156, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8882.037010058475, -8899.711164559956, -8957.612484430603, -8916.378110612406, -8841.980689143511, -8899.711164559956, -9008.497150793028, -8945.53574265254, -8921.478756117105, -8896.83512298153, -8903.108197599877, -8929.351346803516, -8880.08891469026, -8987.55658932177, -8921.81482367714, -8978.515170293447, -8885.322273119331, -8911.46351425718, -8944.716083708232, -8959.682408795197, -8883.05698917871, -8944.877874439333, -8936.721945689345, -8926.545879836951, -8896.634335661105, -8875.263761329721, -8850.140133103665, -8901.173351871355, -8968.548668396683, -8949.266295967176, -8923.787237849454, -8945.90234785922, -8911.020553319246, -8888.61122104573, -8988.714318125938, -8869.896766306152, -8921.29845579144, -8885.134067175082, -8902.293894502995, -8836.863764607675, -8838.560045561908, -8941.830307912205, -8899.711164559956, -8899.711164559956, -8892.629286006326, -8928.379461159047, -8996.15776876015, -8856.698032727956, -8879.706364882837, -8939.096236386886, -8921.787059349352, -8935.610481918733, -8953.960872106121, -8930.321022008251, -8899.711164559956, -8928.676233803611, -8896.760659244415, -8907.603539949092, -8827.150455368672, -8926.00694087174, -8965.905019405493, -8945.018075954626, -8933.197486769855, -8950.110561465774, -8924.838695545377, -8896.87769425596, -8939.959546670378, -8975.054061906023, -8875.092070877165, -8890.278975419353, -8913.278003799973, -8907.841541551557, -8899.711164559956, -8906.922991867526, -8924.356207908566, -8948.49535704537, -8945.221056756416, -8968.19527252281, -8867.812123691156, -8968.94830328423, -8894.646539796293, -8916.113786121698, -8911.388711531734, -8926.36708093509, -8919.966526945997, -8899.711164559956, -8873.484313910787, -8955.67301269914, -8929.312162706985, -8896.04926388056, -8858.383102382395, -9005.097387706863, -8855.940530674105, -8979.842174174102, -8968.180492554295, -8910.39060727401, -9004.922497347727, -8869.906475529464, -8899.711164559956, -8991.52768263775], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.623710015243335, "mean_inference_ms": 0.32978334650155233, "mean_action_processing_ms": 0.08125579879021667, "mean_env_wait_ms": 0.8177568348644576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002343893051147461, "StateBufferConnector_ms": 0.0016658306121826172, "ViewRequirementAgentConnector_ms": 0.0441737174987793}}, "episode_reward_max": -8827.150455368672, "episode_reward_min": -9008.497150793028, "episode_reward_mean": -8918.909457311156, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8882.037010058475, -8899.711164559956, -8957.612484430603, -8916.378110612406, -8841.980689143511, -8899.711164559956, -9008.497150793028, -8945.53574265254, -8921.478756117105, -8896.83512298153, -8903.108197599877, -8929.351346803516, -8880.08891469026, -8987.55658932177, -8921.81482367714, -8978.515170293447, -8885.322273119331, -8911.46351425718, -8944.716083708232, -8959.682408795197, -8883.05698917871, -8944.877874439333, -8936.721945689345, -8926.545879836951, -8896.634335661105, -8875.263761329721, -8850.140133103665, -8901.173351871355, -8968.548668396683, -8949.266295967176, -8923.787237849454, -8945.90234785922, -8911.020553319246, -8888.61122104573, -8988.714318125938, -8869.896766306152, -8921.29845579144, -8885.134067175082, -8902.293894502995, -8836.863764607675, -8838.560045561908, -8941.830307912205, -8899.711164559956, -8899.711164559956, -8892.629286006326, -8928.379461159047, -8996.15776876015, -8856.698032727956, -8879.706364882837, -8939.096236386886, -8921.787059349352, -8935.610481918733, -8953.960872106121, -8930.321022008251, -8899.711164559956, -8928.676233803611, -8896.760659244415, -8907.603539949092, -8827.150455368672, -8926.00694087174, -8965.905019405493, -8945.018075954626, -8933.197486769855, -8950.110561465774, -8924.838695545377, -8896.87769425596, -8939.959546670378, -8975.054061906023, -8875.092070877165, -8890.278975419353, -8913.278003799973, -8907.841541551557, -8899.711164559956, -8906.922991867526, -8924.356207908566, -8948.49535704537, -8945.221056756416, -8968.19527252281, -8867.812123691156, -8968.94830328423, -8894.646539796293, -8916.113786121698, -8911.388711531734, -8926.36708093509, -8919.966526945997, -8899.711164559956, -8873.484313910787, -8955.67301269914, -8929.312162706985, -8896.04926388056, -8858.383102382395, -9005.097387706863, -8855.940530674105, -8979.842174174102, -8968.180492554295, -8910.39060727401, -9004.922497347727, -8869.906475529464, -8899.711164559956, -8991.52768263775], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.623710015243335, "mean_inference_ms": 0.32978334650155233, "mean_action_processing_ms": 0.08125579879021667, "mean_env_wait_ms": 0.8177568348644576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002343893051147461, "StateBufferConnector_ms": 0.0016658306121826172, "ViewRequirementAgentConnector_ms": 0.0441737174987793}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 285240, "num_agent_steps_trained": 285240, "num_env_steps_sampled": 285240, "num_env_steps_trained": 285240, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 184.68477798699, "num_env_steps_trained_throughput_per_sec": 184.68477798699, "timesteps_total": 285240, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 285240, "timers": {"training_iteration_time_ms": 1950.015, "sample_time_ms": 1943.051, "load_time_ms": 0.223, "load_throughput": 1615610.357, "learn_time_ms": 6.186, "learn_throughput": 58194.501, "synch_weights_time_ms": 0.521}, "counters": {"num_env_steps_sampled": 285240, "num_env_steps_trained": 285240, "num_agent_steps_sampled": 285240, "num_agent_steps_trained": 285240}, "done": false, "episodes_total": 1273, "training_iteration": 261, "trial_id": "0d7ea_00000", "date": "2023-08-04_10-03-25", "timestamp": 1691132605, "time_this_iter_s": 11.697927236557007, "time_total_s": 2989.9716272354126, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1260.1409003734589, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 30.38235294117647, "ram_util_percent": 65.78235294117648}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.1245727539062, "policy_loss": -1373281337.525, "vf_loss": 131309472.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2323.0, "diff_num_grad_updates_vs_sampler_policy": 2322.0}}, "num_env_steps_sampled": 287400, "num_env_steps_trained": 287400, "num_agent_steps_sampled": 287400, "num_agent_steps_trained": 287400}, "sampler_results": {"episode_reward_max": -8827.150455368672, "episode_reward_min": -9008.497150793028, "episode_reward_mean": -8921.242644797383, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9008.497150793028, -8945.53574265254, -8921.478756117105, -8896.83512298153, -8903.108197599877, -8929.351346803516, -8880.08891469026, -8987.55658932177, -8921.81482367714, -8978.515170293447, -8885.322273119331, -8911.46351425718, -8944.716083708232, -8959.682408795197, -8883.05698917871, -8944.877874439333, -8936.721945689345, -8926.545879836951, -8896.634335661105, -8875.263761329721, -8850.140133103665, -8901.173351871355, -8968.548668396683, -8949.266295967176, -8923.787237849454, -8945.90234785922, -8911.020553319246, -8888.61122104573, -8988.714318125938, -8869.896766306152, -8921.29845579144, -8885.134067175082, -8902.293894502995, -8836.863764607675, -8838.560045561908, -8941.830307912205, -8899.711164559956, -8899.711164559956, -8892.629286006326, -8928.379461159047, -8996.15776876015, -8856.698032727956, -8879.706364882837, -8939.096236386886, -8921.787059349352, -8935.610481918733, -8953.960872106121, -8930.321022008251, -8899.711164559956, -8928.676233803611, -8896.760659244415, -8907.603539949092, -8827.150455368672, -8926.00694087174, -8965.905019405493, -8945.018075954626, -8933.197486769855, -8950.110561465774, -8924.838695545377, -8896.87769425596, -8939.959546670378, -8975.054061906023, -8875.092070877165, -8890.278975419353, -8913.278003799973, -8907.841541551557, -8899.711164559956, -8906.922991867526, -8924.356207908566, -8948.49535704537, -8945.221056756416, -8968.19527252281, -8867.812123691156, -8968.94830328423, -8894.646539796293, -8916.113786121698, -8911.388711531734, -8926.36708093509, -8919.966526945997, -8899.711164559956, -8873.484313910787, -8955.67301269914, -8929.312162706985, -8896.04926388056, -8858.383102382395, -9005.097387706863, -8855.940530674105, -8979.842174174102, -8968.180492554295, -8910.39060727401, -9004.922497347727, -8869.906475529464, -8899.711164559956, -8991.52768263775, -8969.726833533214, -8909.99839579573, -9008.495243265821, -8939.253505541836, -8882.747220282696, -8920.528173568197], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.591382249213023, "mean_inference_ms": 0.32844739640514853, "mean_action_processing_ms": 0.08091396701357632, "mean_env_wait_ms": 0.8142792022728783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00234222412109375, "StateBufferConnector_ms": 0.001661539077758789, "ViewRequirementAgentConnector_ms": 0.0440976619720459}}, "episode_reward_max": -8827.150455368672, "episode_reward_min": -9008.497150793028, "episode_reward_mean": -8921.242644797383, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-9008.497150793028, -8945.53574265254, -8921.478756117105, -8896.83512298153, -8903.108197599877, -8929.351346803516, -8880.08891469026, -8987.55658932177, -8921.81482367714, -8978.515170293447, -8885.322273119331, -8911.46351425718, -8944.716083708232, -8959.682408795197, -8883.05698917871, -8944.877874439333, -8936.721945689345, -8926.545879836951, -8896.634335661105, -8875.263761329721, -8850.140133103665, -8901.173351871355, -8968.548668396683, -8949.266295967176, -8923.787237849454, -8945.90234785922, -8911.020553319246, -8888.61122104573, -8988.714318125938, -8869.896766306152, -8921.29845579144, -8885.134067175082, -8902.293894502995, -8836.863764607675, -8838.560045561908, -8941.830307912205, -8899.711164559956, -8899.711164559956, -8892.629286006326, -8928.379461159047, -8996.15776876015, -8856.698032727956, -8879.706364882837, -8939.096236386886, -8921.787059349352, -8935.610481918733, -8953.960872106121, -8930.321022008251, -8899.711164559956, -8928.676233803611, -8896.760659244415, -8907.603539949092, -8827.150455368672, -8926.00694087174, -8965.905019405493, -8945.018075954626, -8933.197486769855, -8950.110561465774, -8924.838695545377, -8896.87769425596, -8939.959546670378, -8975.054061906023, -8875.092070877165, -8890.278975419353, -8913.278003799973, -8907.841541551557, -8899.711164559956, -8906.922991867526, -8924.356207908566, -8948.49535704537, -8945.221056756416, -8968.19527252281, -8867.812123691156, -8968.94830328423, -8894.646539796293, -8916.113786121698, -8911.388711531734, -8926.36708093509, -8919.966526945997, -8899.711164559956, -8873.484313910787, -8955.67301269914, -8929.312162706985, -8896.04926388056, -8858.383102382395, -9005.097387706863, -8855.940530674105, -8979.842174174102, -8968.180492554295, -8910.39060727401, -9004.922497347727, -8869.906475529464, -8899.711164559956, -8991.52768263775, -8969.726833533214, -8909.99839579573, -9008.495243265821, -8939.253505541836, -8882.747220282696, -8920.528173568197], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.591382249213023, "mean_inference_ms": 0.32844739640514853, "mean_action_processing_ms": 0.08091396701357632, "mean_env_wait_ms": 0.8142792022728783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00234222412109375, "StateBufferConnector_ms": 0.001661539077758789, "ViewRequirementAgentConnector_ms": 0.0440976619720459}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 287400, "num_agent_steps_trained": 287400, "num_env_steps_sampled": 287400, "num_env_steps_trained": 287400, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.05918255116046, "num_env_steps_trained_throughput_per_sec": 190.05918255116046, "timesteps_total": 287400, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 287400, "timers": {"training_iteration_time_ms": 1919.676, "sample_time_ms": 1912.61, "load_time_ms": 0.223, "load_throughput": 1611988.299, "learn_time_ms": 6.277, "learn_throughput": 57353.646, "synch_weights_time_ms": 0.531}, "counters": {"num_env_steps_sampled": 287400, "num_env_steps_trained": 287400, "num_agent_steps_sampled": 287400, "num_agent_steps_trained": 287400}, "done": false, "episodes_total": 1279, "training_iteration": 262, "trial_id": "0d7ea_00000", "date": "2023-08-04_10-03-36", "timestamp": 1691132616, "time_this_iter_s": 11.367080926895142, "time_total_s": 3001.3387081623077, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1271.507981300354, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 25.299999999999997, "ram_util_percent": 65.69999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.0086669921875, "policy_loss": -1464292622.175, "vf_loss": 134699420.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2353.0, "diff_num_grad_updates_vs_sampler_policy": 2352.0}}, "num_env_steps_sampled": 289560, "num_env_steps_trained": 289560, "num_agent_steps_sampled": 289560, "num_agent_steps_trained": 289560}, "sampler_results": {"episode_reward_max": -8827.150455368672, "episode_reward_min": -9080.66249314025, "episode_reward_mean": -8922.478941202797, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8880.08891469026, -8987.55658932177, -8921.81482367714, -8978.515170293447, -8885.322273119331, -8911.46351425718, -8944.716083708232, -8959.682408795197, -8883.05698917871, -8944.877874439333, -8936.721945689345, -8926.545879836951, -8896.634335661105, -8875.263761329721, -8850.140133103665, -8901.173351871355, -8968.548668396683, -8949.266295967176, -8923.787237849454, -8945.90234785922, -8911.020553319246, -8888.61122104573, -8988.714318125938, -8869.896766306152, -8921.29845579144, -8885.134067175082, -8902.293894502995, -8836.863764607675, -8838.560045561908, -8941.830307912205, -8899.711164559956, -8899.711164559956, -8892.629286006326, -8928.379461159047, -8996.15776876015, -8856.698032727956, -8879.706364882837, -8939.096236386886, -8921.787059349352, -8935.610481918733, -8953.960872106121, -8930.321022008251, -8899.711164559956, -8928.676233803611, -8896.760659244415, -8907.603539949092, -8827.150455368672, -8926.00694087174, -8965.905019405493, -8945.018075954626, -8933.197486769855, -8950.110561465774, -8924.838695545377, -8896.87769425596, -8939.959546670378, -8975.054061906023, -8875.092070877165, -8890.278975419353, -8913.278003799973, -8907.841541551557, -8899.711164559956, -8906.922991867526, -8924.356207908566, -8948.49535704537, -8945.221056756416, -8968.19527252281, -8867.812123691156, -8968.94830328423, -8894.646539796293, -8916.113786121698, -8911.388711531734, -8926.36708093509, -8919.966526945997, -8899.711164559956, -8873.484313910787, -8955.67301269914, -8929.312162706985, -8896.04926388056, -8858.383102382395, -9005.097387706863, -8855.940530674105, -8979.842174174102, -8968.180492554295, -8910.39060727401, -9004.922497347727, -8869.906475529464, -8899.711164559956, -8991.52768263775, -8969.726833533214, -8909.99839579573, -9008.495243265821, -8939.253505541836, -8882.747220282696, -8920.528173568197, -9080.66249314025, -8888.727227427036, -8898.957788567648, -8928.214585909913, -8911.02439282851, -9020.849469615638], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.559974782804475, "mean_inference_ms": 0.32714578009984435, "mean_action_processing_ms": 0.08058123668593592, "mean_env_wait_ms": 0.8108989130876335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023488998413085938, "StateBufferConnector_ms": 0.0016639232635498047, "ViewRequirementAgentConnector_ms": 0.04404950141906738}}, "episode_reward_max": -8827.150455368672, "episode_reward_min": -9080.66249314025, "episode_reward_mean": -8922.478941202797, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8880.08891469026, -8987.55658932177, -8921.81482367714, -8978.515170293447, -8885.322273119331, -8911.46351425718, -8944.716083708232, -8959.682408795197, -8883.05698917871, -8944.877874439333, -8936.721945689345, -8926.545879836951, -8896.634335661105, -8875.263761329721, -8850.140133103665, -8901.173351871355, -8968.548668396683, -8949.266295967176, -8923.787237849454, -8945.90234785922, -8911.020553319246, -8888.61122104573, -8988.714318125938, -8869.896766306152, -8921.29845579144, -8885.134067175082, -8902.293894502995, -8836.863764607675, -8838.560045561908, -8941.830307912205, -8899.711164559956, -8899.711164559956, -8892.629286006326, -8928.379461159047, -8996.15776876015, -8856.698032727956, -8879.706364882837, -8939.096236386886, -8921.787059349352, -8935.610481918733, -8953.960872106121, -8930.321022008251, -8899.711164559956, -8928.676233803611, -8896.760659244415, -8907.603539949092, -8827.150455368672, -8926.00694087174, -8965.905019405493, -8945.018075954626, -8933.197486769855, -8950.110561465774, -8924.838695545377, -8896.87769425596, -8939.959546670378, -8975.054061906023, -8875.092070877165, -8890.278975419353, -8913.278003799973, -8907.841541551557, -8899.711164559956, -8906.922991867526, -8924.356207908566, -8948.49535704537, -8945.221056756416, -8968.19527252281, -8867.812123691156, -8968.94830328423, -8894.646539796293, -8916.113786121698, -8911.388711531734, -8926.36708093509, -8919.966526945997, -8899.711164559956, -8873.484313910787, -8955.67301269914, -8929.312162706985, -8896.04926388056, -8858.383102382395, -9005.097387706863, -8855.940530674105, -8979.842174174102, -8968.180492554295, -8910.39060727401, -9004.922497347727, -8869.906475529464, -8899.711164559956, -8991.52768263775, -8969.726833533214, -8909.99839579573, -9008.495243265821, -8939.253505541836, -8882.747220282696, -8920.528173568197, -9080.66249314025, -8888.727227427036, -8898.957788567648, -8928.214585909913, -8911.02439282851, -9020.849469615638], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.559974782804475, "mean_inference_ms": 0.32714578009984435, "mean_action_processing_ms": 0.08058123668593592, "mean_env_wait_ms": 0.8108989130876335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023488998413085938, "StateBufferConnector_ms": 0.0016639232635498047, "ViewRequirementAgentConnector_ms": 0.04404950141906738}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 289560, "num_agent_steps_trained": 289560, "num_env_steps_sampled": 289560, "num_env_steps_trained": 289560, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.38158433168456, "num_env_steps_trained_throughput_per_sec": 190.38158433168456, "timesteps_total": 289560, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 289560, "timers": {"training_iteration_time_ms": 1894.216, "sample_time_ms": 1887.264, "load_time_ms": 0.22, "load_throughput": 1638755.633, "learn_time_ms": 6.197, "learn_throughput": 58089.277, "synch_weights_time_ms": 0.502}, "counters": {"num_env_steps_sampled": 289560, "num_env_steps_trained": 289560, "num_agent_steps_sampled": 289560, "num_agent_steps_trained": 289560}, "done": false, "episodes_total": 1285, "training_iteration": 263, "trial_id": "0d7ea_00000", "date": "2023-08-04_10-03-48", "timestamp": 1691132628, "time_this_iter_s": 11.347585678100586, "time_total_s": 3012.6862938404083, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1282.8555669784546, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 26.04375, "ram_util_percent": 65.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.0578002929688, "policy_loss": -3644622750.55, "vf_loss": 132085355.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2383.0, "diff_num_grad_updates_vs_sampler_policy": 2382.0}}, "num_env_steps_sampled": 291720, "num_env_steps_trained": 291720, "num_agent_steps_sampled": 291720, "num_agent_steps_trained": 291720}, "sampler_results": {"episode_reward_max": -8827.150455368672, "episode_reward_min": -9080.66249314025, "episode_reward_mean": -8921.754661890724, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8944.716083708232, -8959.682408795197, -8883.05698917871, -8944.877874439333, -8936.721945689345, -8926.545879836951, -8896.634335661105, -8875.263761329721, -8850.140133103665, -8901.173351871355, -8968.548668396683, -8949.266295967176, -8923.787237849454, -8945.90234785922, -8911.020553319246, -8888.61122104573, -8988.714318125938, -8869.896766306152, -8921.29845579144, -8885.134067175082, -8902.293894502995, -8836.863764607675, -8838.560045561908, -8941.830307912205, -8899.711164559956, -8899.711164559956, -8892.629286006326, -8928.379461159047, -8996.15776876015, -8856.698032727956, -8879.706364882837, -8939.096236386886, -8921.787059349352, -8935.610481918733, -8953.960872106121, -8930.321022008251, -8899.711164559956, -8928.676233803611, -8896.760659244415, -8907.603539949092, -8827.150455368672, -8926.00694087174, -8965.905019405493, -8945.018075954626, -8933.197486769855, -8950.110561465774, -8924.838695545377, -8896.87769425596, -8939.959546670378, -8975.054061906023, -8875.092070877165, -8890.278975419353, -8913.278003799973, -8907.841541551557, -8899.711164559956, -8906.922991867526, -8924.356207908566, -8948.49535704537, -8945.221056756416, -8968.19527252281, -8867.812123691156, -8968.94830328423, -8894.646539796293, -8916.113786121698, -8911.388711531734, -8926.36708093509, -8919.966526945997, -8899.711164559956, -8873.484313910787, -8955.67301269914, -8929.312162706985, -8896.04926388056, -8858.383102382395, -9005.097387706863, -8855.940530674105, -8979.842174174102, -8968.180492554295, -8910.39060727401, -9004.922497347727, -8869.906475529464, -8899.711164559956, -8991.52768263775, -8969.726833533214, -8909.99839579573, -9008.495243265821, -8939.253505541836, -8882.747220282696, -8920.528173568197, -9080.66249314025, -8888.727227427036, -8898.957788567648, -8928.214585909913, -8911.02439282851, -9020.849469615638, -8954.647926073645, -8967.416371860341, -8878.239794066096, -8882.57475979492, -8884.139073238932, -8925.31542911795], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.5294660454684434, "mean_inference_ms": 0.32588092512571243, "mean_action_processing_ms": 0.08025805642308664, "mean_env_wait_ms": 0.8076194717691284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023555755615234375, "StateBufferConnector_ms": 0.0016674995422363281, "ViewRequirementAgentConnector_ms": 0.04406857490539551}}, "episode_reward_max": -8827.150455368672, "episode_reward_min": -9080.66249314025, "episode_reward_mean": -8921.754661890724, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8944.716083708232, -8959.682408795197, -8883.05698917871, -8944.877874439333, -8936.721945689345, -8926.545879836951, -8896.634335661105, -8875.263761329721, -8850.140133103665, -8901.173351871355, -8968.548668396683, -8949.266295967176, -8923.787237849454, -8945.90234785922, -8911.020553319246, -8888.61122104573, -8988.714318125938, -8869.896766306152, -8921.29845579144, -8885.134067175082, -8902.293894502995, -8836.863764607675, -8838.560045561908, -8941.830307912205, -8899.711164559956, -8899.711164559956, -8892.629286006326, -8928.379461159047, -8996.15776876015, -8856.698032727956, -8879.706364882837, -8939.096236386886, -8921.787059349352, -8935.610481918733, -8953.960872106121, -8930.321022008251, -8899.711164559956, -8928.676233803611, -8896.760659244415, -8907.603539949092, -8827.150455368672, -8926.00694087174, -8965.905019405493, -8945.018075954626, -8933.197486769855, -8950.110561465774, -8924.838695545377, -8896.87769425596, -8939.959546670378, -8975.054061906023, -8875.092070877165, -8890.278975419353, -8913.278003799973, -8907.841541551557, -8899.711164559956, -8906.922991867526, -8924.356207908566, -8948.49535704537, -8945.221056756416, -8968.19527252281, -8867.812123691156, -8968.94830328423, -8894.646539796293, -8916.113786121698, -8911.388711531734, -8926.36708093509, -8919.966526945997, -8899.711164559956, -8873.484313910787, -8955.67301269914, -8929.312162706985, -8896.04926388056, -8858.383102382395, -9005.097387706863, -8855.940530674105, -8979.842174174102, -8968.180492554295, -8910.39060727401, -9004.922497347727, -8869.906475529464, -8899.711164559956, -8991.52768263775, -8969.726833533214, -8909.99839579573, -9008.495243265821, -8939.253505541836, -8882.747220282696, -8920.528173568197, -9080.66249314025, -8888.727227427036, -8898.957788567648, -8928.214585909913, -8911.02439282851, -9020.849469615638, -8954.647926073645, -8967.416371860341, -8878.239794066096, -8882.57475979492, -8884.139073238932, -8925.31542911795], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.5294660454684434, "mean_inference_ms": 0.32588092512571243, "mean_action_processing_ms": 0.08025805642308664, "mean_env_wait_ms": 0.8076194717691284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023555755615234375, "StateBufferConnector_ms": 0.0016674995422363281, "ViewRequirementAgentConnector_ms": 0.04406857490539551}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 291720, "num_agent_steps_trained": 291720, "num_env_steps_sampled": 291720, "num_env_steps_trained": 291720, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 190.57968097197377, "num_env_steps_trained_throughput_per_sec": 190.57968097197377, "timesteps_total": 291720, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 291720, "timers": {"training_iteration_time_ms": 1893.354, "sample_time_ms": 1886.378, "load_time_ms": 0.221, "load_throughput": 1631848.525, "learn_time_ms": 6.215, "learn_throughput": 57926.153, "synch_weights_time_ms": 0.508}, "counters": {"num_env_steps_sampled": 291720, "num_env_steps_trained": 291720, "num_agent_steps_sampled": 291720, "num_agent_steps_trained": 291720}, "done": false, "episodes_total": 1291, "training_iteration": 264, "trial_id": "0d7ea_00000", "date": "2023-08-04_10-03-59", "timestamp": 1691132639, "time_this_iter_s": 11.33589506149292, "time_total_s": 3024.0221889019012, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1294.1914620399475, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 25.5625, "ram_util_percent": 65.8125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -655.8547729492187, "policy_loss": -5026684595.425, "vf_loss": 134810822.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2413.0, "diff_num_grad_updates_vs_sampler_policy": 2412.0}}, "num_env_steps_sampled": 293880, "num_env_steps_trained": 293880, "num_agent_steps_sampled": 293880, "num_agent_steps_trained": 293880}, "sampler_results": {"episode_reward_max": -8827.150455368672, "episode_reward_min": -9080.66249314025, "episode_reward_mean": -8921.7281937745, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8896.634335661105, -8875.263761329721, -8850.140133103665, -8901.173351871355, -8968.548668396683, -8949.266295967176, -8923.787237849454, -8945.90234785922, -8911.020553319246, -8888.61122104573, -8988.714318125938, -8869.896766306152, -8921.29845579144, -8885.134067175082, -8902.293894502995, -8836.863764607675, -8838.560045561908, -8941.830307912205, -8899.711164559956, -8899.711164559956, -8892.629286006326, -8928.379461159047, -8996.15776876015, -8856.698032727956, -8879.706364882837, -8939.096236386886, -8921.787059349352, -8935.610481918733, -8953.960872106121, -8930.321022008251, -8899.711164559956, -8928.676233803611, -8896.760659244415, -8907.603539949092, -8827.150455368672, -8926.00694087174, -8965.905019405493, -8945.018075954626, -8933.197486769855, -8950.110561465774, -8924.838695545377, -8896.87769425596, -8939.959546670378, -8975.054061906023, -8875.092070877165, -8890.278975419353, -8913.278003799973, -8907.841541551557, -8899.711164559956, -8906.922991867526, -8924.356207908566, -8948.49535704537, -8945.221056756416, -8968.19527252281, -8867.812123691156, -8968.94830328423, -8894.646539796293, -8916.113786121698, -8911.388711531734, -8926.36708093509, -8919.966526945997, -8899.711164559956, -8873.484313910787, -8955.67301269914, -8929.312162706985, -8896.04926388056, -8858.383102382395, -9005.097387706863, -8855.940530674105, -8979.842174174102, -8968.180492554295, -8910.39060727401, -9004.922497347727, -8869.906475529464, -8899.711164559956, -8991.52768263775, -8969.726833533214, -8909.99839579573, -9008.495243265821, -8939.253505541836, -8882.747220282696, -8920.528173568197, -9080.66249314025, -8888.727227427036, -8898.957788567648, -8928.214585909913, -8911.02439282851, -9020.849469615638, -8954.647926073645, -8967.416371860341, -8878.239794066096, -8882.57475979492, -8884.139073238932, -8925.31542911795, -8868.087486611574, -8979.837049251371, -8911.262849631034, -8907.190592358997, -8899.711164559956, -9026.865227612308], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.499831019743213, "mean_inference_ms": 0.32465170711949637, "mean_action_processing_ms": 0.07994401113893627, "mean_env_wait_ms": 0.8044287731840764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023458003997802734, "StateBufferConnector_ms": 0.0016660690307617188, "ViewRequirementAgentConnector_ms": 0.044023990631103516}}, "episode_reward_max": -8827.150455368672, "episode_reward_min": -9080.66249314025, "episode_reward_mean": -8921.7281937745, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8896.634335661105, -8875.263761329721, -8850.140133103665, -8901.173351871355, -8968.548668396683, -8949.266295967176, -8923.787237849454, -8945.90234785922, -8911.020553319246, -8888.61122104573, -8988.714318125938, -8869.896766306152, -8921.29845579144, -8885.134067175082, -8902.293894502995, -8836.863764607675, -8838.560045561908, -8941.830307912205, -8899.711164559956, -8899.711164559956, -8892.629286006326, -8928.379461159047, -8996.15776876015, -8856.698032727956, -8879.706364882837, -8939.096236386886, -8921.787059349352, -8935.610481918733, -8953.960872106121, -8930.321022008251, -8899.711164559956, -8928.676233803611, -8896.760659244415, -8907.603539949092, -8827.150455368672, -8926.00694087174, -8965.905019405493, -8945.018075954626, -8933.197486769855, -8950.110561465774, -8924.838695545377, -8896.87769425596, -8939.959546670378, -8975.054061906023, -8875.092070877165, -8890.278975419353, -8913.278003799973, -8907.841541551557, -8899.711164559956, -8906.922991867526, -8924.356207908566, -8948.49535704537, -8945.221056756416, -8968.19527252281, -8867.812123691156, -8968.94830328423, -8894.646539796293, -8916.113786121698, -8911.388711531734, -8926.36708093509, -8919.966526945997, -8899.711164559956, -8873.484313910787, -8955.67301269914, -8929.312162706985, -8896.04926388056, -8858.383102382395, -9005.097387706863, -8855.940530674105, -8979.842174174102, -8968.180492554295, -8910.39060727401, -9004.922497347727, -8869.906475529464, -8899.711164559956, -8991.52768263775, -8969.726833533214, -8909.99839579573, -9008.495243265821, -8939.253505541836, -8882.747220282696, -8920.528173568197, -9080.66249314025, -8888.727227427036, -8898.957788567648, -8928.214585909913, -8911.02439282851, -9020.849469615638, -8954.647926073645, -8967.416371860341, -8878.239794066096, -8882.57475979492, -8884.139073238932, -8925.31542911795, -8868.087486611574, -8979.837049251371, -8911.262849631034, -8907.190592358997, -8899.711164559956, -9026.865227612308], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.499831019743213, "mean_inference_ms": 0.32465170711949637, "mean_action_processing_ms": 0.07994401113893627, "mean_env_wait_ms": 0.8044287731840764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023458003997802734, "StateBufferConnector_ms": 0.0016660690307617188, "ViewRequirementAgentConnector_ms": 0.044023990631103516}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 293880, "num_agent_steps_trained": 293880, "num_env_steps_sampled": 293880, "num_env_steps_trained": 293880, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.97988305696592, "num_env_steps_trained_throughput_per_sec": 189.97988305696592, "timesteps_total": 293880, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 293880, "timers": {"training_iteration_time_ms": 1891.918, "sample_time_ms": 1884.903, "load_time_ms": 0.222, "load_throughput": 1621161.091, "learn_time_ms": 6.244, "learn_throughput": 57656.085, "synch_weights_time_ms": 0.516}, "counters": {"num_env_steps_sampled": 293880, "num_env_steps_trained": 293880, "num_agent_steps_sampled": 293880, "num_agent_steps_trained": 293880}, "done": false, "episodes_total": 1297, "training_iteration": 265, "trial_id": "0d7ea_00000", "date": "2023-08-04_10-04-11", "timestamp": 1691132651, "time_this_iter_s": 11.371615171432495, "time_total_s": 3035.3938040733337, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1305.56307721138, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 23.225, "ram_util_percent": 65.76875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -655.9972045898437, "policy_loss": -2515116483.9, "vf_loss": 133260477.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2443.0, "diff_num_grad_updates_vs_sampler_policy": 2442.0}}, "num_env_steps_sampled": 296040, "num_env_steps_trained": 296040, "num_agent_steps_sampled": 296040, "num_agent_steps_trained": 296040}, "sampler_results": {"episode_reward_max": -8827.150455368672, "episode_reward_min": -9080.66249314025, "episode_reward_mean": -8924.767108263206, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8923.787237849454, -8945.90234785922, -8911.020553319246, -8888.61122104573, -8988.714318125938, -8869.896766306152, -8921.29845579144, -8885.134067175082, -8902.293894502995, -8836.863764607675, -8838.560045561908, -8941.830307912205, -8899.711164559956, -8899.711164559956, -8892.629286006326, -8928.379461159047, -8996.15776876015, -8856.698032727956, -8879.706364882837, -8939.096236386886, -8921.787059349352, -8935.610481918733, -8953.960872106121, -8930.321022008251, -8899.711164559956, -8928.676233803611, -8896.760659244415, -8907.603539949092, -8827.150455368672, -8926.00694087174, -8965.905019405493, -8945.018075954626, -8933.197486769855, -8950.110561465774, -8924.838695545377, -8896.87769425596, -8939.959546670378, -8975.054061906023, -8875.092070877165, -8890.278975419353, -8913.278003799973, -8907.841541551557, -8899.711164559956, -8906.922991867526, -8924.356207908566, -8948.49535704537, -8945.221056756416, -8968.19527252281, -8867.812123691156, -8968.94830328423, -8894.646539796293, -8916.113786121698, -8911.388711531734, -8926.36708093509, -8919.966526945997, -8899.711164559956, -8873.484313910787, -8955.67301269914, -8929.312162706985, -8896.04926388056, -8858.383102382395, -9005.097387706863, -8855.940530674105, -8979.842174174102, -8968.180492554295, -8910.39060727401, -9004.922497347727, -8869.906475529464, -8899.711164559956, -8991.52768263775, -8969.726833533214, -8909.99839579573, -9008.495243265821, -8939.253505541836, -8882.747220282696, -8920.528173568197, -9080.66249314025, -8888.727227427036, -8898.957788567648, -8928.214585909913, -8911.02439282851, -9020.849469615638, -8954.647926073645, -8967.416371860341, -8878.239794066096, -8882.57475979492, -8884.139073238932, -8925.31542911795, -8868.087486611574, -8979.837049251371, -8911.262849631034, -8907.190592358997, -8899.711164559956, -9026.865227612308, -8881.76989063163, -8895.837882659334, -8979.629267831948, -8983.048277296926, -9044.153005926302, -8960.479670854344], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.471034389380992, "mean_inference_ms": 0.3234597164916407, "mean_action_processing_ms": 0.07963921557850479, "mean_env_wait_ms": 0.8013267680198853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023584365844726562, "StateBufferConnector_ms": 0.0016798973083496094, "ViewRequirementAgentConnector_ms": 0.04419994354248047}}, "episode_reward_max": -8827.150455368672, "episode_reward_min": -9080.66249314025, "episode_reward_mean": -8924.767108263206, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8923.787237849454, -8945.90234785922, -8911.020553319246, -8888.61122104573, -8988.714318125938, -8869.896766306152, -8921.29845579144, -8885.134067175082, -8902.293894502995, -8836.863764607675, -8838.560045561908, -8941.830307912205, -8899.711164559956, -8899.711164559956, -8892.629286006326, -8928.379461159047, -8996.15776876015, -8856.698032727956, -8879.706364882837, -8939.096236386886, -8921.787059349352, -8935.610481918733, -8953.960872106121, -8930.321022008251, -8899.711164559956, -8928.676233803611, -8896.760659244415, -8907.603539949092, -8827.150455368672, -8926.00694087174, -8965.905019405493, -8945.018075954626, -8933.197486769855, -8950.110561465774, -8924.838695545377, -8896.87769425596, -8939.959546670378, -8975.054061906023, -8875.092070877165, -8890.278975419353, -8913.278003799973, -8907.841541551557, -8899.711164559956, -8906.922991867526, -8924.356207908566, -8948.49535704537, -8945.221056756416, -8968.19527252281, -8867.812123691156, -8968.94830328423, -8894.646539796293, -8916.113786121698, -8911.388711531734, -8926.36708093509, -8919.966526945997, -8899.711164559956, -8873.484313910787, -8955.67301269914, -8929.312162706985, -8896.04926388056, -8858.383102382395, -9005.097387706863, -8855.940530674105, -8979.842174174102, -8968.180492554295, -8910.39060727401, -9004.922497347727, -8869.906475529464, -8899.711164559956, -8991.52768263775, -8969.726833533214, -8909.99839579573, -9008.495243265821, -8939.253505541836, -8882.747220282696, -8920.528173568197, -9080.66249314025, -8888.727227427036, -8898.957788567648, -8928.214585909913, -8911.02439282851, -9020.849469615638, -8954.647926073645, -8967.416371860341, -8878.239794066096, -8882.57475979492, -8884.139073238932, -8925.31542911795, -8868.087486611574, -8979.837049251371, -8911.262849631034, -8907.190592358997, -8899.711164559956, -9026.865227612308, -8881.76989063163, -8895.837882659334, -8979.629267831948, -8983.048277296926, -9044.153005926302, -8960.479670854344], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.471034389380992, "mean_inference_ms": 0.3234597164916407, "mean_action_processing_ms": 0.07963921557850479, "mean_env_wait_ms": 0.8013267680198853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023584365844726562, "StateBufferConnector_ms": 0.0016798973083496094, "ViewRequirementAgentConnector_ms": 0.04419994354248047}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296040, "num_agent_steps_trained": 296040, "num_env_steps_sampled": 296040, "num_env_steps_trained": 296040, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 189.05588610257695, "num_env_steps_trained_throughput_per_sec": 189.05588610257695, "timesteps_total": 296040, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 296040, "timers": {"training_iteration_time_ms": 1898.083, "sample_time_ms": 1891.153, "load_time_ms": 0.221, "load_throughput": 1626049.365, "learn_time_ms": 6.172, "learn_throughput": 58324.878, "synch_weights_time_ms": 0.503}, "counters": {"num_env_steps_sampled": 296040, "num_env_steps_trained": 296040, "num_agent_steps_sampled": 296040, "num_agent_steps_trained": 296040}, "done": false, "episodes_total": 1303, "training_iteration": 266, "trial_id": "0d7ea_00000", "date": "2023-08-04_10-04-22", "timestamp": 1691132662, "time_this_iter_s": 11.427300214767456, "time_total_s": 3046.821104288101, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1316.9903774261475, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 24.552941176470586, "ram_util_percent": 65.79411764705883}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.026025390625, "policy_loss": -1732645333.45, "vf_loss": 132829320.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2473.0, "diff_num_grad_updates_vs_sampler_policy": 2472.0}}, "num_env_steps_sampled": 298200, "num_env_steps_trained": 298200, "num_agent_steps_sampled": 298200, "num_agent_steps_trained": 298200}, "sampler_results": {"episode_reward_max": -8827.150455368672, "episode_reward_min": -9080.66249314025, "episode_reward_mean": -8924.119804941982, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8921.29845579144, -8885.134067175082, -8902.293894502995, -8836.863764607675, -8838.560045561908, -8941.830307912205, -8899.711164559956, -8899.711164559956, -8892.629286006326, -8928.379461159047, -8996.15776876015, -8856.698032727956, -8879.706364882837, -8939.096236386886, -8921.787059349352, -8935.610481918733, -8953.960872106121, -8930.321022008251, -8899.711164559956, -8928.676233803611, -8896.760659244415, -8907.603539949092, -8827.150455368672, -8926.00694087174, -8965.905019405493, -8945.018075954626, -8933.197486769855, -8950.110561465774, -8924.838695545377, -8896.87769425596, -8939.959546670378, -8975.054061906023, -8875.092070877165, -8890.278975419353, -8913.278003799973, -8907.841541551557, -8899.711164559956, -8906.922991867526, -8924.356207908566, -8948.49535704537, -8945.221056756416, -8968.19527252281, -8867.812123691156, -8968.94830328423, -8894.646539796293, -8916.113786121698, -8911.388711531734, -8926.36708093509, -8919.966526945997, -8899.711164559956, -8873.484313910787, -8955.67301269914, -8929.312162706985, -8896.04926388056, -8858.383102382395, -9005.097387706863, -8855.940530674105, -8979.842174174102, -8968.180492554295, -8910.39060727401, -9004.922497347727, -8869.906475529464, -8899.711164559956, -8991.52768263775, -8969.726833533214, -8909.99839579573, -9008.495243265821, -8939.253505541836, -8882.747220282696, -8920.528173568197, -9080.66249314025, -8888.727227427036, -8898.957788567648, -8928.214585909913, -8911.02439282851, -9020.849469615638, -8954.647926073645, -8967.416371860341, -8878.239794066096, -8882.57475979492, -8884.139073238932, -8925.31542911795, -8868.087486611574, -8979.837049251371, -8911.262849631034, -8907.190592358997, -8899.711164559956, -9026.865227612308, -8881.76989063163, -8895.837882659334, -8979.629267831948, -8983.048277296926, -9044.153005926302, -8960.479670854344, -8899.711164559956, -8929.541156696521, -8874.15694155366, -8883.085714641658, -8915.17912037489, -8961.528014556676], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.443048094607604, "mean_inference_ms": 0.322308211628969, "mean_action_processing_ms": 0.07934404650553784, "mean_env_wait_ms": 0.7983186605142666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023658275604248047, "StateBufferConnector_ms": 0.0016829967498779297, "ViewRequirementAgentConnector_ms": 0.044233083724975586}}, "episode_reward_max": -8827.150455368672, "episode_reward_min": -9080.66249314025, "episode_reward_mean": -8924.119804941982, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8921.29845579144, -8885.134067175082, -8902.293894502995, -8836.863764607675, -8838.560045561908, -8941.830307912205, -8899.711164559956, -8899.711164559956, -8892.629286006326, -8928.379461159047, -8996.15776876015, -8856.698032727956, -8879.706364882837, -8939.096236386886, -8921.787059349352, -8935.610481918733, -8953.960872106121, -8930.321022008251, -8899.711164559956, -8928.676233803611, -8896.760659244415, -8907.603539949092, -8827.150455368672, -8926.00694087174, -8965.905019405493, -8945.018075954626, -8933.197486769855, -8950.110561465774, -8924.838695545377, -8896.87769425596, -8939.959546670378, -8975.054061906023, -8875.092070877165, -8890.278975419353, -8913.278003799973, -8907.841541551557, -8899.711164559956, -8906.922991867526, -8924.356207908566, -8948.49535704537, -8945.221056756416, -8968.19527252281, -8867.812123691156, -8968.94830328423, -8894.646539796293, -8916.113786121698, -8911.388711531734, -8926.36708093509, -8919.966526945997, -8899.711164559956, -8873.484313910787, -8955.67301269914, -8929.312162706985, -8896.04926388056, -8858.383102382395, -9005.097387706863, -8855.940530674105, -8979.842174174102, -8968.180492554295, -8910.39060727401, -9004.922497347727, -8869.906475529464, -8899.711164559956, -8991.52768263775, -8969.726833533214, -8909.99839579573, -9008.495243265821, -8939.253505541836, -8882.747220282696, -8920.528173568197, -9080.66249314025, -8888.727227427036, -8898.957788567648, -8928.214585909913, -8911.02439282851, -9020.849469615638, -8954.647926073645, -8967.416371860341, -8878.239794066096, -8882.57475979492, -8884.139073238932, -8925.31542911795, -8868.087486611574, -8979.837049251371, -8911.262849631034, -8907.190592358997, -8899.711164559956, -9026.865227612308, -8881.76989063163, -8895.837882659334, -8979.629267831948, -8983.048277296926, -9044.153005926302, -8960.479670854344, -8899.711164559956, -8929.541156696521, -8874.15694155366, -8883.085714641658, -8915.17912037489, -8961.528014556676], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.443048094607604, "mean_inference_ms": 0.322308211628969, "mean_action_processing_ms": 0.07934404650553784, "mean_env_wait_ms": 0.7983186605142666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023658275604248047, "StateBufferConnector_ms": 0.0016829967498779297, "ViewRequirementAgentConnector_ms": 0.044233083724975586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 298200, "num_agent_steps_trained": 298200, "num_env_steps_sampled": 298200, "num_env_steps_trained": 298200, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 187.26213610374273, "num_env_steps_trained_throughput_per_sec": 187.26213610374273, "timesteps_total": 298200, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 298200, "timers": {"training_iteration_time_ms": 1917.225, "sample_time_ms": 1909.936, "load_time_ms": 0.223, "load_throughput": 1615264.698, "learn_time_ms": 6.429, "learn_throughput": 55993.112, "synch_weights_time_ms": 0.6}, "counters": {"num_env_steps_sampled": 298200, "num_env_steps_trained": 298200, "num_agent_steps_sampled": 298200, "num_agent_steps_trained": 298200}, "done": false, "episodes_total": 1309, "training_iteration": 267, "trial_id": "0d7ea_00000", "date": "2023-08-04_10-04-34", "timestamp": 1691132674, "time_this_iter_s": 11.539219856262207, "time_total_s": 3058.3603241443634, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1328.5295972824097, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 31.9625, "ram_util_percent": 65.71875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": -656.101025390625, "policy_loss": -1747168965.275, "vf_loss": 131399290.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2503.0, "diff_num_grad_updates_vs_sampler_policy": 2502.0}}, "num_env_steps_sampled": 300360, "num_env_steps_trained": 300360, "num_agent_steps_sampled": 300360, "num_agent_steps_trained": 300360}, "sampler_results": {"episode_reward_max": -8827.150455368672, "episode_reward_min": -9080.66249314025, "episode_reward_mean": -8926.492684359448, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8899.711164559956, -8899.711164559956, -8892.629286006326, -8928.379461159047, -8996.15776876015, -8856.698032727956, -8879.706364882837, -8939.096236386886, -8921.787059349352, -8935.610481918733, -8953.960872106121, -8930.321022008251, -8899.711164559956, -8928.676233803611, -8896.760659244415, -8907.603539949092, -8827.150455368672, -8926.00694087174, -8965.905019405493, -8945.018075954626, -8933.197486769855, -8950.110561465774, -8924.838695545377, -8896.87769425596, -8939.959546670378, -8975.054061906023, -8875.092070877165, -8890.278975419353, -8913.278003799973, -8907.841541551557, -8899.711164559956, -8906.922991867526, -8924.356207908566, -8948.49535704537, -8945.221056756416, -8968.19527252281, -8867.812123691156, -8968.94830328423, -8894.646539796293, -8916.113786121698, -8911.388711531734, -8926.36708093509, -8919.966526945997, -8899.711164559956, -8873.484313910787, -8955.67301269914, -8929.312162706985, -8896.04926388056, -8858.383102382395, -9005.097387706863, -8855.940530674105, -8979.842174174102, -8968.180492554295, -8910.39060727401, -9004.922497347727, -8869.906475529464, -8899.711164559956, -8991.52768263775, -8969.726833533214, -8909.99839579573, -9008.495243265821, -8939.253505541836, -8882.747220282696, -8920.528173568197, -9080.66249314025, -8888.727227427036, -8898.957788567648, -8928.214585909913, -8911.02439282851, -9020.849469615638, -8954.647926073645, -8967.416371860341, -8878.239794066096, -8882.57475979492, -8884.139073238932, -8925.31542911795, -8868.087486611574, -8979.837049251371, -8911.262849631034, -8907.190592358997, -8899.711164559956, -9026.865227612308, -8881.76989063163, -8895.837882659334, -8979.629267831948, -8983.048277296926, -9044.153005926302, -8960.479670854344, -8899.711164559956, -8929.541156696521, -8874.15694155366, -8883.085714641658, -8915.17912037489, -8961.528014556676, -8996.564986904357, -8966.280064468661, -8894.322026506361, -8952.26544397238, -8850.490998418116, -8903.344957027739], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.415846295697369, "mean_inference_ms": 0.3212010235405055, "mean_action_processing_ms": 0.07905900155842788, "mean_env_wait_ms": 0.7954393857929428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023598670959472656, "StateBufferConnector_ms": 0.0016810894012451172, "ViewRequirementAgentConnector_ms": 0.044198036193847656}}, "episode_reward_max": -8827.150455368672, "episode_reward_min": -9080.66249314025, "episode_reward_mean": -8926.492684359448, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8899.711164559956, -8899.711164559956, -8892.629286006326, -8928.379461159047, -8996.15776876015, -8856.698032727956, -8879.706364882837, -8939.096236386886, -8921.787059349352, -8935.610481918733, -8953.960872106121, -8930.321022008251, -8899.711164559956, -8928.676233803611, -8896.760659244415, -8907.603539949092, -8827.150455368672, -8926.00694087174, -8965.905019405493, -8945.018075954626, -8933.197486769855, -8950.110561465774, -8924.838695545377, -8896.87769425596, -8939.959546670378, -8975.054061906023, -8875.092070877165, -8890.278975419353, -8913.278003799973, -8907.841541551557, -8899.711164559956, -8906.922991867526, -8924.356207908566, -8948.49535704537, -8945.221056756416, -8968.19527252281, -8867.812123691156, -8968.94830328423, -8894.646539796293, -8916.113786121698, -8911.388711531734, -8926.36708093509, -8919.966526945997, -8899.711164559956, -8873.484313910787, -8955.67301269914, -8929.312162706985, -8896.04926388056, -8858.383102382395, -9005.097387706863, -8855.940530674105, -8979.842174174102, -8968.180492554295, -8910.39060727401, -9004.922497347727, -8869.906475529464, -8899.711164559956, -8991.52768263775, -8969.726833533214, -8909.99839579573, -9008.495243265821, -8939.253505541836, -8882.747220282696, -8920.528173568197, -9080.66249314025, -8888.727227427036, -8898.957788567648, -8928.214585909913, -8911.02439282851, -9020.849469615638, -8954.647926073645, -8967.416371860341, -8878.239794066096, -8882.57475979492, -8884.139073238932, -8925.31542911795, -8868.087486611574, -8979.837049251371, -8911.262849631034, -8907.190592358997, -8899.711164559956, -9026.865227612308, -8881.76989063163, -8895.837882659334, -8979.629267831948, -8983.048277296926, -9044.153005926302, -8960.479670854344, -8899.711164559956, -8929.541156696521, -8874.15694155366, -8883.085714641658, -8915.17912037489, -8961.528014556676, -8996.564986904357, -8966.280064468661, -8894.322026506361, -8952.26544397238, -8850.490998418116, -8903.344957027739], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.415846295697369, "mean_inference_ms": 0.3212010235405055, "mean_action_processing_ms": 0.07905900155842788, "mean_env_wait_ms": 0.7954393857929428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023598670959472656, "StateBufferConnector_ms": 0.0016810894012451172, "ViewRequirementAgentConnector_ms": 0.044198036193847656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300360, "num_agent_steps_trained": 300360, "num_env_steps_sampled": 300360, "num_env_steps_trained": 300360, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 183.4449416522285, "num_env_steps_trained_throughput_per_sec": 183.4449416522285, "timesteps_total": 300360, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 300360, "timers": {"training_iteration_time_ms": 1953.238, "sample_time_ms": 1945.689, "load_time_ms": 0.224, "load_throughput": 1610097.505, "learn_time_ms": 6.66, "learn_throughput": 54057.469, "synch_weights_time_ms": 0.628}, "counters": {"num_env_steps_sampled": 300360, "num_env_steps_trained": 300360, "num_agent_steps_sampled": 300360, "num_agent_steps_trained": 300360}, "done": false, "episodes_total": 1315, "training_iteration": 268, "trial_id": "0d7ea_00000", "date": "2023-08-04_10-04-45", "timestamp": 1691132685, "time_this_iter_s": 11.776728868484497, "time_total_s": 3070.137053012848, "pid": 38033, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (1,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[121000, 5e-05], [124600, 8e-05], [128200, 2.5e-05], [131800, 2.5e-05], [135400, 2.5e-05], [139000, 2.5e-05], [142600, 1e-05], [146200, 1e-05], [149800, 1e-05], [153400, 5e-06], [157000, 5e-06], [160600, 5e-06], [164200, 5e-06], [167800, 1e-06], [171400, 1e-06], [175000, 1e-06], [178600, 1e-06], [182200, 5e-07], [185800, 5e-07], [189400, 2.5e-07], [193000, 2.5e-07], [196600, 1e-07], [200200, 1e-07], [203800, 5e-08], [207400, 5e-08], [211000, 1e-08]], "grad_clip": 5, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.25, "final_epsilon": 0.01, "epsilon_timesteps": 121780}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x15f6b79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1340.3063261508942, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 31.676470588235293, "ram_util_percent": 65.71176470588235}}
