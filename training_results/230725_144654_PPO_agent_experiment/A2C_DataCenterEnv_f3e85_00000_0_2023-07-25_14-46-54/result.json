{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.300000000000001e-05, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.2891906738281, "policy_loss": 1107953959033180.4, "vf_loss": 95126281420.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25.5, "diff_num_grad_updates_vs_sampler_policy": 24.5}}, "num_env_steps_sampled": 5102880, "num_env_steps_trained": 5102880, "num_agent_steps_sampled": 5102880, "num_agent_steps_trained": 5102880}, "sampler_results": {"episode_reward_max": 692459.1949729929, "episode_reward_min": 691988.2961855764, "episode_reward_mean": 692147.7802437098, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929], "episode_lengths": [1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4044961741287754, "mean_inference_ms": 0.24235668992771106, "mean_action_processing_ms": 0.05891031107946224, "mean_env_wait_ms": 1.4243529790376697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005467732747395833, "StateBufferConnector_ms": 0.0018517176310221355, "ViewRequirementAgentConnector_ms": 0.042923291524251304}}, "episode_reward_max": 692459.1949729929, "episode_reward_min": 691988.2961855764, "episode_reward_mean": 692147.7802437098, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929], "episode_lengths": [1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4044961741287754, "mean_inference_ms": 0.24235668992771106, "mean_action_processing_ms": 0.05891031107946224, "mean_env_wait_ms": 1.4243529790376697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005467732747395833, "StateBufferConnector_ms": 0.0018517176310221355, "ViewRequirementAgentConnector_ms": 0.042923291524251304}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5102880, "num_agent_steps_trained": 5102880, "num_env_steps_sampled": 5102880, "num_env_steps_trained": 5102880, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 316.4733344577246, "num_env_steps_trained_throughput_per_sec": 316.4733344577246, "timesteps_total": 5102880, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 5102880, "timers": {"training_iteration_time_ms": 3791.777, "sample_time_ms": 3774.418, "load_time_ms": 0.424, "load_throughput": 2830270.74, "learn_time_ms": 16.317, "learn_throughput": 73541.99, "synch_weights_time_ms": 0.584}, "counters": {"num_env_steps_sampled": 5102880, "num_env_steps_trained": 5102880, "num_agent_steps_sampled": 5102880, "num_agent_steps_trained": 5102880}, "done": false, "episodes_total": 1212, "training_iteration": 581, "trial_id": "f3e85_00000", "date": "2023-07-25_14-47-10", "timestamp": 1690285630, "time_this_iter_s": 11.377380847930908, "time_total_s": 10191.008924484253, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11.377380847930908, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 23.535294117647055, "ram_util_percent": 78.09411764705882}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.7e-05, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.3690490722656, "policy_loss": 108992045782202.2, "vf_loss": 95085230899.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 65.5, "diff_num_grad_updates_vs_sampler_policy": 64.5}}, "num_env_steps_sampled": 5107680, "num_env_steps_trained": 5107680, "num_agent_steps_sampled": 5107680, "num_agent_steps_trained": 5107680}, "sampler_results": {"episode_reward_max": 692459.1949729929, "episode_reward_min": 691953.9429809812, "episode_reward_mean": 692093.6591780497, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.400640807471819, "mean_inference_ms": 0.24212595994897365, "mean_action_processing_ms": 0.05884083385602452, "mean_env_wait_ms": 1.259874297047088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004890986851283482, "StateBufferConnector_ms": 0.0018221991402762277, "ViewRequirementAgentConnector_ms": 0.044424193246023994}}, "episode_reward_max": 692459.1949729929, "episode_reward_min": 691953.9429809812, "episode_reward_mean": 692093.6591780497, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.400640807471819, "mean_inference_ms": 0.24212595994897365, "mean_action_processing_ms": 0.05884083385602452, "mean_env_wait_ms": 1.259874297047088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004890986851283482, "StateBufferConnector_ms": 0.0018221991402762277, "ViewRequirementAgentConnector_ms": 0.044424193246023994}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5107680, "num_agent_steps_trained": 5107680, "num_env_steps_sampled": 5107680, "num_env_steps_trained": 5107680, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 379.0184500373669, "num_env_steps_trained_throughput_per_sec": 379.0184500373669, "timesteps_total": 5107680, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5107680, "timers": {"training_iteration_time_ms": 3434.224, "sample_time_ms": 3419.719, "load_time_ms": 0.417, "load_throughput": 2876798.694, "learn_time_ms": 13.464, "learn_throughput": 89126.281, "synch_weights_time_ms": 0.591}, "counters": {"num_env_steps_sampled": 5107680, "num_env_steps_trained": 5107680, "num_agent_steps_sampled": 5107680, "num_agent_steps_trained": 5107680}, "done": false, "episodes_total": 1216, "training_iteration": 582, "trial_id": "f3e85_00000", "date": "2023-07-25_14-47-23", "timestamp": 1690285643, "time_this_iter_s": 12.666332960128784, "time_total_s": 10203.675257444382, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 24.043713808059692, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 22.86111111111111, "ram_util_percent": 78.02222222222221}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.6666666666666665e-05, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0736633300781, "policy_loss": 32530859718288.8, "vf_loss": 94958371635.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 105.5, "diff_num_grad_updates_vs_sampler_policy": 104.5}}, "num_env_steps_sampled": 5112480, "num_env_steps_trained": 5112480, "num_agent_steps_sampled": 5112480, "num_agent_steps_trained": 5112480}, "sampler_results": {"episode_reward_max": 692527.1379140471, "episode_reward_min": 691838.3194861005, "episode_reward_mean": 692111.8227029202, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3997683350051788, "mean_inference_ms": 0.24169390993058784, "mean_action_processing_ms": 0.05875461202139061, "mean_env_wait_ms": 1.185346926481146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004499608820134943, "StateBufferConnector_ms": 0.0018336556174538352, "ViewRequirementAgentConnector_ms": 0.04394704645330256}}, "episode_reward_max": 692527.1379140471, "episode_reward_min": 691838.3194861005, "episode_reward_mean": 692111.8227029202, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3997683350051788, "mean_inference_ms": 0.24169390993058784, "mean_action_processing_ms": 0.05875461202139061, "mean_env_wait_ms": 1.185346926481146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004499608820134943, "StateBufferConnector_ms": 0.0018336556174538352, "ViewRequirementAgentConnector_ms": 0.04394704645330256}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5112480, "num_agent_steps_trained": 5112480, "num_env_steps_sampled": 5112480, "num_env_steps_trained": 5112480, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 379.7538377092155, "num_env_steps_trained_throughput_per_sec": 379.7538377092155, "timesteps_total": 5112480, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5112480, "timers": {"training_iteration_time_ms": 3166.968, "sample_time_ms": 3154.509, "load_time_ms": 0.417, "load_throughput": 2875436.929, "learn_time_ms": 11.436, "learn_throughput": 104935.865, "synch_weights_time_ms": 0.573}, "counters": {"num_env_steps_sampled": 5112480, "num_env_steps_trained": 5112480, "num_agent_steps_sampled": 5112480, "num_agent_steps_trained": 5112480}, "done": false, "episodes_total": 1220, "training_iteration": 583, "trial_id": "f3e85_00000", "date": "2023-07-25_14-47-35", "timestamp": 1690285655, "time_this_iter_s": 12.641672849655151, "time_total_s": 10216.316930294037, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 36.685386657714844, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 23.67222222222222, "ram_util_percent": 78.02222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.8e-05, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0201293945313, "policy_loss": 5066547930794.4, "vf_loss": 94976819609.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 145.5, "diff_num_grad_updates_vs_sampler_policy": 144.5}}, "num_env_steps_sampled": 5117280, "num_env_steps_trained": 5117280, "num_agent_steps_sampled": 5117280, "num_agent_steps_trained": 5117280}, "sampler_results": {"episode_reward_max": 692527.1379140471, "episode_reward_min": 691838.3194861005, "episode_reward_mean": 692119.481466299, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3989601983774993, "mean_inference_ms": 0.24148410640104592, "mean_action_processing_ms": 0.05869975014819707, "mean_env_wait_ms": 1.1413474415868052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039259592692057295, "StateBufferConnector_ms": 0.0018437703450520833, "ViewRequirementAgentConnector_ms": 0.044067700703938804}}, "episode_reward_max": 692527.1379140471, "episode_reward_min": 691838.3194861005, "episode_reward_mean": 692119.481466299, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3989601983774993, "mean_inference_ms": 0.24148410640104592, "mean_action_processing_ms": 0.05869975014819707, "mean_env_wait_ms": 1.1413474415868052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039259592692057295, "StateBufferConnector_ms": 0.0018437703450520833, "ViewRequirementAgentConnector_ms": 0.044067700703938804}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5117280, "num_agent_steps_trained": 5117280, "num_env_steps_sampled": 5117280, "num_env_steps_trained": 5117280, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 378.5491074387484, "num_env_steps_trained_throughput_per_sec": 378.5491074387484, "timesteps_total": 5117280, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5117280, "timers": {"training_iteration_time_ms": 3164.715, "sample_time_ms": 3152.287, "load_time_ms": 0.419, "load_throughput": 2864309.583, "learn_time_ms": 11.418, "learn_throughput": 105096.256, "synch_weights_time_ms": 0.557}, "counters": {"num_env_steps_sampled": 5117280, "num_env_steps_trained": 5117280, "num_agent_steps_sampled": 5117280, "num_agent_steps_trained": 5117280}, "done": false, "episodes_total": 1224, "training_iteration": 584, "trial_id": "f3e85_00000", "date": "2023-07-25_14-47-48", "timestamp": 1690285668, "time_this_iter_s": 12.681924819946289, "time_total_s": 10228.998855113983, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 49.36731147766113, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 25.072222222222223, "ram_util_percent": 77.95555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.000000000000001e-06, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0129516601562, "policy_loss": 960682678884.0, "vf_loss": 95007784960.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 185.5, "diff_num_grad_updates_vs_sampler_policy": 184.5}}, "num_env_steps_sampled": 5122080, "num_env_steps_trained": 5122080, "num_agent_steps_sampled": 5122080, "num_agent_steps_trained": 5122080}, "sampler_results": {"episode_reward_max": 692527.1379140471, "episode_reward_min": 691806.4425434617, "episode_reward_mean": 692079.1032540968, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3983990191644025, "mean_inference_ms": 0.24133186721675126, "mean_action_processing_ms": 0.05866009908516421, "mean_env_wait_ms": 1.1118731714353527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003593846371299342, "StateBufferConnector_ms": 0.0018584100823653372, "ViewRequirementAgentConnector_ms": 0.04402587288304379}}, "episode_reward_max": 692527.1379140471, "episode_reward_min": 691806.4425434617, "episode_reward_mean": 692079.1032540968, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3983990191644025, "mean_inference_ms": 0.24133186721675126, "mean_action_processing_ms": 0.05866009908516421, "mean_env_wait_ms": 1.1118731714353527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003593846371299342, "StateBufferConnector_ms": 0.0018584100823653372, "ViewRequirementAgentConnector_ms": 0.04402587288304379}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5122080, "num_agent_steps_trained": 5122080, "num_env_steps_sampled": 5122080, "num_env_steps_trained": 5122080, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 377.5794893954125, "num_env_steps_trained_throughput_per_sec": 377.5794893954125, "timesteps_total": 5122080, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5122080, "timers": {"training_iteration_time_ms": 3174.223, "sample_time_ms": 3161.715, "load_time_ms": 0.41, "load_throughput": 2930176.864, "learn_time_ms": 11.532, "learn_throughput": 104060.023, "synch_weights_time_ms": 0.533}, "counters": {"num_env_steps_sampled": 5122080, "num_env_steps_trained": 5122080, "num_agent_steps_sampled": 5122080, "num_agent_steps_trained": 5122080}, "done": false, "episodes_total": 1228, "training_iteration": 585, "trial_id": "f3e85_00000", "date": "2023-07-25_14-48-01", "timestamp": 1690285681, "time_this_iter_s": 12.714576244354248, "time_total_s": 10241.713431358337, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 62.08188772201538, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 23.08888888888889, "ram_util_percent": 77.8722222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.666666666666667e-06, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0103149414062, "policy_loss": 304360650387.2, "vf_loss": 94864744038.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 225.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 5126880, "num_env_steps_trained": 5126880, "num_agent_steps_sampled": 5126880, "num_agent_steps_trained": 5126880}, "sampler_results": {"episode_reward_max": 692527.1379140471, "episode_reward_min": 691452.0968307164, "episode_reward_mean": 692044.9956426137, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3984672764237316, "mean_inference_ms": 0.24128316581847373, "mean_action_processing_ms": 0.05863297895006135, "mean_env_wait_ms": 1.090027088014041, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00337932420813519, "StateBufferConnector_ms": 0.0018959460051163383, "ViewRequirementAgentConnector_ms": 0.044356221738068954}}, "episode_reward_max": 692527.1379140471, "episode_reward_min": 691452.0968307164, "episode_reward_mean": 692044.9956426137, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3984672764237316, "mean_inference_ms": 0.24128316581847373, "mean_action_processing_ms": 0.05863297895006135, "mean_env_wait_ms": 1.090027088014041, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00337932420813519, "StateBufferConnector_ms": 0.0018959460051163383, "ViewRequirementAgentConnector_ms": 0.044356221738068954}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5126880, "num_agent_steps_trained": 5126880, "num_env_steps_sampled": 5126880, "num_env_steps_trained": 5126880, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 377.18310289265725, "num_env_steps_trained_throughput_per_sec": 377.18310289265725, "timesteps_total": 5126880, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5126880, "timers": {"training_iteration_time_ms": 3174.924, "sample_time_ms": 3162.255, "load_time_ms": 0.412, "load_throughput": 2913216.878, "learn_time_ms": 11.68, "learn_throughput": 102741.133, "synch_weights_time_ms": 0.543}, "counters": {"num_env_steps_sampled": 5126880, "num_env_steps_trained": 5126880, "num_agent_steps_sampled": 5126880, "num_agent_steps_trained": 5126880}, "done": false, "episodes_total": 1232, "training_iteration": 586, "trial_id": "f3e85_00000", "date": "2023-07-25_14-48-13", "timestamp": 1690285693, "time_this_iter_s": 12.728034019470215, "time_total_s": 10254.441465377808, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 74.8099217414856, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 24.894444444444446, "ram_util_percent": 77.94444444444443}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.8000000000000001e-06, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0103149414062, "policy_loss": 42266800268.8, "vf_loss": 94990283571.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 265.5, "diff_num_grad_updates_vs_sampler_policy": 264.5}}, "num_env_steps_sampled": 5131680, "num_env_steps_trained": 5131680, "num_agent_steps_sampled": 5131680, "num_agent_steps_trained": 5131680}, "sampler_results": {"episode_reward_max": 692527.1379140471, "episode_reward_min": 691452.0968307164, "episode_reward_mean": 692038.1883413439, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3983385072449805, "mean_inference_ms": 0.24127071511159504, "mean_action_processing_ms": 0.05860077549136368, "mean_env_wait_ms": 1.0732359818447652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003238077516908999, "StateBufferConnector_ms": 0.0018932201244212963, "ViewRequirementAgentConnector_ms": 0.04426549982141565}}, "episode_reward_max": 692527.1379140471, "episode_reward_min": 691452.0968307164, "episode_reward_mean": 692038.1883413439, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3983385072449805, "mean_inference_ms": 0.24127071511159504, "mean_action_processing_ms": 0.05860077549136368, "mean_env_wait_ms": 1.0732359818447652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003238077516908999, "StateBufferConnector_ms": 0.0018932201244212963, "ViewRequirementAgentConnector_ms": 0.04426549982141565}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5131680, "num_agent_steps_trained": 5131680, "num_env_steps_sampled": 5131680, "num_env_steps_trained": 5131680, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 378.9587573782258, "num_env_steps_trained_throughput_per_sec": 378.9587573782258, "timesteps_total": 5131680, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5131680, "timers": {"training_iteration_time_ms": 3178.015, "sample_time_ms": 3164.988, "load_time_ms": 0.419, "load_throughput": 2863820.654, "learn_time_ms": 11.948, "learn_throughput": 100436.51, "synch_weights_time_ms": 0.625}, "counters": {"num_env_steps_sampled": 5131680, "num_env_steps_trained": 5131680, "num_agent_steps_sampled": 5131680, "num_agent_steps_trained": 5131680}, "done": false, "episodes_total": 1236, "training_iteration": 587, "trial_id": "f3e85_00000", "date": "2023-07-25_14-48-26", "timestamp": 1690285706, "time_this_iter_s": 12.66861605644226, "time_total_s": 10267.11008143425, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 87.47853779792786, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 23.57777777777778, "ram_util_percent": 77.72777777777779}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8e-07, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0103149414062, "policy_loss": 30508566106.4, "vf_loss": 94967882547.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 305.5, "diff_num_grad_updates_vs_sampler_policy": 304.5}}, "num_env_steps_sampled": 5136480, "num_env_steps_trained": 5136480, "num_agent_steps_sampled": 5136480, "num_agent_steps_trained": 5136480}, "sampler_results": {"episode_reward_max": 692527.1379140471, "episode_reward_min": 691452.0968307164, "episode_reward_mean": 692047.3890931911, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3981940964498296, "mean_inference_ms": 0.24129105800387365, "mean_action_processing_ms": 0.058591307672225285, "mean_env_wait_ms": 1.0597103822581373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032248035553962954, "StateBufferConnector_ms": 0.0019065795406218498, "ViewRequirementAgentConnector_ms": 0.04502496411723475}}, "episode_reward_max": 692527.1379140471, "episode_reward_min": 691452.0968307164, "episode_reward_mean": 692047.3890931911, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3981940964498296, "mean_inference_ms": 0.24129105800387365, "mean_action_processing_ms": 0.058591307672225285, "mean_env_wait_ms": 1.0597103822581373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032248035553962954, "StateBufferConnector_ms": 0.0019065795406218498, "ViewRequirementAgentConnector_ms": 0.04502496411723475}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5136480, "num_agent_steps_trained": 5136480, "num_env_steps_sampled": 5136480, "num_env_steps_trained": 5136480, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 379.58253698461226, "num_env_steps_trained_throughput_per_sec": 379.58253698461226, "timesteps_total": 5136480, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5136480, "timers": {"training_iteration_time_ms": 3167.151, "sample_time_ms": 3154.126, "load_time_ms": 0.421, "load_throughput": 2848746.208, "learn_time_ms": 11.944, "learn_throughput": 100468.187, "synch_weights_time_ms": 0.625}, "counters": {"num_env_steps_sampled": 5136480, "num_env_steps_trained": 5136480, "num_agent_steps_sampled": 5136480, "num_agent_steps_trained": 5136480}, "done": false, "episodes_total": 1240, "training_iteration": 588, "trial_id": "f3e85_00000", "date": "2023-07-25_14-48-39", "timestamp": 1690285719, "time_this_iter_s": 12.647438049316406, "time_total_s": 10279.757519483566, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 100.12597584724426, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 24.83888888888889, "ram_util_percent": 77.8388888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.666666666666666e-07, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0103149414062, "policy_loss": 2088165718.6, "vf_loss": 95062999449.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 345.5, "diff_num_grad_updates_vs_sampler_policy": 344.5}}, "num_env_steps_sampled": 5141280, "num_env_steps_trained": 5141280, "num_agent_steps_sampled": 5141280, "num_agent_steps_trained": 5141280}, "sampler_results": {"episode_reward_max": 692527.1379140471, "episode_reward_min": 691452.0968307164, "episode_reward_mean": 692054.3401259473, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3980649861028933, "mean_inference_ms": 0.24131468382236235, "mean_action_processing_ms": 0.058583682022612764, "mean_env_wait_ms": 1.0487589004697817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003147125244140625, "StateBufferConnector_ms": 0.0018944059099469865, "ViewRequirementAgentConnector_ms": 0.04514285496303013}}, "episode_reward_max": 692527.1379140471, "episode_reward_min": 691452.0968307164, "episode_reward_mean": 692054.3401259473, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3980649861028933, "mean_inference_ms": 0.24131468382236235, "mean_action_processing_ms": 0.058583682022612764, "mean_env_wait_ms": 1.0487589004697817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003147125244140625, "StateBufferConnector_ms": 0.0018944059099469865, "ViewRequirementAgentConnector_ms": 0.04514285496303013}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5141280, "num_agent_steps_trained": 5141280, "num_env_steps_sampled": 5141280, "num_env_steps_trained": 5141280, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 377.29151269190555, "num_env_steps_trained_throughput_per_sec": 377.29151269190555, "timesteps_total": 5141280, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5141280, "timers": {"training_iteration_time_ms": 3171.968, "sample_time_ms": 3158.861, "load_time_ms": 0.422, "load_throughput": 2844077.979, "learn_time_ms": 11.978, "learn_throughput": 100180.426, "synch_weights_time_ms": 0.67}, "counters": {"num_env_steps_sampled": 5141280, "num_env_steps_trained": 5141280, "num_agent_steps_sampled": 5141280, "num_agent_steps_trained": 5141280}, "done": false, "episodes_total": 1244, "training_iteration": 589, "trial_id": "f3e85_00000", "date": "2023-07-25_14-48-51", "timestamp": 1690285731, "time_this_iter_s": 12.72423791885376, "time_total_s": 10292.48175740242, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 112.85021376609802, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 21.17777777777778, "ram_util_percent": 77.32777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.8e-07, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0103149414062, "policy_loss": 9456811784.0, "vf_loss": 95018596761.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 385.5, "diff_num_grad_updates_vs_sampler_policy": 384.5}}, "num_env_steps_sampled": 5146080, "num_env_steps_trained": 5146080, "num_agent_steps_sampled": 5146080, "num_agent_steps_trained": 5146080}, "sampler_results": {"episode_reward_max": 692527.1379140471, "episode_reward_min": 691452.0968307164, "episode_reward_mean": 692043.4688531439, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3983328381512017, "mean_inference_ms": 0.24130383505874514, "mean_action_processing_ms": 0.0585731990187908, "mean_env_wait_ms": 1.0394683456442497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003071320362580128, "StateBufferConnector_ms": 0.0018945107093224158, "ViewRequirementAgentConnector_ms": 0.04502259767972506}}, "episode_reward_max": 692527.1379140471, "episode_reward_min": 691452.0968307164, "episode_reward_mean": 692043.4688531439, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3983328381512017, "mean_inference_ms": 0.24130383505874514, "mean_action_processing_ms": 0.0585731990187908, "mean_env_wait_ms": 1.0394683456442497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003071320362580128, "StateBufferConnector_ms": 0.0018945107093224158, "ViewRequirementAgentConnector_ms": 0.04502259767972506}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5146080, "num_agent_steps_trained": 5146080, "num_env_steps_sampled": 5146080, "num_env_steps_trained": 5146080, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 375.50996442527025, "num_env_steps_trained_throughput_per_sec": 375.50996442527025, "timesteps_total": 5146080, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5146080, "timers": {"training_iteration_time_ms": 3179.381, "sample_time_ms": 3166.481, "load_time_ms": 0.433, "load_throughput": 2771871.792, "learn_time_ms": 11.805, "learn_throughput": 101650.526, "synch_weights_time_ms": 0.622}, "counters": {"num_env_steps_sampled": 5146080, "num_env_steps_trained": 5146080, "num_agent_steps_sampled": 5146080, "num_agent_steps_trained": 5146080}, "done": false, "episodes_total": 1248, "training_iteration": 590, "trial_id": "f3e85_00000", "date": "2023-07-25_14-49-04", "timestamp": 1690285744, "time_this_iter_s": 12.78466510772705, "time_total_s": 10305.266422510147, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 125.63487887382507, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 33.57777777777778, "ram_util_percent": 77.82222222222224}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.999999999999998e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0103149414062, "policy_loss": 1044655543.0, "vf_loss": 95090885836.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 425.5, "diff_num_grad_updates_vs_sampler_policy": 424.5}}, "num_env_steps_sampled": 5150880, "num_env_steps_trained": 5150880, "num_agent_steps_sampled": 5150880, "num_agent_steps_trained": 5150880}, "sampler_results": {"episode_reward_max": 692527.1379140471, "episode_reward_min": 691452.0968307164, "episode_reward_mean": 692065.7425635143, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3985533421891057, "mean_inference_ms": 0.24129543716378168, "mean_action_processing_ms": 0.05856532069663296, "mean_env_wait_ms": 1.0316491845057938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030373418053915332, "StateBufferConnector_ms": 0.0018918237020803053, "ViewRequirementAgentConnector_ms": 0.04527069801507994}}, "episode_reward_max": 692527.1379140471, "episode_reward_min": 691452.0968307164, "episode_reward_mean": 692065.7425635143, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3985533421891057, "mean_inference_ms": 0.24129543716378168, "mean_action_processing_ms": 0.05856532069663296, "mean_env_wait_ms": 1.0316491845057938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030373418053915332, "StateBufferConnector_ms": 0.0018918237020803053, "ViewRequirementAgentConnector_ms": 0.04527069801507994}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5150880, "num_agent_steps_trained": 5150880, "num_env_steps_sampled": 5150880, "num_env_steps_trained": 5150880, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 376.6639443678161, "num_env_steps_trained_throughput_per_sec": 376.6639443678161, "timesteps_total": 5150880, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5150880, "timers": {"training_iteration_time_ms": 3190.955, "sample_time_ms": 3177.991, "load_time_ms": 0.426, "load_throughput": 2817332.662, "learn_time_ms": 11.868, "learn_throughput": 101113.656, "synch_weights_time_ms": 0.629}, "counters": {"num_env_steps_sampled": 5150880, "num_env_steps_trained": 5150880, "num_agent_steps_sampled": 5150880, "num_agent_steps_trained": 5150880}, "done": false, "episodes_total": 1252, "training_iteration": 591, "trial_id": "f3e85_00000", "date": "2023-07-25_14-49-17", "timestamp": 1690285757, "time_this_iter_s": 12.745468854904175, "time_total_s": 10318.011891365051, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 138.38034772872925, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 27.84444444444445, "ram_util_percent": 78.69999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.01171875, "policy_loss": 57437348.6, "vf_loss": 94990315520.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 5155680, "num_env_steps_trained": 5155680, "num_agent_steps_sampled": 5155680, "num_agent_steps_trained": 5155680}, "sampler_results": {"episode_reward_max": 692544.3846333754, "episode_reward_min": 691452.0968307164, "episode_reward_mean": 692078.3232811132, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3987762003406237, "mean_inference_ms": 0.24128681006800762, "mean_action_processing_ms": 0.058558020245402825, "mean_env_wait_ms": 1.0249065542811917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029807395123420876, "StateBufferConnector_ms": 0.0018890867842004655, "ViewRequirementAgentConnector_ms": 0.045188437116906996}}, "episode_reward_max": 692544.3846333754, "episode_reward_min": 691452.0968307164, "episode_reward_mean": 692078.3232811132, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3987762003406237, "mean_inference_ms": 0.24128681006800762, "mean_action_processing_ms": 0.058558020245402825, "mean_env_wait_ms": 1.0249065542811917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029807395123420876, "StateBufferConnector_ms": 0.0018890867842004655, "ViewRequirementAgentConnector_ms": 0.045188437116906996}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5155680, "num_agent_steps_trained": 5155680, "num_env_steps_sampled": 5155680, "num_env_steps_trained": 5155680, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 377.19486188688194, "num_env_steps_trained_throughput_per_sec": 377.19486188688194, "timesteps_total": 5155680, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5155680, "timers": {"training_iteration_time_ms": 3193.486, "sample_time_ms": 3180.497, "load_time_ms": 0.428, "load_throughput": 2803991.532, "learn_time_ms": 11.919, "learn_throughput": 100682.224, "synch_weights_time_ms": 0.602}, "counters": {"num_env_steps_sampled": 5155680, "num_env_steps_trained": 5155680, "num_agent_steps_sampled": 5155680, "num_agent_steps_trained": 5155680}, "done": false, "episodes_total": 1256, "training_iteration": 592, "trial_id": "f3e85_00000", "date": "2023-07-25_14-49-30", "timestamp": 1690285770, "time_this_iter_s": 12.727518320083618, "time_total_s": 10330.739409685135, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 151.10786604881287, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 28.026315789473685, "ram_util_percent": 78.86315789473684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0121887207031, "policy_loss": 13084198.6, "vf_loss": 94985130393.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 505.5, "diff_num_grad_updates_vs_sampler_policy": 504.5}}, "num_env_steps_sampled": 5160480, "num_env_steps_trained": 5160480, "num_agent_steps_sampled": 5160480, "num_agent_steps_trained": 5160480}, "sampler_results": {"episode_reward_max": 692544.3846333754, "episode_reward_min": 691452.0968307164, "episode_reward_mean": 692081.1702906311, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3990290779441343, "mean_inference_ms": 0.24126551857461973, "mean_action_processing_ms": 0.05855119867998181, "mean_env_wait_ms": 1.019002472377919, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002934885959999234, "StateBufferConnector_ms": 0.0018975313972024357, "ViewRequirementAgentConnector_ms": 0.045098977930405564}}, "episode_reward_max": 692544.3846333754, "episode_reward_min": 691452.0968307164, "episode_reward_mean": 692081.1702906311, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3990290779441343, "mean_inference_ms": 0.24126551857461973, "mean_action_processing_ms": 0.05855119867998181, "mean_env_wait_ms": 1.019002472377919, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002934885959999234, "StateBufferConnector_ms": 0.0018975313972024357, "ViewRequirementAgentConnector_ms": 0.045098977930405564}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5160480, "num_agent_steps_trained": 5160480, "num_env_steps_sampled": 5160480, "num_env_steps_trained": 5160480, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 377.2555482548333, "num_env_steps_trained_throughput_per_sec": 377.2555482548333, "timesteps_total": 5160480, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5160480, "timers": {"training_iteration_time_ms": 3186.502, "sample_time_ms": 3173.873, "load_time_ms": 0.414, "load_throughput": 2901795.791, "learn_time_ms": 11.61, "learn_throughput": 103362.504, "synch_weights_time_ms": 0.571}, "counters": {"num_env_steps_sampled": 5160480, "num_env_steps_trained": 5160480, "num_agent_steps_sampled": 5160480, "num_agent_steps_trained": 5160480}, "done": false, "episodes_total": 1260, "training_iteration": 593, "trial_id": "f3e85_00000", "date": "2023-07-25_14-49-43", "timestamp": 1690285783, "time_this_iter_s": 12.725424766540527, "time_total_s": 10343.464834451675, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 163.8332908153534, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 23.92222222222222, "ram_util_percent": 78.67222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0122680664062, "policy_loss": 144972135.7, "vf_loss": 95036538470.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 545.5, "diff_num_grad_updates_vs_sampler_policy": 544.5}}, "num_env_steps_sampled": 5165280, "num_env_steps_trained": 5165280, "num_agent_steps_sampled": 5165280, "num_agent_steps_trained": 5165280}, "sampler_results": {"episode_reward_max": 692544.3846333754, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692073.0439273675, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3991856145215182, "mean_inference_ms": 0.24123730277521693, "mean_action_processing_ms": 0.05854378972742535, "mean_env_wait_ms": 1.0137670327045167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028987364335493608, "StateBufferConnector_ms": 0.00188003886829723, "ViewRequirementAgentConnector_ms": 0.04505374214865945}}, "episode_reward_max": 692544.3846333754, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692073.0439273675, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3991856145215182, "mean_inference_ms": 0.24123730277521693, "mean_action_processing_ms": 0.05854378972742535, "mean_env_wait_ms": 1.0137670327045167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028987364335493608, "StateBufferConnector_ms": 0.00188003886829723, "ViewRequirementAgentConnector_ms": 0.04505374214865945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5165280, "num_agent_steps_trained": 5165280, "num_env_steps_sampled": 5165280, "num_env_steps_trained": 5165280, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 380.71953560545285, "num_env_steps_trained_throughput_per_sec": 380.71953560545285, "timesteps_total": 5165280, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5165280, "timers": {"training_iteration_time_ms": 3165.91, "sample_time_ms": 3153.381, "load_time_ms": 0.411, "load_throughput": 2918115.028, "learn_time_ms": 11.519, "learn_throughput": 104171.371, "synch_weights_time_ms": 0.564}, "counters": {"num_env_steps_sampled": 5165280, "num_env_steps_trained": 5165280, "num_agent_steps_sampled": 5165280, "num_agent_steps_trained": 5165280}, "done": false, "episodes_total": 1264, "training_iteration": 594, "trial_id": "f3e85_00000", "date": "2023-07-25_14-49-55", "timestamp": 1690285795, "time_this_iter_s": 12.609868049621582, "time_total_s": 10356.074702501297, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 176.44315886497498, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 22.63888888888889, "ram_util_percent": 78.42777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0122680664062, "policy_loss": 180656514.8, "vf_loss": 95118338867.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 585.5, "diff_num_grad_updates_vs_sampler_policy": 584.5}}, "num_env_steps_sampled": 5170080, "num_env_steps_trained": 5170080, "num_agent_steps_sampled": 5170080, "num_agent_steps_trained": 5170080}, "sampler_results": {"episode_reward_max": 692544.3846333754, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692084.9522618267, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3993473451351401, "mean_inference_ms": 0.2412103191939905, "mean_action_processing_ms": 0.058536602452451195, "mean_env_wait_ms": 1.0091028012505656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028707213320974577, "StateBufferConnector_ms": 0.0018758288884567003, "ViewRequirementAgentConnector_ms": 0.04499645556433726}}, "episode_reward_max": 692544.3846333754, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692084.9522618267, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3993473451351401, "mean_inference_ms": 0.2412103191939905, "mean_action_processing_ms": 0.058536602452451195, "mean_env_wait_ms": 1.0091028012505656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028707213320974577, "StateBufferConnector_ms": 0.0018758288884567003, "ViewRequirementAgentConnector_ms": 0.04499645556433726}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5170080, "num_agent_steps_trained": 5170080, "num_env_steps_sampled": 5170080, "num_env_steps_trained": 5170080, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 377.7665436419968, "num_env_steps_trained_throughput_per_sec": 377.7665436419968, "timesteps_total": 5170080, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5170080, "timers": {"training_iteration_time_ms": 3171.097, "sample_time_ms": 3158.583, "load_time_ms": 0.435, "load_throughput": 2760318.526, "learn_time_ms": 11.493, "learn_throughput": 104408.859, "synch_weights_time_ms": 0.551}, "counters": {"num_env_steps_sampled": 5170080, "num_env_steps_trained": 5170080, "num_agent_steps_sampled": 5170080, "num_agent_steps_trained": 5170080}, "done": false, "episodes_total": 1268, "training_iteration": 595, "trial_id": "f3e85_00000", "date": "2023-07-25_14-50-08", "timestamp": 1690285808, "time_this_iter_s": 12.70838189125061, "time_total_s": 10368.783084392548, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 189.1515407562256, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 25.46666666666667, "ram_util_percent": 78.94999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0123413085937, "policy_loss": -1557456.3, "vf_loss": 95060679475.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 625.5, "diff_num_grad_updates_vs_sampler_policy": 624.5}}, "num_env_steps_sampled": 5174880, "num_env_steps_trained": 5174880, "num_agent_steps_sampled": 5174880, "num_agent_steps_trained": 5174880}, "sampler_results": {"episode_reward_max": 692544.3846333754, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692094.7539019701, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3994655953977608, "mean_inference_ms": 0.24119013911105786, "mean_action_processing_ms": 0.058530952597600674, "mean_env_wait_ms": 1.00491304500217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028477774726019967, "StateBufferConnector_ms": 0.00190697019062345, "ViewRequirementAgentConnector_ms": 0.045044081551688056}}, "episode_reward_max": 692544.3846333754, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692094.7539019701, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3994655953977608, "mean_inference_ms": 0.24119013911105786, "mean_action_processing_ms": 0.058530952597600674, "mean_env_wait_ms": 1.00491304500217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028477774726019967, "StateBufferConnector_ms": 0.00190697019062345, "ViewRequirementAgentConnector_ms": 0.045044081551688056}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5174880, "num_agent_steps_trained": 5174880, "num_env_steps_sampled": 5174880, "num_env_steps_trained": 5174880, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 379.254615397512, "num_env_steps_trained_throughput_per_sec": 379.254615397512, "timesteps_total": 5174880, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5174880, "timers": {"training_iteration_time_ms": 3168.062, "sample_time_ms": 3155.666, "load_time_ms": 0.439, "load_throughput": 2732445.603, "learn_time_ms": 11.374, "learn_throughput": 105507.349, "synch_weights_time_ms": 0.549}, "counters": {"num_env_steps_sampled": 5174880, "num_env_steps_trained": 5174880, "num_agent_steps_sampled": 5174880, "num_agent_steps_trained": 5174880}, "done": false, "episodes_total": 1272, "training_iteration": 596, "trial_id": "f3e85_00000", "date": "2023-07-25_14-50-21", "timestamp": 1690285821, "time_this_iter_s": 12.658476114273071, "time_total_s": 10381.44156050682, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 201.81001687049866, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 26.48888888888889, "ram_util_percent": 79.42777777777779}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.013427734375, "policy_loss": -44592480.2, "vf_loss": 95023386624.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 665.5, "diff_num_grad_updates_vs_sampler_policy": 664.5}}, "num_env_steps_sampled": 5179680, "num_env_steps_trained": 5179680, "num_agent_steps_sampled": 5179680, "num_agent_steps_trained": 5179680}, "sampler_results": {"episode_reward_max": 692544.3846333754, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692094.3930616494, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3995320672689582, "mean_inference_ms": 0.2411618870733484, "mean_action_processing_ms": 0.058524567968675875, "mean_env_wait_ms": 1.001131115574087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002824370540789704, "StateBufferConnector_ms": 0.0019105512704422226, "ViewRequirementAgentConnector_ms": 0.04502232395001312}}, "episode_reward_max": 692544.3846333754, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692094.3930616494, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3995320672689582, "mean_inference_ms": 0.2411618870733484, "mean_action_processing_ms": 0.058524567968675875, "mean_env_wait_ms": 1.001131115574087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002824370540789704, "StateBufferConnector_ms": 0.0019105512704422226, "ViewRequirementAgentConnector_ms": 0.04502232395001312}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5179680, "num_agent_steps_trained": 5179680, "num_env_steps_sampled": 5179680, "num_env_steps_trained": 5179680, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 380.45839048353014, "num_env_steps_trained_throughput_per_sec": 380.45839048353014, "timesteps_total": 5179680, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5179680, "timers": {"training_iteration_time_ms": 3158.073, "sample_time_ms": 3145.716, "load_time_ms": 0.416, "load_throughput": 2887976.13, "learn_time_ms": 11.353, "learn_throughput": 105695.013, "synch_weights_time_ms": 0.553}, "counters": {"num_env_steps_sampled": 5179680, "num_env_steps_trained": 5179680, "num_agent_steps_sampled": 5179680, "num_agent_steps_trained": 5179680}, "done": false, "episodes_total": 1276, "training_iteration": 597, "trial_id": "f3e85_00000", "date": "2023-07-25_14-50-33", "timestamp": 1690285833, "time_this_iter_s": 12.618442058563232, "time_total_s": 10394.060002565384, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 214.4284589290619, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 23.433333333333334, "ram_util_percent": 79.56111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0135498046875, "policy_loss": -15606666.0, "vf_loss": 95022347468.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 705.5, "diff_num_grad_updates_vs_sampler_policy": 704.5}}, "num_env_steps_sampled": 5184480, "num_env_steps_trained": 5184480, "num_agent_steps_sampled": 5184480, "num_agent_steps_trained": 5184480}, "sampler_results": {"episode_reward_max": 692544.3846333754, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692091.8483028321, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3995475878285764, "mean_inference_ms": 0.24113373192339052, "mean_action_processing_ms": 0.05851801315918448, "mean_env_wait_ms": 0.9977072626457166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028046084121919014, "StateBufferConnector_ms": 0.0018999610148685078, "ViewRequirementAgentConnector_ms": 0.044979176051180125}}, "episode_reward_max": 692544.3846333754, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692091.8483028321, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3995475878285764, "mean_inference_ms": 0.24113373192339052, "mean_action_processing_ms": 0.05851801315918448, "mean_env_wait_ms": 0.9977072626457166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028046084121919014, "StateBufferConnector_ms": 0.0018999610148685078, "ViewRequirementAgentConnector_ms": 0.044979176051180125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5184480, "num_agent_steps_trained": 5184480, "num_env_steps_sampled": 5184480, "num_env_steps_trained": 5184480, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 380.332827177771, "num_env_steps_trained_throughput_per_sec": 380.332827177771, "timesteps_total": 5184480, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5184480, "timers": {"training_iteration_time_ms": 3154.427, "sample_time_ms": 3142.166, "load_time_ms": 0.414, "load_throughput": 2898119.883, "learn_time_ms": 11.265, "learn_throughput": 106527.192, "synch_weights_time_ms": 0.548}, "counters": {"num_env_steps_sampled": 5184480, "num_env_steps_trained": 5184480, "num_agent_steps_sampled": 5184480, "num_agent_steps_trained": 5184480}, "done": false, "episodes_total": 1280, "training_iteration": 598, "trial_id": "f3e85_00000", "date": "2023-07-25_14-50-46", "timestamp": 1690285846, "time_this_iter_s": 12.622661828994751, "time_total_s": 10406.682664394379, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 227.05112075805664, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 23.6, "ram_util_percent": 79.25555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0135498046875, "policy_loss": -15376143.7, "vf_loss": 94880960921.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 745.5, "diff_num_grad_updates_vs_sampler_policy": 744.5}}, "num_env_steps_sampled": 5189280, "num_env_steps_trained": 5189280, "num_agent_steps_sampled": 5189280, "num_agent_steps_trained": 5189280}, "sampler_results": {"episode_reward_max": 692544.3846333754, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692091.3272858481, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3995573274546091, "mean_inference_ms": 0.24111863079841028, "mean_action_processing_ms": 0.05851260980760479, "mean_env_wait_ms": 0.9946085973902654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027831395467122397, "StateBufferConnector_ms": 0.00189208984375, "ViewRequirementAgentConnector_ms": 0.044949849446614586}}, "episode_reward_max": 692544.3846333754, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692091.3272858481, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3995573274546091, "mean_inference_ms": 0.24111863079841028, "mean_action_processing_ms": 0.05851260980760479, "mean_env_wait_ms": 0.9946085973902654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027831395467122397, "StateBufferConnector_ms": 0.00189208984375, "ViewRequirementAgentConnector_ms": 0.044949849446614586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5189280, "num_agent_steps_trained": 5189280, "num_env_steps_sampled": 5189280, "num_env_steps_trained": 5189280, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 376.97150277132016, "num_env_steps_trained_throughput_per_sec": 376.97150277132016, "timesteps_total": 5189280, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5189280, "timers": {"training_iteration_time_ms": 3166.407, "sample_time_ms": 3154.041, "load_time_ms": 0.424, "load_throughput": 2832394.373, "learn_time_ms": 11.345, "learn_throughput": 105771.199, "synch_weights_time_ms": 0.562}, "counters": {"num_env_steps_sampled": 5189280, "num_env_steps_trained": 5189280, "num_agent_steps_sampled": 5189280, "num_agent_steps_trained": 5189280}, "done": false, "episodes_total": 1284, "training_iteration": 599, "trial_id": "f3e85_00000", "date": "2023-07-25_14-50-59", "timestamp": 1690285859, "time_this_iter_s": 12.735068082809448, "time_total_s": 10419.417732477188, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 239.7861888408661, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 25.1, "ram_util_percent": 79.39444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0135498046875, "policy_loss": 166312322.0, "vf_loss": 95109196595.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 785.5, "diff_num_grad_updates_vs_sampler_policy": 784.5}}, "num_env_steps_sampled": 5194080, "num_env_steps_trained": 5194080, "num_agent_steps_sampled": 5194080, "num_agent_steps_trained": 5194080}, "sampler_results": {"episode_reward_max": 692544.3846333754, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692102.1616600798, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3995605380958898, "mean_inference_ms": 0.24110987933427314, "mean_action_processing_ms": 0.05850754740357439, "mean_env_wait_ms": 0.991787399807578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002785574031781547, "StateBufferConnector_ms": 0.0019016145150872726, "ViewRequirementAgentConnector_ms": 0.045122979562493816}}, "episode_reward_max": 692544.3846333754, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692102.1616600798, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3995605380958898, "mean_inference_ms": 0.24110987933427314, "mean_action_processing_ms": 0.05850754740357439, "mean_env_wait_ms": 0.991787399807578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002785574031781547, "StateBufferConnector_ms": 0.0019016145150872726, "ViewRequirementAgentConnector_ms": 0.045122979562493816}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5194080, "num_agent_steps_trained": 5194080, "num_env_steps_sampled": 5194080, "num_env_steps_trained": 5194080, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 377.4309812471762, "num_env_steps_trained_throughput_per_sec": 377.4309812471762, "timesteps_total": 5194080, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5194080, "timers": {"training_iteration_time_ms": 3172.945, "sample_time_ms": 3160.536, "load_time_ms": 0.424, "load_throughput": 2829528.221, "learn_time_ms": 11.393, "learn_throughput": 105327.845, "synch_weights_time_ms": 0.558}, "counters": {"num_env_steps_sampled": 5194080, "num_env_steps_trained": 5194080, "num_agent_steps_sampled": 5194080, "num_agent_steps_trained": 5194080}, "done": false, "episodes_total": 1288, "training_iteration": 600, "trial_id": "f3e85_00000", "date": "2023-07-25_14-51-11", "timestamp": 1690285871, "time_this_iter_s": 12.71950101852417, "time_total_s": 10432.137233495712, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 252.50568985939026, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 22.13888888888889, "ram_util_percent": 79.17222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0133728027344, "policy_loss": -32064331.0, "vf_loss": 94968203264.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 825.5, "diff_num_grad_updates_vs_sampler_policy": 824.5}}, "num_env_steps_sampled": 5198880, "num_env_steps_trained": 5198880, "num_agent_steps_sampled": 5198880, "num_agent_steps_trained": 5198880}, "sampler_results": {"episode_reward_max": 692544.3846333754, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692100.8823199447, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3995497249171056, "mean_inference_ms": 0.2411117799995093, "mean_action_processing_ms": 0.05850410249528058, "mean_env_wait_ms": 0.9892062429289287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027736985539815514, "StateBufferConnector_ms": 0.0019059123763118882, "ViewRequirementAgentConnector_ms": 0.045083229800304735}}, "episode_reward_max": 692544.3846333754, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692100.8823199447, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3995497249171056, "mean_inference_ms": 0.2411117799995093, "mean_action_processing_ms": 0.05850410249528058, "mean_env_wait_ms": 0.9892062429289287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027736985539815514, "StateBufferConnector_ms": 0.0019059123763118882, "ViewRequirementAgentConnector_ms": 0.045083229800304735}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5198880, "num_agent_steps_trained": 5198880, "num_env_steps_sampled": 5198880, "num_env_steps_trained": 5198880, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 377.57034052158815, "num_env_steps_trained_throughput_per_sec": 377.57034052158815, "timesteps_total": 5198880, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5198880, "timers": {"training_iteration_time_ms": 3176.49, "sample_time_ms": 3164.029, "load_time_ms": 0.426, "load_throughput": 2819226.349, "learn_time_ms": 11.447, "learn_throughput": 104831.61, "synch_weights_time_ms": 0.553}, "counters": {"num_env_steps_sampled": 5198880, "num_env_steps_trained": 5198880, "num_agent_steps_sampled": 5198880, "num_agent_steps_trained": 5198880}, "done": false, "episodes_total": 1292, "training_iteration": 601, "trial_id": "f3e85_00000", "date": "2023-07-25_14-51-24", "timestamp": 1690285884, "time_this_iter_s": 12.714935064315796, "time_total_s": 10444.852168560028, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 265.22062492370605, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 26.533333333333335, "ram_util_percent": 79.20555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0146911621093, "policy_loss": 67842805.5, "vf_loss": 94991667609.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 865.5, "diff_num_grad_updates_vs_sampler_policy": 864.5}}, "num_env_steps_sampled": 5203680, "num_env_steps_trained": 5203680, "num_agent_steps_sampled": 5203680, "num_agent_steps_trained": 5203680}, "sampler_results": {"episode_reward_max": 692775.8887269107, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692101.7365591327, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3995102210242192, "mean_inference_ms": 0.24111061920913143, "mean_action_processing_ms": 0.05849985473774856, "mean_env_wait_ms": 0.9868125117532301, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002752227344732175, "StateBufferConnector_ms": 0.0019004975242176275, "ViewRequirementAgentConnector_ms": 0.045031788705409255}}, "episode_reward_max": 692775.8887269107, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692101.7365591327, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3995102210242192, "mean_inference_ms": 0.24111061920913143, "mean_action_processing_ms": 0.05849985473774856, "mean_env_wait_ms": 0.9868125117532301, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002752227344732175, "StateBufferConnector_ms": 0.0019004975242176275, "ViewRequirementAgentConnector_ms": 0.045031788705409255}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5203680, "num_agent_steps_trained": 5203680, "num_env_steps_sampled": 5203680, "num_env_steps_trained": 5203680, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 381.3010352461416, "num_env_steps_trained_throughput_per_sec": 381.3010352461416, "timesteps_total": 5203680, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5203680, "timers": {"training_iteration_time_ms": 3164.765, "sample_time_ms": 3152.108, "load_time_ms": 0.419, "load_throughput": 2863006.143, "learn_time_ms": 11.629, "learn_throughput": 103194.026, "synch_weights_time_ms": 0.573}, "counters": {"num_env_steps_sampled": 5203680, "num_env_steps_trained": 5203680, "num_agent_steps_sampled": 5203680, "num_agent_steps_trained": 5203680}, "done": false, "episodes_total": 1296, "training_iteration": 602, "trial_id": "f3e85_00000", "date": "2023-07-25_14-51-37", "timestamp": 1690285897, "time_this_iter_s": 12.590635061264038, "time_total_s": 10457.442803621292, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 277.8112599849701, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 23.733333333333334, "ram_util_percent": 79.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0147644042969, "policy_loss": -36051537.2, "vf_loss": 95144717926.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 905.5, "diff_num_grad_updates_vs_sampler_policy": 904.5}}, "num_env_steps_sampled": 5208480, "num_env_steps_trained": 5208480, "num_agent_steps_sampled": 5208480, "num_agent_steps_trained": 5208480}, "sampler_results": {"episode_reward_max": 692775.8887269107, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692102.7760061674, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3994624785410605, "mean_inference_ms": 0.24111185336320137, "mean_action_processing_ms": 0.05849594210557175, "mean_env_wait_ms": 0.9845779524432716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027606775472452352, "StateBufferConnector_ms": 0.0019081346281282195, "ViewRequirementAgentConnector_ms": 0.04522538447118068}}, "episode_reward_max": 692775.8887269107, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692102.7760061674, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3994624785410605, "mean_inference_ms": 0.24111185336320137, "mean_action_processing_ms": 0.05849594210557175, "mean_env_wait_ms": 0.9845779524432716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027606775472452352, "StateBufferConnector_ms": 0.0019081346281282195, "ViewRequirementAgentConnector_ms": 0.04522538447118068}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5208480, "num_agent_steps_trained": 5208480, "num_env_steps_sampled": 5208480, "num_env_steps_trained": 5208480, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 380.40890993855083, "num_env_steps_trained_throughput_per_sec": 380.40890993855083, "timesteps_total": 5208480, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5208480, "timers": {"training_iteration_time_ms": 3153.389, "sample_time_ms": 3140.774, "load_time_ms": 0.415, "load_throughput": 2894619.738, "learn_time_ms": 11.589, "learn_throughput": 103548.786, "synch_weights_time_ms": 0.576}, "counters": {"num_env_steps_sampled": 5208480, "num_env_steps_trained": 5208480, "num_agent_steps_sampled": 5208480, "num_agent_steps_trained": 5208480}, "done": false, "episodes_total": 1300, "training_iteration": 603, "trial_id": "f3e85_00000", "date": "2023-07-25_14-51-49", "timestamp": 1690285909, "time_this_iter_s": 12.62019395828247, "time_total_s": 10470.062997579575, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 290.43145394325256, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 25.261111111111113, "ram_util_percent": 79.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0150756835938, "policy_loss": 11665053.1, "vf_loss": 95054687027.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 5213280, "num_env_steps_trained": 5213280, "num_agent_steps_sampled": 5213280, "num_agent_steps_trained": 5213280}, "sampler_results": {"episode_reward_max": 692775.8887269107, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692104.1652568248, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3994162120993943, "mean_inference_ms": 0.2411211827213222, "mean_action_processing_ms": 0.05849266675695702, "mean_env_wait_ms": 0.9825237731154878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027408097919664883, "StateBufferConnector_ms": 0.0019013254266036185, "ViewRequirementAgentConnector_ms": 0.045184085243626645}}, "episode_reward_max": 692775.8887269107, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692104.1652568248, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3994162120993943, "mean_inference_ms": 0.2411211827213222, "mean_action_processing_ms": 0.05849266675695702, "mean_env_wait_ms": 0.9825237731154878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027408097919664883, "StateBufferConnector_ms": 0.0019013254266036185, "ViewRequirementAgentConnector_ms": 0.045184085243626645}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5213280, "num_agent_steps_trained": 5213280, "num_env_steps_sampled": 5213280, "num_env_steps_trained": 5213280, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 376.27707888615316, "num_env_steps_trained_throughput_per_sec": 376.27707888615316, "timesteps_total": 5213280, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5213280, "timers": {"training_iteration_time_ms": 3168.712, "sample_time_ms": 3156.459, "load_time_ms": 0.408, "load_throughput": 2938216.462, "learn_time_ms": 11.26, "learn_throughput": 106569.371, "synch_weights_time_ms": 0.551}, "counters": {"num_env_steps_sampled": 5213280, "num_env_steps_trained": 5213280, "num_agent_steps_sampled": 5213280, "num_agent_steps_trained": 5213280}, "done": false, "episodes_total": 1304, "training_iteration": 604, "trial_id": "f3e85_00000", "date": "2023-07-25_14-52-02", "timestamp": 1690285922, "time_this_iter_s": 12.75876498222351, "time_total_s": 10482.821762561798, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 303.1902189254761, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 24.672222222222224, "ram_util_percent": 79.1277777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0150756835938, "policy_loss": 1339667.4, "vf_loss": 95014756352.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 985.5, "diff_num_grad_updates_vs_sampler_policy": 984.5}}, "num_env_steps_sampled": 5218080, "num_env_steps_trained": 5218080, "num_agent_steps_sampled": 5218080, "num_agent_steps_trained": 5218080}, "sampler_results": {"episode_reward_max": 692775.8887269107, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692111.1645873096, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3993634350491801, "mean_inference_ms": 0.24113288148618844, "mean_action_processing_ms": 0.05848982662612278, "mean_env_wait_ms": 0.9806166692860363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027300131441366795, "StateBufferConnector_ms": 0.0019025320958609533, "ViewRequirementAgentConnector_ms": 0.04521066492254084}}, "episode_reward_max": 692775.8887269107, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692111.1645873096, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [691995.8495725603, 691988.2961855764, 692459.1949729929, 691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3993634350491801, "mean_inference_ms": 0.24113288148618844, "mean_action_processing_ms": 0.05848982662612278, "mean_env_wait_ms": 0.9806166692860363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027300131441366795, "StateBufferConnector_ms": 0.0019025320958609533, "ViewRequirementAgentConnector_ms": 0.04521066492254084}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5218080, "num_agent_steps_trained": 5218080, "num_env_steps_sampled": 5218080, "num_env_steps_trained": 5218080, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 378.3890326857126, "num_env_steps_trained_throughput_per_sec": 378.3890326857126, "timesteps_total": 5218080, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5218080, "timers": {"training_iteration_time_ms": 3174.491, "sample_time_ms": 3162.179, "load_time_ms": 0.416, "load_throughput": 2886485.519, "learn_time_ms": 11.305, "learn_throughput": 106146.842, "synch_weights_time_ms": 0.556}, "counters": {"num_env_steps_sampled": 5218080, "num_env_steps_trained": 5218080, "num_agent_steps_sampled": 5218080, "num_agent_steps_trained": 5218080}, "done": false, "episodes_total": 1308, "training_iteration": 605, "trial_id": "f3e85_00000", "date": "2023-07-25_14-52-15", "timestamp": 1690285935, "time_this_iter_s": 12.687449932098389, "time_total_s": 10495.509212493896, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 315.87766885757446, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 23.833333333333336, "ram_util_percent": 78.74444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0159912109375, "policy_loss": 46995520.0, "vf_loss": 95029350809.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1025.5, "diff_num_grad_updates_vs_sampler_policy": 1024.5}}, "num_env_steps_sampled": 5222880, "num_env_steps_trained": 5222880, "num_agent_steps_sampled": 5222880, "num_agent_steps_trained": 5222880}, "sampler_results": {"episode_reward_max": 692775.8887269107, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692113.4217828257, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3991640627386823, "mean_inference_ms": 0.24110592332712905, "mean_action_processing_ms": 0.05847406755537356, "mean_env_wait_ms": 0.9654584307447004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027420520782470703, "StateBufferConnector_ms": 0.0019009113311767578, "ViewRequirementAgentConnector_ms": 0.04521036148071289}}, "episode_reward_max": 692775.8887269107, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692113.4217828257, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [691971.8042493426, 691953.9429809812, 692017.4773763401, 692269.0489085552, 692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3991640627386823, "mean_inference_ms": 0.24110592332712905, "mean_action_processing_ms": 0.05847406755537356, "mean_env_wait_ms": 0.9654584307447004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027420520782470703, "StateBufferConnector_ms": 0.0019009113311767578, "ViewRequirementAgentConnector_ms": 0.04521036148071289}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5222880, "num_agent_steps_trained": 5222880, "num_env_steps_sampled": 5222880, "num_env_steps_trained": 5222880, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 379.06715553908526, "num_env_steps_trained_throughput_per_sec": 379.06715553908526, "timesteps_total": 5222880, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5222880, "timers": {"training_iteration_time_ms": 3175.167, "sample_time_ms": 3162.718, "load_time_ms": 0.417, "load_throughput": 2874944.194, "learn_time_ms": 11.428, "learn_throughput": 105005.045, "synch_weights_time_ms": 0.568}, "counters": {"num_env_steps_sampled": 5222880, "num_env_steps_trained": 5222880, "num_agent_steps_sampled": 5222880, "num_agent_steps_trained": 5222880}, "done": false, "episodes_total": 1312, "training_iteration": 606, "trial_id": "f3e85_00000", "date": "2023-07-25_14-52-27", "timestamp": 1690285947, "time_this_iter_s": 12.664663076400757, "time_total_s": 10508.173875570297, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 328.5423319339752, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 23.31666666666667, "ram_util_percent": 79.0611111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0166015625, "policy_loss": -35673300.1, "vf_loss": 95010457600.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1065.5, "diff_num_grad_updates_vs_sampler_policy": 1064.5}}, "num_env_steps_sampled": 5227680, "num_env_steps_trained": 5227680, "num_agent_steps_sampled": 5227680, "num_agent_steps_trained": 5227680}, "sampler_results": {"episode_reward_max": 692775.8887269107, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692113.7598547078, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3991614256135523, "mean_inference_ms": 0.24108303783017299, "mean_action_processing_ms": 0.058458873160883475, "mean_env_wait_ms": 0.9573360932264356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027456283569335938, "StateBufferConnector_ms": 0.0019049644470214844, "ViewRequirementAgentConnector_ms": 0.04518914222717285}}, "episode_reward_max": 692775.8887269107, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692113.7598547078, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692527.1379140471, 692123.9500393254, 692085.0280462996, 691838.3194861005, 692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3991614256135523, "mean_inference_ms": 0.24108303783017299, "mean_action_processing_ms": 0.058458873160883475, "mean_env_wait_ms": 0.9573360932264356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027456283569335938, "StateBufferConnector_ms": 0.0019049644470214844, "ViewRequirementAgentConnector_ms": 0.04518914222717285}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5227680, "num_agent_steps_trained": 5227680, "num_env_steps_sampled": 5227680, "num_env_steps_trained": 5227680, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 381.95306934736885, "num_env_steps_trained_throughput_per_sec": 381.95306934736885, "timesteps_total": 5227680, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5227680, "timers": {"training_iteration_time_ms": 3161.193, "sample_time_ms": 3148.439, "load_time_ms": 0.436, "load_throughput": 2750212.994, "learn_time_ms": 11.704, "learn_throughput": 102530.792, "synch_weights_time_ms": 0.577}, "counters": {"num_env_steps_sampled": 5227680, "num_env_steps_trained": 5227680, "num_agent_steps_sampled": 5227680, "num_agent_steps_trained": 5227680}, "done": false, "episodes_total": 1316, "training_iteration": 607, "trial_id": "f3e85_00000", "date": "2023-07-25_14-52-40", "timestamp": 1690285960, "time_this_iter_s": 12.569191932678223, "time_total_s": 10520.743067502975, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 341.11152386665344, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 27.42222222222222, "ram_util_percent": 78.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0177001953125, "policy_loss": 1411522.1, "vf_loss": 95004238233.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1105.5, "diff_num_grad_updates_vs_sampler_policy": 1104.5}}, "num_env_steps_sampled": 5232480, "num_env_steps_trained": 5232480, "num_agent_steps_sampled": 5232480, "num_agent_steps_trained": 5232480}, "sampler_results": {"episode_reward_max": 692775.8887269107, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692108.9871562065, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3991323864420895, "mean_inference_ms": 0.2410983986252191, "mean_action_processing_ms": 0.05845042848236165, "mean_env_wait_ms": 0.9524484549389556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027430057525634766, "StateBufferConnector_ms": 0.001905679702758789, "ViewRequirementAgentConnector_ms": 0.045226097106933594}}, "episode_reward_max": 692775.8887269107, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692108.9871562065, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692170.240831177, 692187.8668793766, 692272.0321046631, 691932.0324471485, 691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3991323864420895, "mean_inference_ms": 0.2410983986252191, "mean_action_processing_ms": 0.05845042848236165, "mean_env_wait_ms": 0.9524484549389556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027430057525634766, "StateBufferConnector_ms": 0.001905679702758789, "ViewRequirementAgentConnector_ms": 0.045226097106933594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5232480, "num_agent_steps_trained": 5232480, "num_env_steps_sampled": 5232480, "num_env_steps_trained": 5232480, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 380.3326259980122, "num_env_steps_trained_throughput_per_sec": 380.3326259980122, "timesteps_total": 5232480, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5232480, "timers": {"training_iteration_time_ms": 3151.405, "sample_time_ms": 3138.684, "load_time_ms": 0.443, "load_throughput": 2709498.708, "learn_time_ms": 11.658, "learn_throughput": 102931.705, "synch_weights_time_ms": 0.579}, "counters": {"num_env_steps_sampled": 5232480, "num_env_steps_trained": 5232480, "num_agent_steps_sampled": 5232480, "num_agent_steps_trained": 5232480}, "done": false, "episodes_total": 1320, "training_iteration": 608, "trial_id": "f3e85_00000", "date": "2023-07-25_14-52-53", "timestamp": 1690285973, "time_this_iter_s": 12.62273097038269, "time_total_s": 10533.365798473358, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 353.73425483703613, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 23.95294117647059, "ram_util_percent": 78.91764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0199096679687, "policy_loss": 76754439.6, "vf_loss": 94976791756.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1145.5, "diff_num_grad_updates_vs_sampler_policy": 1144.5}}, "num_env_steps_sampled": 5237280, "num_env_steps_trained": 5237280, "num_agent_steps_sampled": 5237280, "num_agent_steps_trained": 5237280}, "sampler_results": {"episode_reward_max": 692775.8887269107, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692102.088493035, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3991546448748835, "mean_inference_ms": 0.24111303928015218, "mean_action_processing_ms": 0.05844424911921898, "mean_env_wait_ms": 0.9489333343457617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027472972869873047, "StateBufferConnector_ms": 0.001905679702758789, "ViewRequirementAgentConnector_ms": 0.04522275924682617}}, "episode_reward_max": 692775.8887269107, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692102.088493035, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [691935.6344381572, 691959.8252512405, 691806.4425434617, 692008.8376004945, 691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3991546448748835, "mean_inference_ms": 0.24111303928015218, "mean_action_processing_ms": 0.05844424911921898, "mean_env_wait_ms": 0.9489333343457617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027472972869873047, "StateBufferConnector_ms": 0.001905679702758789, "ViewRequirementAgentConnector_ms": 0.04522275924682617}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5237280, "num_agent_steps_trained": 5237280, "num_env_steps_sampled": 5237280, "num_env_steps_trained": 5237280, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 378.8424724205519, "num_env_steps_trained_throughput_per_sec": 378.8424724205519, "timesteps_total": 5237280, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5237280, "timers": {"training_iteration_time_ms": 3155.788, "sample_time_ms": 3143.088, "load_time_ms": 0.444, "load_throughput": 2703386.4, "learn_time_ms": 11.641, "learn_throughput": 103084.124, "synch_weights_time_ms": 0.574}, "counters": {"num_env_steps_sampled": 5237280, "num_env_steps_trained": 5237280, "num_agent_steps_sampled": 5237280, "num_agent_steps_trained": 5237280}, "done": false, "episodes_total": 1324, "training_iteration": 609, "trial_id": "f3e85_00000", "date": "2023-07-25_14-53-05", "timestamp": 1690285985, "time_this_iter_s": 12.672399044036865, "time_total_s": 10546.038197517395, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 366.406653881073, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 22.944444444444443, "ram_util_percent": 78.71666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0199584960938, "policy_loss": -15800433.4, "vf_loss": 95002134937.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1185.5, "diff_num_grad_updates_vs_sampler_policy": 1184.5}}, "num_env_steps_sampled": 5242080, "num_env_steps_trained": 5242080, "num_agent_steps_sampled": 5242080, "num_agent_steps_trained": 5242080}, "sampler_results": {"episode_reward_max": 692775.8887269107, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692113.6614298846, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3991878904324375, "mean_inference_ms": 0.24112813086479654, "mean_action_processing_ms": 0.0584386719191083, "mean_env_wait_ms": 0.9461656887003795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027501583099365234, "StateBufferConnector_ms": 0.0019004344940185547, "ViewRequirementAgentConnector_ms": 0.04526185989379883}}, "episode_reward_max": 692775.8887269107, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692113.6614298846, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [691840.4215755708, 692012.5806544031, 692226.8388915875, 691452.0968307164, 691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3991878904324375, "mean_inference_ms": 0.24112813086479654, "mean_action_processing_ms": 0.0584386719191083, "mean_env_wait_ms": 0.9461656887003795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027501583099365234, "StateBufferConnector_ms": 0.0019004344940185547, "ViewRequirementAgentConnector_ms": 0.04526185989379883}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5242080, "num_agent_steps_trained": 5242080, "num_env_steps_sampled": 5242080, "num_env_steps_trained": 5242080, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 379.53037914714366, "num_env_steps_trained_throughput_per_sec": 379.53037914714366, "timesteps_total": 5242080, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5242080, "timers": {"training_iteration_time_ms": 3165.858, "sample_time_ms": 3153.42, "load_time_ms": 0.422, "load_throughput": 2840546.758, "learn_time_ms": 11.421, "learn_throughput": 105068.613, "synch_weights_time_ms": 0.554}, "counters": {"num_env_steps_sampled": 5242080, "num_env_steps_trained": 5242080, "num_agent_steps_sampled": 5242080, "num_agent_steps_trained": 5242080}, "done": false, "episodes_total": 1328, "training_iteration": 610, "trial_id": "f3e85_00000", "date": "2023-07-25_14-53-18", "timestamp": 1690285998, "time_this_iter_s": 12.649251699447632, "time_total_s": 10558.687449216843, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 379.05590558052063, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 22.91666666666667, "ram_util_percent": 78.79444444444442}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0199584960938, "policy_loss": -21971925.8, "vf_loss": 95103750553.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1225.5, "diff_num_grad_updates_vs_sampler_policy": 1224.5}}, "num_env_steps_sampled": 5246880, "num_env_steps_trained": 5246880, "num_agent_steps_sampled": 5246880, "num_agent_steps_trained": 5246880}, "sampler_results": {"episode_reward_max": 692775.8887269107, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692130.7875702323, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452, 692227.8228232132, 692140.3858421975, 692443.1460952075, 692433.1972264306], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3991252850303135, "mean_inference_ms": 0.24112929751360504, "mean_action_processing_ms": 0.05843311124562796, "mean_env_wait_ms": 0.9439728765589376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027565956115722656, "StateBufferConnector_ms": 0.0018973350524902344, "ViewRequirementAgentConnector_ms": 0.045272111892700195}}, "episode_reward_max": 692775.8887269107, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692130.7875702323, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [691973.0315765619, 692007.9493832758, 692074.6512009262, 691940.5532753989, 692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452, 692227.8228232132, 692140.3858421975, 692443.1460952075, 692433.1972264306], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3991252850303135, "mean_inference_ms": 0.24112929751360504, "mean_action_processing_ms": 0.05843311124562796, "mean_env_wait_ms": 0.9439728765589376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027565956115722656, "StateBufferConnector_ms": 0.0018973350524902344, "ViewRequirementAgentConnector_ms": 0.045272111892700195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5246880, "num_agent_steps_trained": 5246880, "num_env_steps_sampled": 5246880, "num_env_steps_trained": 5246880, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 379.8121330948536, "num_env_steps_trained_throughput_per_sec": 379.8121330948536, "timesteps_total": 5246880, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5246880, "timers": {"training_iteration_time_ms": 3164.178, "sample_time_ms": 3151.807, "load_time_ms": 0.436, "load_throughput": 2752468.993, "learn_time_ms": 11.344, "learn_throughput": 105786.093, "synch_weights_time_ms": 0.554}, "counters": {"num_env_steps_sampled": 5246880, "num_env_steps_trained": 5246880, "num_agent_steps_sampled": 5246880, "num_agent_steps_trained": 5246880}, "done": false, "episodes_total": 1332, "training_iteration": 611, "trial_id": "f3e85_00000", "date": "2023-07-25_14-53-31", "timestamp": 1690286011, "time_this_iter_s": 12.639992237091064, "time_total_s": 10571.327441453934, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 391.6958978176117, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 26.194444444444443, "ram_util_percent": 78.86111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0199584960938, "policy_loss": -16045690.4, "vf_loss": 95159164928.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1265.5, "diff_num_grad_updates_vs_sampler_policy": 1264.5}}, "num_env_steps_sampled": 5251680, "num_env_steps_trained": 5251680, "num_agent_steps_sampled": 5251680, "num_agent_steps_trained": 5251680}, "sampler_results": {"episode_reward_max": 692775.8887269107, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692140.7533302405, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452, 692227.8228232132, 692140.3858421975, 692443.1460952075, 692433.1972264306, 692099.4329785105, 692288.44498466, 692182.4893940524, 692422.394079768], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.399115873607596, "mean_inference_ms": 0.24111985595935514, "mean_action_processing_ms": 0.058430479460350536, "mean_env_wait_ms": 0.9421517519720131, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00275421142578125, "StateBufferConnector_ms": 0.0018947124481201172, "ViewRequirementAgentConnector_ms": 0.04528188705444336}}, "episode_reward_max": 692775.8887269107, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692140.7533302405, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692393.7422861527, 692296.4582269337, 691900.7877243859, 691846.988435168, 692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452, 692227.8228232132, 692140.3858421975, 692443.1460952075, 692433.1972264306, 692099.4329785105, 692288.44498466, 692182.4893940524, 692422.394079768], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.399115873607596, "mean_inference_ms": 0.24111985595935514, "mean_action_processing_ms": 0.058430479460350536, "mean_env_wait_ms": 0.9421517519720131, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00275421142578125, "StateBufferConnector_ms": 0.0018947124481201172, "ViewRequirementAgentConnector_ms": 0.04528188705444336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5251680, "num_agent_steps_trained": 5251680, "num_env_steps_sampled": 5251680, "num_env_steps_trained": 5251680, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 378.13175559462, "num_env_steps_trained_throughput_per_sec": 378.13175559462, "timesteps_total": 5251680, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5251680, "timers": {"training_iteration_time_ms": 3167.519, "sample_time_ms": 3154.846, "load_time_ms": 0.434, "load_throughput": 2762439.517, "learn_time_ms": 11.632, "learn_throughput": 103160.397, "synch_weights_time_ms": 0.569}, "counters": {"num_env_steps_sampled": 5251680, "num_env_steps_trained": 5251680, "num_agent_steps_sampled": 5251680, "num_agent_steps_trained": 5251680}, "done": false, "episodes_total": 1336, "training_iteration": 612, "trial_id": "f3e85_00000", "date": "2023-07-25_14-53-43", "timestamp": 1690286023, "time_this_iter_s": 12.696115016937256, "time_total_s": 10584.023556470871, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 404.39201283454895, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 22.84444444444444, "ram_util_percent": 78.59444444444443}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0199584960938, "policy_loss": 128406451.6, "vf_loss": 95140852121.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1305.5, "diff_num_grad_updates_vs_sampler_policy": 1304.5}}, "num_env_steps_sampled": 5256480, "num_env_steps_trained": 5256480, "num_agent_steps_sampled": 5256480, "num_agent_steps_trained": 5256480}, "sampler_results": {"episode_reward_max": 692775.8887269107, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692141.1455214113, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452, 692227.8228232132, 692140.3858421975, 692443.1460952075, 692433.1972264306, 692099.4329785105, 692288.44498466, 692182.4893940524, 692422.394079768, 692144.4641350291, 691888.1846243031, 691899.0711419258, 692545.4758884523], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3991216143183614, "mean_inference_ms": 0.24109863273782145, "mean_action_processing_ms": 0.05842290781384624, "mean_env_wait_ms": 0.9406456348982914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027256011962890625, "StateBufferConnector_ms": 0.0018885135650634766, "ViewRequirementAgentConnector_ms": 0.045081377029418945}}, "episode_reward_max": 692775.8887269107, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692141.1455214113, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692109.6717667655, 692238.9967620998, 691950.1410050198, 692134.0329853469, 691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452, 692227.8228232132, 692140.3858421975, 692443.1460952075, 692433.1972264306, 692099.4329785105, 692288.44498466, 692182.4893940524, 692422.394079768, 692144.4641350291, 691888.1846243031, 691899.0711419258, 692545.4758884523], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3991216143183614, "mean_inference_ms": 0.24109863273782145, "mean_action_processing_ms": 0.05842290781384624, "mean_env_wait_ms": 0.9406456348982914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027256011962890625, "StateBufferConnector_ms": 0.0018885135650634766, "ViewRequirementAgentConnector_ms": 0.045081377029418945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5256480, "num_agent_steps_trained": 5256480, "num_env_steps_sampled": 5256480, "num_env_steps_trained": 5256480, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 379.1787293800066, "num_env_steps_trained_throughput_per_sec": 379.1787293800066, "timesteps_total": 5256480, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5256480, "timers": {"training_iteration_time_ms": 3166.158, "sample_time_ms": 3153.493, "load_time_ms": 0.429, "load_throughput": 2795581.426, "learn_time_ms": 11.635, "learn_throughput": 103141.371, "synch_weights_time_ms": 0.566}, "counters": {"num_env_steps_sampled": 5256480, "num_env_steps_trained": 5256480, "num_agent_steps_sampled": 5256480, "num_agent_steps_trained": 5256480}, "done": false, "episodes_total": 1340, "training_iteration": 613, "trial_id": "f3e85_00000", "date": "2023-07-25_14-53-56", "timestamp": 1690286036, "time_this_iter_s": 12.661059856414795, "time_total_s": 10596.684616327286, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 417.05307269096375, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 22.544444444444444, "ram_util_percent": 78.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0199584960938, "policy_loss": 28156958.4, "vf_loss": 95054454374.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1345.5, "diff_num_grad_updates_vs_sampler_policy": 1344.5}}, "num_env_steps_sampled": 5261280, "num_env_steps_trained": 5261280, "num_agent_steps_sampled": 5261280, "num_agent_steps_trained": 5261280}, "sampler_results": {"episode_reward_max": 692775.8887269107, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692140.0855332454, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452, 692227.8228232132, 692140.3858421975, 692443.1460952075, 692433.1972264306, 692099.4329785105, 692288.44498466, 692182.4893940524, 692422.394079768, 692144.4641350291, 691888.1846243031, 691899.0711419258, 692545.4758884523, 692458.089775554, 691676.9159433729, 692079.890121774, 692111.9478619553], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3991339697677876, "mean_inference_ms": 0.24107562227696758, "mean_action_processing_ms": 0.05841514087743494, "mean_env_wait_ms": 0.9393127447886525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027229785919189453, "StateBufferConnector_ms": 0.0018916130065917969, "ViewRequirementAgentConnector_ms": 0.04509544372558594}}, "episode_reward_max": 692775.8887269107, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692140.0855332454, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [691943.5342513095, 692262.5273291377, 691630.7516814856, 691956.5676025216, 692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452, 692227.8228232132, 692140.3858421975, 692443.1460952075, 692433.1972264306, 692099.4329785105, 692288.44498466, 692182.4893940524, 692422.394079768, 692144.4641350291, 691888.1846243031, 691899.0711419258, 692545.4758884523, 692458.089775554, 691676.9159433729, 692079.890121774, 692111.9478619553], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3991339697677876, "mean_inference_ms": 0.24107562227696758, "mean_action_processing_ms": 0.05841514087743494, "mean_env_wait_ms": 0.9393127447886525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027229785919189453, "StateBufferConnector_ms": 0.0018916130065917969, "ViewRequirementAgentConnector_ms": 0.04509544372558594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5261280, "num_agent_steps_trained": 5261280, "num_env_steps_sampled": 5261280, "num_env_steps_trained": 5261280, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 377.8508856139131, "num_env_steps_trained_throughput_per_sec": 377.8508856139131, "timesteps_total": 5261280, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5261280, "timers": {"training_iteration_time_ms": 3171.331, "sample_time_ms": 3158.736, "load_time_ms": 0.412, "load_throughput": 2910184.909, "learn_time_ms": 11.588, "learn_throughput": 103556.669, "synch_weights_time_ms": 0.559}, "counters": {"num_env_steps_sampled": 5261280, "num_env_steps_trained": 5261280, "num_agent_steps_sampled": 5261280, "num_agent_steps_trained": 5261280}, "done": false, "episodes_total": 1344, "training_iteration": 614, "trial_id": "f3e85_00000", "date": "2023-07-25_14-54-09", "timestamp": 1690286049, "time_this_iter_s": 12.705514907836914, "time_total_s": 10609.390131235123, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 429.75858759880066, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 25.0, "ram_util_percent": 78.65000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0206848144531, "policy_loss": -12042357.6, "vf_loss": 94956853657.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1385.5, "diff_num_grad_updates_vs_sampler_policy": 1384.5}}, "num_env_steps_sampled": 5266080, "num_env_steps_trained": 5266080, "num_agent_steps_sampled": 5266080, "num_agent_steps_trained": 5266080}, "sampler_results": {"episode_reward_max": 692775.8887269107, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692143.3814983837, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452, 692227.8228232132, 692140.3858421975, 692443.1460952075, 692433.1972264306, 692099.4329785105, 692288.44498466, 692182.4893940524, 692422.394079768, 692144.4641350291, 691888.1846243031, 691899.0711419258, 692545.4758884523, 692458.089775554, 691676.9159433729, 692079.890121774, 692111.9478619553, 691669.4556962688, 692199.7184176765, 692392.9363950219, 691860.8668693084], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3990178887725186, "mean_inference_ms": 0.24106192828718176, "mean_action_processing_ms": 0.05840884803673118, "mean_env_wait_ms": 0.9381808131178511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027191638946533203, "StateBufferConnector_ms": 0.0018908977508544922, "ViewRequirementAgentConnector_ms": 0.04506039619445801}}, "episode_reward_max": 692775.8887269107, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692143.3814983837, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692308.5416458809, 692125.4676942013, 692399.389362083, 692298.2462563447, 692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452, 692227.8228232132, 692140.3858421975, 692443.1460952075, 692433.1972264306, 692099.4329785105, 692288.44498466, 692182.4893940524, 692422.394079768, 692144.4641350291, 691888.1846243031, 691899.0711419258, 692545.4758884523, 692458.089775554, 691676.9159433729, 692079.890121774, 692111.9478619553, 691669.4556962688, 692199.7184176765, 692392.9363950219, 691860.8668693084], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3990178887725186, "mean_inference_ms": 0.24106192828718176, "mean_action_processing_ms": 0.05840884803673118, "mean_env_wait_ms": 0.9381808131178511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027191638946533203, "StateBufferConnector_ms": 0.0018908977508544922, "ViewRequirementAgentConnector_ms": 0.04506039619445801}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5266080, "num_agent_steps_trained": 5266080, "num_env_steps_sampled": 5266080, "num_env_steps_trained": 5266080, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 378.73458743953535, "num_env_steps_trained_throughput_per_sec": 378.73458743953535, "timesteps_total": 5266080, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5266080, "timers": {"training_iteration_time_ms": 3172.105, "sample_time_ms": 3159.545, "load_time_ms": 0.417, "load_throughput": 2874779.986, "learn_time_ms": 11.559, "learn_throughput": 103815.551, "synch_weights_time_ms": 0.548}, "counters": {"num_env_steps_sampled": 5266080, "num_env_steps_trained": 5266080, "num_agent_steps_sampled": 5266080, "num_agent_steps_trained": 5266080}, "done": false, "episodes_total": 1348, "training_iteration": 615, "trial_id": "f3e85_00000", "date": "2023-07-25_14-54-21", "timestamp": 1690286061, "time_this_iter_s": 12.675818920135498, "time_total_s": 10622.065950155258, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 442.43440651893616, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 35.1, "ram_util_percent": 78.68888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0220031738281, "policy_loss": 8983573.85, "vf_loss": 95045754880.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1425.5, "diff_num_grad_updates_vs_sampler_policy": 1424.5}}, "num_env_steps_sampled": 5270880, "num_env_steps_trained": 5270880, "num_agent_steps_sampled": 5270880, "num_agent_steps_trained": 5270880}, "sampler_results": {"episode_reward_max": 692775.8887269107, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692136.9217385827, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452, 692227.8228232132, 692140.3858421975, 692443.1460952075, 692433.1972264306, 692099.4329785105, 692288.44498466, 692182.4893940524, 692422.394079768, 692144.4641350291, 691888.1846243031, 691899.0711419258, 692545.4758884523, 692458.089775554, 691676.9159433729, 692079.890121774, 692111.9478619553, 691669.4556962688, 692199.7184176765, 692392.9363950219, 691860.8668693084, 692285.6803109256, 692223.3993270368, 691896.5117780381, 692080.0775624138], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3989010653156913, "mean_inference_ms": 0.24104969088393005, "mean_action_processing_ms": 0.05840239951911295, "mean_env_wait_ms": 0.9371427038428812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027008056640625, "StateBufferConnector_ms": 0.0018870830535888672, "ViewRequirementAgentConnector_ms": 0.044933319091796875}}, "episode_reward_max": 692775.8887269107, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692136.9217385827, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692544.3846333754, 692279.2274319767, 692132.1673754875, 691898.4845403666, 692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452, 692227.8228232132, 692140.3858421975, 692443.1460952075, 692433.1972264306, 692099.4329785105, 692288.44498466, 692182.4893940524, 692422.394079768, 692144.4641350291, 691888.1846243031, 691899.0711419258, 692545.4758884523, 692458.089775554, 691676.9159433729, 692079.890121774, 692111.9478619553, 691669.4556962688, 692199.7184176765, 692392.9363950219, 691860.8668693084, 692285.6803109256, 692223.3993270368, 691896.5117780381, 692080.0775624138], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3989010653156913, "mean_inference_ms": 0.24104969088393005, "mean_action_processing_ms": 0.05840239951911295, "mean_env_wait_ms": 0.9371427038428812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027008056640625, "StateBufferConnector_ms": 0.0018870830535888672, "ViewRequirementAgentConnector_ms": 0.044933319091796875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5270880, "num_agent_steps_trained": 5270880, "num_env_steps_sampled": 5270880, "num_env_steps_trained": 5270880, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 379.0053498584697, "num_env_steps_trained_throughput_per_sec": 379.0053498584697, "timesteps_total": 5270880, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5270880, "timers": {"training_iteration_time_ms": 3169.141, "sample_time_ms": 3156.608, "load_time_ms": 0.419, "load_throughput": 2861215.849, "learn_time_ms": 11.539, "learn_throughput": 103993.157, "synch_weights_time_ms": 0.538}, "counters": {"num_env_steps_sampled": 5270880, "num_env_steps_trained": 5270880, "num_agent_steps_sampled": 5270880, "num_agent_steps_trained": 5270880}, "done": false, "episodes_total": 1352, "training_iteration": 616, "trial_id": "f3e85_00000", "date": "2023-07-25_14-54-34", "timestamp": 1690286074, "time_this_iter_s": 12.667006969451904, "time_total_s": 10634.73295712471, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 455.10141348838806, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 23.288888888888888, "ram_util_percent": 79.14444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0223693847656, "policy_loss": 58542789.6, "vf_loss": 95179168563.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1465.5, "diff_num_grad_updates_vs_sampler_policy": 1464.5}}, "num_env_steps_sampled": 5275680, "num_env_steps_trained": 5275680, "num_agent_steps_sampled": 5275680, "num_agent_steps_trained": 5275680}, "sampler_results": {"episode_reward_max": 692775.8887269107, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692136.9368015191, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452, 692227.8228232132, 692140.3858421975, 692443.1460952075, 692433.1972264306, 692099.4329785105, 692288.44498466, 692182.4893940524, 692422.394079768, 692144.4641350291, 691888.1846243031, 691899.0711419258, 692545.4758884523, 692458.089775554, 691676.9159433729, 692079.890121774, 692111.9478619553, 691669.4556962688, 692199.7184176765, 692392.9363950219, 691860.8668693084, 692285.6803109256, 692223.3993270368, 691896.5117780381, 692080.0775624138, 692140.1412790724, 691900.1892512202, 692196.0848121945, 692619.3549323474], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3987612553773392, "mean_inference_ms": 0.24103750172481, "mean_action_processing_ms": 0.05839630861184149, "mean_env_wait_ms": 0.9362224156995441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027043819427490234, "StateBufferConnector_ms": 0.0018877983093261719, "ViewRequirementAgentConnector_ms": 0.04493141174316406}}, "episode_reward_max": 692775.8887269107, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692136.9368015191, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692344.8269963553, 691915.7420821342, 692258.840367332, 691939.0811640458, 691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452, 692227.8228232132, 692140.3858421975, 692443.1460952075, 692433.1972264306, 692099.4329785105, 692288.44498466, 692182.4893940524, 692422.394079768, 692144.4641350291, 691888.1846243031, 691899.0711419258, 692545.4758884523, 692458.089775554, 691676.9159433729, 692079.890121774, 692111.9478619553, 691669.4556962688, 692199.7184176765, 692392.9363950219, 691860.8668693084, 692285.6803109256, 692223.3993270368, 691896.5117780381, 692080.0775624138, 692140.1412790724, 691900.1892512202, 692196.0848121945, 692619.3549323474], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3987612553773392, "mean_inference_ms": 0.24103750172481, "mean_action_processing_ms": 0.05839630861184149, "mean_env_wait_ms": 0.9362224156995441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027043819427490234, "StateBufferConnector_ms": 0.0018877983093261719, "ViewRequirementAgentConnector_ms": 0.04493141174316406}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5275680, "num_agent_steps_trained": 5275680, "num_env_steps_sampled": 5275680, "num_env_steps_trained": 5275680, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 378.02663862666583, "num_env_steps_trained_throughput_per_sec": 378.02663862666583, "timesteps_total": 5275680, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5275680, "timers": {"training_iteration_time_ms": 3171.34, "sample_time_ms": 3158.774, "load_time_ms": 0.42, "load_throughput": 2856506.697, "learn_time_ms": 11.562, "learn_throughput": 103786.651, "synch_weights_time_ms": 0.548}, "counters": {"num_env_steps_sampled": 5275680, "num_env_steps_trained": 5275680, "num_agent_steps_sampled": 5275680, "num_agent_steps_trained": 5275680}, "done": false, "episodes_total": 1356, "training_iteration": 617, "trial_id": "f3e85_00000", "date": "2023-07-25_14-54-47", "timestamp": 1690286087, "time_this_iter_s": 12.699641942977905, "time_total_s": 10647.432599067688, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 467.80105543136597, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 23.166666666666668, "ram_util_percent": 78.6888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0228881835938, "policy_loss": 54220577.6, "vf_loss": 95059328204.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1505.5, "diff_num_grad_updates_vs_sampler_policy": 1504.5}}, "num_env_steps_sampled": 5280480, "num_env_steps_trained": 5280480, "num_agent_steps_sampled": 5280480, "num_agent_steps_trained": 5280480}, "sampler_results": {"episode_reward_max": 692775.8887269107, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692139.087698885, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452, 692227.8228232132, 692140.3858421975, 692443.1460952075, 692433.1972264306, 692099.4329785105, 692288.44498466, 692182.4893940524, 692422.394079768, 692144.4641350291, 691888.1846243031, 691899.0711419258, 692545.4758884523, 692458.089775554, 691676.9159433729, 692079.890121774, 692111.9478619553, 691669.4556962688, 692199.7184176765, 692392.9363950219, 691860.8668693084, 692285.6803109256, 692223.3993270368, 691896.5117780381, 692080.0775624138, 692140.1412790724, 691900.1892512202, 692196.0848121945, 692619.3549323474, 692152.9896431612, 692146.0627366151, 692104.8538852198, 692269.6740814747], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3985862252568015, "mean_inference_ms": 0.24103044418802358, "mean_action_processing_ms": 0.05839057445585061, "mean_env_wait_ms": 0.9354007404281189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027015209197998047, "StateBufferConnector_ms": 0.001878499984741211, "ViewRequirementAgentConnector_ms": 0.04491424560546875}}, "episode_reward_max": 692775.8887269107, "episode_reward_min": 691380.7950247736, "episode_reward_mean": 692139.087698885, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [691380.7950247736, 692222.1534339783, 692148.8249597154, 692125.9577645559, 692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452, 692227.8228232132, 692140.3858421975, 692443.1460952075, 692433.1972264306, 692099.4329785105, 692288.44498466, 692182.4893940524, 692422.394079768, 692144.4641350291, 691888.1846243031, 691899.0711419258, 692545.4758884523, 692458.089775554, 691676.9159433729, 692079.890121774, 692111.9478619553, 691669.4556962688, 692199.7184176765, 692392.9363950219, 691860.8668693084, 692285.6803109256, 692223.3993270368, 691896.5117780381, 692080.0775624138, 692140.1412790724, 691900.1892512202, 692196.0848121945, 692619.3549323474, 692152.9896431612, 692146.0627366151, 692104.8538852198, 692269.6740814747], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3985862252568015, "mean_inference_ms": 0.24103044418802358, "mean_action_processing_ms": 0.05839057445585061, "mean_env_wait_ms": 0.9354007404281189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027015209197998047, "StateBufferConnector_ms": 0.001878499984741211, "ViewRequirementAgentConnector_ms": 0.04491424560546875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5280480, "num_agent_steps_trained": 5280480, "num_env_steps_sampled": 5280480, "num_env_steps_trained": 5280480, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 379.52461969417186, "num_env_steps_trained_throughput_per_sec": 379.52461969417186, "timesteps_total": 5280480, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5280480, "timers": {"training_iteration_time_ms": 3171.455, "sample_time_ms": 3158.944, "load_time_ms": 0.417, "load_throughput": 2880703.297, "learn_time_ms": 11.505, "learn_throughput": 104306.082, "synch_weights_time_ms": 0.554}, "counters": {"num_env_steps_sampled": 5280480, "num_env_steps_trained": 5280480, "num_agent_steps_sampled": 5280480, "num_agent_steps_trained": 5280480}, "done": false, "episodes_total": 1360, "training_iteration": 618, "trial_id": "f3e85_00000", "date": "2023-07-25_14-55-00", "timestamp": 1690286100, "time_this_iter_s": 12.649471998214722, "time_total_s": 10660.082071065903, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 480.4505274295807, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 26.505555555555556, "ram_util_percent": 78.90555555555557}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0228942871094, "policy_loss": -45245416.8, "vf_loss": 95034924236.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1545.5, "diff_num_grad_updates_vs_sampler_policy": 1544.5}}, "num_env_steps_sampled": 5285280, "num_env_steps_trained": 5285280, "num_agent_steps_sampled": 5285280, "num_agent_steps_trained": 5285280}, "sampler_results": {"episode_reward_max": 692775.8887269107, "episode_reward_min": 691548.4862699892, "episode_reward_mean": 692142.1516418234, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452, 692227.8228232132, 692140.3858421975, 692443.1460952075, 692433.1972264306, 692099.4329785105, 692288.44498466, 692182.4893940524, 692422.394079768, 692144.4641350291, 691888.1846243031, 691899.0711419258, 692545.4758884523, 692458.089775554, 691676.9159433729, 692079.890121774, 692111.9478619553, 691669.4556962688, 692199.7184176765, 692392.9363950219, 691860.8668693084, 692285.6803109256, 692223.3993270368, 691896.5117780381, 692080.0775624138, 692140.1412790724, 691900.1892512202, 692196.0848121945, 692619.3549323474, 692152.9896431612, 692146.0627366151, 692104.8538852198, 692269.6740814747, 692376.1612923285, 691981.4098184285, 691780.7576601236, 692045.7967059696], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3984405424840087, "mean_inference_ms": 0.24102805764380564, "mean_action_processing_ms": 0.05838603305187141, "mean_env_wait_ms": 0.934673635847042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026998519897460938, "StateBufferConnector_ms": 0.0018837451934814453, "ViewRequirementAgentConnector_ms": 0.04489278793334961}}, "episode_reward_max": 692775.8887269107, "episode_reward_min": 691548.4862699892, "episode_reward_mean": 692142.1516418234, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692135.0502537262, 692254.2827020298, 692194.6510775356, 692410.7834092714, 692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452, 692227.8228232132, 692140.3858421975, 692443.1460952075, 692433.1972264306, 692099.4329785105, 692288.44498466, 692182.4893940524, 692422.394079768, 692144.4641350291, 691888.1846243031, 691899.0711419258, 692545.4758884523, 692458.089775554, 691676.9159433729, 692079.890121774, 692111.9478619553, 691669.4556962688, 692199.7184176765, 692392.9363950219, 691860.8668693084, 692285.6803109256, 692223.3993270368, 691896.5117780381, 692080.0775624138, 692140.1412790724, 691900.1892512202, 692196.0848121945, 692619.3549323474, 692152.9896431612, 692146.0627366151, 692104.8538852198, 692269.6740814747, 692376.1612923285, 691981.4098184285, 691780.7576601236, 692045.7967059696], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3984405424840087, "mean_inference_ms": 0.24102805764380564, "mean_action_processing_ms": 0.05838603305187141, "mean_env_wait_ms": 0.934673635847042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026998519897460938, "StateBufferConnector_ms": 0.0018837451934814453, "ViewRequirementAgentConnector_ms": 0.04489278793334961}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5285280, "num_agent_steps_trained": 5285280, "num_env_steps_sampled": 5285280, "num_env_steps_trained": 5285280, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 379.15292191302564, "num_env_steps_trained_throughput_per_sec": 379.15292191302564, "timesteps_total": 5285280, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5285280, "timers": {"training_iteration_time_ms": 3158.823, "sample_time_ms": 3146.199, "load_time_ms": 0.42, "load_throughput": 2855534.324, "learn_time_ms": 11.581, "learn_throughput": 103616.362, "synch_weights_time_ms": 0.586}, "counters": {"num_env_steps_sampled": 5285280, "num_env_steps_trained": 5285280, "num_agent_steps_sampled": 5285280, "num_agent_steps_trained": 5285280}, "done": false, "episodes_total": 1364, "training_iteration": 619, "trial_id": "f3e85_00000", "date": "2023-07-25_14-55-12", "timestamp": 1690286112, "time_this_iter_s": 12.662554264068604, "time_total_s": 10672.744625329971, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 493.1130816936493, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 24.55, "ram_util_percent": 79.82777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0235595703125, "policy_loss": 6318022.7, "vf_loss": 95031210393.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1585.5, "diff_num_grad_updates_vs_sampler_policy": 1584.5}}, "num_env_steps_sampled": 5290080, "num_env_steps_trained": 5290080, "num_agent_steps_sampled": 5290080, "num_agent_steps_trained": 5290080}, "sampler_results": {"episode_reward_max": 692775.8887269107, "episode_reward_min": 691548.4862699892, "episode_reward_mean": 692142.7585786687, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452, 692227.8228232132, 692140.3858421975, 692443.1460952075, 692433.1972264306, 692099.4329785105, 692288.44498466, 692182.4893940524, 692422.394079768, 692144.4641350291, 691888.1846243031, 691899.0711419258, 692545.4758884523, 692458.089775554, 691676.9159433729, 692079.890121774, 692111.9478619553, 691669.4556962688, 692199.7184176765, 692392.9363950219, 691860.8668693084, 692285.6803109256, 692223.3993270368, 691896.5117780381, 692080.0775624138, 692140.1412790724, 691900.1892512202, 692196.0848121945, 692619.3549323474, 692152.9896431612, 692146.0627366151, 692104.8538852198, 692269.6740814747, 692376.1612923285, 691981.4098184285, 691780.7576601236, 692045.7967059696, 692378.7955097074, 692121.8904206526, 692410.559728587, 692144.2154681421], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.398262376402833, "mean_inference_ms": 0.24102196499736242, "mean_action_processing_ms": 0.0583812013557049, "mean_env_wait_ms": 0.9340106550725273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026941299438476562, "StateBufferConnector_ms": 0.0018858909606933594, "ViewRequirementAgentConnector_ms": 0.04485774040222168}}, "episode_reward_max": 692775.8887269107, "episode_reward_min": 691548.4862699892, "episode_reward_mean": 692142.7585786687, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692241.4075046532, 692301.0410513564, 692242.0913659843, 692172.7724543381, 692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452, 692227.8228232132, 692140.3858421975, 692443.1460952075, 692433.1972264306, 692099.4329785105, 692288.44498466, 692182.4893940524, 692422.394079768, 692144.4641350291, 691888.1846243031, 691899.0711419258, 692545.4758884523, 692458.089775554, 691676.9159433729, 692079.890121774, 692111.9478619553, 691669.4556962688, 692199.7184176765, 692392.9363950219, 691860.8668693084, 692285.6803109256, 692223.3993270368, 691896.5117780381, 692080.0775624138, 692140.1412790724, 691900.1892512202, 692196.0848121945, 692619.3549323474, 692152.9896431612, 692146.0627366151, 692104.8538852198, 692269.6740814747, 692376.1612923285, 691981.4098184285, 691780.7576601236, 692045.7967059696, 692378.7955097074, 692121.8904206526, 692410.559728587, 692144.2154681421], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.398262376402833, "mean_inference_ms": 0.24102196499736242, "mean_action_processing_ms": 0.0583812013557049, "mean_env_wait_ms": 0.9340106550725273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026941299438476562, "StateBufferConnector_ms": 0.0018858909606933594, "ViewRequirementAgentConnector_ms": 0.04485774040222168}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5290080, "num_agent_steps_trained": 5290080, "num_env_steps_sampled": 5290080, "num_env_steps_trained": 5290080, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 383.14649843789937, "num_env_steps_trained_throughput_per_sec": 383.14649843789937, "timesteps_total": 5290080, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5290080, "timers": {"training_iteration_time_ms": 3145.55, "sample_time_ms": 3133.005, "load_time_ms": 0.416, "load_throughput": 2887313.447, "learn_time_ms": 11.516, "learn_throughput": 104204.585, "synch_weights_time_ms": 0.577}, "counters": {"num_env_steps_sampled": 5290080, "num_env_steps_trained": 5290080, "num_agent_steps_sampled": 5290080, "num_agent_steps_trained": 5290080}, "done": false, "episodes_total": 1368, "training_iteration": 620, "trial_id": "f3e85_00000", "date": "2023-07-25_14-55-25", "timestamp": 1690286125, "time_this_iter_s": 12.52991795539856, "time_total_s": 10685.27454328537, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 505.64299964904785, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 22.383333333333333, "ram_util_percent": 79.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0235595703125, "policy_loss": -16188658.4, "vf_loss": 95158336307.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1625.5, "diff_num_grad_updates_vs_sampler_policy": 1624.5}}, "num_env_steps_sampled": 5294880, "num_env_steps_trained": 5294880, "num_agent_steps_sampled": 5294880, "num_agent_steps_trained": 5294880}, "sampler_results": {"episode_reward_max": 692775.8887269107, "episode_reward_min": 691548.4862699892, "episode_reward_mean": 692141.142541061, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452, 692227.8228232132, 692140.3858421975, 692443.1460952075, 692433.1972264306, 692099.4329785105, 692288.44498466, 692182.4893940524, 692422.394079768, 692144.4641350291, 691888.1846243031, 691899.0711419258, 692545.4758884523, 692458.089775554, 691676.9159433729, 692079.890121774, 692111.9478619553, 691669.4556962688, 692199.7184176765, 692392.9363950219, 691860.8668693084, 692285.6803109256, 692223.3993270368, 691896.5117780381, 692080.0775624138, 692140.1412790724, 691900.1892512202, 692196.0848121945, 692619.3549323474, 692152.9896431612, 692146.0627366151, 692104.8538852198, 692269.6740814747, 692376.1612923285, 691981.4098184285, 691780.7576601236, 692045.7967059696, 692378.7955097074, 692121.8904206526, 692410.559728587, 692144.2154681421, 691889.7306185246, 692223.3765616196, 692137.5862679753, 692545.0151674481], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3980886855227552, "mean_inference_ms": 0.24101359476620082, "mean_action_processing_ms": 0.05837621975061303, "mean_env_wait_ms": 0.9334212594036404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002690553665161133, "StateBufferConnector_ms": 0.0018715858459472656, "ViewRequirementAgentConnector_ms": 0.04482245445251465}}, "episode_reward_max": 692775.8887269107, "episode_reward_min": 691548.4862699892, "episode_reward_mean": 692141.142541061, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692090.4847271512, 692278.6932179887, 691923.9764205564, 692061.6849407133, 692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452, 692227.8228232132, 692140.3858421975, 692443.1460952075, 692433.1972264306, 692099.4329785105, 692288.44498466, 692182.4893940524, 692422.394079768, 692144.4641350291, 691888.1846243031, 691899.0711419258, 692545.4758884523, 692458.089775554, 691676.9159433729, 692079.890121774, 692111.9478619553, 691669.4556962688, 692199.7184176765, 692392.9363950219, 691860.8668693084, 692285.6803109256, 692223.3993270368, 691896.5117780381, 692080.0775624138, 692140.1412790724, 691900.1892512202, 692196.0848121945, 692619.3549323474, 692152.9896431612, 692146.0627366151, 692104.8538852198, 692269.6740814747, 692376.1612923285, 691981.4098184285, 691780.7576601236, 692045.7967059696, 692378.7955097074, 692121.8904206526, 692410.559728587, 692144.2154681421, 691889.7306185246, 692223.3765616196, 692137.5862679753, 692545.0151674481], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3980886855227552, "mean_inference_ms": 0.24101359476620082, "mean_action_processing_ms": 0.05837621975061303, "mean_env_wait_ms": 0.9334212594036404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002690553665161133, "StateBufferConnector_ms": 0.0018715858459472656, "ViewRequirementAgentConnector_ms": 0.04482245445251465}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5294880, "num_agent_steps_trained": 5294880, "num_env_steps_sampled": 5294880, "num_env_steps_trained": 5294880, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 378.52477338329226, "num_env_steps_trained_throughput_per_sec": 378.52477338329226, "timesteps_total": 5294880, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5294880, "timers": {"training_iteration_time_ms": 3157.491, "sample_time_ms": 3144.289, "load_time_ms": 0.42, "load_throughput": 2855858.375, "learn_time_ms": 12.127, "learn_throughput": 98953.576, "synch_weights_time_ms": 0.618}, "counters": {"num_env_steps_sampled": 5294880, "num_env_steps_trained": 5294880, "num_agent_steps_sampled": 5294880, "num_agent_steps_trained": 5294880}, "done": false, "episodes_total": 1372, "training_iteration": 621, "trial_id": "f3e85_00000", "date": "2023-07-25_14-55-37", "timestamp": 1690286137, "time_this_iter_s": 12.68303108215332, "time_total_s": 10697.957574367523, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 518.3260307312012, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 23.083333333333336, "ram_util_percent": 79.68333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0239440917969, "policy_loss": 20889247.8, "vf_loss": 95113354444.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1665.5, "diff_num_grad_updates_vs_sampler_policy": 1664.5}}, "num_env_steps_sampled": 5299680, "num_env_steps_trained": 5299680, "num_agent_steps_sampled": 5299680, "num_agent_steps_trained": 5299680}, "sampler_results": {"episode_reward_max": 692775.8887269107, "episode_reward_min": 691548.4862699892, "episode_reward_mean": 692145.0855823829, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452, 692227.8228232132, 692140.3858421975, 692443.1460952075, 692433.1972264306, 692099.4329785105, 692288.44498466, 692182.4893940524, 692422.394079768, 692144.4641350291, 691888.1846243031, 691899.0711419258, 692545.4758884523, 692458.089775554, 691676.9159433729, 692079.890121774, 692111.9478619553, 691669.4556962688, 692199.7184176765, 692392.9363950219, 691860.8668693084, 692285.6803109256, 692223.3993270368, 691896.5117780381, 692080.0775624138, 692140.1412790724, 691900.1892512202, 692196.0848121945, 692619.3549323474, 692152.9896431612, 692146.0627366151, 692104.8538852198, 692269.6740814747, 692376.1612923285, 691981.4098184285, 691780.7576601236, 692045.7967059696, 692378.7955097074, 692121.8904206526, 692410.559728587, 692144.2154681421, 691889.7306185246, 692223.3765616196, 692137.5862679753, 692545.0151674481, 692104.1020112762, 692125.4694469656, 692159.17251825, 692360.3994620896], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3979413401564358, "mean_inference_ms": 0.2410092793361589, "mean_action_processing_ms": 0.058371949219645315, "mean_env_wait_ms": 0.9328820738879466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00269317626953125, "StateBufferConnector_ms": 0.0018682479858398438, "ViewRequirementAgentConnector_ms": 0.04482913017272949}}, "episode_reward_max": 692775.8887269107, "episode_reward_min": 691548.4862699892, "episode_reward_mean": 692145.0855823829, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692168.1531162963, 691688.1120328383, 692164.7552630438, 692175.8739583932, 692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452, 692227.8228232132, 692140.3858421975, 692443.1460952075, 692433.1972264306, 692099.4329785105, 692288.44498466, 692182.4893940524, 692422.394079768, 692144.4641350291, 691888.1846243031, 691899.0711419258, 692545.4758884523, 692458.089775554, 691676.9159433729, 692079.890121774, 692111.9478619553, 691669.4556962688, 692199.7184176765, 692392.9363950219, 691860.8668693084, 692285.6803109256, 692223.3993270368, 691896.5117780381, 692080.0775624138, 692140.1412790724, 691900.1892512202, 692196.0848121945, 692619.3549323474, 692152.9896431612, 692146.0627366151, 692104.8538852198, 692269.6740814747, 692376.1612923285, 691981.4098184285, 691780.7576601236, 692045.7967059696, 692378.7955097074, 692121.8904206526, 692410.559728587, 692144.2154681421, 691889.7306185246, 692223.3765616196, 692137.5862679753, 692545.0151674481, 692104.1020112762, 692125.4694469656, 692159.17251825, 692360.3994620896], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3979413401564358, "mean_inference_ms": 0.2410092793361589, "mean_action_processing_ms": 0.058371949219645315, "mean_env_wait_ms": 0.9328820738879466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00269317626953125, "StateBufferConnector_ms": 0.0018682479858398438, "ViewRequirementAgentConnector_ms": 0.04482913017272949}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5299680, "num_agent_steps_trained": 5299680, "num_env_steps_sampled": 5299680, "num_env_steps_trained": 5299680, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 379.4212082424655, "num_env_steps_trained_throughput_per_sec": 379.4212082424655, "timesteps_total": 5299680, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5299680, "timers": {"training_iteration_time_ms": 3161.703, "sample_time_ms": 3148.374, "load_time_ms": 0.429, "load_throughput": 2798690.391, "learn_time_ms": 12.25, "learn_throughput": 97956.942, "synch_weights_time_ms": 0.612}, "counters": {"num_env_steps_sampled": 5299680, "num_env_steps_trained": 5299680, "num_agent_steps_sampled": 5299680, "num_agent_steps_trained": 5299680}, "done": false, "episodes_total": 1376, "training_iteration": 622, "trial_id": "f3e85_00000", "date": "2023-07-25_14-55-50", "timestamp": 1690286150, "time_this_iter_s": 12.653016805648804, "time_total_s": 10710.610591173172, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 530.97904753685, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 23.15, "ram_util_percent": 79.84444444444446}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0238647460938, "policy_loss": 124325100.8, "vf_loss": 94985639116.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1705.5, "diff_num_grad_updates_vs_sampler_policy": 1704.5}}, "num_env_steps_sampled": 5304480, "num_env_steps_trained": 5304480, "num_agent_steps_sampled": 5304480, "num_agent_steps_trained": 5304480}, "sampler_results": {"episode_reward_max": 692775.8887269107, "episode_reward_min": 691548.4862699892, "episode_reward_mean": 692148.5726420751, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452, 692227.8228232132, 692140.3858421975, 692443.1460952075, 692433.1972264306, 692099.4329785105, 692288.44498466, 692182.4893940524, 692422.394079768, 692144.4641350291, 691888.1846243031, 691899.0711419258, 692545.4758884523, 692458.089775554, 691676.9159433729, 692079.890121774, 692111.9478619553, 691669.4556962688, 692199.7184176765, 692392.9363950219, 691860.8668693084, 692285.6803109256, 692223.3993270368, 691896.5117780381, 692080.0775624138, 692140.1412790724, 691900.1892512202, 692196.0848121945, 692619.3549323474, 692152.9896431612, 692146.0627366151, 692104.8538852198, 692269.6740814747, 692376.1612923285, 691981.4098184285, 691780.7576601236, 692045.7967059696, 692378.7955097074, 692121.8904206526, 692410.559728587, 692144.2154681421, 691889.7306185246, 692223.3765616196, 692137.5862679753, 692545.0151674481, 692104.1020112762, 692125.4694469656, 692159.17251825, 692360.3994620896, 692325.6420096942, 692208.7521608497, 692111.1522816174, 691900.0538876588], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3978193534262777, "mean_inference_ms": 0.24100530707276394, "mean_action_processing_ms": 0.05836819218203331, "mean_env_wait_ms": 0.9323850439531511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002688169479370117, "StateBufferConnector_ms": 0.0018725395202636719, "ViewRequirementAgentConnector_ms": 0.04480266571044922}}, "episode_reward_max": 692775.8887269107, "episode_reward_min": 691548.4862699892, "episode_reward_mean": 692148.5726420751, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692177.094058289, 692433.0677925362, 692169.6688167029, 691548.4862699892, 692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452, 692227.8228232132, 692140.3858421975, 692443.1460952075, 692433.1972264306, 692099.4329785105, 692288.44498466, 692182.4893940524, 692422.394079768, 692144.4641350291, 691888.1846243031, 691899.0711419258, 692545.4758884523, 692458.089775554, 691676.9159433729, 692079.890121774, 692111.9478619553, 691669.4556962688, 692199.7184176765, 692392.9363950219, 691860.8668693084, 692285.6803109256, 692223.3993270368, 691896.5117780381, 692080.0775624138, 692140.1412790724, 691900.1892512202, 692196.0848121945, 692619.3549323474, 692152.9896431612, 692146.0627366151, 692104.8538852198, 692269.6740814747, 692376.1612923285, 691981.4098184285, 691780.7576601236, 692045.7967059696, 692378.7955097074, 692121.8904206526, 692410.559728587, 692144.2154681421, 691889.7306185246, 692223.3765616196, 692137.5862679753, 692545.0151674481, 692104.1020112762, 692125.4694469656, 692159.17251825, 692360.3994620896, 692325.6420096942, 692208.7521608497, 692111.1522816174, 691900.0538876588], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3978193534262777, "mean_inference_ms": 0.24100530707276394, "mean_action_processing_ms": 0.05836819218203331, "mean_env_wait_ms": 0.9323850439531511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002688169479370117, "StateBufferConnector_ms": 0.0018725395202636719, "ViewRequirementAgentConnector_ms": 0.04480266571044922}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5304480, "num_agent_steps_trained": 5304480, "num_env_steps_sampled": 5304480, "num_env_steps_trained": 5304480, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 379.55996617328753, "num_env_steps_trained_throughput_per_sec": 379.55996617328753, "timesteps_total": 5304480, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5304480, "timers": {"training_iteration_time_ms": 3160.859, "sample_time_ms": 3148.048, "load_time_ms": 0.425, "load_throughput": 2825081.275, "learn_time_ms": 11.767, "learn_throughput": 101983.575, "synch_weights_time_ms": 0.584}, "counters": {"num_env_steps_sampled": 5304480, "num_env_steps_trained": 5304480, "num_agent_steps_sampled": 5304480, "num_agent_steps_trained": 5304480}, "done": false, "episodes_total": 1380, "training_iteration": 623, "trial_id": "f3e85_00000", "date": "2023-07-25_14-56-03", "timestamp": 1690286163, "time_this_iter_s": 12.648581981658936, "time_total_s": 10723.259173154831, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 543.6276295185089, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 22.970588235294116, "ram_util_percent": 80.07647058823528}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0241943359375, "policy_loss": 6462270.7, "vf_loss": 95130755481.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1745.5, "diff_num_grad_updates_vs_sampler_policy": 1744.5}}, "num_env_steps_sampled": 5309280, "num_env_steps_trained": 5309280, "num_agent_steps_sampled": 5309280, "num_agent_steps_trained": 5309280}, "sampler_results": {"episode_reward_max": 692775.8887269107, "episode_reward_min": 691587.9329448391, "episode_reward_mean": 692157.3768918053, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452, 692227.8228232132, 692140.3858421975, 692443.1460952075, 692433.1972264306, 692099.4329785105, 692288.44498466, 692182.4893940524, 692422.394079768, 692144.4641350291, 691888.1846243031, 691899.0711419258, 692545.4758884523, 692458.089775554, 691676.9159433729, 692079.890121774, 692111.9478619553, 691669.4556962688, 692199.7184176765, 692392.9363950219, 691860.8668693084, 692285.6803109256, 692223.3993270368, 691896.5117780381, 692080.0775624138, 692140.1412790724, 691900.1892512202, 692196.0848121945, 692619.3549323474, 692152.9896431612, 692146.0627366151, 692104.8538852198, 692269.6740814747, 692376.1612923285, 691981.4098184285, 691780.7576601236, 692045.7967059696, 692378.7955097074, 692121.8904206526, 692410.559728587, 692144.2154681421, 691889.7306185246, 692223.3765616196, 692137.5862679753, 692545.0151674481, 692104.1020112762, 692125.4694469656, 692159.17251825, 692360.3994620896, 692325.6420096942, 692208.7521608497, 692111.1522816174, 691900.0538876588, 692116.9556841803, 692243.9585619798, 692280.6274761359, 692567.2001882413], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3976850430646035, "mean_inference_ms": 0.24099396266825493, "mean_action_processing_ms": 0.058364319239304414, "mean_env_wait_ms": 0.9319143294759215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026869773864746094, "StateBufferConnector_ms": 0.0018749237060546875, "ViewRequirementAgentConnector_ms": 0.04479718208312988}}, "episode_reward_max": 692775.8887269107, "episode_reward_min": 691587.9329448391, "episode_reward_mean": 692157.3768918053, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692406.5302351995, 692324.5880160755, 692080.5630846393, 692409.543371784, 692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452, 692227.8228232132, 692140.3858421975, 692443.1460952075, 692433.1972264306, 692099.4329785105, 692288.44498466, 692182.4893940524, 692422.394079768, 692144.4641350291, 691888.1846243031, 691899.0711419258, 692545.4758884523, 692458.089775554, 691676.9159433729, 692079.890121774, 692111.9478619553, 691669.4556962688, 692199.7184176765, 692392.9363950219, 691860.8668693084, 692285.6803109256, 692223.3993270368, 691896.5117780381, 692080.0775624138, 692140.1412790724, 691900.1892512202, 692196.0848121945, 692619.3549323474, 692152.9896431612, 692146.0627366151, 692104.8538852198, 692269.6740814747, 692376.1612923285, 691981.4098184285, 691780.7576601236, 692045.7967059696, 692378.7955097074, 692121.8904206526, 692410.559728587, 692144.2154681421, 691889.7306185246, 692223.3765616196, 692137.5862679753, 692545.0151674481, 692104.1020112762, 692125.4694469656, 692159.17251825, 692360.3994620896, 692325.6420096942, 692208.7521608497, 692111.1522816174, 691900.0538876588, 692116.9556841803, 692243.9585619798, 692280.6274761359, 692567.2001882413], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3976850430646035, "mean_inference_ms": 0.24099396266825493, "mean_action_processing_ms": 0.058364319239304414, "mean_env_wait_ms": 0.9319143294759215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026869773864746094, "StateBufferConnector_ms": 0.0018749237060546875, "ViewRequirementAgentConnector_ms": 0.04479718208312988}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5309280, "num_agent_steps_trained": 5309280, "num_env_steps_sampled": 5309280, "num_env_steps_trained": 5309280, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 380.0074960876006, "num_env_steps_trained_throughput_per_sec": 380.0074960876006, "timesteps_total": 5309280, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5309280, "timers": {"training_iteration_time_ms": 3156.732, "sample_time_ms": 3143.808, "load_time_ms": 0.432, "load_throughput": 2779986.081, "learn_time_ms": 11.872, "learn_throughput": 101074.67, "synch_weights_time_ms": 0.583}, "counters": {"num_env_steps_sampled": 5309280, "num_env_steps_trained": 5309280, "num_agent_steps_sampled": 5309280, "num_agent_steps_trained": 5309280}, "done": false, "episodes_total": 1384, "training_iteration": 624, "trial_id": "f3e85_00000", "date": "2023-07-25_14-56-15", "timestamp": 1690286175, "time_this_iter_s": 12.633484125137329, "time_total_s": 10735.892657279968, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 556.2611136436462, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 23.983333333333334, "ram_util_percent": 79.81666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0239868164062, "policy_loss": -1058054.0, "vf_loss": 95126754508.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1785.5, "diff_num_grad_updates_vs_sampler_policy": 1784.5}}, "num_env_steps_sampled": 5314080, "num_env_steps_trained": 5314080, "num_agent_steps_sampled": 5314080, "num_agent_steps_trained": 5314080}, "sampler_results": {"episode_reward_max": 692775.8887269107, "episode_reward_min": 691587.9329448391, "episode_reward_mean": 692161.52849358, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452, 692227.8228232132, 692140.3858421975, 692443.1460952075, 692433.1972264306, 692099.4329785105, 692288.44498466, 692182.4893940524, 692422.394079768, 692144.4641350291, 691888.1846243031, 691899.0711419258, 692545.4758884523, 692458.089775554, 691676.9159433729, 692079.890121774, 692111.9478619553, 691669.4556962688, 692199.7184176765, 692392.9363950219, 691860.8668693084, 692285.6803109256, 692223.3993270368, 691896.5117780381, 692080.0775624138, 692140.1412790724, 691900.1892512202, 692196.0848121945, 692619.3549323474, 692152.9896431612, 692146.0627366151, 692104.8538852198, 692269.6740814747, 692376.1612923285, 691981.4098184285, 691780.7576601236, 692045.7967059696, 692378.7955097074, 692121.8904206526, 692410.559728587, 692144.2154681421, 691889.7306185246, 692223.3765616196, 692137.5862679753, 692545.0151674481, 692104.1020112762, 692125.4694469656, 692159.17251825, 692360.3994620896, 692325.6420096942, 692208.7521608497, 692111.1522816174, 691900.0538876588, 692116.9556841803, 692243.9585619798, 692280.6274761359, 692567.2001882413, 692373.8536279972, 692220.8433941582, 692616.2914575821, 692425.3964054075], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3975465502640747, "mean_inference_ms": 0.24097583625503538, "mean_action_processing_ms": 0.05836038166716797, "mean_env_wait_ms": 0.9314516946602691, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026912689208984375, "StateBufferConnector_ms": 0.0018739700317382812, "ViewRequirementAgentConnector_ms": 0.044802188873291016}}, "episode_reward_max": 692775.8887269107, "episode_reward_min": 691587.9329448391, "episode_reward_mean": 692161.52849358, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692228.4477045485, 692533.2746540261, 691736.9250018932, 691803.8140486293, 691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452, 692227.8228232132, 692140.3858421975, 692443.1460952075, 692433.1972264306, 692099.4329785105, 692288.44498466, 692182.4893940524, 692422.394079768, 692144.4641350291, 691888.1846243031, 691899.0711419258, 692545.4758884523, 692458.089775554, 691676.9159433729, 692079.890121774, 692111.9478619553, 691669.4556962688, 692199.7184176765, 692392.9363950219, 691860.8668693084, 692285.6803109256, 692223.3993270368, 691896.5117780381, 692080.0775624138, 692140.1412790724, 691900.1892512202, 692196.0848121945, 692619.3549323474, 692152.9896431612, 692146.0627366151, 692104.8538852198, 692269.6740814747, 692376.1612923285, 691981.4098184285, 691780.7576601236, 692045.7967059696, 692378.7955097074, 692121.8904206526, 692410.559728587, 692144.2154681421, 691889.7306185246, 692223.3765616196, 692137.5862679753, 692545.0151674481, 692104.1020112762, 692125.4694469656, 692159.17251825, 692360.3994620896, 692325.6420096942, 692208.7521608497, 692111.1522816174, 691900.0538876588, 692116.9556841803, 692243.9585619798, 692280.6274761359, 692567.2001882413, 692373.8536279972, 692220.8433941582, 692616.2914575821, 692425.3964054075], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3975465502640747, "mean_inference_ms": 0.24097583625503538, "mean_action_processing_ms": 0.05836038166716797, "mean_env_wait_ms": 0.9314516946602691, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026912689208984375, "StateBufferConnector_ms": 0.0018739700317382812, "ViewRequirementAgentConnector_ms": 0.044802188873291016}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5314080, "num_agent_steps_trained": 5314080, "num_env_steps_sampled": 5314080, "num_env_steps_trained": 5314080, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 382.87238835362086, "num_env_steps_trained_throughput_per_sec": 382.87238835362086, "timesteps_total": 5314080, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5314080, "timers": {"training_iteration_time_ms": 3148.185, "sample_time_ms": 3135.295, "load_time_ms": 0.432, "load_throughput": 2779679.019, "learn_time_ms": 11.852, "learn_throughput": 101248.105, "synch_weights_time_ms": 0.57}, "counters": {"num_env_steps_sampled": 5314080, "num_env_steps_trained": 5314080, "num_agent_steps_sampled": 5314080, "num_agent_steps_trained": 5314080}, "done": false, "episodes_total": 1388, "training_iteration": 625, "trial_id": "f3e85_00000", "date": "2023-07-25_14-56-28", "timestamp": 1690286188, "time_this_iter_s": 12.538933277130127, "time_total_s": 10748.431590557098, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 568.8000469207764, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 22.916666666666668, "ram_util_percent": 79.59444444444443}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0239868164062, "policy_loss": -15414727.35, "vf_loss": 95048672870.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1825.5, "diff_num_grad_updates_vs_sampler_policy": 1824.5}}, "num_env_steps_sampled": 5318880, "num_env_steps_trained": 5318880, "num_agent_steps_sampled": 5318880, "num_agent_steps_trained": 5318880}, "sampler_results": {"episode_reward_max": 692775.8887269107, "episode_reward_min": 691587.9329448391, "episode_reward_mean": 692162.0621044763, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452, 692227.8228232132, 692140.3858421975, 692443.1460952075, 692433.1972264306, 692099.4329785105, 692288.44498466, 692182.4893940524, 692422.394079768, 692144.4641350291, 691888.1846243031, 691899.0711419258, 692545.4758884523, 692458.089775554, 691676.9159433729, 692079.890121774, 692111.9478619553, 691669.4556962688, 692199.7184176765, 692392.9363950219, 691860.8668693084, 692285.6803109256, 692223.3993270368, 691896.5117780381, 692080.0775624138, 692140.1412790724, 691900.1892512202, 692196.0848121945, 692619.3549323474, 692152.9896431612, 692146.0627366151, 692104.8538852198, 692269.6740814747, 692376.1612923285, 691981.4098184285, 691780.7576601236, 692045.7967059696, 692378.7955097074, 692121.8904206526, 692410.559728587, 692144.2154681421, 691889.7306185246, 692223.3765616196, 692137.5862679753, 692545.0151674481, 692104.1020112762, 692125.4694469656, 692159.17251825, 692360.3994620896, 692325.6420096942, 692208.7521608497, 692111.1522816174, 691900.0538876588, 692116.9556841803, 692243.9585619798, 692280.6274761359, 692567.2001882413, 692373.8536279972, 692220.8433941582, 692616.2914575821, 692425.3964054075, 692169.0924138171, 692187.5106231583, 691901.6551551446, 692097.5643066026], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3974198898753971, "mean_inference_ms": 0.24094904004134535, "mean_action_processing_ms": 0.05835558314289797, "mean_env_wait_ms": 0.9310136811637656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002691507339477539, "StateBufferConnector_ms": 0.0018701553344726562, "ViewRequirementAgentConnector_ms": 0.04485821723937988}}, "episode_reward_max": 692775.8887269107, "episode_reward_min": 691587.9329448391, "episode_reward_mean": 692162.0621044763, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [691886.3696607272, 692775.8887269107, 691917.1528282311, 691898.436873271, 692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452, 692227.8228232132, 692140.3858421975, 692443.1460952075, 692433.1972264306, 692099.4329785105, 692288.44498466, 692182.4893940524, 692422.394079768, 692144.4641350291, 691888.1846243031, 691899.0711419258, 692545.4758884523, 692458.089775554, 691676.9159433729, 692079.890121774, 692111.9478619553, 691669.4556962688, 692199.7184176765, 692392.9363950219, 691860.8668693084, 692285.6803109256, 692223.3993270368, 691896.5117780381, 692080.0775624138, 692140.1412790724, 691900.1892512202, 692196.0848121945, 692619.3549323474, 692152.9896431612, 692146.0627366151, 692104.8538852198, 692269.6740814747, 692376.1612923285, 691981.4098184285, 691780.7576601236, 692045.7967059696, 692378.7955097074, 692121.8904206526, 692410.559728587, 692144.2154681421, 691889.7306185246, 692223.3765616196, 692137.5862679753, 692545.0151674481, 692104.1020112762, 692125.4694469656, 692159.17251825, 692360.3994620896, 692325.6420096942, 692208.7521608497, 692111.1522816174, 691900.0538876588, 692116.9556841803, 692243.9585619798, 692280.6274761359, 692567.2001882413, 692373.8536279972, 692220.8433941582, 692616.2914575821, 692425.3964054075, 692169.0924138171, 692187.5106231583, 691901.6551551446, 692097.5643066026], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3974198898753971, "mean_inference_ms": 0.24094904004134535, "mean_action_processing_ms": 0.05835558314289797, "mean_env_wait_ms": 0.9310136811637656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002691507339477539, "StateBufferConnector_ms": 0.0018701553344726562, "ViewRequirementAgentConnector_ms": 0.04485821723937988}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5318880, "num_agent_steps_trained": 5318880, "num_env_steps_sampled": 5318880, "num_env_steps_trained": 5318880, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 377.96700958433775, "num_env_steps_trained_throughput_per_sec": 377.96700958433775, "timesteps_total": 5318880, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5318880, "timers": {"training_iteration_time_ms": 3156.354, "sample_time_ms": 3143.827, "load_time_ms": 0.42, "load_throughput": 2859265.352, "learn_time_ms": 11.513, "learn_throughput": 104231.991, "synch_weights_time_ms": 0.559}, "counters": {"num_env_steps_sampled": 5318880, "num_env_steps_trained": 5318880, "num_agent_steps_sampled": 5318880, "num_agent_steps_trained": 5318880}, "done": false, "episodes_total": 1392, "training_iteration": 626, "trial_id": "f3e85_00000", "date": "2023-07-25_14-56-41", "timestamp": 1690286201, "time_this_iter_s": 12.701809883117676, "time_total_s": 10761.133400440216, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 581.501856803894, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 26.41111111111111, "ram_util_percent": 79.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0239868164062, "policy_loss": -45018694.2, "vf_loss": 95092316569.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1865.5, "diff_num_grad_updates_vs_sampler_policy": 1864.5}}, "num_env_steps_sampled": 5323680, "num_env_steps_trained": 5323680, "num_agent_steps_sampled": 5323680, "num_agent_steps_trained": 5323680}, "sampler_results": {"episode_reward_max": 692636.9624059303, "episode_reward_min": 691587.9329448391, "episode_reward_mean": 692165.280377812, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452, 692227.8228232132, 692140.3858421975, 692443.1460952075, 692433.1972264306, 692099.4329785105, 692288.44498466, 692182.4893940524, 692422.394079768, 692144.4641350291, 691888.1846243031, 691899.0711419258, 692545.4758884523, 692458.089775554, 691676.9159433729, 692079.890121774, 692111.9478619553, 691669.4556962688, 692199.7184176765, 692392.9363950219, 691860.8668693084, 692285.6803109256, 692223.3993270368, 691896.5117780381, 692080.0775624138, 692140.1412790724, 691900.1892512202, 692196.0848121945, 692619.3549323474, 692152.9896431612, 692146.0627366151, 692104.8538852198, 692269.6740814747, 692376.1612923285, 691981.4098184285, 691780.7576601236, 692045.7967059696, 692378.7955097074, 692121.8904206526, 692410.559728587, 692144.2154681421, 691889.7306185246, 692223.3765616196, 692137.5862679753, 692545.0151674481, 692104.1020112762, 692125.4694469656, 692159.17251825, 692360.3994620896, 692325.6420096942, 692208.7521608497, 692111.1522816174, 691900.0538876588, 692116.9556841803, 692243.9585619798, 692280.6274761359, 692567.2001882413, 692373.8536279972, 692220.8433941582, 692616.2914575821, 692425.3964054075, 692169.0924138171, 692187.5106231583, 691901.6551551446, 692097.5643066026, 692262.1190005111, 692276.7985135244, 691933.291785062, 692327.4661236109], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3973269076497952, "mean_inference_ms": 0.24092251521847644, "mean_action_processing_ms": 0.058351480357163935, "mean_env_wait_ms": 0.9306088358285395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002702951431274414, "StateBufferConnector_ms": 0.001871347427368164, "ViewRequirementAgentConnector_ms": 0.044901132583618164}}, "episode_reward_max": 692636.9624059303, "episode_reward_min": 691587.9329448391, "episode_reward_mean": 692165.280377812, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692215.9827579557, 692001.5199151962, 691770.3914880396, 692513.6417555081, 692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452, 692227.8228232132, 692140.3858421975, 692443.1460952075, 692433.1972264306, 692099.4329785105, 692288.44498466, 692182.4893940524, 692422.394079768, 692144.4641350291, 691888.1846243031, 691899.0711419258, 692545.4758884523, 692458.089775554, 691676.9159433729, 692079.890121774, 692111.9478619553, 691669.4556962688, 692199.7184176765, 692392.9363950219, 691860.8668693084, 692285.6803109256, 692223.3993270368, 691896.5117780381, 692080.0775624138, 692140.1412790724, 691900.1892512202, 692196.0848121945, 692619.3549323474, 692152.9896431612, 692146.0627366151, 692104.8538852198, 692269.6740814747, 692376.1612923285, 691981.4098184285, 691780.7576601236, 692045.7967059696, 692378.7955097074, 692121.8904206526, 692410.559728587, 692144.2154681421, 691889.7306185246, 692223.3765616196, 692137.5862679753, 692545.0151674481, 692104.1020112762, 692125.4694469656, 692159.17251825, 692360.3994620896, 692325.6420096942, 692208.7521608497, 692111.1522816174, 691900.0538876588, 692116.9556841803, 692243.9585619798, 692280.6274761359, 692567.2001882413, 692373.8536279972, 692220.8433941582, 692616.2914575821, 692425.3964054075, 692169.0924138171, 692187.5106231583, 691901.6551551446, 692097.5643066026, 692262.1190005111, 692276.7985135244, 691933.291785062, 692327.4661236109], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3973269076497952, "mean_inference_ms": 0.24092251521847644, "mean_action_processing_ms": 0.058351480357163935, "mean_env_wait_ms": 0.9306088358285395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002702951431274414, "StateBufferConnector_ms": 0.001871347427368164, "ViewRequirementAgentConnector_ms": 0.044901132583618164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5323680, "num_agent_steps_trained": 5323680, "num_env_steps_sampled": 5323680, "num_env_steps_trained": 5323680, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 378.19911655488943, "num_env_steps_trained_throughput_per_sec": 378.19911655488943, "timesteps_total": 5323680, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5323680, "timers": {"training_iteration_time_ms": 3166.1, "sample_time_ms": 3152.723, "load_time_ms": 0.442, "load_throughput": 2714467.048, "learn_time_ms": 12.325, "learn_throughput": 97365.526, "synch_weights_time_ms": 0.573}, "counters": {"num_env_steps_sampled": 5323680, "num_env_steps_trained": 5323680, "num_agent_steps_sampled": 5323680, "num_agent_steps_trained": 5323680}, "done": false, "episodes_total": 1396, "training_iteration": 627, "trial_id": "f3e85_00000", "date": "2023-07-25_14-56-53", "timestamp": 1690286213, "time_this_iter_s": 12.69368290901184, "time_total_s": 10773.827083349228, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 594.1955397129059, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 24.13888888888889, "ram_util_percent": 78.63888888888887}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.009999999999999998, "policy_entropy": -824.0253784179688, "policy_loss": -14930790.5, "vf_loss": 95142481510.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1905.5, "diff_num_grad_updates_vs_sampler_policy": 1904.5}}, "num_env_steps_sampled": 5328480, "num_env_steps_trained": 5328480, "num_agent_steps_sampled": 5328480, "num_agent_steps_trained": 5328480}, "sampler_results": {"episode_reward_max": 692636.9624059303, "episode_reward_min": 691587.9329448391, "episode_reward_mean": 692174.5458414346, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452, 692227.8228232132, 692140.3858421975, 692443.1460952075, 692433.1972264306, 692099.4329785105, 692288.44498466, 692182.4893940524, 692422.394079768, 692144.4641350291, 691888.1846243031, 691899.0711419258, 692545.4758884523, 692458.089775554, 691676.9159433729, 692079.890121774, 692111.9478619553, 691669.4556962688, 692199.7184176765, 692392.9363950219, 691860.8668693084, 692285.6803109256, 692223.3993270368, 691896.5117780381, 692080.0775624138, 692140.1412790724, 691900.1892512202, 692196.0848121945, 692619.3549323474, 692152.9896431612, 692146.0627366151, 692104.8538852198, 692269.6740814747, 692376.1612923285, 691981.4098184285, 691780.7576601236, 692045.7967059696, 692378.7955097074, 692121.8904206526, 692410.559728587, 692144.2154681421, 691889.7306185246, 692223.3765616196, 692137.5862679753, 692545.0151674481, 692104.1020112762, 692125.4694469656, 692159.17251825, 692360.3994620896, 692325.6420096942, 692208.7521608497, 692111.1522816174, 691900.0538876588, 692116.9556841803, 692243.9585619798, 692280.6274761359, 692567.2001882413, 692373.8536279972, 692220.8433941582, 692616.2914575821, 692425.3964054075, 692169.0924138171, 692187.5106231583, 691901.6551551446, 692097.5643066026, 692262.1190005111, 692276.7985135244, 691933.291785062, 692327.4661236109, 692461.6404037649, 692097.758871363, 692386.7554142022, 692481.9275896351], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3972481928195553, "mean_inference_ms": 0.24089481726809356, "mean_action_processing_ms": 0.05834772186617492, "mean_env_wait_ms": 0.9302476333252144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00267791748046875, "StateBufferConnector_ms": 0.001859426498413086, "ViewRequirementAgentConnector_ms": 0.04466557502746582}}, "episode_reward_max": 692636.9624059303, "episode_reward_min": 691587.9329448391, "episode_reward_mean": 692174.5458414346, "episode_len_mean": 1200.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [692257.2456280063, 691907.8335585257, 692191.0157532558, 692186.9878973432, 692138.7825941098, 692463.5854766275, 692474.8494247993, 692032.3772497404, 691771.3965464325, 692211.1399487633, 692636.9624059303, 692160.7259689097, 692190.7388958187, 691744.6072876651, 692358.535334768, 691952.1991851972, 691852.1126525961, 692370.6785792514, 691795.9983223828, 692078.3760813999, 692222.1306550787, 691587.9329448391, 692126.8281812379, 691935.4141640628, 692356.155579775, 692186.1432333806, 692425.4971130178, 691900.2375921452, 692227.8228232132, 692140.3858421975, 692443.1460952075, 692433.1972264306, 692099.4329785105, 692288.44498466, 692182.4893940524, 692422.394079768, 692144.4641350291, 691888.1846243031, 691899.0711419258, 692545.4758884523, 692458.089775554, 691676.9159433729, 692079.890121774, 692111.9478619553, 691669.4556962688, 692199.7184176765, 692392.9363950219, 691860.8668693084, 692285.6803109256, 692223.3993270368, 691896.5117780381, 692080.0775624138, 692140.1412790724, 691900.1892512202, 692196.0848121945, 692619.3549323474, 692152.9896431612, 692146.0627366151, 692104.8538852198, 692269.6740814747, 692376.1612923285, 691981.4098184285, 691780.7576601236, 692045.7967059696, 692378.7955097074, 692121.8904206526, 692410.559728587, 692144.2154681421, 691889.7306185246, 692223.3765616196, 692137.5862679753, 692545.0151674481, 692104.1020112762, 692125.4694469656, 692159.17251825, 692360.3994620896, 692325.6420096942, 692208.7521608497, 692111.1522816174, 691900.0538876588, 692116.9556841803, 692243.9585619798, 692280.6274761359, 692567.2001882413, 692373.8536279972, 692220.8433941582, 692616.2914575821, 692425.3964054075, 692169.0924138171, 692187.5106231583, 691901.6551551446, 692097.5643066026, 692262.1190005111, 692276.7985135244, 691933.291785062, 692327.4661236109, 692461.6404037649, 692097.758871363, 692386.7554142022, 692481.9275896351], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3972481928195553, "mean_inference_ms": 0.24089481726809356, "mean_action_processing_ms": 0.05834772186617492, "mean_env_wait_ms": 0.9302476333252144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00267791748046875, "StateBufferConnector_ms": 0.001859426498413086, "ViewRequirementAgentConnector_ms": 0.04466557502746582}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5328480, "num_agent_steps_trained": 5328480, "num_env_steps_sampled": 5328480, "num_env_steps_trained": 5328480, "num_env_steps_sampled_this_iter": 4800, "num_env_steps_trained_this_iter": 4800, "num_env_steps_sampled_throughput_per_sec": 377.47066635978024, "num_env_steps_trained_throughput_per_sec": 377.47066635978024, "timesteps_total": 5328480, "num_steps_trained_this_iter": 4800, "agent_timesteps_total": 5328480, "timers": {"training_iteration_time_ms": 3172.299, "sample_time_ms": 3158.999, "load_time_ms": 0.439, "load_throughput": 2734078.331, "learn_time_ms": 12.259, "learn_throughput": 97884.359, "synch_weights_time_ms": 0.564}, "counters": {"num_env_steps_sampled": 5328480, "num_env_steps_trained": 5328480, "num_agent_steps_sampled": 5328480, "num_agent_steps_trained": 5328480}, "done": true, "episodes_total": 1400, "training_iteration": 628, "trial_id": "f3e85_00000", "date": "2023-07-25_14-57-06", "timestamp": 1690286226, "time_this_iter_s": 12.718688011169434, "time_total_s": 10786.545771360397, "pid": 63890, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.0001], [5103600, 8.5e-05], [5107200, 7.5e-05], [5110800, 5e-05], [5114400, 2.5e-05], [5118000, 1e-05], [5121600, 7.5e-06], [5125200, 5e-06], [5128800, 2.5e-06], [5132400, 1e-06], [5136000, 7.5e-07], [5139600, 5e-07], [5143200, 2.5e-07], [5146800, 1e-07], [5150400, 5e-08], [5154000, 1e-08]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16d6ac550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 606.9142277240753, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 23.56111111111111, "ram_util_percent": 79.31666666666666}}
