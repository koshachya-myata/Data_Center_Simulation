{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.49395751953125, "policy_loss": -61678.53125, "vf_loss": 1584417.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}}, "num_env_steps_sampled": 220920, "num_env_steps_trained": 220920, "num_agent_steps_sampled": 220920, "num_agent_steps_trained": 220920}, "sampler_results": {"episode_reward_max": -447.971528146465, "episode_reward_min": -808.110443610696, "episode_reward_mean": -632.0444060620706, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-808.110443610696, -640.0512464290508, -447.971528146465], "episode_lengths": [120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.924729323453192, "mean_inference_ms": 0.4118941827494022, "mean_action_processing_ms": 0.09769349877523914, "mean_env_wait_ms": 10.601397696624502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003528594970703125, "StateBufferConnector_ms": 0.0026782353719075522, "ViewRequirementAgentConnector_ms": 0.07333755493164062}}, "episode_reward_max": -447.971528146465, "episode_reward_min": -808.110443610696, "episode_reward_mean": -632.0444060620706, "episode_len_mean": 120.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-808.110443610696, -640.0512464290508, -447.971528146465], "episode_lengths": [120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.924729323453192, "mean_inference_ms": 0.4118941827494022, "mean_action_processing_ms": 0.09769349877523914, "mean_env_wait_ms": 10.601397696624502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003528594970703125, "StateBufferConnector_ms": 0.0026782353719075522, "ViewRequirementAgentConnector_ms": 0.07333755493164062}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220920, "num_agent_steps_trained": 220920, "num_env_steps_sampled": 220920, "num_env_steps_trained": 220920, "num_env_steps_sampled_this_iter": 360, "num_env_steps_trained_this_iter": 360, "num_env_steps_sampled_throughput_per_sec": 31.01416001969198, "num_env_steps_trained_throughput_per_sec": 31.01416001969198, "timesteps_total": 220920, "num_steps_trained_this_iter": 360, "agent_timesteps_total": 220920, "timers": {"training_iteration_time_ms": 3869.185, "sample_time_ms": 3860.684, "load_time_ms": 0.326, "load_throughput": 367831.776, "learn_time_ms": 7.416, "learn_throughput": 16181.902, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 220920, "num_env_steps_trained": 220920, "num_agent_steps_sampled": 220920, "num_agent_steps_trained": 220920}, "done": false, "episodes_total": 1841, "training_iteration": 461, "trial_id": "59a5e_00000", "date": "2023-07-26_03-00-12", "timestamp": 1690329612, "time_this_iter_s": 11.609986066818237, "time_total_s": 5632.935461997986, "pid": 92986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f576700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11.609986066818237, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 39.75882352941177, "ram_util_percent": 78.20588235294117}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.48187255859375, "policy_loss": -79817.046875, "vf_loss": 3195003.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}}, "num_env_steps_sampled": 221400, "num_env_steps_trained": 221400, "num_agent_steps_sampled": 221400, "num_agent_steps_trained": 221400}, "sampler_results": {"episode_reward_max": -447.971528146465, "episode_reward_min": -808.110443610696, "episode_reward_mean": -624.4248137747364, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-808.110443610696, -640.0512464290508, -447.971528146465, -645.1045730956314, -549.4669143009, -680.7455070835609, -599.5234837568506], "episode_lengths": [120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.80374739648365, "mean_inference_ms": 0.40823183997356854, "mean_action_processing_ms": 0.09728089463754329, "mean_env_wait_ms": 7.961904253802593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038010733468191965, "StateBufferConnector_ms": 0.002697535923549107, "ViewRequirementAgentConnector_ms": 0.07139955248151507}}, "episode_reward_max": -447.971528146465, "episode_reward_min": -808.110443610696, "episode_reward_mean": -624.4248137747364, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-808.110443610696, -640.0512464290508, -447.971528146465, -645.1045730956314, -549.4669143009, -680.7455070835609, -599.5234837568506], "episode_lengths": [120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.80374739648365, "mean_inference_ms": 0.40823183997356854, "mean_action_processing_ms": 0.09728089463754329, "mean_env_wait_ms": 7.961904253802593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038010733468191965, "StateBufferConnector_ms": 0.002697535923549107, "ViewRequirementAgentConnector_ms": 0.07139955248151507}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 221400, "num_agent_steps_trained": 221400, "num_env_steps_sampled": 221400, "num_env_steps_trained": 221400, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 42.30833190047587, "num_env_steps_trained_throughput_per_sec": 42.30833190047587, "timesteps_total": 221400, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 221400, "timers": {"training_iteration_time_ms": 3278.969, "sample_time_ms": 3273.154, "load_time_ms": 0.263, "load_throughput": 457026.25, "learn_time_ms": 4.8, "learn_throughput": 24999.932, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 221400, "num_env_steps_trained": 221400, "num_agent_steps_sampled": 221400, "num_agent_steps_trained": 221400}, "done": false, "episodes_total": 1845, "training_iteration": 462, "trial_id": "59a5e_00000", "date": "2023-07-26_03-00-23", "timestamp": 1690329623, "time_this_iter_s": 11.347811222076416, "time_total_s": 5644.283273220062, "pid": 92986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f576700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 22.957797288894653, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 36.868750000000006, "ram_util_percent": 77.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4950866699219, "policy_loss": -89356.015625, "vf_loss": 3558272.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}}, "num_env_steps_sampled": 221880, "num_env_steps_trained": 221880, "num_agent_steps_sampled": 221880, "num_agent_steps_trained": 221880}, "sampler_results": {"episode_reward_max": -447.971528146465, "episode_reward_min": -933.7798957988444, "episode_reward_mean": -685.547042488387, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-808.110443610696, -640.0512464290508, -447.971528146465, -645.1045730956314, -549.4669143009, -680.7455070835609, -599.5234837568506, -573.6726515424044, -859.1871993007937, -933.7798957988444, -803.4040243070591], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.78871915000629, "mean_inference_ms": 0.40567073526800884, "mean_action_processing_ms": 0.0969305679653147, "mean_env_wait_ms": 6.80286131541648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038211995905095882, "StateBufferConnector_ms": 0.0026702880859375, "ViewRequirementAgentConnector_ms": 0.06985230879350142}}, "episode_reward_max": -447.971528146465, "episode_reward_min": -933.7798957988444, "episode_reward_mean": -685.547042488387, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-808.110443610696, -640.0512464290508, -447.971528146465, -645.1045730956314, -549.4669143009, -680.7455070835609, -599.5234837568506, -573.6726515424044, -859.1871993007937, -933.7798957988444, -803.4040243070591], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.78871915000629, "mean_inference_ms": 0.40567073526800884, "mean_action_processing_ms": 0.0969305679653147, "mean_env_wait_ms": 6.80286131541648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038211995905095882, "StateBufferConnector_ms": 0.0026702880859375, "ViewRequirementAgentConnector_ms": 0.06985230879350142}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 221880, "num_agent_steps_trained": 221880, "num_env_steps_sampled": 221880, "num_env_steps_trained": 221880, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.54148014760072, "num_env_steps_trained_throughput_per_sec": 41.54148014760072, "timesteps_total": 221880, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 221880, "timers": {"training_iteration_time_ms": 2869.758, "sample_time_ms": 2865.971, "load_time_ms": 0.216, "load_throughput": 556581.312, "learn_time_ms": 2.836, "learn_throughput": 42312.925, "synch_weights_time_ms": 0.698}, "counters": {"num_env_steps_sampled": 221880, "num_env_steps_trained": 221880, "num_agent_steps_sampled": 221880, "num_agent_steps_trained": 221880}, "done": false, "episodes_total": 1849, "training_iteration": 463, "trial_id": "59a5e_00000", "date": "2023-07-26_03-00-35", "timestamp": 1690329635, "time_this_iter_s": 11.5571448802948, "time_total_s": 5655.840418100357, "pid": 92986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f576700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 34.51494216918945, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 35.43529411764706, "ram_util_percent": 78.6058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.5043640136719, "policy_loss": -114727.9296875, "vf_loss": 5777050.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}}, "num_env_steps_sampled": 222360, "num_env_steps_trained": 222360, "num_agent_steps_sampled": 222360, "num_agent_steps_trained": 222360}, "sampler_results": {"episode_reward_max": -447.971528146465, "episode_reward_min": -1228.6108509537364, "episode_reward_mean": -766.1167797038181, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-808.110443610696, -640.0512464290508, -447.971528146465, -645.1045730956314, -549.4669143009, -680.7455070835609, -599.5234837568506, -573.6726515424044, -859.1871993007937, -933.7798957988444, -803.4040243070591, -791.7855992846615, -995.9147941731061, -1228.6108509537364, -934.4229837735103], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.836821811715506, "mean_inference_ms": 0.40560288533480726, "mean_action_processing_ms": 0.09693632777129786, "mean_env_wait_ms": 6.116606722766649, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003620783487955729, "StateBufferConnector_ms": 0.0027068456013997397, "ViewRequirementAgentConnector_ms": 0.06931622823079427}}, "episode_reward_max": -447.971528146465, "episode_reward_min": -1228.6108509537364, "episode_reward_mean": -766.1167797038181, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-808.110443610696, -640.0512464290508, -447.971528146465, -645.1045730956314, -549.4669143009, -680.7455070835609, -599.5234837568506, -573.6726515424044, -859.1871993007937, -933.7798957988444, -803.4040243070591, -791.7855992846615, -995.9147941731061, -1228.6108509537364, -934.4229837735103], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.836821811715506, "mean_inference_ms": 0.40560288533480726, "mean_action_processing_ms": 0.09693632777129786, "mean_env_wait_ms": 6.116606722766649, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003620783487955729, "StateBufferConnector_ms": 0.0027068456013997397, "ViewRequirementAgentConnector_ms": 0.06931622823079427}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 222360, "num_agent_steps_trained": 222360, "num_env_steps_sampled": 222360, "num_env_steps_trained": 222360, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.205332044589476, "num_env_steps_trained_throughput_per_sec": 40.205332044589476, "timesteps_total": 222360, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 222360, "timers": {"training_iteration_time_ms": 2916.623, "sample_time_ms": 2912.533, "load_time_ms": 0.232, "load_throughput": 517815.309, "learn_time_ms": 3.041, "learn_throughput": 39462.184, "synch_weights_time_ms": 0.77}, "counters": {"num_env_steps_sampled": 222360, "num_env_steps_trained": 222360, "num_agent_steps_sampled": 222360, "num_agent_steps_trained": 222360}, "done": false, "episodes_total": 1853, "training_iteration": 464, "trial_id": "59a5e_00000", "date": "2023-07-26_03-00-47", "timestamp": 1690329647, "time_this_iter_s": 11.941494226455688, "time_total_s": 5667.781912326813, "pid": 92986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f576700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 46.45643639564514, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 43.258823529411764, "ram_util_percent": 78.61764705882352}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.50634765625, "policy_loss": -151832.859375, "vf_loss": 9145636.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19.0, "diff_num_grad_updates_vs_sampler_policy": 18.0}}, "num_env_steps_sampled": 222840, "num_env_steps_trained": 222840, "num_agent_steps_sampled": 222840, "num_agent_steps_trained": 222840}, "sampler_results": {"episode_reward_max": -447.971528146465, "episode_reward_min": -1228.6108509537364, "episode_reward_mean": -779.4740620290979, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-808.110443610696, -640.0512464290508, -447.971528146465, -645.1045730956314, -549.4669143009, -680.7455070835609, -599.5234837568506, -573.6726515424044, -859.1871993007937, -933.7798957988444, -803.4040243070591, -791.7855992846615, -995.9147941731061, -1228.6108509537364, -934.4229837735103, -776.5614355695958, -621.715651964171, -864.3261664824307, -1055.6522289793918], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.885777166722935, "mean_inference_ms": 0.40506299428749487, "mean_action_processing_ms": 0.0968151912910187, "mean_env_wait_ms": 5.650092298559013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035085176166735196, "StateBufferConnector_ms": 0.0026803267629523027, "ViewRequirementAgentConnector_ms": 0.0686971764815481}}, "episode_reward_max": -447.971528146465, "episode_reward_min": -1228.6108509537364, "episode_reward_mean": -779.4740620290979, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-808.110443610696, -640.0512464290508, -447.971528146465, -645.1045730956314, -549.4669143009, -680.7455070835609, -599.5234837568506, -573.6726515424044, -859.1871993007937, -933.7798957988444, -803.4040243070591, -791.7855992846615, -995.9147941731061, -1228.6108509537364, -934.4229837735103, -776.5614355695958, -621.715651964171, -864.3261664824307, -1055.6522289793918], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.885777166722935, "mean_inference_ms": 0.40506299428749487, "mean_action_processing_ms": 0.0968151912910187, "mean_env_wait_ms": 5.650092298559013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035085176166735196, "StateBufferConnector_ms": 0.0026803267629523027, "ViewRequirementAgentConnector_ms": 0.0686971764815481}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 222840, "num_agent_steps_trained": 222840, "num_env_steps_sampled": 222840, "num_env_steps_trained": 222840, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.52477910873929, "num_env_steps_trained_throughput_per_sec": 40.52477910873929, "timesteps_total": 222840, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 222840, "timers": {"training_iteration_time_ms": 2957.192, "sample_time_ms": 2953.151, "load_time_ms": 0.231, "load_throughput": 520492.74, "learn_time_ms": 2.998, "learn_throughput": 40026.441, "synch_weights_time_ms": 0.764}, "counters": {"num_env_steps_sampled": 222840, "num_env_steps_trained": 222840, "num_agent_steps_sampled": 222840, "num_agent_steps_trained": 222840}, "done": false, "episodes_total": 1857, "training_iteration": 465, "trial_id": "59a5e_00000", "date": "2023-07-26_03-00-59", "timestamp": 1690329659, "time_this_iter_s": 11.847048997879028, "time_total_s": 5679.628961324692, "pid": 92986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f576700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 58.30348539352417, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 40.83529411764705, "ram_util_percent": 76.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.516845703125, "policy_loss": -91645.671875, "vf_loss": 3934851.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 223320, "num_env_steps_trained": 223320, "num_agent_steps_sampled": 223320, "num_agent_steps_trained": 223320}, "sampler_results": {"episode_reward_max": -447.971528146465, "episode_reward_min": -1228.6108509537364, "episode_reward_mean": -767.826284962593, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-808.110443610696, -640.0512464290508, -447.971528146465, -645.1045730956314, -549.4669143009, -680.7455070835609, -599.5234837568506, -573.6726515424044, -859.1871993007937, -933.7798957988444, -803.4040243070591, -791.7855992846615, -995.9147941731061, -1228.6108509537364, -934.4229837735103, -776.5614355695958, -621.715651964171, -864.3261664824307, -1055.6522289793918, -565.8901652246673, -737.249666349422, -858.641909765053, -688.2156342476392], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.920620065561227, "mean_inference_ms": 0.40481135318081146, "mean_action_processing_ms": 0.09675007805501382, "mean_env_wait_ms": 5.308152979060894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034394471541694975, "StateBufferConnector_ms": 0.002678580906080163, "ViewRequirementAgentConnector_ms": 0.0688791275024414}}, "episode_reward_max": -447.971528146465, "episode_reward_min": -1228.6108509537364, "episode_reward_mean": -767.826284962593, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-808.110443610696, -640.0512464290508, -447.971528146465, -645.1045730956314, -549.4669143009, -680.7455070835609, -599.5234837568506, -573.6726515424044, -859.1871993007937, -933.7798957988444, -803.4040243070591, -791.7855992846615, -995.9147941731061, -1228.6108509537364, -934.4229837735103, -776.5614355695958, -621.715651964171, -864.3261664824307, -1055.6522289793918, -565.8901652246673, -737.249666349422, -858.641909765053, -688.2156342476392], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.920620065561227, "mean_inference_ms": 0.40481135318081146, "mean_action_processing_ms": 0.09675007805501382, "mean_env_wait_ms": 5.308152979060894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034394471541694975, "StateBufferConnector_ms": 0.002678580906080163, "ViewRequirementAgentConnector_ms": 0.0688791275024414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 223320, "num_agent_steps_trained": 223320, "num_env_steps_sampled": 223320, "num_env_steps_trained": 223320, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.983691195026125, "num_env_steps_trained_throughput_per_sec": 40.983691195026125, "timesteps_total": 223320, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 223320, "timers": {"training_iteration_time_ms": 2956.477, "sample_time_ms": 2952.407, "load_time_ms": 0.24, "load_throughput": 499817.756, "learn_time_ms": 3.002, "learn_throughput": 39969.861, "synch_weights_time_ms": 0.779}, "counters": {"num_env_steps_sampled": 223320, "num_env_steps_trained": 223320, "num_agent_steps_sampled": 223320, "num_agent_steps_trained": 223320}, "done": false, "episodes_total": 1861, "training_iteration": 466, "trial_id": "59a5e_00000", "date": "2023-07-26_03-01-10", "timestamp": 1690329670, "time_this_iter_s": 11.714595079421997, "time_total_s": 5691.343556404114, "pid": 92986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f576700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 70.01808047294617, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 41.14375, "ram_util_percent": 77.00625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.49273681640625, "policy_loss": -102620.3671875, "vf_loss": 4942332.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}}, "num_env_steps_sampled": 223800, "num_env_steps_trained": 223800, "num_agent_steps_sampled": 223800, "num_agent_steps_trained": 223800}, "sampler_results": {"episode_reward_max": -447.971528146465, "episode_reward_min": -1228.6108509537364, "episode_reward_mean": -775.9285992899014, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-808.110443610696, -640.0512464290508, -447.971528146465, -645.1045730956314, -549.4669143009, -680.7455070835609, -599.5234837568506, -573.6726515424044, -859.1871993007937, -933.7798957988444, -803.4040243070591, -791.7855992846615, -995.9147941731061, -1228.6108509537364, -934.4229837735103, -776.5614355695958, -621.715651964171, -864.3261664824307, -1055.6522289793918, -565.8901652246673, -737.249666349422, -858.641909765053, -688.2156342476392, -861.838701554391, -900.2700053728789, -713.5719773131852, -814.3869424472393], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.937498005089964, "mean_inference_ms": 0.4043404393785328, "mean_action_processing_ms": 0.09664484077641325, "mean_env_wait_ms": 5.043771690220102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035012209856951676, "StateBufferConnector_ms": 0.0026729371812608507, "ViewRequirementAgentConnector_ms": 0.06871488359239367}}, "episode_reward_max": -447.971528146465, "episode_reward_min": -1228.6108509537364, "episode_reward_mean": -775.9285992899014, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-808.110443610696, -640.0512464290508, -447.971528146465, -645.1045730956314, -549.4669143009, -680.7455070835609, -599.5234837568506, -573.6726515424044, -859.1871993007937, -933.7798957988444, -803.4040243070591, -791.7855992846615, -995.9147941731061, -1228.6108509537364, -934.4229837735103, -776.5614355695958, -621.715651964171, -864.3261664824307, -1055.6522289793918, -565.8901652246673, -737.249666349422, -858.641909765053, -688.2156342476392, -861.838701554391, -900.2700053728789, -713.5719773131852, -814.3869424472393], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.937498005089964, "mean_inference_ms": 0.4043404393785328, "mean_action_processing_ms": 0.09664484077641325, "mean_env_wait_ms": 5.043771690220102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035012209856951676, "StateBufferConnector_ms": 0.0026729371812608507, "ViewRequirementAgentConnector_ms": 0.06871488359239367}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 223800, "num_agent_steps_trained": 223800, "num_env_steps_sampled": 223800, "num_env_steps_trained": 223800, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.844254432837076, "num_env_steps_trained_throughput_per_sec": 41.844254432837076, "timesteps_total": 223800, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 223800, "timers": {"training_iteration_time_ms": 2910.995, "sample_time_ms": 2907.209, "load_time_ms": 0.228, "load_throughput": 526316.512, "learn_time_ms": 2.811, "learn_throughput": 42686.134, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 223800, "num_env_steps_trained": 223800, "num_agent_steps_sampled": 223800, "num_agent_steps_trained": 223800}, "done": false, "episodes_total": 1865, "training_iteration": 467, "trial_id": "59a5e_00000", "date": "2023-07-26_03-01-22", "timestamp": 1690329682, "time_this_iter_s": 11.473612070083618, "time_total_s": 5702.817168474197, "pid": 92986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f576700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 81.49169254302979, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 37.26470588235294, "ram_util_percent": 74.57058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.48724365234375, "policy_loss": -87915.7109375, "vf_loss": 3660059.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}}, "num_env_steps_sampled": 224280, "num_env_steps_trained": 224280, "num_agent_steps_sampled": 224280, "num_agent_steps_trained": 224280}, "sampler_results": {"episode_reward_max": -447.971528146465, "episode_reward_min": -1228.6108509537364, "episode_reward_mean": -774.9888338748993, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-808.110443610696, -640.0512464290508, -447.971528146465, -645.1045730956314, -549.4669143009, -680.7455070835609, -599.5234837568506, -573.6726515424044, -859.1871993007937, -933.7798957988444, -803.4040243070591, -791.7855992846615, -995.9147941731061, -1228.6108509537364, -934.4229837735103, -776.5614355695958, -621.715651964171, -864.3261664824307, -1055.6522289793918, -565.8901652246673, -737.249666349422, -858.641909765053, -688.2156342476392, -861.838701554391, -900.2700053728789, -713.5719773131852, -814.3869424472393, -726.3350777871877, -835.6300323416948, -856.8642543921059, -655.7523047735523], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.950501323056468, "mean_inference_ms": 0.4039371851127219, "mean_action_processing_ms": 0.09655694367918036, "mean_env_wait_ms": 4.831841142912704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035332095238470263, "StateBufferConnector_ms": 0.002647215320217994, "ViewRequirementAgentConnector_ms": 0.0684699704570155}}, "episode_reward_max": -447.971528146465, "episode_reward_min": -1228.6108509537364, "episode_reward_mean": -774.9888338748993, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-808.110443610696, -640.0512464290508, -447.971528146465, -645.1045730956314, -549.4669143009, -680.7455070835609, -599.5234837568506, -573.6726515424044, -859.1871993007937, -933.7798957988444, -803.4040243070591, -791.7855992846615, -995.9147941731061, -1228.6108509537364, -934.4229837735103, -776.5614355695958, -621.715651964171, -864.3261664824307, -1055.6522289793918, -565.8901652246673, -737.249666349422, -858.641909765053, -688.2156342476392, -861.838701554391, -900.2700053728789, -713.5719773131852, -814.3869424472393, -726.3350777871877, -835.6300323416948, -856.8642543921059, -655.7523047735523], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.950501323056468, "mean_inference_ms": 0.4039371851127219, "mean_action_processing_ms": 0.09655694367918036, "mean_env_wait_ms": 4.831841142912704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035332095238470263, "StateBufferConnector_ms": 0.002647215320217994, "ViewRequirementAgentConnector_ms": 0.0684699704570155}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224280, "num_agent_steps_trained": 224280, "num_env_steps_sampled": 224280, "num_env_steps_trained": 224280, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.30805431031083, "num_env_steps_trained_throughput_per_sec": 41.30805431031083, "timesteps_total": 224280, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 224280, "timers": {"training_iteration_time_ms": 2885.796, "sample_time_ms": 2882.051, "load_time_ms": 0.219, "load_throughput": 548334.764, "learn_time_ms": 2.783, "learn_throughput": 43122.439, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 224280, "num_env_steps_trained": 224280, "num_agent_steps_sampled": 224280, "num_agent_steps_trained": 224280}, "done": false, "episodes_total": 1869, "training_iteration": 468, "trial_id": "59a5e_00000", "date": "2023-07-26_03-01-33", "timestamp": 1690329693, "time_this_iter_s": 11.622416019439697, "time_total_s": 5714.439584493637, "pid": 92986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f576700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 93.11410856246948, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 39.74375, "ram_util_percent": 74.86875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.5076904296875, "policy_loss": -78239.6875, "vf_loss": 2746567.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}}, "num_env_steps_sampled": 224760, "num_env_steps_trained": 224760, "num_agent_steps_sampled": 224760, "num_agent_steps_trained": 224760}, "sampler_results": {"episode_reward_max": -447.971528146465, "episode_reward_min": -1228.6108509537364, "episode_reward_mean": -759.530529647891, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-808.110443610696, -640.0512464290508, -447.971528146465, -645.1045730956314, -549.4669143009, -680.7455070835609, -599.5234837568506, -573.6726515424044, -859.1871993007937, -933.7798957988444, -803.4040243070591, -791.7855992846615, -995.9147941731061, -1228.6108509537364, -934.4229837735103, -776.5614355695958, -621.715651964171, -864.3261664824307, -1055.6522289793918, -565.8901652246673, -737.249666349422, -858.641909765053, -688.2156342476392, -861.838701554391, -900.2700053728789, -713.5719773131852, -814.3869424472393, -726.3350777871877, -835.6300323416948, -856.8642543921059, -655.7523047735523, -597.4852506153485, -530.1536203643059, -843.3392975307421, -587.9365190439107], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.957616296594196, "mean_inference_ms": 0.4041612795361977, "mean_action_processing_ms": 0.09661558052888489, "mean_env_wait_ms": 4.66193467413207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036369051252092633, "StateBufferConnector_ms": 0.002750669206891741, "ViewRequirementAgentConnector_ms": 0.07136481148856026}}, "episode_reward_max": -447.971528146465, "episode_reward_min": -1228.6108509537364, "episode_reward_mean": -759.530529647891, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-808.110443610696, -640.0512464290508, -447.971528146465, -645.1045730956314, -549.4669143009, -680.7455070835609, -599.5234837568506, -573.6726515424044, -859.1871993007937, -933.7798957988444, -803.4040243070591, -791.7855992846615, -995.9147941731061, -1228.6108509537364, -934.4229837735103, -776.5614355695958, -621.715651964171, -864.3261664824307, -1055.6522289793918, -565.8901652246673, -737.249666349422, -858.641909765053, -688.2156342476392, -861.838701554391, -900.2700053728789, -713.5719773131852, -814.3869424472393, -726.3350777871877, -835.6300323416948, -856.8642543921059, -655.7523047735523, -597.4852506153485, -530.1536203643059, -843.3392975307421, -587.9365190439107], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.957616296594196, "mean_inference_ms": 0.4041612795361977, "mean_action_processing_ms": 0.09661558052888489, "mean_env_wait_ms": 4.66193467413207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036369051252092633, "StateBufferConnector_ms": 0.002750669206891741, "ViewRequirementAgentConnector_ms": 0.07136481148856026}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224760, "num_agent_steps_trained": 224760, "num_env_steps_sampled": 224760, "num_env_steps_trained": 224760, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.06809535115285, "num_env_steps_trained_throughput_per_sec": 41.06809535115285, "timesteps_total": 224760, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 224760, "timers": {"training_iteration_time_ms": 2897.091, "sample_time_ms": 2893.343, "load_time_ms": 0.22, "load_throughput": 545955.613, "learn_time_ms": 2.774, "learn_throughput": 43266.267, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 224760, "num_env_steps_trained": 224760, "num_agent_steps_sampled": 224760, "num_agent_steps_trained": 224760}, "done": false, "episodes_total": 1873, "training_iteration": 469, "trial_id": "59a5e_00000", "date": "2023-07-26_03-01-45", "timestamp": 1690329705, "time_this_iter_s": 11.690433979034424, "time_total_s": 5726.1300184726715, "pid": 92986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f576700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 104.8045425415039, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 42.800000000000004, "ram_util_percent": 76.01176470588236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.5190734863281, "policy_loss": -71074.609375, "vf_loss": 2768709.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}}, "num_env_steps_sampled": 225240, "num_env_steps_trained": 225240, "num_agent_steps_sampled": 225240, "num_agent_steps_trained": 225240}, "sampler_results": {"episode_reward_max": -447.971528146465, "episode_reward_min": -1228.6108509537364, "episode_reward_mean": -759.9629611776311, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-808.110443610696, -640.0512464290508, -447.971528146465, -645.1045730956314, -549.4669143009, -680.7455070835609, -599.5234837568506, -573.6726515424044, -859.1871993007937, -933.7798957988444, -803.4040243070591, -791.7855992846615, -995.9147941731061, -1228.6108509537364, -934.4229837735103, -776.5614355695958, -621.715651964171, -864.3261664824307, -1055.6522289793918, -565.8901652246673, -737.249666349422, -858.641909765053, -688.2156342476392, -861.838701554391, -900.2700053728789, -713.5719773131852, -814.3869424472393, -726.3350777871877, -835.6300323416948, -856.8642543921059, -655.7523047735523, -597.4852506153485, -530.1536203643059, -843.3392975307421, -587.9365190439107, -782.1191684592422, -830.0277062722189, -907.8669854342356, -534.9730880857319], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.96312441500609, "mean_inference_ms": 0.4041596734646213, "mean_action_processing_ms": 0.09662272384038749, "mean_env_wait_ms": 4.519394280008525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036588081946739783, "StateBufferConnector_ms": 0.002769323495718149, "ViewRequirementAgentConnector_ms": 0.0721907004331931}}, "episode_reward_max": -447.971528146465, "episode_reward_min": -1228.6108509537364, "episode_reward_mean": -759.9629611776311, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-808.110443610696, -640.0512464290508, -447.971528146465, -645.1045730956314, -549.4669143009, -680.7455070835609, -599.5234837568506, -573.6726515424044, -859.1871993007937, -933.7798957988444, -803.4040243070591, -791.7855992846615, -995.9147941731061, -1228.6108509537364, -934.4229837735103, -776.5614355695958, -621.715651964171, -864.3261664824307, -1055.6522289793918, -565.8901652246673, -737.249666349422, -858.641909765053, -688.2156342476392, -861.838701554391, -900.2700053728789, -713.5719773131852, -814.3869424472393, -726.3350777871877, -835.6300323416948, -856.8642543921059, -655.7523047735523, -597.4852506153485, -530.1536203643059, -843.3392975307421, -587.9365190439107, -782.1191684592422, -830.0277062722189, -907.8669854342356, -534.9730880857319], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.96312441500609, "mean_inference_ms": 0.4041596734646213, "mean_action_processing_ms": 0.09662272384038749, "mean_env_wait_ms": 4.519394280008525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036588081946739783, "StateBufferConnector_ms": 0.002769323495718149, "ViewRequirementAgentConnector_ms": 0.0721907004331931}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 225240, "num_agent_steps_trained": 225240, "num_env_steps_sampled": 225240, "num_env_steps_trained": 225240, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.34009811401526, "num_env_steps_trained_throughput_per_sec": 41.34009811401526, "timesteps_total": 225240, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 225240, "timers": {"training_iteration_time_ms": 2904.475, "sample_time_ms": 2900.735, "load_time_ms": 0.219, "load_throughput": 547142.602, "learn_time_ms": 2.762, "learn_throughput": 43442.156, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 225240, "num_env_steps_trained": 225240, "num_agent_steps_sampled": 225240, "num_agent_steps_trained": 225240}, "done": false, "episodes_total": 1877, "training_iteration": 470, "trial_id": "59a5e_00000", "date": "2023-07-26_03-01-57", "timestamp": 1690329717, "time_this_iter_s": 11.613569974899292, "time_total_s": 5737.743588447571, "pid": 92986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f576700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 116.4181125164032, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 42.46875, "ram_util_percent": 77.90625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.49285888671875, "policy_loss": -55293.8046875, "vf_loss": 1562271.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}}, "num_env_steps_sampled": 225720, "num_env_steps_trained": 225720, "num_agent_steps_sampled": 225720, "num_agent_steps_trained": 225720}, "sampler_results": {"episode_reward_max": -447.971528146465, "episode_reward_min": -1228.6108509537364, "episode_reward_mean": -752.3527138888469, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-808.110443610696, -640.0512464290508, -447.971528146465, -645.1045730956314, -549.4669143009, -680.7455070835609, -599.5234837568506, -573.6726515424044, -859.1871993007937, -933.7798957988444, -803.4040243070591, -791.7855992846615, -995.9147941731061, -1228.6108509537364, -934.4229837735103, -776.5614355695958, -621.715651964171, -864.3261664824307, -1055.6522289793918, -565.8901652246673, -737.249666349422, -858.641909765053, -688.2156342476392, -861.838701554391, -900.2700053728789, -713.5719773131852, -814.3869424472393, -726.3350777871877, -835.6300323416948, -856.8642543921059, -655.7523047735523, -597.4852506153485, -530.1536203643059, -843.3392975307421, -587.9365190439107, -782.1191684592422, -830.0277062722189, -907.8669854342356, -534.9730880857319, -754.050510992144, -736.4374948893237, -748.6745759576813, -473.4486294536536], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.965237354760387, "mean_inference_ms": 0.4041147286057963, "mean_action_processing_ms": 0.09661470906691969, "mean_env_wait_ms": 4.3971021294730015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036827353544013446, "StateBufferConnector_ms": 0.002771200135696766, "ViewRequirementAgentConnector_ms": 0.07184660711953807}}, "episode_reward_max": -447.971528146465, "episode_reward_min": -1228.6108509537364, "episode_reward_mean": -752.3527138888469, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-808.110443610696, -640.0512464290508, -447.971528146465, -645.1045730956314, -549.4669143009, -680.7455070835609, -599.5234837568506, -573.6726515424044, -859.1871993007937, -933.7798957988444, -803.4040243070591, -791.7855992846615, -995.9147941731061, -1228.6108509537364, -934.4229837735103, -776.5614355695958, -621.715651964171, -864.3261664824307, -1055.6522289793918, -565.8901652246673, -737.249666349422, -858.641909765053, -688.2156342476392, -861.838701554391, -900.2700053728789, -713.5719773131852, -814.3869424472393, -726.3350777871877, -835.6300323416948, -856.8642543921059, -655.7523047735523, -597.4852506153485, -530.1536203643059, -843.3392975307421, -587.9365190439107, -782.1191684592422, -830.0277062722189, -907.8669854342356, -534.9730880857319, -754.050510992144, -736.4374948893237, -748.6745759576813, -473.4486294536536], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.965237354760387, "mean_inference_ms": 0.4041147286057963, "mean_action_processing_ms": 0.09661470906691969, "mean_env_wait_ms": 4.3971021294730015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036827353544013446, "StateBufferConnector_ms": 0.002771200135696766, "ViewRequirementAgentConnector_ms": 0.07184660711953807}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 225720, "num_agent_steps_trained": 225720, "num_env_steps_sampled": 225720, "num_env_steps_trained": 225720, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.91875070388902, "num_env_steps_trained_throughput_per_sec": 41.91875070388902, "timesteps_total": 225720, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 225720, "timers": {"training_iteration_time_ms": 2905.651, "sample_time_ms": 2901.876, "load_time_ms": 0.22, "load_throughput": 544361.324, "learn_time_ms": 2.767, "learn_throughput": 43375.143, "synch_weights_time_ms": 0.749}, "counters": {"num_env_steps_sampled": 225720, "num_env_steps_trained": 225720, "num_agent_steps_sampled": 225720, "num_agent_steps_trained": 225720}, "done": false, "episodes_total": 1881, "training_iteration": 471, "trial_id": "59a5e_00000", "date": "2023-07-26_03-02-08", "timestamp": 1690329728, "time_this_iter_s": 11.453282117843628, "time_total_s": 5749.196870565414, "pid": 92986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f576700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 127.87139463424683, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 36.96470588235294, "ram_util_percent": 76.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.5152893066406, "policy_loss": -109092.171875, "vf_loss": 5245068.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}}, "num_env_steps_sampled": 226200, "num_env_steps_trained": 226200, "num_agent_steps_sampled": 226200, "num_agent_steps_trained": 226200}, "sampler_results": {"episode_reward_max": -447.971528146465, "episode_reward_min": -1228.6108509537364, "episode_reward_mean": -756.7932163177996, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-808.110443610696, -640.0512464290508, -447.971528146465, -645.1045730956314, -549.4669143009, -680.7455070835609, -599.5234837568506, -573.6726515424044, -859.1871993007937, -933.7798957988444, -803.4040243070591, -791.7855992846615, -995.9147941731061, -1228.6108509537364, -934.4229837735103, -776.5614355695958, -621.715651964171, -864.3261664824307, -1055.6522289793918, -565.8901652246673, -737.249666349422, -858.641909765053, -688.2156342476392, -861.838701554391, -900.2700053728789, -713.5719773131852, -814.3869424472393, -726.3350777871877, -835.6300323416948, -856.8642543921059, -655.7523047735523, -597.4852506153485, -530.1536203643059, -843.3392975307421, -587.9365190439107, -782.1191684592422, -830.0277062722189, -907.8669854342356, -534.9730880857319, -754.050510992144, -736.4374948893237, -748.6745759576813, -473.4486294536536, -706.5139794727601, -961.0698294683373, -664.4537555188972, -886.0769052561755], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.96451759439154, "mean_inference_ms": 0.4040402650259418, "mean_action_processing_ms": 0.09660210260445284, "mean_env_wait_ms": 4.291735672294559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003631064232359541, "StateBufferConnector_ms": 0.002763626423287899, "ViewRequirementAgentConnector_ms": 0.0714819482032289}}, "episode_reward_max": -447.971528146465, "episode_reward_min": -1228.6108509537364, "episode_reward_mean": -756.7932163177996, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-808.110443610696, -640.0512464290508, -447.971528146465, -645.1045730956314, -549.4669143009, -680.7455070835609, -599.5234837568506, -573.6726515424044, -859.1871993007937, -933.7798957988444, -803.4040243070591, -791.7855992846615, -995.9147941731061, -1228.6108509537364, -934.4229837735103, -776.5614355695958, -621.715651964171, -864.3261664824307, -1055.6522289793918, -565.8901652246673, -737.249666349422, -858.641909765053, -688.2156342476392, -861.838701554391, -900.2700053728789, -713.5719773131852, -814.3869424472393, -726.3350777871877, -835.6300323416948, -856.8642543921059, -655.7523047735523, -597.4852506153485, -530.1536203643059, -843.3392975307421, -587.9365190439107, -782.1191684592422, -830.0277062722189, -907.8669854342356, -534.9730880857319, -754.050510992144, -736.4374948893237, -748.6745759576813, -473.4486294536536, -706.5139794727601, -961.0698294683373, -664.4537555188972, -886.0769052561755], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.96451759439154, "mean_inference_ms": 0.4040402650259418, "mean_action_processing_ms": 0.09660210260445284, "mean_env_wait_ms": 4.291735672294559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003631064232359541, "StateBufferConnector_ms": 0.002763626423287899, "ViewRequirementAgentConnector_ms": 0.0714819482032289}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 226200, "num_agent_steps_trained": 226200, "num_env_steps_sampled": 226200, "num_env_steps_trained": 226200, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.86837995595937, "num_env_steps_trained_throughput_per_sec": 41.86837995595937, "timesteps_total": 226200, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 226200, "timers": {"training_iteration_time_ms": 2882.999, "sample_time_ms": 2879.156, "load_time_ms": 0.224, "load_throughput": 536184.596, "learn_time_ms": 2.815, "learn_throughput": 42636.234, "synch_weights_time_ms": 0.764}, "counters": {"num_env_steps_sampled": 226200, "num_env_steps_trained": 226200, "num_agent_steps_sampled": 226200, "num_agent_steps_trained": 226200}, "done": false, "episodes_total": 1885, "training_iteration": 472, "trial_id": "59a5e_00000", "date": "2023-07-26_03-02-20", "timestamp": 1690329740, "time_this_iter_s": 11.467336893081665, "time_total_s": 5760.664207458496, "pid": 92986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f576700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 139.3387315273285, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 40.349999999999994, "ram_util_percent": 77.1125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4950256347656, "policy_loss": -137009.421875, "vf_loss": 8285757.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}}, "num_env_steps_sampled": 226680, "num_env_steps_trained": 226680, "num_agent_steps_sampled": 226680, "num_agent_steps_trained": 226680}, "sampler_results": {"episode_reward_max": -447.971528146465, "episode_reward_min": -1228.6108509537364, "episode_reward_mean": -756.2903432215035, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-808.110443610696, -640.0512464290508, -447.971528146465, -645.1045730956314, -549.4669143009, -680.7455070835609, -599.5234837568506, -573.6726515424044, -859.1871993007937, -933.7798957988444, -803.4040243070591, -791.7855992846615, -995.9147941731061, -1228.6108509537364, -934.4229837735103, -776.5614355695958, -621.715651964171, -864.3261664824307, -1055.6522289793918, -565.8901652246673, -737.249666349422, -858.641909765053, -688.2156342476392, -861.838701554391, -900.2700053728789, -713.5719773131852, -814.3869424472393, -726.3350777871877, -835.6300323416948, -856.8642543921059, -655.7523047735523, -597.4852506153485, -530.1536203643059, -843.3392975307421, -587.9365190439107, -782.1191684592422, -830.0277062722189, -907.8669854342356, -534.9730880857319, -754.050510992144, -736.4374948893237, -748.6745759576813, -473.4486294536536, -706.5139794727601, -961.0698294683373, -664.4537555188972, -886.0769052561755, -535.6387699753877, -577.471385438633, -863.0993420213517, -1025.3168399247143], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.963540550177505, "mean_inference_ms": 0.4041407553734885, "mean_action_processing_ms": 0.09661078141618099, "mean_env_wait_ms": 4.199669153234907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037165249095243566, "StateBufferConnector_ms": 0.0027679929546281404, "ViewRequirementAgentConnector_ms": 0.07160411161534927}}, "episode_reward_max": -447.971528146465, "episode_reward_min": -1228.6108509537364, "episode_reward_mean": -756.2903432215035, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-808.110443610696, -640.0512464290508, -447.971528146465, -645.1045730956314, -549.4669143009, -680.7455070835609, -599.5234837568506, -573.6726515424044, -859.1871993007937, -933.7798957988444, -803.4040243070591, -791.7855992846615, -995.9147941731061, -1228.6108509537364, -934.4229837735103, -776.5614355695958, -621.715651964171, -864.3261664824307, -1055.6522289793918, -565.8901652246673, -737.249666349422, -858.641909765053, -688.2156342476392, -861.838701554391, -900.2700053728789, -713.5719773131852, -814.3869424472393, -726.3350777871877, -835.6300323416948, -856.8642543921059, -655.7523047735523, -597.4852506153485, -530.1536203643059, -843.3392975307421, -587.9365190439107, -782.1191684592422, -830.0277062722189, -907.8669854342356, -534.9730880857319, -754.050510992144, -736.4374948893237, -748.6745759576813, -473.4486294536536, -706.5139794727601, -961.0698294683373, -664.4537555188972, -886.0769052561755, -535.6387699753877, -577.471385438633, -863.0993420213517, -1025.3168399247143], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.963540550177505, "mean_inference_ms": 0.4041407553734885, "mean_action_processing_ms": 0.09661078141618099, "mean_env_wait_ms": 4.199669153234907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037165249095243566, "StateBufferConnector_ms": 0.0027679929546281404, "ViewRequirementAgentConnector_ms": 0.07160411161534927}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 226680, "num_agent_steps_trained": 226680, "num_env_steps_sampled": 226680, "num_env_steps_trained": 226680, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.42283648584705, "num_env_steps_trained_throughput_per_sec": 41.42283648584705, "timesteps_total": 226680, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 226680, "timers": {"training_iteration_time_ms": 2872.371, "sample_time_ms": 2868.397, "load_time_ms": 0.224, "load_throughput": 534589.995, "learn_time_ms": 2.928, "learn_throughput": 40985.015, "synch_weights_time_ms": 0.78}, "counters": {"num_env_steps_sampled": 226680, "num_env_steps_trained": 226680, "num_agent_steps_sampled": 226680, "num_agent_steps_trained": 226680}, "done": false, "episodes_total": 1889, "training_iteration": 473, "trial_id": "59a5e_00000", "date": "2023-07-26_03-02-31", "timestamp": 1690329751, "time_this_iter_s": 11.590423107147217, "time_total_s": 5772.254630565643, "pid": 92986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f576700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 150.9291546344757, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 41.725, "ram_util_percent": 77.33125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.5224914550781, "policy_loss": -123476.40625, "vf_loss": 7063634.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 54.0}}, "num_env_steps_sampled": 227160, "num_env_steps_trained": 227160, "num_agent_steps_sampled": 227160, "num_agent_steps_trained": 227160}, "sampler_results": {"episode_reward_max": -447.971528146465, "episode_reward_min": -1228.6108509537364, "episode_reward_mean": -766.1609649487684, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-808.110443610696, -640.0512464290508, -447.971528146465, -645.1045730956314, -549.4669143009, -680.7455070835609, -599.5234837568506, -573.6726515424044, -859.1871993007937, -933.7798957988444, -803.4040243070591, -791.7855992846615, -995.9147941731061, -1228.6108509537364, -934.4229837735103, -776.5614355695958, -621.715651964171, -864.3261664824307, -1055.6522289793918, -565.8901652246673, -737.249666349422, -858.641909765053, -688.2156342476392, -861.838701554391, -900.2700053728789, -713.5719773131852, -814.3869424472393, -726.3350777871877, -835.6300323416948, -856.8642543921059, -655.7523047735523, -597.4852506153485, -530.1536203643059, -843.3392975307421, -587.9365190439107, -782.1191684592422, -830.0277062722189, -907.8669854342356, -534.9730880857319, -754.050510992144, -736.4374948893237, -748.6745759576813, -473.4486294536536, -706.5139794727601, -961.0698294683373, -664.4537555188972, -886.0769052561755, -535.6387699753877, -577.471385438633, -863.0993420213517, -1025.3168399247143, -1071.3068260516327, -745.9131426318907, -822.2237957823311, -928.601803419731], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.963703457848755, "mean_inference_ms": 0.4041977183472668, "mean_action_processing_ms": 0.09661017428620645, "mean_env_wait_ms": 4.118875440352632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003664710304953835, "StateBufferConnector_ms": 0.0027669559825550427, "ViewRequirementAgentConnector_ms": 0.07128758863969283}}, "episode_reward_max": -447.971528146465, "episode_reward_min": -1228.6108509537364, "episode_reward_mean": -766.1609649487684, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-808.110443610696, -640.0512464290508, -447.971528146465, -645.1045730956314, -549.4669143009, -680.7455070835609, -599.5234837568506, -573.6726515424044, -859.1871993007937, -933.7798957988444, -803.4040243070591, -791.7855992846615, -995.9147941731061, -1228.6108509537364, -934.4229837735103, -776.5614355695958, -621.715651964171, -864.3261664824307, -1055.6522289793918, -565.8901652246673, -737.249666349422, -858.641909765053, -688.2156342476392, -861.838701554391, -900.2700053728789, -713.5719773131852, -814.3869424472393, -726.3350777871877, -835.6300323416948, -856.8642543921059, -655.7523047735523, -597.4852506153485, -530.1536203643059, -843.3392975307421, -587.9365190439107, -782.1191684592422, -830.0277062722189, -907.8669854342356, -534.9730880857319, -754.050510992144, -736.4374948893237, -748.6745759576813, -473.4486294536536, -706.5139794727601, -961.0698294683373, -664.4537555188972, -886.0769052561755, -535.6387699753877, -577.471385438633, -863.0993420213517, -1025.3168399247143, -1071.3068260516327, -745.9131426318907, -822.2237957823311, -928.601803419731], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.963703457848755, "mean_inference_ms": 0.4041977183472668, "mean_action_processing_ms": 0.09661017428620645, "mean_env_wait_ms": 4.118875440352632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003664710304953835, "StateBufferConnector_ms": 0.0027669559825550427, "ViewRequirementAgentConnector_ms": 0.07128758863969283}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 227160, "num_agent_steps_trained": 227160, "num_env_steps_sampled": 227160, "num_env_steps_trained": 227160, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.935795977728176, "num_env_steps_trained_throughput_per_sec": 40.935795977728176, "timesteps_total": 227160, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 227160, "timers": {"training_iteration_time_ms": 2905.168, "sample_time_ms": 2901.22, "load_time_ms": 0.223, "load_throughput": 538248.829, "learn_time_ms": 2.925, "learn_throughput": 41023.766, "synch_weights_time_ms": 0.76}, "counters": {"num_env_steps_sampled": 227160, "num_env_steps_trained": 227160, "num_agent_steps_sampled": 227160, "num_agent_steps_trained": 227160}, "done": false, "episodes_total": 1893, "training_iteration": 474, "trial_id": "59a5e_00000", "date": "2023-07-26_03-02-43", "timestamp": 1690329763, "time_this_iter_s": 11.72835397720337, "time_total_s": 5783.982984542847, "pid": 92986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f576700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 162.65750861167908, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 41.811764705882354, "ram_util_percent": 77.8294117647059}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.5184020996094, "policy_loss": -113359.28125, "vf_loss": 5704716.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 58.0}}, "num_env_steps_sampled": 227640, "num_env_steps_trained": 227640, "num_agent_steps_sampled": 227640, "num_agent_steps_trained": 227640}, "sampler_results": {"episode_reward_max": -447.971528146465, "episode_reward_min": -1228.6108509537364, "episode_reward_mean": -770.5876029340824, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-808.110443610696, -640.0512464290508, -447.971528146465, -645.1045730956314, -549.4669143009, -680.7455070835609, -599.5234837568506, -573.6726515424044, -859.1871993007937, -933.7798957988444, -803.4040243070591, -791.7855992846615, -995.9147941731061, -1228.6108509537364, -934.4229837735103, -776.5614355695958, -621.715651964171, -864.3261664824307, -1055.6522289793918, -565.8901652246673, -737.249666349422, -858.641909765053, -688.2156342476392, -861.838701554391, -900.2700053728789, -713.5719773131852, -814.3869424472393, -726.3350777871877, -835.6300323416948, -856.8642543921059, -655.7523047735523, -597.4852506153485, -530.1536203643059, -843.3392975307421, -587.9365190439107, -782.1191684592422, -830.0277062722189, -907.8669854342356, -534.9730880857319, -754.050510992144, -736.4374948893237, -748.6745759576813, -473.4486294536536, -706.5139794727601, -961.0698294683373, -664.4537555188972, -886.0769052561755, -535.6387699753877, -577.471385438633, -863.0993420213517, -1025.3168399247143, -1071.3068260516327, -745.9131426318907, -822.2237957823311, -928.601803419731, -735.0186406906979, -877.1118020314492, -914.0157620695743, -799.6692961368831], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.96544187199422, "mean_inference_ms": 0.4045036414818955, "mean_action_processing_ms": 0.09663774436762355, "mean_env_wait_ms": 4.048680621398508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036409345723814883, "StateBufferConnector_ms": 0.002752320241119902, "ViewRequirementAgentConnector_ms": 0.07111783755027641}}, "episode_reward_max": -447.971528146465, "episode_reward_min": -1228.6108509537364, "episode_reward_mean": -770.5876029340824, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-808.110443610696, -640.0512464290508, -447.971528146465, -645.1045730956314, -549.4669143009, -680.7455070835609, -599.5234837568506, -573.6726515424044, -859.1871993007937, -933.7798957988444, -803.4040243070591, -791.7855992846615, -995.9147941731061, -1228.6108509537364, -934.4229837735103, -776.5614355695958, -621.715651964171, -864.3261664824307, -1055.6522289793918, -565.8901652246673, -737.249666349422, -858.641909765053, -688.2156342476392, -861.838701554391, -900.2700053728789, -713.5719773131852, -814.3869424472393, -726.3350777871877, -835.6300323416948, -856.8642543921059, -655.7523047735523, -597.4852506153485, -530.1536203643059, -843.3392975307421, -587.9365190439107, -782.1191684592422, -830.0277062722189, -907.8669854342356, -534.9730880857319, -754.050510992144, -736.4374948893237, -748.6745759576813, -473.4486294536536, -706.5139794727601, -961.0698294683373, -664.4537555188972, -886.0769052561755, -535.6387699753877, -577.471385438633, -863.0993420213517, -1025.3168399247143, -1071.3068260516327, -745.9131426318907, -822.2237957823311, -928.601803419731, -735.0186406906979, -877.1118020314492, -914.0157620695743, -799.6692961368831], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.96544187199422, "mean_inference_ms": 0.4045036414818955, "mean_action_processing_ms": 0.09663774436762355, "mean_env_wait_ms": 4.048680621398508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036409345723814883, "StateBufferConnector_ms": 0.002752320241119902, "ViewRequirementAgentConnector_ms": 0.07111783755027641}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 227640, "num_agent_steps_trained": 227640, "num_env_steps_sampled": 227640, "num_env_steps_trained": 227640, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.04913955255762, "num_env_steps_trained_throughput_per_sec": 40.04913955255762, "timesteps_total": 227640, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 227640, "timers": {"training_iteration_time_ms": 2944.704, "sample_time_ms": 2940.719, "load_time_ms": 0.23, "load_throughput": 522004.231, "learn_time_ms": 2.973, "learn_throughput": 40363.482, "synch_weights_time_ms": 0.738}, "counters": {"num_env_steps_sampled": 227640, "num_env_steps_trained": 227640, "num_agent_steps_sampled": 227640, "num_agent_steps_trained": 227640}, "done": false, "episodes_total": 1897, "training_iteration": 475, "trial_id": "59a5e_00000", "date": "2023-07-26_03-02-55", "timestamp": 1690329775, "time_this_iter_s": 11.988101720809937, "time_total_s": 5795.971086263657, "pid": 92986, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f576700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 174.645610332489, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 37.7764705882353, "ram_util_percent": 77.65294117647058}}
